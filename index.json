[{"authors":null,"categories":null,"content":"","date":1612051200,"expirydate":-62135596800,"kind":"term","lang":"zh","lastmod":1612051200,"objectID":"7e67303e3d29a2216e9a2e04059938a0","permalink":"https://CoMath21.github.io/authors/comath/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/authors/comath/","section":"authors","summary":"","tags":null,"title":"CoMath","type":"authors"},{"authors":null,"categories":null,"content":"å…³äºæˆ‘ 96åï¼Œ2019çº§è®¡ç®—æ•°å­¦ç¡•å£«åœ¨è¯»ï¼Œ ä¸€ä¸ªåˆšæ­¥å…¥è®¡ç®—æ•°å­¦é¢†åŸŸçš„å°å­¦ç”ŸğŸ˜‚ï¼›æœ¬ç§‘ä¸“ä¸šä¿¡æ¯ä¸è®¡ç®—ç§‘å­¦ï¼Œå½“åˆä½œä¸ºä¸€ä¸ªåˆšåˆšæ­¥å…¥å¤§å­¦ç”Ÿæ´»çš„å°å¹´è½»ï¼Œæ²¡æœ‰è¿‡å¤šçš„è€ƒè™‘ï¼Œåªæƒ³æ¯•ä¸šå·¥ä½œæŒ£é’±ğŸ˜…. åœ¨è’åºŸäº†ä¸€å¹´çš„æ—¶é—´åï¼Œå¼€å§‹å­¦ä¹ è®¡ç®—æœºç¼–ç¨‹. C++å…¥é—¨ï¼Œåè‡ªå­¦Javaè¿›é˜¶(ä¹Ÿå¿«å¿˜çš„å·®ä¸å¤šäº†ğŸ˜–ï¼Œä¸è¿‡ç¼–ç¨‹çš„æ€æƒ³è¿˜åœ¨)ï¼Œç›®å‰èƒ½å¤Ÿç†Ÿç»ƒæŒæ¡Matlabå’ŒPython(ç¨å·®ä¸€ç‚¹). ç›¸æ¯”è¾ƒäºç¼–ç¨‹ï¼Œå¯¹æ•°å­¦çš„çƒ­çˆ±ç•¥å°‘ä¸€ç‚¹(æ•°å­¦åº•å­è¾ƒå·®)ï¼Œå¸Œæœ›ä»¥åèƒ½å¤Ÿå¼¥è¡¥è¿™ä¸€çŸ­æ¿. ä¸ä¼šæŠ½çƒŸï¼Œè·Ÿæœ‹å‹ä¼šå°é…Œä¸€æ¯ï¼Œå–œæ¬¢åŠ¨ç”µå½±ã€åŠ¨æ¼«ï¼›è¿åŠ¨ç»†èƒæ¯”è¾ƒç¨€ç¼ºï¼Œä»ä¸æ–­å¼€å‘è®­ç»ƒä¸­ğŸ’ª.\nä¸ºä»€ä¹ˆå†™åšå®¢ å…¶å®åœ¨æˆ‘å¤§ä¸‰çš„æ—¶å€™å°±å·²ç»è°‹ç”Ÿäº†åšä¸ªäººåšå®¢çš„æƒ³æ³•ğŸ¤”ï¼Œå½“æ—¶çš„æˆ‘è¿˜æ˜¯ä¸€å¿ƒæƒ³ç€æ¯•ä¸šä¹‹åå·¥ä½œï¼Œä¸€ç›´åŸ‹å¤´äºå­¦ç¨‹åºã€æ•²ä»£ç ï¼Œå¾ˆå¤šå­¦ä¹ ç¬”è®°ä¹Ÿæ˜¯åœ¨é‚£ä¸ªæ—¶å€™ç§¯ç´¯çš„ï¼›å‡­å€Ÿå½“åˆå­¦ä¹ çš„Javaã€æ•°æ®åº“ç­‰çŸ¥è¯†ç¡®å®åšäº†ä¸€ä¸ªåŸºäºSSHæ¡†æ¶çš„ä¸ªäººåšå®¢(å¦‚æœè¿˜èƒ½é‡æ–°æ­å»ºå‡ºåŸæ¥çš„ç¯å¢ƒï¼Œæˆ‘ä¼šå°†è¿™ä¸ªåšå®¢çš„ä»£ç å…±äº«å‡ºæ¥ğŸ˜)ï¼Œæƒ³çš„æ˜¯å¯ä»¥å°†å­¦è¿‡çš„ç¼–ç¨‹è¯­è¨€ã€é‡åˆ°çš„å„ç§Bugè¿›è¡Œæ•´ç†ç•™ä¸ªå¤‡ä»½ï¼Œæ–¹ä¾¿è‡ªå·±éšæ—¶ç¿»é˜…ï¼›è¿˜æœ‰ä¸€ä¸ªåŸå› å°±æ˜¯æƒ³ç€æœ‰è¿™æ ·ä¸€ä¸ªå®Œå…¨ç”±è‡ªå·±æ­å»ºçš„Blogèƒ½å¤Ÿå¾—åˆ°HRçš„è®¤å¯ğŸ˜„.ç›´åˆ°åæ¥é€‰æ‹©è¯»ç ”å°±ä¸€ç›´æ”¾ä¸‹äº†ï¼Œç°åœ¨å†æ¡èµ·æ¥çš„ç›®çš„ä¸€æ˜¯ä¸ºäº†ä¸æƒ³è®©å½“åˆæ•´ç†çš„ç¬”è®°æ— å¤„å®‰æ”¾ï¼Œå¦ä¸€ä¸ªä¹Ÿæ˜¯ä¸ºäº†ç£ä¿ƒè‡ªå·±èƒ½å¤Ÿåœ¨å­¦ä¹ æ–°çŸ¥è¯†çš„åŒæ—¶èƒ½æŠŠå®ƒè®²å‡ºæ¥ï¼Œåˆ†äº«å‡ºæ¥ï¼Œè¿™æ ·å¯¹è‡ªå·±ä¹Ÿæ˜¯æœ‰æ¨åŠ¨ä½œç”¨çš„ğŸ§. ","date":1612051200,"expirydate":-62135596800,"kind":"term","lang":"zh","lastmod":1612051200,"objectID":"2525497d367e79493fd32b198b28f040","permalink":"https://CoMath21.github.io/authors/admin/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/authors/admin/","section":"authors","summary":"å…³äºæˆ‘ 96åï¼Œ2019çº§è®¡ç®—æ•°å­¦ç¡•å£«åœ¨è¯»ï¼Œ ä¸€ä¸ªåˆšæ­¥å…¥è®¡ç®—æ•°å­¦é¢†åŸŸçš„å°å­¦ç”ŸğŸ˜‚ï¼›æœ¬ç§‘ä¸“ä¸šä¿¡æ¯ä¸è®¡ç®—ç§‘å­¦ï¼Œå½“åˆä½œä¸ºä¸€ä¸ªåˆšåˆšæ­¥å…¥å¤§å­¦ç”Ÿæ´»çš„å°å¹´è½»ï¼Œæ²¡æœ‰è¿‡å¤šçš„è€ƒè™‘ï¼Œåªæƒ³æ¯•ä¸šå·¥ä½œæŒ£é’±ğŸ˜…. åœ¨è’åºŸäº†ä¸€å¹´çš„æ—¶é—´åï¼Œå¼€å§‹å­¦ä¹ è®¡ç®—æœºç¼–ç¨‹. C++å…¥é—¨ï¼Œåè‡ªå­¦Javaè¿›é˜¶(ä¹Ÿå¿«å¿˜çš„å·®ä¸å¤šäº†ğŸ˜–ï¼Œä¸è¿‡ç¼–ç¨‹çš„æ€æƒ³è¿˜åœ¨)ï¼Œç›®å‰èƒ½å¤Ÿç†Ÿç»ƒæŒæ¡Matlabå’ŒPython(ç¨å·®ä¸€ç‚¹). ç›¸æ¯”è¾ƒäºç¼–ç¨‹ï¼Œå¯¹æ•°å­¦çš„çƒ­çˆ±ç•¥å°‘ä¸€ç‚¹(æ•°å­¦åº•å­è¾ƒå·®)ï¼Œå¸Œæœ›ä»¥åèƒ½å¤Ÿå¼¥è¡¥è¿™ä¸€çŸ­æ¿. ä¸ä¼šæŠ½çƒŸï¼Œè·Ÿæœ‹å‹ä¼šå°é…Œä¸€æ¯ï¼Œå–œæ¬¢åŠ¨ç”µå½±ã€åŠ¨æ¼«ï¼›è¿åŠ¨ç»†èƒæ¯”è¾ƒç¨€ç¼ºï¼Œä»ä¸æ–­å¼€å‘è®­ç»ƒä¸­ğŸ’ª.\nä¸ºä»€ä¹ˆå†™åšå®¢ å…¶å®åœ¨æˆ‘å¤§ä¸‰çš„æ—¶å€™å°±å·²ç»è°‹ç”Ÿäº†åšä¸ªäººåšå®¢çš„æƒ³æ³•ğŸ¤”ï¼Œå½“æ—¶çš„æˆ‘è¿˜æ˜¯ä¸€å¿ƒæƒ³ç€æ¯•ä¸šä¹‹åå·¥ä½œï¼Œä¸€ç›´åŸ‹å¤´äºå­¦ç¨‹åºã€æ•²ä»£ç ï¼Œå¾ˆå¤šå­¦ä¹ ç¬”è®°ä¹Ÿæ˜¯åœ¨é‚£ä¸ªæ—¶å€™ç§¯ç´¯çš„ï¼›å‡­å€Ÿå½“åˆå­¦ä¹ çš„Javaã€æ•°æ®åº“ç­‰çŸ¥è¯†ç¡®å®åšäº†ä¸€ä¸ªåŸºäºSSHæ¡†æ¶çš„ä¸ªäººåšå®¢(å¦‚æœè¿˜èƒ½é‡æ–°æ­å»ºå‡ºåŸæ¥çš„ç¯å¢ƒï¼Œæˆ‘ä¼šå°†è¿™ä¸ªåšå®¢çš„ä»£ç å…±äº«å‡ºæ¥ğŸ˜)ï¼Œæƒ³çš„æ˜¯å¯ä»¥å°†å­¦è¿‡çš„ç¼–ç¨‹è¯­è¨€ã€é‡åˆ°çš„å„ç§Bugè¿›è¡Œæ•´ç†ç•™ä¸ªå¤‡ä»½ï¼Œæ–¹ä¾¿è‡ªå·±éšæ—¶ç¿»é˜…ï¼›è¿˜æœ‰ä¸€ä¸ªåŸå› å°±æ˜¯æƒ³ç€æœ‰è¿™æ ·ä¸€ä¸ªå®Œå…¨ç”±è‡ªå·±æ­å»ºçš„Blogèƒ½å¤Ÿå¾—åˆ°HRçš„è®¤å¯ğŸ˜„.ç›´åˆ°åæ¥é€‰æ‹©è¯»ç ”å°±ä¸€ç›´æ”¾ä¸‹äº†ï¼Œç°åœ¨å†æ¡èµ·æ¥çš„ç›®çš„ä¸€æ˜¯ä¸ºäº†ä¸æƒ³è®©å½“åˆæ•´ç†çš„ç¬”è®°æ— å¤„å®‰æ”¾ï¼Œå¦ä¸€ä¸ªä¹Ÿæ˜¯ä¸ºäº†ç£ä¿ƒè‡ªå·±èƒ½å¤Ÿåœ¨å­¦ä¹ æ–°çŸ¥è¯†çš„åŒæ—¶èƒ½æŠŠå®ƒè®²å‡ºæ¥ï¼Œåˆ†äº«å‡ºæ¥ï¼Œè¿™æ ·å¯¹è‡ªå·±ä¹Ÿæ˜¯æœ‰æ¨åŠ¨ä½œç”¨çš„ğŸ§. ","tags":null,"title":"Xinæ€å¥½å…ˆç”Ÿ","type":"authors"},{"authors":["Xinæ€å¥½å…ˆç”Ÿ","CoMath"],"categories":["å­¦ä¹ ç¬”è®°","ç¼–ç¨‹è¯­è¨€"],"content":"ã€€Pythonä¸‹æœ‰è®¸å¤šæ¬¾ä¸åŒçš„ Web æ¡†æ¶. Djangoæ˜¯æœ€æœ‰ä»£è¡¨æ€§çš„ä¸€ä¸ª. è®¸å¤šæˆåŠŸçš„ç½‘ç«™å’ŒAPPéƒ½åŸºäºDjango. 2019å¹´é€šè¿‡æ…•è¯¾ç½‘çš„è§†é¢‘æ•™å­¦æ•´ç†äº†ç”±åŸºäºDjangoçš„ç½‘ç«™å¼€å‘. æ•´è¿‡è¿‡ç¨‹æŒç»­äº†å¤šé•¿æ—¶é—´å·²ç»è®°ä¸æ¸…äº†. ä¸­é—´å¾ˆå¤šç£•ç£•ç¢°ç¢°ï¼Œç½‘ä¸Šæ‰¾äº†å¾ˆå¤šææ–™æ•´åˆæˆäº†ä¸€ä¸ªç¬”è®°. æœ¬æ¥æƒ³ç€èƒ½æ¥ç€åšç‚¹ä¸œè¥¿ï¼Œä½†åæ¥è¿˜æ˜¯æ²¡æ¡èµ·æ¥.\nè™šæ‹Ÿç¯å¢ƒçš„å®‰è£…ä¸é…ç½® virtualenv virtualenvæ˜¯ä¸€æ¬¾è½»é‡çº§ç¬¬ä¸‰æ–¹è™šæ‹Ÿç¯å¢ƒç®¡ç†å·¥å…·.\nWindows å®‰è£…virtualenvå‘½ä»¤ï¼špip install virtualenv\npipå®‰è£…æŠ€å·§ï¼špythonè±†ç“£æºï¼šhttps://pypi.doubanio.com/simple/\nå®‰è£…æ—¶ä¸­é—´åŠ å…¥è±†ç“£æºå³å¯ï¼Œå¦‚ï¼š\npip3 install -i https://pypi.doubanio.com/simple/ selenium\neasy_install -i https://pypi.doubanio.com/simple/ selenium\nåˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼š\n æ­£å¸¸åˆ›å»ºï¼švirtualenv è™šæ‹Ÿç¯å¢ƒåç§° å…¶ä»–ç‰ˆæœ¬ï¼švirtualenv -p pythonç‰ˆæœ¬\\python.exe è™šæ‹Ÿç¯å¢ƒåç§°  è¿›å…¥åˆ°è™šæ‹Ÿç¯å¢ƒçš„ç›®å½•ä¸‹æ‰§è¡Œactivate.batå‘½ä»¤å¯åŠ¨è™šæ‹Ÿç¯å¢ƒ\né€€å‡ºè™šæ‹Ÿç¯å¢ƒdeactivate.batå‘½ä»¤\nLinux å®‰è£…virtualenvå‘½ä»¤ï¼šsudo apt-get install python-virtualenv\nåˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼švirtualenv è™šæ‹Ÿç¯å¢ƒåç§°ï¼ˆé»˜è®¤æ˜¯Python2.7ç‰ˆæœ¬ï¼‰\néœ€è¦è¿›å…¥åˆ°è™šæ‹Ÿç¯å¢ƒçš„binç›®å½•ä¸‹æ‰§è¡Œsource activateå¯åŠ¨è™šæ‹Ÿç¯å¢ƒ\né€€å‡ºè™šæ‹Ÿç¯å¢ƒå‘½ä»¤ï¼šdeactivate\nåˆ›å»ºPython3çš„è™šæ‹Ÿç¯å¢ƒï¼š\nvirtualenv -p python3ç›®å½• è™šæ‹Ÿç¯å¢ƒåç§°\nvirtualenv -p /usr/bin/python3 py3test\nvirtualenvwrapper virtualenvä½¿ç”¨è¿‡äºéº»çƒ¦ï¼Œæ‰€ä»¥ä¾¿äºç®¡ç†ï¼Œä½¿ç”¨virtualenvwrapperï¼ˆä¾èµ–virtualenvï¼‰\nWindows å®‰è£…ï¼š\nâ€‹\tpip install virtualenvwrapper-win\nå‘½ä»¤ï¼š\n workonï¼šæŸ¥çœ‹æ‰€æœ‰è™šæ‹Ÿç¯å¢ƒï¼› workon XXXï¼šå¯åŠ¨åä¸ºXXXçš„è™šæ‹Ÿå·¥ä½œç¯å¢ƒï¼› mkvirtualenv XXX ï¼šåˆ›å»ºåä¸ºXXXçš„è™šæ‹Ÿç¯å¢ƒï¼›ï¼ˆç›®å½•åœ¨C:\\Users\\Wise_Hai\\Envsï¼‰ mkvirtualenv \u0026ndash;python=pythonç‰ˆæœ¬ç›®å½•\\python.exe XXXï¼šåˆ›å»ºåä¸ºXXXçš„pythonç‰ˆæœ¬çš„è™šæ‹Ÿç¯å¢ƒï¼› deactivateï¼šå…³é—­å½“å‰è™šæ‹Ÿç¯å¢ƒ.  é…ç½®å·¥ä½œç¯å¢ƒï¼ˆå¯é€‰ï¼‰\n è®¡ç®—æœºå³é”®å±æ€§ ã€‹é«˜çº§ç³»ç»Ÿè®¾ç½® ã€‹ç¯å¢ƒå˜é‡ æ–°å»ºç³»ç»Ÿå˜é‡  å˜é‡åï¼šWORKON_HOME å˜é‡å€¼ï¼šå·¥ä½œç¯å¢ƒåœ°å€   ä¿å­˜å¹¶é€€å‡ºï¼Œé‡æ–°å¼€å¯å‘½ä»¤è¡Œçª—å£ å¦‚æœéœ€è¦ï¼Œå¯ä»¥æ‰¾åˆ°ä¹‹å‰çš„è™šæ‹Ÿç¯å¢ƒç›®å½•å°†å…¶ä¸­çš„è™šæ‹Ÿç¯å¢ƒç›´æ¥æ‹·è´è¿‡æ¥å³å¯.  å¤‡æ³¨ï¼šå¯åœ¨è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£…ä»»æ„åŒ…ï¼Œå¦‚æœå‡ºé”™å¯ä»¥åœ¨è¿™é‡Œä¸­æ‰¾åˆ°å®‰è£…å¤±è´¥çš„åŒ…åŠç›¸åº”çš„ç‰ˆæœ¬è¿›è¡Œä¸‹è½½å®‰è£…ï¼Œåœ¨æ‰§è¡Œä¹‹å‰çš„å®‰è£…å‘½ä»¤.\nLinux å®‰è£…å‘½ä»¤ï¼špip install virtualenvwrapper\nLinuxä¸èƒ½åƒWindowsä¸€æ ·ç›´æ¥è°ƒç”¨mkvirtualenvï¼Œå› ä¸ºæ²¡æœ‰é…ç½®.\n åˆ›å»ºç›®å½•æ¥å­˜æ”¾è™šæ‹Ÿç¯å¢ƒ   mkdir $HOME/.virtualenvs  éœ€è¦é€šè¿‡sudo find / -name virtualenvwrapper.shåœ¨æ ¹ç›®å½•ä¸‹æŸ¥æ‰¾virtualenvwrapper.shæ–‡ä»¶çš„è·¯å¾„ é…ç½®æ–‡ä»¶ï¼švim/sudo gedit ~/.bashrc  export WORKON_HOME=$HOME/ .virtualenvs export VIRTUALENVWRAPPER_PYTHON=/usr/bin/python3 #å¦‚æœæ˜¯pip3å®‰è£…çš„virtualenvwrapperæŠŠè¿™æ¡åŠ ä¸Š æœ€åä¸€è¡Œæ·»åŠ source virtualenvwrapper.shæ–‡ä»¶çš„è·¯å¾„   é‡æ–°åŠ è½½ï¼šsource ~/.bashrc mkvirtualenv XXX ï¼šåœ¨~/ .virtualenvsåˆ›å»ºåä¸ºXXXçš„è™šæ‹Ÿç¯å¢ƒ mkvirtualenv \u0026ndash;python=/usr/bin/python3 XXXï¼šåˆ›å»ºåä¸ºXXXçš„pythonç‰ˆæœ¬çš„è™šæ‹Ÿç¯å¢ƒï¼›  ç¯å¢ƒé…ç½®åŠModelè®¾è®¡ ç¯å¢ƒé…ç½®ï¼ˆPyCharmï¼ŒMySQLï¼ŒDjango1.11ï¼‰\nâ€‹\tæ­¤é¡¹ç›®ä¸»è¦æ˜¯åœ¨Windowsä¸Šåˆ›å»ºå¹¶æ‰§è¡Œï¼Œæ‰€ä»¥æ‰€æœ‰ç¯å¢ƒéœ€æ”¹æˆWindowsç¯å¢ƒï¼Œç”±äºä¹‹å‰å®‰è£…è¿‡Ancondaï¼Œè€Œè™šæ‹Ÿç¯å¢ƒéœ€è¦pipå®‰è£…virtualenvï¼Œæ‰€ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•ä½¿å¾—Ancondaä¸Python3.6å…±å­˜ï¼Œå¹¶ä¸”å¯ä»¥åˆ‡æ¢ï¼š\nâ€‹\tå®‰è£…Python3.6ï¼ˆä¸æ·»åŠ åˆ°Pathï¼‰ï¼Œåœ¨Pythonç›®å½•ä¸‹å°†python.exeæ–‡ä»¶æ›´åä¸ºpython3.exeï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°Pathä¸‹å³å¯.æµ‹è¯•ï¼šcmdä¸­ä½¿ç”¨python3å‘½ä»¤.\né¡¹ç›®åˆå§‹åŒ–   åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆè¿™é‡Œéšä¾¿èµ·çš„åå­—ï¼‰\n  å®‰è£…Django Rest Frameworkï¼ˆåŸºäºDjangoï¼‰\n  å®‰è£…Django Rest Frameworkï¼špip install djangorestframework\n  æ³¨æ„ï¼šDjangRestFrameworkæ²¡æœ‰å®‰è£…Djangoï¼Œéœ€è¦æ‰‹åŠ¨å®‰è£…\n  å®‰è£…Django\npip install -i https://pypi.doubanio.com/simple/ django\nåœ°å€ï¼šhttps://www.django-rest-framework.org/\n  å®‰è£…markdownå’Œdjango-filter\npip install markdown django-filter\n  Pycharmåˆ›å»ºDjangoé¡¹ç›®\n  æµ‹è¯•è¿è¡Œ\n  æ›´æ”¹æ•°æ®åº“é…ç½®\nå°†setting.pyä¸­çš„DATABASEå†…å®¹\nDATABASES = {\r'default': {\r'ENGINE': 'django.db.backends.mysql', # è¿æ¥mysqlæ•°æ®åº“\r'NAME': \u0026quot;mxshop\u0026quot;, # æ•°æ®åº“åç§°\r'USER': 'root', # è´¦æˆ·\r'PASSWORD': \u0026quot;root\u0026quot;, # å¯†ç \r'HOST': \u0026quot;127.0.0.1\u0026quot;, # åœ°å€\r\u0026quot;OPTIONS\u0026quot;:{\u0026quot;init_command\u0026quot;:\u0026quot;SET default_storage_engine=INNODB;\u0026quot;} # mysqlæ•°æ®åº“çš„ç‰ˆæœ¬5.6ä»¥å\r# 'OPTIONS': { 'init_command': 'SET storage_engine=INNODB;' }\r# ç”¨äºç¬¬ä¸‰æ–¹ç™»å½•\r}\r}\r   åˆ›å»ºæ•°æ®åº“\nMySQLæ•°æ®åº“ä¸‹åˆ›å»ºåä¸ºmxshopçš„æ•°æ®åº“ï¼ˆæ­¤æ—¶é‡æ–°è¿è¡Œé†’ç›®ä¼šå‡ºç°æ•°æ®åº“è¿æ¥é”™è¯¯ï¼Œä¸»è¦æ˜¯å› ä¸ºç¼ºå°‘è¿æ¥æ•°æ®çš„mysqlckientæˆ–è€…MySQL-pythonåŒ…ï¼‰\n  å®‰è£…mysqlclientæ•°æ®åº“\npip install -i https://pypi.doubanio.com/simple/ mysqlclient\næ­¤å¤„å¯èƒ½æœ‰å‘ï¼Œå¦‚æœæŠ¥é”™æ— æ³•å®‰è£…ï¼Œhttps://www.lfd.uci.edu/~gohlke/pythonlibs/#mysqlclientæ‰¾åˆ°å¯¹åº”ç‰ˆæœ¬ä¸‹è½½ï¼Œé€šè¿‡pip install xx å®‰è£…å³å¯\nå¦‚æœå‡ºç°ä¸‹é¢é—®é¢˜ï¼Œå¯èƒ½çš„é—®é¢˜\n?: (mysql.W002) MySQL Strict Mode is not set for database connection \u0026lsquo;default\u0026rsquo; HINT: MySQL\u0026rsquo;s Strict Mode fixes many data integrity problems in MySQL, such as data truncation upon insertion, by escalating warnings into errors. It is strongly recommended you activate it. See: https://docs.djangoproject.com/en/2.1/ref/databases/#mysql-sql-mode\n# è§£å†³\rDATABASES = { 'default': { 'OPTIONS': { \u0026quot;init_command\u0026quot;: \u0026quot;SET sql_mode='STRICT_TRANS_TABLES'\u0026quot;, } }\r}\r   å®‰è£…å›¾ç‰‡å¤„ç†åŒ…\npip install -i https://pypi.doubanio.com/simple/ pillow\n  æ•´ç†é¡¹ç›®ç»“æ„\nåˆ›å»ºPackage\n appsï¼šä¿å­˜æ‰€æœ‰app extra_appsï¼šå­˜æ”¾ç¬¬ä¸‰æ–¹çš„åŒ…ï¼Œéšç€æºç åŒ…æ‰“åŒ…è€Œä¸ä¼šå®‰è£…åˆ°è™šæ‹Ÿç¯å¢ƒä¸­  åˆ›å»ºDirectory\n mediaï¼šä¿å­˜å›¾ç‰‡ç­‰ db_toolsï¼šæ•°æ®åº“åˆå§‹åŒ–ç­‰  ä¸ºäº†ä»¥åæ–¹ä¾¿å°†appså’Œextra_appsæ˜ å°„Sources Rootå¹¶ä¸”åŠ å…¥åˆ°settingçš„æœç´¢ç›®å½•ä¸‹\nimport sys\rsys.path.insert(0, BASE_DIR)\rsys.path.insert(0, os.path.join(BASE_DIR, 'apps'))\rsys.path.insert(0, os.path.join(BASE_DIR, 'extra_apps'))\r   app modelsè®¾è®¡ åœ¨Toolsçš„Run manage.py Taskä¸‹è¿è¡Œstartapp xxxåˆ›å»ºmodel\næ‰¾åˆ°å¯¹åº”modelçš„é€»è¾‘ï¼Œåˆ›å»ºç›¸åº”çš„model\næ³¨æ„ï¼šæ­¤å¤„æœ‰å‘ï¼ï¼\nä¸è§†é¢‘ä¸åŒçš„åœ°æ–¹åœ¨äºdjangoä»¥åŠMySQLçš„ç‰ˆæœ¬ä¸åŒï¼Œåˆ›å»ºå¤–é”®çš„æ—¶å€™éœ€è¦æ·»åŠ on_delete=models.CASCADE\nusers-ç”¨æˆ·ç›¸å…³ è¿™é‡Œé¢ä¸»è¦æ˜¯ä½¿ç”¨UserProfileè¦†ç›–äº†åŸUsers\n# _*_ encoding:utf-8\rfrom datetime import datetime\rfrom django.db import models\rfrom django.contrib.auth.models import AbstractUser\rclass UserProfile(AbstractUser):\rnick_name = models.CharField(max_length=50, verbose_name=u\u0026quot;æ˜µç§°\u0026quot;, default=\u0026quot;\u0026quot;)\rbirthday = models.DateField(verbose_name=u\u0026quot;ç”Ÿæ—¥\u0026quot;, null=True, blank=True)\rgender = models.CharField(max_length=5, choices=((\u0026quot;male\u0026quot;, u\u0026quot;ç”·\u0026quot;), (\u0026quot;female\u0026quot;, \u0026quot;å¥³\u0026quot;)), default=\u0026quot;female\u0026quot;)\raddress = models.CharField(max_length=100, default=u\u0026quot;\u0026quot;)\rmobile = models.CharField(max_length=11, null=True, blank=True)\rimage = models.ImageField(upload_to=\u0026quot;image/%Y/%m\u0026quot;, default=u\u0026quot;image/default..jpg\u0026quot;, max_length=100)\rclass Meta:\rverbose_name = u\u0026quot;ç”¨æˆ·ä¿¡æ¯\u0026quot;\rverbose_name_plural = verbose_name\rdef __unicode__(self):\rreturn self.username\rclass EmailVerifyRecord(models.Model):\rcode = models.CharField(max_length=20, verbose_name=u\u0026quot;éªŒè¯ç \u0026quot;)\remail = models.EmailField(max_length=50, verbose_name=u\u0026quot;é‚®ç®±\u0026quot;)\rsend_type = models.CharField(max_length=10, choices=((\u0026quot;register\u0026quot;, u\u0026quot;æ³¨å†Œ\u0026quot;), (\u0026quot;forget\u0026quot;, u\u0026quot;æ‰¾å›å¯†ç \u0026quot;)))\rsend_time = models.DateTimeField(default=datetime.now)\rclass Meta:\rverbose_name = u\u0026quot;é‚®ç®±éªŒè¯ç \u0026quot;\rverbose_name_plural = verbose_name\r# def __unicode__(self):\r# return self.username\rclass Banner(models.Model):\rtitle = models.CharField(max_length=100, verbose_name=u\u0026quot;æ ‡é¢˜\u0026quot;)\rimage = models.ImageField(upload_to=\u0026quot;banner/%Y/%m\u0026quot;, verbose_name=u\u0026quot;è½®æ’­å›¾\u0026quot;)\rurl = models.URLField(max_length=200, verbose_name=u\u0026quot;è®¿é—®åœ°å€\u0026quot;)\rindex = models.IntegerField(default=100, verbose_name=u\u0026quot;é¡ºåº\u0026quot;)\radd_time = models.DateTimeField(default=datetime.now, verbose_name=u\u0026quot;æ·»åŠ æ—¶é—´\u0026quot;)\rclass Meta:\rverbose_name = u\u0026quot;è½®æ’­å›¾\u0026quot;\rverbose_name_plural = verbose_name\r courses-è¯¾ç¨‹ç›¸å…³ # _*_ encoding:utf-8\rfrom django.db import models\rfrom datetime import datetime\rclass Course(models.Model):\rname = models.CharField(max_length=50, verbose_name=u\u0026quot;è¯¾ç¨‹åç§°\u0026quot;)\rdesc = models.CharField(max_length=50, verbose_name=u\u0026quot;è¯¾ç¨‹æè¿°\u0026quot;)\rdetail = models.TextField(verbose_name=u\u0026quot;è¯¾ç¨‹è¯¦æƒ…\u0026quot;)\rdegree = models.CharField(max_length=2, choices=((\u0026quot;cj\u0026quot;, \u0026quot;åˆçº§\u0026quot;), (\u0026quot;zj\u0026quot;, \u0026quot;ä¸­çº§\u0026quot;), (\u0026quot;gj\u0026quot;, \u0026quot;é«˜çº§\u0026quot;)))\rlearn_times = models.IntegerField(default=0, verbose_name=u\u0026quot;å­¦ä¹ æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰\u0026quot;)\rstudents = models.IntegerField(default=0, verbose_name=u\u0026quot;å­¦ä¹ äººæ•°\u0026quot;)\rfav_nums = models.IntegerField(default=0, verbose_name=u\u0026quot;æ”¶è—äººæ•°\u0026quot;)\rimage = models.ImageField(upload_to=\u0026quot;courses/%Y/%m\u0026quot;, verbose_name=u\u0026quot;å°é¢å›¾\u0026quot;, max_length=100)\rclick_nums = models.IntegerField(default=0, verbose_name=u\u0026quot;ç‚¹å‡»æ•°\u0026quot;)\radd_time = models.DateTimeField(default=datetime.now, verbose_name=u\u0026quot;æ·»åŠ æ—¶é—´\u0026quot;)\rclass Meta:\rverbose_name = u\u0026quot;è¯¾ç¨‹\u0026quot;\rverbose_name_plural = verbose_name\rclass Lesson(models.Model):\rcourse = models.ForeignKey(Course, verbose_name=u\u0026quot;è¯¾ç¨‹\u0026quot;, on_delete=models.CASCADE)\rname = models.CharField(max_length=100, verbose_name=u\u0026quot;ç« èŠ‚åç§°\u0026quot;)\radd_time = models.DateTimeField(default=datetime.now, verbose_name=u\u0026quot;æ·»åŠ æ—¶é—´\u0026quot;)\rclass Meta:\rverbose_name = u\u0026quot;ç« èŠ‚\u0026quot;\rverbose_name_plural = verbose_name\rclass Video(models.Model):\rlesson = models.ForeignKey(Lesson, verbose_name=u\u0026quot;è¯¾ç¨‹\u0026quot;, on_delete=models.CASCADE)\rname = models.CharField(max_length=100, verbose_name=u\u0026quot;è§†é¢‘åç§°\u0026quot;)\radd_time = models.DateTimeField(default=datetime.now, verbose_name=u\u0026quot;æ·»åŠ æ—¶é—´\u0026quot;)\rclass Meta:\rverbose_name = u\u0026quot;è§†é¢‘\u0026quot;\rverbose_name_plural = verbose_name\rclass CourseResource(models.Model):\rcourse = models.ForeignKey(Course, verbose_name=u\u0026quot;è¯¾ç¨‹\u0026quot;, on_delete=models.CASCADE)\rname = models.CharField(max_length=100, verbose_name=u\u0026quot;åç§°\u0026quot;)\rdownload = models.FileField(upload_to=\u0026quot;course/resource/%Y/%m\u0026quot;, verbose_name=u\u0026quot;èµ„æºæ–‡ä»¶\u0026quot;, max_length=100)\radd_time = models.DateTimeField(default=datetime.now, verbose_name=u\u0026quot;æ·»åŠ æ—¶é—´\u0026quot;)\rclass Meta:\rverbose_name = u\u0026quot;è¯¾ç¨‹èµ„æº\u0026quot;\rverbose_name_plural = verbose_name\r organization-æœºæ„ç›¸å…³ # _*_ encoding:utf-8\rfrom django.db import models\rfrom datetime import datetime\rclass CityDic(models.Model):\rname = models.CharField(max_length=20, verbose_name=u\u0026quot;åŸå¸‚\u0026quot;)\rdesc = models.CharField(max_length=200, verbose_name=u\u0026quot;æè¿°\u0026quot;)\radd_time = models.DateTimeField(default=datetime.now, verbose_name=u\u0026quot;æ·»åŠ æ—¶é—´\u0026quot;)\rclass Meta:\rverbose_name = u\u0026quot;åŸå¸‚\u0026quot;\rverbose_name_plural = verbose_name\rclass CourseOrg(models.Model):\rname = models.CharField(max_length=50, verbose_name=u\u0026quot;æœºæ„åç§°\u0026quot;)\rdesc = models.CharField(max_length=50, verbose_name=u\u0026quot;æœºæ„æè¿°\u0026quot;)\rfav_nums = models.IntegerField(default=0, verbose_name=u\u0026quot;æ”¶è—äººæ•°\u0026quot;)\rclick_nums = models.IntegerField(default=0, verbose_name=u\u0026quot;ç‚¹å‡»æ•°\u0026quot;)\rimage = models.ImageField(upload_to=\u0026quot;courses/%Y/%m\u0026quot;, verbose_name=u\u0026quot;å°é¢å›¾\u0026quot;, max_length=100)\raddress = models.CharField(max_length=150, verbose_name=u\u0026quot;æœºæ„åœ°å€\u0026quot;)\rcity = models.ForeignKey(CityDic, on_delete=models.CASCADE, verbose_name=u\u0026quot;æ‰€åœ¨åŸå¸‚\u0026quot;)\radd_time = models.DateTimeField(default=datetime.now, verbose_name=u\u0026quot;æ·»åŠ æ—¶é—´\u0026quot;)\rclass Meta:\rverbose_name = u\u0026quot;è¯¾ç¨‹æœºæ„\u0026quot;\rverbose_name_plural = verbose_name\rclass Teacher(models.Model):\rorg = models.ForeignKey(CourseOrg, on_delete=models.CASCADE, verbose_name=u\u0026quot;æ‰€å±æœºæ„\u0026quot;)\rname = models.CharField(max_length=50, verbose_name=u\u0026quot;æ•™å¸ˆå\u0026quot;)\rwork_years = models.IntegerField(default=0, verbose_name=u\u0026quot;å·¥ä½œå¹´é™\u0026quot;)\rwork_company = models.CharField(max_length=50, verbose_name=u\u0026quot;å°±èŒå…¬å¸\u0026quot;)\rwork_position = models.CharField(max_length=50, verbose_name=u\u0026quot;å…¬å¸èŒä½\u0026quot;)\rpoints = models.CharField(max_length=50, verbose_name=u\u0026quot;æ•™å­¦ç‰¹ç‚¹\u0026quot;)\rfav_nums = models.IntegerField(default=0, verbose_name=u\u0026quot;æ”¶è—äººæ•°\u0026quot;)\rclick_nums = models.IntegerField(default=0, verbose_name=u\u0026quot;ç‚¹å‡»æ•°\u0026quot;)\rclass Meta:\rverbose_name = u\u0026quot;æ•™å¸ˆ\u0026quot;\rverbose_name_plural = verbose_name\r operation-æ“ä½œç›¸å…³ # _*_ encoding:utf-8\rfrom django.db import models\rfrom datetime import datetime\rfrom users.models import UserProfile\rfrom courses.models import Course\rclass UserAsk(models.Model):\rname = models.CharField(max_length=20, verbose_name=u\u0026quot;å§“å\u0026quot;)\rmobile = models.CharField(max_length=11, verbose_name=u\u0026quot;æ‰‹æœº\u0026quot;)\rcourse_name = models.CharField(max_length=50, verbose_name=u\u0026quot;è¯¾ç¨‹å\u0026quot;)\radd_time = models.DateTimeField(default=datetime.now, verbose_name=u\u0026quot;æ·»åŠ æ—¶é—´\u0026quot;)\rclass Meta:\rverbose_name = u\u0026quot;ç”¨æˆ·å’¨è¯¢\u0026quot;\rverbose_name_plural = verbose_name\rclass CourseComments(models.Model):\r\u0026quot;è¯¾ç¨‹è¯„è®º\u0026quot;\ruser = models.ForeignKey(UserProfile, on_delete=models.CASCADE, verbose_name=u\u0026quot;ç”¨æˆ·\u0026quot;)\rcourse = models.ForeignKey(Course, on_delete=models.CASCADE, verbose_name=u\u0026quot;è¯¾ç¨‹\u0026quot;)\rcomments = models.CharField(max_length=200, verbose_name=u\u0026quot;è¯„è®º\u0026quot;)\radd_time = models.DateTimeField(default=datetime.now, verbose_name=u\u0026quot;æ·»åŠ æ—¶é—´\u0026quot;)\rclass Meta:\rverbose_name = u\u0026quot;è¯¾ç¨‹è¯„è®º\u0026quot;\rverbose_name_plural = verbose_name\rclass UserFavorite(models.Model):\ruser = models.ForeignKey(UserProfile, on_delete=models.CASCADE, verbose_name=u\u0026quot;ç”¨æˆ·\u0026quot;)\rfav_id = models.IntegerField(default=0, verbose_name=u\u0026quot;æ•°æ®id\u0026quot;)\rfav_type = models.IntegerField(choices=((1, \u0026quot;è¯¾ç¨‹\u0026quot;), (2, \u0026quot;è¯¾ç¨‹æœºæ„\u0026quot;), (3, \u0026quot;è®²å¸ˆ\u0026quot;)))\radd_time = models.DateTimeField(default=datetime.now, verbose_name=u\u0026quot;æ·»åŠ æ—¶é—´\u0026quot;)\rclass Meta:\rverbose_name = u\u0026quot;ç”¨æˆ·æ”¶è—\u0026quot;\rverbose_name_plural = verbose_name\rclass UserMessage(models.Model):\ruser = models.IntegerField(default=0, verbose_name=u\u0026quot;æ¥æ”¶ç”¨æˆ·\u0026quot;)\rmessage = models.CharField(max_length=500, verbose_name=u\u0026quot;æ¶ˆæ¯å†…å®¹\u0026quot;)\rhas_read = models.BooleanField(default=False, verbose_name=u\u0026quot;æ˜¯å¦å·²è¯»\u0026quot;)\radd_time = models.DateTimeField(default=datetime.now, verbose_name=u\u0026quot;æ·»åŠ æ—¶é—´\u0026quot;)\rclass Meta:\rverbose_name = u\u0026quot;ç”¨æˆ·æ¶ˆæ¯\u0026quot;\rverbose_name_plural = verbose_name\rclass UserCourse(models.Model):\ruser = models.ForeignKey(UserProfile, on_delete=models.CASCADE, verbose_name=u\u0026quot;ç”¨æˆ·\u0026quot;)\rcourse = models.ForeignKey(Course, on_delete=models.CASCADE, verbose_name=u\u0026quot;è¯¾ç¨‹\u0026quot;)\radd_time = models.DateTimeField(default=datetime.now, verbose_name=u\u0026quot;æ·»åŠ æ—¶é—´\u0026quot;)\rclass Meta:\rverbose_name = u\u0026quot;ç”¨æˆ·è¯¾ç¨‹\u0026quot;\rverbose_name_plural = verbose_name\r è€ƒè™‘åˆ°å­˜åœ¨å¾ˆå¤šmodelsçš„æƒ…å†µï¼Œåˆ›å»ºåä¸ºappsçš„Python Packageï¼Œå­˜å‚¨æ‰€æœ‰çš„modelsï¼Œå¹¶ä¸”å°†æ‰€æœ‰appsæ˜ å°„æˆSources Rootï¼ˆå¦åˆ™ï¼Œå„ä¸ªmodelä¸­è°ƒç”¨çš„åŒ…å°†æŠ¥é”™ï¼‰\nå¹¶ä¸”ï¼Œåœ¨settings.pyä¸­è®¾ç½®\nimport os\rimport sys\rBASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))\rsys.path.insert(0, os.path.join(BASE_DIR, 'apps'))\r æ–‡ä»¶ä¸Šä¼ æ“ä½œ è®¾ç½®å­—æ®µçš„æ—¶å€™å­˜åœ¨ä¸Šä¼ æ–‡ä»¶è·¯å¾„ï¼Œæ‰€ä»¥éœ€è¦é…ç½®æ–‡ä»¶ä¸Šä¼ çš„ç›®å½•\nimage = models.ImageField(upload_to=\u0026quot;courses/%Y/%m\u0026quot;)\r é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºåä¸ºmiediaçš„Directoryï¼Œç„¶ååœ¨settings.pyä¸­æ·»åŠ \nMEDIA_URL = '/media/'\rMEDIA_ROOT = os.path.join(BASE_DIR, 'media')\r æ–‡ä»¶ä¸Šä¼ è®¿é—® é…ç½®æ–‡ä»¶ä¸Šä¼ è®¿é—®å¤„ç†å‡½æ•°\nfrom django.views.static import serve\rfrom mxonline.settings import MEDIA_ROOT\r# é…ç½®æ–‡ä»¶ä¸Šä¼ çš„è®¿é—®å¤„ç†å‡½æ•°\rurl(r'^media/(?P\u0026lt;path\u0026gt;.*)$', serve, {\u0026quot;document_root\u0026quot;: MEDIA_ROOT}),\r é…ç½®ä¸Šä¸‹æ–‡å¤„ç†å™¨ï¼ˆåœ¨settings.pyä¸­æ‰¾åˆ°TEMPLATESä¸‹çš„'context_processors' æ·»åŠ 'django.template.context_processors.media',),å…¶ç›®çš„æ˜¯å°†{{ MEDIA_URL }}æ³¨å†Œåˆ°urlä¸­\nTEMPLATES = [\r{\r'OPTIONS': {\r'context_processors': [\r'django.template.context_processors.media',\r],\r},\r},\r]\r åœ¨å¯¹åº”ä½ç½®å³å¯è®¿é—®ä¸Šä¼ çš„å›¾ç‰‡\n\u0026lt;img width=\u0026quot;200\u0026quot; height=\u0026quot;120\u0026quot; class=\u0026quot;scrollLoading\u0026quot; data-url=\u0026quot;{{ MEDIA_URL }}{{ xxx.image }}\u0026quot;/\u0026gt;\r åå°ç®¡ç†ç³»ç»Ÿ admin åˆ›å»ºDjangoä¹‹åå°±ä¼šè‡ªåŠ¨ç”Ÿæˆå†å¸¦çš„åå°ç®¡ç†ç³»ç»Ÿï¼ˆæ³¨æ„ï¼šçº¢è‰²æ¡†æ¡†ï¼‰\nåœ¨PyCharmçš„æ–°ç‰ˆæœ¬ä¸­åˆ›å»ºDjangoæ–‡ä»¶çš„æ—¶å€™ï¼Œä¸è¦å‹¾æ‰æœ€åçš„Enable Django admin\né€šè¿‡http://127.0.0.1:8000/adminè¿›è¡Œè®¿é—®ï¼Œä½†æ˜¯Djangoå¹¶ä¸é»˜è®¤ç”Ÿæˆç™»å½•è´¦å·åŠå¯†ç ï¼Œéœ€è¦é€šè¿‡createsuperuseræ³¨å†Œadminåå°ç®¡ç†çš„è´¦å·å’Œå¯†ç \nä¿®æ”¹æˆä¸­æ–‡æ˜¾ç¤ºï¼šåœ¨settings.pyä¸­è®¾ç½®\nLANGUAGE_CODE = 'zh-hans'\rTIME_ZONE = 'Asia/Shanghai'\rUSE_I18N = True\rUSE_L10N = True\rUSE_TZ = False\r é»˜è®¤æ˜¾ç¤ºçš„åªæœ‰Groupï¼Œå¦‚æœæƒ³æ˜¾ç¤ºå…¶ä»–modelï¼Œéœ€è¦åœ¨å¯¹åº”çš„modelç›®å½•ä¸‹çš„adminä¸­åˆ›å»ºå¯¹åº”çš„classå³å¯\nform django.contrib import admin form .model import UserProfile\rclass UserProfileAdmin(admin.ModelAdmin): # æ·»åŠ ä¸€ä¸ªç®¡ç†å™¨\rpass\radmin.site.register(UserProfile, UserProfileAdmin)\t# å…³è”æ³¨å†Œ\r urlé…ç½®æŠ€å·§ urlpatterns = [\r# url(R'^admin/', admin.site.urls)\rurl(r'^form/$', getform, name='go_form')\r]\r è§£é‡Šä¸ºï¼šä»¥^åçš„åå­—å¼€å¤´ï¼Œä»¥/$ç»“å°¾ï¼Œè½¬åˆ°getformçš„viewsä¸‹ï¼Œåœ¨htmlçš„formè¡¨å•ä¸­ï¼Œå¯ä»¥é€šè¿‡é…ç½®action=\u0026quot;{% url \u0026lsquo;go_form\u0026rsquo; %}\u0026ldquo;æäº¤è¡¨å•.\nxadmin å‘½ä»¤å®‰è£…   å®‰è£…\nåœ¨å¯¹åº”çš„è™šæ‹Ÿç¯å¢ƒä¸­é€šè¿‡pip install xadminè¿›è¡Œå®‰è£….ï¼ˆä¾èµ–çš„å®‰è£…åŒ…ä¹Ÿä¼šè¢«å®‰è£…ï¼‰\n  ç¯å¢ƒé…ç½®\nåœ¨é¡¹ç›®setting.pyä¸­ï¼Œæ‰¾åˆ°INSTALLED_APPSï¼Œåœ¨ä¸‹é¢æ·»åŠ \u0026rsquo;xadmin\u0026rsquo;ä»¥åŠ\u0026rsquo;crispy_forms'ï¼Œåœ¨urls.pyä¸­ï¼Œå¼•å…¥xadminåŒ…ï¼Œå¹¶ç»å‘½ä»¤ä¸­çš„adminæ”¹æˆxadmin.\nimport xadmin\rurlpatterns = [\rurl(r'^xadmin/', xadmin.site.urls),\r]\r   ç”Ÿæˆç®¡ç†è¡¨å•\né…ç½®ä¹‹åï¼Œxadminéœ€è¦è‡ªå·±çš„ç®¡ç†è¡¨å•ï¼Œæ‰€ä»¥é‡æ–°åˆ›å»ºè¡¨å•makemigrationsï¼Œmigrate\n  æºç å®‰è£…(æ¨èä½¿ç”¨)   GitHubä¸‹è½½\n  å®‰è£…\nè§£å‹ä¸‹è½½çš„xadmin-master.zipæ–‡ä»¶ï¼Œæ‰¾åˆ°å…¶ä¸­çš„xadminæ–‡ä»¶å¤¹å¹¶å°†å…¶æ‹·è´åˆ°é¡¹ç›®æ–‡ä»¶çš„æ ¹ç›®å½•ä¸‹ï¼Œä¸ºäº†èƒ½å¤Ÿæ›´å¥½çš„ç®¡ç†ï¼Œä¹Ÿä¸ºäº†modelèƒ½å¤Ÿç›´æ¥è®¿é—®åˆ°xadminï¼Œåˆ›å»ºä¸€ä¸ªpackageåŒ…ï¼ˆä¾‹å¦‚ï¼šextra_appsï¼‰ï¼Œå¹¶å°†å…¶æ˜ å°„æˆSources Rootï¼Œå°†xadminæ–‡ä»¶å¤¹æ‹–åˆ°æ”¹æ–‡ä»¶å¤¹ä¸‹å³å¯.\næ³¨æ„ï¼šæ­¤æ—¶å¯ä»¥å¸è½½å‘½ä»¤è¡Œå®‰è£…çš„xadminåŒ…ï¼Œä½†æ˜¯ä¸è¦å¸è½½è‡ªåŠ¨ä¸‹è½½çš„ä¾èµ–åŒ….é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜éœ€è¦åœ¨setting.pyä¸‹æ³¨å†Œextra_apps.\nsys.path.insert(0, os.path.join(BASE_DIR, 'extra_apps'))\r ä¾èµ–åŒ…ï¼š\næ­¤å¤„æœ‰å‘ï¼šï¼ˆDjangoç‰ˆæœ¬åœ¨2.0ä»¥ä¸Šæœ‰å‘ï¼‰\n  é¦–å…ˆæŠ¥é”™ï¼šâ€œ from future.utils import iteritems ImportError: No module named future.utilsâ€\n  åŸå› æ˜¯ç¼ºå°‘futureåŒ…\n  è§£å†³æ–¹æ³•ï¼š\n pip install future    ç„¶åæŠ¥é”™ï¼šfrom django.urls import NoReverseMatch, reverse\n  åŸå› æ˜¯django2.0 æŠŠåŸæ¥çš„ django.core.urlresolvers åŒ… æ›´æ”¹ä¸ºäº† django.urlsåŒ…\n  è§£å†³æ–¹æ³•ï¼š\n å°†django.core.urlresolvers æ”¹ä¸º django.urls    æœ‰å‘ï¼ï¼ï¼ï¼\n  æœ‰å‘ï¼ï¼ï¼ï¼\n  æœ‰å‘ï¼ï¼ï¼ï¼\n  å‚ç…§https://www.cnblogs.com/netalen/p/10987016.htmlæ›´æ”¹\n  è¿˜æœ‰å‘ï¼šéœ€è¦å°†ç”Ÿæˆxadminç®¡ç†è¡¨ï¼Œå³æ‰§è¡Œmakemigrations xadminä»¥åŠmigrate xadmin.\n  ç¯å¢ƒé…ç½®\nå°†modelæ³¨å†Œåˆ°xadminï¼š\nåœ¨ç›¸åº”çš„modelåˆ›å»ºadminx.pyæ–‡ä»¶ï¼Œå¹¶ä¸”\nimport xadmin\rfrom .models import modelClassName\rclass modelClassNameAdmin(object):\rlist_display = ['å­—æ®µ1', 'å­—æ®µ2', ...]/('',)\t# æ˜¾ç¤ºxadminåˆ—è¡¨é¢˜å¤´(æœ€å¥½é€‰æ‹©æ•°ç»„ç±»å‹)\rsearch_fields = ['å­—æ®µ1', 'å­—æ®µ2', ...]/('',)\t#æœç´¢åŠŸèƒ½\tlistr_filter = ['å­—æ®µ1', 'å­—æ®µ2', ...]/('',)\t# è¿‡æ»¤å™¨åŠŸèƒ½\rxadmin.site.register(modelClassName, modelClassNameAdmin)\r å¦‚æœå­˜åœ¨å¤–é”®ï¼Œåœ¨æ·»åŠ è¿‡æ»¤å™¨åŠŸèƒ½çš„æ—¶å€™éœ€è¦åˆ¶å®šé€šè¿‡å“ªä¸ªå­—æ®µï¼Œå¦‚ï¼š\u0026lsquo;User__name\u0026rsquo;\nè¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œæ·»åŠ ä¸€æ¡æ•°æ®ä¹‹åéœ€è¦æ·»åŠ ä»¥ä¸‹ä»£ç ï¼Œæ‰èƒ½æ˜¾ç¤ºæƒ³è¦çš„æ•°æ®\ndef __unicode__(self):\rreturn self.name\r# æˆ–è€…\rdef __str__(self):\rreturn self.name\r   xadminæºç å®‰è£…ä¼˜åŠ¿\nå¯ä»¥äº«ç”¨xadminçš„æ–°ç‰¹æ€§ï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®éœ€æ±‚æ·»åŠ æ’ä»¶ç­‰.\n  xadminå…¨å±€ä¿®æ”¹\n  è®¾ç½®ä¸»é¢˜ï¼š\nåœ¨adminx.pyä¸‹åˆ›å»ºcalss\nfrom xadmin import views\rclass BaseSetting(object):\renable_themes = True\ruse_bootswatch = True\rxadmin.site.register(views.BaseAdminView, BaseSetting)    å…¨å±€å˜é‡\nfrom xadmin import views\rclass GlobalSetting(object):\rsite_title = \u0026quot;\u0026quot;\rsite_footer = \u0026quot;\u0026quot;\rmenu_style = \u0026quot;accordion\u0026quot;\t# æŠ˜å èœå•\rxadmin.site.register(views.CommAdminView, GlobalSetting)  å¤‡æ³¨ï¼šå¦‚æœéœ€è¦å¯¹æ˜¾ç¤ºèœå•åç§°æ”¹æˆä¸­æ–‡å’‹éœ€è¦åœ¨å¯¹åº”modelä¸‹æ‰¾åˆ°apps.pyè¿›è¡Œæ·»åŠ ï¼Œç„¶åæ›´æ”¹å½“å‰ç›®å½•ä¸‹çš„__init__.py\napps.pyä¸‹æ·»åŠ verbose_name = u\u0026quot;Name\u0026quot;\n__init__.pyä¸‹æ·»åŠ ï¼šdefault_app_config = model.apps.ModelConfig \næ³¨æ„ï¼šå¦‚æœåœ¨setting.pyä¸­é…ç½®.XxxConfigåˆ™ä¸éœ€è¦ä¸Šè¿°__init__.pyæ“ä½œ.\n    å‰ç«¯ é¦–é¡µ é¦–å…ˆå‡†å¤‡å¥½å‰ç«¯é¡µé¢åŠæ ·å¼\nåœ¨é¡¹ç›®ä¸‹åˆ›å»ºåä¸ºstaticçš„Directoryï¼ŒåŒäºå­˜æ”¾æ‰€æœ‰çš„é™æ€æ–‡ä»¶ï¼Œå¹¶å°†img/images/css/jsç­‰æ–‡ä»¶æ‹·è´åˆ°staticæ–‡ä»¶å¤¹ä¸‹\nç„¶ååœ¨urls.pyä¸­é…ç½®urlå³å¯è®¿é—®\nfrom django.views.generic import TemplateView\rurlpatterns = [\rurl('^$', TemplateView.as_view(template_name=\u0026quot;index.html\u0026quot;), name=\u0026quot;index\u0026quot;)\r]\r å­˜åœ¨é—®é¢˜ï¼šé™æ€æ–‡ä»¶æ²¡æœ‰åŠ è½½\nè§£å†³æ–¹æ³•ï¼š\n  settings.pyä¸­æ‰¾åˆ°STATIC_URL = '/static/'ï¼Œåœ¨ä¸‹é¢æ·»åŠ \nSTATICFILES_DIRS = (\ros.path.join(BASE_DIR, \u0026quot;static\u0026quot;),\r)\r   åœ¨å¯¹åº”çš„htmlç•Œé¢ä¸­æ‰¾åˆ°å¯¹åº”çš„æ ·å¼æ–‡ä»¶ï¼Œå°†ç›¸å¯¹è·¯å¾„è·Ÿæ”¹ä¸º/static/\u0026hellip;æˆ–è€…å¼•å…¥{% load staticfiles %}ç„¶åä½¿ç”¨{% static 'css/xx.css' %}\n  ç™»å½•é¡µé¢ é¡µé¢   å¤åˆ¶ç™»å½•é¡µé¢åˆ°templateä¸‹ï¼Œå¹¶æ›´æ”¹æ ·å¼æ–‡ä»¶\n  é…ç½®urlè®¿é—®è·¯å¾„ï¼š\nurl('^login/$', TemplateView.as_view(template_name=\u0026quot;login.html\u0026quot;), name=\u0026quot;login\u0026quot;)\r   æ‰¾åˆ°index.htmlä¸‹çš„ç™»å½•å…¥å£ï¼Œaæ ‡ç­¾æ›´æ”¹ä¸ºhref=\u0026quot;/login\u0026quot;æˆ–è€…{% url 'login' %}\n  urlä½¿ç”¨include åœ¨é¡¹ç›®ä¸‹çš„urls.pyæ–‡ä»¶ä¸­å¯ä»¥é€šè¿‡includeå¯¼å…¥å…¶ä»–urlé…ç½®æ–‡ä»¶ï¼ˆurlåˆ†è§£ï¼‰ï¼Œä¹Ÿæ˜¯ä¸ºäº†æ›´å¥½çš„ç®¡ç†ï¼Œä¸è‡³äºé¡¹ç›®ä¸‹çš„urls.pyæ‚ä¹±æ— ç« . å¯ä»¥åœ¨å¯¹åº”çš„appä¸‹åˆ›å»ºurls.pyæ–‡ä»¶ï¼Œç„¶åå¯¼å…¥å³å¯.\n# é¡¹ç›®ä¸‹çš„urls.pyæ–‡ä»¶\rfrom django.conf.urls import url, include\rurlpatterns = [\r# namespaceå‘½åç©ºé—´\rurl(r'^org/$', include('organization.urls'), namespace=\u0026quot;org\u0026quot;),\r]\r # organizationä¸‹çš„urls.py\rfrom django.conf.urls import url, include\rurlpatterns = [\r# ...\rurl(r'^list/$', OrgListView.as_view(), name=\u0026quot;org_list\u0026quot;),\r]\r è®¿é—®ä»¥org*å¼€å¤´çš„çš„urléƒ½ä¼šåˆ°organization.urlsä¸­æŸ¥æ‰¾ï¼Œæäº¤å˜ä¸º\n\u0026lt;a href=\u0026quot;{% url 'org:org_list' %}\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\r è®¿é—®åœ°å€ç”±åŸæ¥çš„http://127.0.0.1:8000/org-listå˜ä¸ºhttp://127.0.0.1:8000/org/list\né€»è¾‘ åœ¨usersä¸‹çš„views.pyä¸­æ·»åŠ é€»è¾‘\næ³¨æ„ï¼šåœ¨viewä¸­é…ç½®å‡½æ•°é€»è¾‘åï¼Œå°±å¯ä»¥æ›¿æ¢urlä¸‹çš„å†…å®¹ï¼Œå¦‚ï¼š\nåœ¨views.pyä¸­åˆ›å»ºloginå‡½æ•°æ–¹æ³•\ndef login(request):\rif request.method == \u0026quot;POST\u0026quot;:\rpass\relif request.method == \u0026quot;GET\u0026quot;:\rreturn render(request, \u0026quot;login.html\u0026quot;, {})\r åœ¨urls.pyä¸­å°±å¯ä»¥æ›´æ”¹ä¸ºï¼š\nfrom django.views.generic import TemplateView\rfrom model.views import login\rurlpatterns = [\rurl('^$', login, name=\u0026quot;index\u0026quot;)\r]\r æ³¨æ„ï¼šè¿™é‡Œé¢çš„loginä¸å¸¦()ï¼Œä¸æ˜¯ç‚¹ç”¨å‡½æ•°æ–¹æ³•ï¼Œåªæ˜¯æŒ‡å‘äº†loginå‡½æ•°.\n  HTMLè¡¨å•æäº¤\nä¸»è¦åœ¨äºactionä»¥åŠmethodï¼Œé™¤æ­¤ä¹‹å¤–ï¼ŒDjangoè‡ªå¸¦ä¸€ç§å®‰å…¨æœºåˆ¶ï¼Œé˜²æ­¢è·¨è¶Šæäº¤ï¼Œåå¤å‘åå°æäº¤è¡¨å•å¯¹æœåŠ¡å™¨é€ æˆè´Ÿæ‹…ï¼ŒDjangoä¸ºäº†é˜²æ­¢è¿™ç§æ”»å‡»ï¼Œä¼šåšä¸€ç§CSRFéªŒè¯ï¼ˆå½“ç”¨postæäº¤æ•°æ®çš„æ—¶å€™ï¼ŒDjangoä¼šå»æ£€æŸ¥æ˜¯å¦æœ‰ä¸€ä¸ªCSRFçš„éšæœºå­—ç¬¦ä¸²ï¼Œå¦‚æœæ²¡æœ‰å°±ä¼šæŠ¥é”™ï¼‰ï¼Œæ‰€ä»¥éœ€è¦åœ¨formè¡¨å•é‡Œé¢æ·»åŠ {% csrf_token %}ï¼ˆå¯ä»¥æŸ¥çœ‹é¡µé¢æºç ,çœ‹åˆ°formä¸­æœ‰ä¸€ä¸ªinputæ˜¯éšè—çš„ï¼‰!\n  æ¥æ”¶æ•°æ®\nviews.pyé€šè¿‡request.POST.get(\u0026quot;labelName\u0026quot;,\u0026quot;\u0026quot;)æ¥è·å–è¡¨å•ä¸­çš„æ•°æ®ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå‚æ•°åå­—ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºé»˜è®¤å€¼.\n    åŸºäºå‡½æ•°çš„ç™»å½•æ“ä½œ\nDjangoè‡ªå¸¦çš„ç”¨æˆ·è®¤è¯authï¼Œdjango.contrib.authä¸­æä¾›äº†è®¸å¤šæ–¹æ³•ï¼Œå…¶ä¸­ï¼š\n  authenticate()\næä¾›äº†ç”¨æˆ·è®¤è¯ï¼Œå³éªŒè¯ç”¨æˆ·åä»¥åŠå¯†ç æ˜¯å¦æ­£ç¡®ï¼Œä¸€èˆ¬éœ€è¦username passwordä¸¤ä¸ªå…³é”®å­—å‚æ•°ï¼Œå¦‚æœè®¤è¯ä¿¡æ¯æœ‰æ•ˆï¼Œä¼šè¿”å›ä¸€ä¸ª User å¯¹è±¡.authenticate()ä¼šåœ¨User å¯¹è±¡ä¸Šè®¾ç½®ä¸€ä¸ªå±æ€§æ¥æ ‡è¯†åç«¯å·²ç»è®¤è¯äº†è¯¥ç”¨æˆ·ï¼Œä¸”è¯¥ä¿¡æ¯åœ¨åç»­çš„ç™»å½•è¿‡ç¨‹ä¸­æ˜¯éœ€è¦çš„ã€‚å½“è¯•å›¾ç™»é™†ä¸€ä¸ªä»æ•°æ®åº“ä¸­ç›´æ¥å–å‡ºæ¥ä¸ç»è¿‡authenticate()çš„Userå¯¹è±¡æ—¶ä¼šæŠ¥é”™ï¼\nfrom django.contrib.auth import authenticate\ruser = authenticate(username='username',password='password')\r   Userå¯¹è±¡\nUser å¯¹è±¡å±æ€§ï¼šusernameï¼Œ passwordï¼ˆå¿…å¡«é¡¹ï¼‰passwordç”¨å“ˆå¸Œç®—æ³•ä¿å­˜åˆ°æ•°æ®åº“\nis_staff ï¼š ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰ç½‘ç«™çš„ç®¡ç†æƒé™.\nis_active ï¼š æ˜¯å¦å…è®¸ç”¨æˆ·ç™»å½•, è®¾ç½®ä¸ºFalseï¼Œå¯ä»¥ä¸ç”¨åˆ é™¤ç”¨æˆ·æ¥ç¦æ­¢ ç”¨æˆ·ç™»å½•\n    login(HttpRequest, user)ã€€è¯¥å‡½æ•°æ¥å—ä¸€ä¸ªHttpRequestå¯¹è±¡ï¼Œä»¥åŠä¸€ä¸ªè®¤è¯äº†çš„Userå¯¹è±¡\nå¤‡æ³¨ï¼šauth.loginæ–¹æ³•å°†æ ¡éªŒé€šè¿‡çš„ç”¨æˆ·å°è£…åˆ°requestä¸­ï¼Œè¿™æ ·åœ¨requestçš„ç”Ÿå‘½å‘¨æœŸæˆ‘ä»¬éƒ½å¯ä»¥ä½¿ç”¨request.userå¾—åˆ°è¿™ä¸ªç”¨æˆ·çš„å¯¹è±¡ï¼Œä¸ç®¡æ˜¯åœ¨è§†å›¾å‡½æ•°è¿˜æ˜¯åœ¨æ¨¡æ¿è¯­è¨€ä¸­éƒ½å¯ä»¥ä½¿ç”¨request.user ç„¶ååœ¨ .å­—æ®µå±æ€§ æ¥å–åˆ°éœ€è¦çš„å†…å®¹ã€‚æ­¤å‡½æ•°ä½¿ç”¨djangoçš„sessionæ¡†æ¶ç»™æŸä¸ªå·²è®¤è¯çš„ç”¨æˆ·é™„åŠ ä¸Šsession idç­‰ä¿¡æ¯.\nfrom django.contrib.auth import authenticate, login\rdef user_login(request):\rif request.method == \u0026quot;POST\u0026quot;:\rusername = request.POST.get(\u0026quot;username\u0026quot;, \u0026quot;\u0026quot;)\rpassword = request.POST.get(\u0026quot;password\u0026quot;, \u0026quot;\u0026quot;)\ruser = authenticate(username=username, password=password)\rif user is not None:\rlogin(request, user)\rreturn render(request, \u0026quot;index.html\u0026quot;)\relse:\rreturn render(request, \u0026quot;login.html\u0026quot;, {\u0026quot;msg\u0026quot;: \u0026quot;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯\u0026quot;})\relif request.method == \u0026quot;GET\u0026quot;:\rreturn render(request, \u0026quot;login.html\u0026quot;, {})\r æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼š\né€»è¾‘ä»£ç ä¸­è¿”å›çš„é”™è¯¯ä¿¡æ¯å¯ä»¥ç”¨{{ }}æ¥æ˜¾ç¤ºåœ¨é¡µé¢ä¸­\n\u0026lt;div class=\u0026quot;error btns login-form-tips\u0026quot; id=\u0026quot;jsLoginTips\u0026quot;\u0026gt;{{ msg }}\u0026lt;/div\u0026gt;\r   is_authenticated()\nåˆ¤æ–­æ˜¯å¦å·²ç»é€šè¿‡äº†è®¤è¯ï¼Œä½†é€šè¿‡è®¤è¯å¹¶ä¸æ„å‘³ç€ç”¨æˆ·æ‹¥æœ‰ä»»ä½•æƒé™ï¼Œè¿™ä¸ªæ–¹æ³•ç”šè‡³ä¹Ÿä¸æ£€æŸ¥è¯¥ç”¨æˆ·æ˜¯å¦å¤„äºæ¿€æ´»çŠ¶æ€ï¼Œåªæ˜¯è¡¨æ˜ç”¨æˆ·æˆåŠŸçš„é€šè¿‡äº†è®¤è¯ã€‚\nè¿™ä¸ªæ–¹æ³•å¾ˆé‡è¦, åœ¨åå°ç”¨request.user.is_authenticated()åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å·²ç»ç™»å½•ï¼Œå¦‚æœtrueåˆ™å¯ä»¥å‘å‰å°å±•ç¤ºrequest.user.name\nå¤‡æ³¨ï¼šå‰ç«¯å¯ä»¥é€šè¿‡{% request.user.is_authenticated() %}è¿›è¡Œåˆ¤æ–­.\n    logout(request) æ³¨é”€ç”¨æˆ·ã€€from django.contrib.auth import logout\rdef logout_view(request):\rlogout(request)\r# Redirect to a success page.\r è¯¥å‡½æ•°æ¥å—ä¸€ä¸ªHttpRequestå¯¹è±¡ï¼Œæ— è¿”å›å€¼ã€‚å½“è°ƒç”¨è¯¥å‡½æ•°æ—¶ï¼Œå½“å‰è¯·æ±‚çš„sessionä¿¡æ¯ä¼šå…¨éƒ¨æ¸…é™¤ã€‚è¯¥ç”¨æˆ·å³ä½¿æ²¡æœ‰ç™»å½•ï¼Œä½¿ç”¨è¯¥å‡½æ•°ä¹Ÿä¸ä¼šæŠ¥é”™.\nå¤‡æ³¨ï¼šæ³¨é”€ç”¨æˆ·åï¼Œç›´æ¥è®¿é—®è¿™ä¸ªè·¯å¾„ï¼Œè¿˜å¯ä»¥ç™»å½•ï¼Œä½†æ˜¯å¯ä»¥print(request.user)ï¼Œå½“ç”¨æˆ·é€šè¿‡æ ¡éªŒç™»å½•æ—¶ï¼Œå¾—åˆ°çš„æ˜¯ä¸€ä¸ªå…·ä½“çš„ç”¨æˆ·å¯¹è±¡ï¼›å½“æ³¨é”€æ—¶ï¼Œå†æ¬¡è®¿é—®ï¼Œå°±ä¼šè¾“å‡ºAnonymousUserï¼ˆæ˜¯ä¸€ä¸ªç±» \u0026lt;class \u0026lsquo;django.utils.functional.SimpleLazyObject\u0026rsquo;\u0026gt;ï¼‰ï¼Œæ„ä¸ºåŒ¿åç”¨æˆ·ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªå¤„ç†ä¸€äº›åˆ¤æ–­.\n    å¤šè´¦æˆ·ä¿¡æ¯ç™»å½•\néœ€è¦åœ¨usersModelä¸‹çš„views.pyä¸­åˆ›å»ºç»§æ‰¿django.contrib.auth.backends import ModelBackendsçš„ç±»ï¼Œç„¶åå®šä¹‰å‡½æ•°ï¼Œå¹¶å°†å‡½æ•°æ³¨å†Œåˆ°settings.pyä¸‹\nfrom django.contrib.auth.backends import ModelBackends\rfrom django.db.models import Q\rcalss CustomBackend(ModelBackends):\r# è¯¥æ–¹æ³•ä¼šè¢«djangoè‡ªåŠ¨è°ƒç”¨\rdef authenticate(self, username=None, password=None, **kwargs):\rtry:\r# æ ¹æ®ç”¨æˆ·åæŸ¥æ‰¾æ˜¯å¦å­˜åœ¨ç”¨æˆ·(get()å‡½æ•°åªä¼šè¿”å›å­˜åœ¨ä¸€ä¸ªçš„æ•°æ®)\ruser = User.oject.get(username=username)\r# å¦‚æœè¡Œå¤šä¸ªè´¦å·å½¢å¼ï¼Œéœ€è¦å¯¼å…¥QåŒ…ï¼Œç„¶åæ‰§è¡Œï¼š\r# user = User.oject.get(Q(username=username)|Q(email=username)\rif user.check_password(password):\rreturn user\rexcept Exception as e:\rretirn None\r settings.pyä¸­é…ç½®\nAUTHenTICATION_BACKENDS = (\r'model.views.CustomBackend',\r)\r Qï¼š\naã€åœ¨ filter() ç­‰å‡½å¼ä¸­å…³é”®å­—å‚æ•°å½¼æ­¤ä¹‹é—´éƒ½æ˜¯ \u0026ldquo;AND\u0026rdquo; å…³ç³»ã€‚å¦‚æœä½ è¦æ‰§è¡Œæ›´å¤æ‚çš„æŸ¥è¯¢(æ¯”å¦‚ï¼Œå®ç°ç­›é€‰æ¡ä»¶çš„ OR å…³ç³»)ï¼Œå¯ä»¥ä½¿ç”¨ Q å¯¹è±¡ã€‚ bã€Qå¯¹è±¡åŒ…æ‹¬ AND å…³ç³» å’ŒOR å…³ç³» cã€Q å¯¹è±¡å¯ä»¥ç”¨ \u0026amp; å’Œ | è¿ç®—ç¬¦è¿›è¡Œè¿æ¥ã€‚å½“æŸä¸ªæ“ä½œè¿æ¥ä¸¤ä¸ª Q å¯¹è±¡æ—¶ï¼Œå°±ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ç­‰ä»·çš„ Q å¯¹è±¡ã€‚\nå¦‚ï¼šä¸‹é¢è¿™æ®µè¯­å¥å°±äº§ç”Ÿäº†ä¸€ä¸ª Q ï¼Œè¿™æ˜¯ç”¨ \u0026ldquo;OR\u0026rdquo; å…³ç³»è¿æ¥\nQ(question__startswith='Who') | Q(question__startswith='What')\r dã€æ¯ç§æŸ¥è¯¢å‡½å¼(æ¯”å¦‚ filter(), exclude(), get()) é™¤äº†èƒ½æ¥æ”¶å…³é”®å­—å‚æ•°ä»¥å¤–ï¼Œä¹Ÿèƒ½ä»¥ä½ç½®å‚æ•°çš„å½¢å¼æ¥å—ä¸€ä¸ªæˆ–å¤šä¸ª Q å¯¹è±¡ã€‚å¦‚æœä½ ç»™æŸ¥è¯¢å‡½å¼ä¼ é€’äº†å¤šä¸ª Q å¯¹è±¡ï¼Œé‚£ä¹ˆå®ƒä»¬å½¼æ­¤é—´éƒ½æ˜¯**\u0026ldquo;AND\u0026rdquo; å…³ç³»ã€‚**ä¾‹å¦‚ï¼š\nPoll.objects.get(\rQ(question__startswith='Who'), Q(pub_date=date(2005, 5, 2)) | Q(pub_date=date(2005, 5, 6))\r)\r e: filter() ç­‰å‡½æ•° å¯ä»¥æ¥å— Qå¯¹è±¡å’Œæ¡ä»¶å‚æ•°ï¼Œä½†Qå¯¹è±¡å¿…é¡»æ”¾åœ¨ æ¡ä»¶å‚æ•°å‰é¢\nsettings.pyä¸­é…ç½®ï¼Œé‡è½½å˜é‡\n  åŸºäºç±»çš„ç™»å½•æ“ä½œ\nå®šä¹‰ç»§æ‰¿django.views.generic.baseä¸‹Viewçš„classç±»ï¼Œç›´æ¥é‡å†™get/postæ–¹æ³•\nfrom django.views.generic.base import View\rclass LoginViewï¼ˆViewï¼‰ï¼š\rdef get(self, request):\rreturn render(request, \u0026quot;login.heml\u0026quot;, {})\rdef post(self, request):\rusername = request.POST['username']\rpassword = request.POST['password']\ruser = authenticate(username=username, password=password)\rif user is not None:\rlogin(request, user)\r# Redirect to a success page.\r...\relse:\r# Return an 'invalid login' error message.\r...\r åŒæ—¶urls.pyä¸­è¿˜è¦æ›´æ”¹ä¸º\nfrom model.views import LoginView\rurlpatterns = [\r# è°ƒç”¨LoginViewä¸‹çš„as_view()æ–¹æ³•\rurl('^login/$', LoginView.as_view(), name=\u0026quot;index\u0026quot;)\r]\r   Django Form è¡¨å•\nåœ¨å®é™…çš„ç”Ÿäº§ç¯å¢ƒä¸­æ¯”å¦‚ç™»å½•å’ŒéªŒè¯çš„æ—¶å€™ï¼Œä¸€èˆ¬éƒ½ä½¿ç”¨Jquery+ajaxæ¥åˆ¤æ–­ç”¨æˆ·çš„è¾“å…¥æ˜¯å¦ä¸ºç©ºï¼Œå‡å¦‚JSè¢«ç¦ç”¨çš„è¯ï¼Œè¿™ä¸ªè®¤è¯å±éšœæ˜¯å°±æ¶ˆå¤±äº†ï¼ˆè™½ç„¶ä¸€èˆ¬ä¸ä¼šç¦ç”¨æ‰ä½†æ˜¯è¿˜æ˜¯å­˜åœ¨é£é™©ï¼‰\næ‰€ä»¥ä¸€èˆ¬åšä¸¤ç§è®¤è¯ä¸€ç§æ˜¯å‰ç«¯åšä¸€éè®¤è¯ï¼Œåœ¨åç«¯åšä¸€éè®¤è¯. é€šè¿‡Djangoçš„formæ¥å®ç°.\n  Djangoçš„formçš„ä½œç”¨ï¼š 1). ç”Ÿæˆhtmlæ ‡ç­¾\n2). ç”¨æ¥åšç”¨æˆ·æäº¤çš„éªŒè¯\n  ç”Ÿæˆ\nåˆ›å»ºforms.pyè„šæœ¬æ–‡ä»¶\nfrom django import forms\rclass Loginform(forms.Form):\r# è¦æ±‚ å˜é‡åä¸formè¡¨å•æäº¤çš„å­—æ®µåä¸€è‡´\remail = forms.EmailField(required=True) #requiredæ˜¯å¦å¯ä»¥ä¸ºç©º,å¦‚æœä¸ºFalseè¯´æ˜å¯ä»¥ä¸ºç©º\rusername = forms.CharField() #å¦‚æœrequiredä¸å†™é»˜è®¤ä¸ºTure\rpassword = forms.CharField()  views.pyä¸­\nfrom .forms import LginForm\r# åˆ›å»ºå®ä¾‹,LoginForm(å‚æ•°)éœ€è¦ä¼ å…¥å­—å…¸ç±»å‹çš„å‚æ•°ï¼Œè¿™é‡Œå°†request.POSTä¼ å…¥å³å¯\rlogin_form = LoginForm(request.POST)\r# å°±å¯ä»¥é€šè¿‡.is_valid()æ¥åˆ¤æ–­ç”¨æˆ·è¾“å…¥æ˜¯å¦åˆæ³•\rif login_form.is_valid():\rpass\r   ä½¿ç”¨.is_valid()å‡½æ•°ä¹‹åå¯ä»¥æ›´æ”¹è¿”å›é¡µé¢çš„é”™è¯¯ä¿¡æ¯ï¼Œ\nreturn render(request, \u0026quot;login.html\u0026quot;, {\u0026quot;login_form\u0026quot;: login_form})\r htmlé¡µé¢ä¸­è·å–å¯ä»¥ä½¿ç”¨\nå¾ªç¯è·å–é”™è¯¯ä¿¡æ¯ï¼š\n{% for key, error in login_form.errors.items %}{{ error }}{% endfor %}{{ msg }}    Forms.ModelForm ModelFormè¡¨å•åŒæ ·éœ€è¦å¯¼å…¥åŒ…from django import forms,å®ƒå¯ä»¥ç®€åŒ–å…ƒformè¡¨å•çš„ç”Ÿæˆï¼Œå³å¯ä»¥ç›´æ¥å°†Modelè½¬æ¢æˆè¡¨å•ï¼Œé€šè¿‡å®šä¹‰Metaç±»æ¥æŒ‡å®šModelï¼Œå¹¶ä¸”ä½¿ç”¨filesæŒ‡å®šå“ªäº›å˜é‡ä¸ºè¡¨å•å†…å®¹\nfrom django import forms\rfrom operation.models import UserAsk\rclass UserAskForm(forms.ModelForm):\r# è¿™é‡Œå¯ä»¥å†æ·»åŠ å­—æ®µ\r# temp = forms.CharField()\rclass Meta:\rmodel = UserAsk\rfields = ['name', 'mobile', 'course_name']\r# å¦‚æœç›¸å¯¹æŸä¸ªå­—æ®µè¿›è¡Œæ­£åˆ™åˆ¤æ–­ï¼Œå¯ä»¥å®šä¹‰'clean_å­—æ®µå'çš„å‡½æ•°\rdef clean_mobile(self):\r# éªŒè¯æ‰‹æœºå·ç æ˜¯å¦åˆæ³•\rmobile = self.cleaned_data['mobile']\rREGEX_MOBIE = \u0026quot;^1[358]\\d{9}$|^147\\d{8}$|^176\\\\d{8}$\u0026quot;\rp = re.compile(REGEX_MOBIE)\rif p.match(mobile):\rreturn mobile\relse:\r# æŠ›å‡ºå¼‚å¸¸\rraise forms.ValidationError(u\u0026quot;æ‰‹æœºå·ç éæ³•\u0026quot;, \u0026quot;mobile_invalid\u0026quot;)\r å®ä¾‹åŒ–è¿‡ç¨‹\nclass AddUserAskView(View):\rdef post(self, request):\ruserask_form = UserAskForm(request.POST)\rif userask_form.valid():\ruser_ask = userask_form.save(commit=True)\r å¤‡æ³¨ï¼šæ— éœ€æå–è¡¨å•ä¿¡æ¯ï¼Œç›´æ¥save()å³å¯\næ³¨æ„ï¼šéœ€è¦æŒ‡å®šsave()å‚æ•°commit=TRUEå¦åˆ™æ— æ³•å­˜å…¥æ•°æ®åº“\næ³¨å†Œé¡µé¢ é¡µé¢ DJango captcha éªŒè¯ç æ’ä»¶ ä¸‹æ‹‰æ‰¾åˆ°documentation online\n Installation    Install django-simple-captcha via pip: pip install django-simple-captcha\n  Add captcha to the INSTALLED_APPS in your settings.py\n  Run python manage.py migrate\n  Add an entry to your urls.py:\nurlpatterns += [\rurl(r'^captcha/', include('captcha.urls')),\r]\r     Adding to a Form\nfrom django import forms\rfrom captcha.fields import CaptchaField\rclass CaptchaTestForm(forms.Form):\rmyfield = AnyOtherField()\rcaptcha = CaptchaField()\r å®ä¾‹åŒ–CaptchaTestFormï¼Œä¼ ç»™å‰å°åœ¨å¯¹åº”ä½ç½®æ·»åŠ {{ CaptchaTestForm.captcha }}å³å¯.\n  é€»è¾‘ from django import forms\rfrom captcha.fields import CaptchaField\rclass RegisterForm(forms.Form):\rmyfield = AnyOtherField() # ä¸é¡µé¢ä¸€ä¸€å¯¹åº”\rcaptcha = CaptchaField()\t# å¯ä»¥æ·»åŠ å‚(error_messages={\u0026quot;é”™è¯¯å†…å®¹\u0026quot;:\u0026quot;å°†æ˜¾ç¤ºçš„é”™è¯¯ä¿¡æ¯\u0026quot;})\r åœ¨views.pyä¸­åˆ›å»ºRegisterView(View)ç±»ï¼Œ ç„¶åå†å‰ç«¯éªŒè¯ç labelä¸‹é¢æ·»åŠ {{ register_form.captcha }}\nfrom django.contrib.auth.hashers import make_password\rclass RegisterView(View):\rdef get(self, request)\rregister_form = RegisterForm()\t# å®ä¾‹åŒ–æ³¨å†Œè¡¨å•\rreturn render(request, \u0026quot;register.html\u0026quot;, {\u0026quot;register_form\u0026quot;:register_form})\rdef post(self, request):\r# åˆ›å»ºå®ä¾‹register_form(å‚æ•°)\rregister_form = RegisterForm(request.POST)\r# å°±å¯ä»¥é€šè¿‡.is_valid()æ¥åˆ¤æ–­ç”¨æˆ·è¾“å…¥æ˜¯å¦åˆæ³•\rif register_form.is_valid():\r# ...\ruser.password = make_password(password)\ruser.save() # å¦‚æœå‘é€é‚®ä»¶æ‰§è¡Œå‘é€é‚®ç®±éªŒè¯ä»£ç \rreturn else:\rreturn  åˆ›å»ºé€»è¾‘å³å¯ï¼Œå€¼å¾—ä¸€æçš„æ˜¯å­˜å‚¨æ˜ç çš„æ—¶å€™éœ€è¦å­˜å¯†æ–‡ï¼Œæ‰€ä»¥éœ€è¦åŠ å¯†ï¼š\nfrom django.contrib.auth.hashers import make_password\ruser.password = make_password(password)\r å‘é€é‚®ç®±éªŒè¯   æ³¨å†Œé‚®ç®±è´¦å·\né¦–å…ˆæ³¨å†Œé‚®ç®±è´¦å·ï¼ˆä»¥æ–°æµª/ç½‘æ˜“é‚®ç®±ä¸ºä¾‹ï¼‰ï¼Œåœ¨å¸¸è§„è®¾ç½®ä¸­æ‰¾åˆ°ï¼šPOP3/SMTP/IMAP\n  é…ç½®Email\nsettings.pyä¸­æ·»åŠ \n  EMAIL_HOST = \u0026quot;smtp.sina.com\u0026quot;\rEMAIL_PORT= 25\rEMAIL_HOST_USER = \u0026quot;xxx@xxx.com\u0026quot;\rEMAIL_HOST_PASSWORD = \u0026quot;xxxxxx\u0026quot; # è¿™é‡Œçš„PASSWORDæ˜¯æˆæƒç ï¼Œè€Œä¸æ˜¯æ™®é€šçš„é‚®ç®±å¯†ç \rEMAIL_USE_TLS = False\rEMAIL_FORM = \u0026quot;xxx@xxx.com\u0026quot;\r   å‡½æ•°\nfrom random import Random\rfrom django.core.mail import send_mail\rdef random_str(randomlength=8):\rstr = ''\rchars = 'AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz0123456789'\rlength = len(chars) - 1\rrandom = Random()\rfor i in range(randomlength):\rstr += chars[random.randint(0, length)]\rreturn str\rdef send_register_email(email, send_type=\u0026quot;register\u0026quot;): email_record = EmailVerifyRecord()\rcode = random_str(16)\remail_record.code = code\remail_record.email = email\remail_record.type = send_type\remail_record.save()\remail title=\u0026quot;\u0026quot;\remail body=\u0026quot;\u0026quot;\rif send type==\u0026quot;register\u0026quot;ï¼š\remail_title=\u0026quot;åœ¨çº¿ç½‘æ³¨å†Œæ¿€æ´»é“¾æ¥â€\remail_body=\u0026quot;è¯·ç‚¹å‡»ä¸‹é¢çš„é“¾æ¥æ¿€æ´»ä½ çš„è´¦å·ï¼šhttp://127.0.0.1ï¼š8000/active/{0}\u0026quot;.format(code)\r# è¿”å›çŠ¶æ€\rsend_status = send_mail(email_title, email_body, EMAIL_FORM, [email])\r# send_status = send_mail(email_title, email_body, éœ€è¦å¯¼å…¥settings.py, åˆ—è¡¨listç±»å‹)\tè¿”å›çŠ¶æ€ä¸º0/1\rif send_status:\rpass\relse:\rpass\r   æ¿€æ´»æ“ä½œ\n urls.pyé…ç½®æ‹¿åˆ°éšæœºç è¿›è¡ŒåŒ¹é…  url(r'^active/(?P\u0026lt;Name\u0026gt;.*)/$', ActiveUserView.as_view())\r# æå–active/åé¢æ‰€æœ‰çš„ä¸œè¥¿å­˜åˆ°Nameä¸­\r class ActiveUserView(View):\rdef get(self, request, Name)\rall_records = EmaolVerifyRecord.object.filter(code=Name)\rif all_records:\rfor record in all_records:\remail = record.mail\ruser = User.object.get(email=email)\ruser.active = True\ruser.save()\rreturn ...\r åœ¨djangoä¸­ï¼ŒæŸ¥è¯¢ç»å¸¸ç”¨çš„ä¸¤ä¸ªAPIï¼šget()å’Œfilter()ä¸¤ä¸ªæ–¹æ³•ï¼Œ\n object.get()ï¼šå¾—åˆ°çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœåœ¨æ•°æ®åº“ä¸­æŸ¥ä¸åˆ°è¿™ä¸ªå¯¹è±¡æˆ–è€…æŸ¥æ‰¾åˆ°å¯¹è±¡éƒ½ä¼šæŠ¥é”™ï¼ï¼ï¼ object.filter() ï¼šè¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡åˆ—è¡¨ã€‚å¦‚æœåœ¨æ•°æ®åº“ä¸­æ‰¾ä¸åˆ°è¿™ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆä¼šè¿”å›ä¸€ä¸ªç©ºåˆ—è¡¨[]    æ‰¾å›å¯†ç  urls.pyä¸­é…ç½®é“¾æ¥ url(r'^active/(?P\u0026lt;Name\u0026gt;.*)/$', ForgetPwdView.as_view(), name=\u0026quot;forget_pwd\r\u0026quot;)\r æ‰¾åˆ°å¿˜è®°å¯†ç çš„æ ‡ç­¾ï¼Œå°†href='{% url 'forget_pwd' %}'\nclass ForgetPwdView(View):\rdef get(self, request)\rforget_form = ForgetForm()\t# å®ä¾‹åŒ–å¿˜è®°å¯†ç è¡¨å•\rreturn render(request, \u0026quot;forget.html\u0026quot;,{\u0026quot;forget_form\u0026quot;:forget_form})\rdef post(self, request)\rforget_form = ForgetForm(request.POST)\rif forget_form.is_valid():\r# ...\remail = request.POST.get(\u0026quot;email\u0026quot;)\r# å¦‚æœå‘é€é‚®ä»¶æ‰§è¡Œå‘é€é‚®ç®±éªŒè¯ä»£ç \rreturn else:\rreturn  æ¿€æ´»æ“ä½œ urls.pyé…ç½®æ‹¿åˆ°éšæœºç è¿›è¡ŒåŒ¹é…\nurl(r'^reset/(?P\u0026lt;Name\u0026gt;.*)/$', ResetView.as_view())\r class ResetView(View):\rdef get(self, request, Name)\rall_records = EmaolVerifyRecord.object.filter(code=Name)\rif all_records:\rfor record in all_records:\remail = record.mail\rreturn render(request, \u0026quot;password.html\u0026quot; {\u0026quot;email\u0026quot;:email})\relse: return def post(self, request):\r... class ModifyPwdView(View):\rdef post(self, request):\rmodify_form = ModifyPwdForm(request.POST)\rif modify_form.is_valid():\remail = request.POST.get(\u0026quot;email\u0026quot;, \u0026quot;\u0026quot;)\rpassword1 = request.POST.get(\u0026quot;password1\u0026quot;, \u0026quot;\u0026quot;)\rpassword2 = request.POST.get(\u0026quot;password2\u0026quot;, \u0026quot;\u0026quot;)\rif password1 != password2:\rreturn render(request, \u0026quot;password_reset.html\u0026quot;, {\u0026quot;email\u0026quot;: email, \u0026quot;msg\u0026quot;: \u0026quot;å¯†ç ä¸ä¸€è‡´\u0026quot;})\rmodify_user = UserProfile.objects.get(email=email)\rmodify_user.password = make_password(password1)\rmodify_user.save()\rreturn render(request, \u0026quot;login.html\u0026quot;)\relse:\rreturn render(request, \u0026quot;login.html\u0026quot;, {\u0026quot;modify_form\u0026quot;: modify_form})\r æœºæ„çš„åŠŸèƒ½å®ç° Djangoç½‘é¡µæ¨¡æ¿çš„ç»§æ‰¿block   æ–°å»ºæ¯ç‰ˆhtmlæ–‡ä»¶ï¼ˆåœ¨é‡Œé¢æŒ–å‘blockï¼‰\n\u0026lt;!DOCTYPE html\u0026gt;\r\u0026lt;html lang=\u0026quot;en\u0026quot;\u0026gt;\r\u0026lt;head\u0026gt;\r\u0026lt;meta charset=\u0026quot;UTF-8\u0026quot;\u0026gt;\r{% block title %}\u0026lt;title\u0026gt;æ¨¡æ¿é¡µ\u0026lt;/title\u0026gt;{% endblock %}\r\u0026lt;/head\u0026gt;\r\u0026lt;body\u0026gt;\r{% block custom_bread %}\r\u0026lt;section\u0026gt;\r\u0026lt;div class=\u0026quot;wp\u0026quot;\u0026gt;\r\u0026lt;ul class=\u0026quot;crumbs\u0026quot;\u0026gt;\r\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;{% url 'index' %}\u0026quot;\u0026gt;é¦–é¡µ\u0026lt;/a\u0026gt;\u0026gt;\u0026lt;/li\u0026gt;\r\u0026lt;/ul\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;/section\u0026gt;\r{% endblock %}\r\u0026lt;/body\u0026gt;\r\u0026lt;/html\u0026gt;\r   æ–°å»ºå­ç½‘é¡µå¹¶ç»§æ‰¿æ¯ç‰ˆextendsï¼ˆåœ¨é‡Œé¢å¡«å‘ï¼‰\n{% extends 'base.html' %} # æ³¨æ„ï¼š ç»§æ‰¿è¯­å¥å¿…é¡»æ”¾åœ¨é¦–è¡Œ {% block title %}æˆè¯¾æœºæ„åˆ—è¡¨{% endblock %}\r{% block custom_bread %}\r\u0026lt;section\u0026gt;\r\u0026lt;div class=\u0026quot;wp\u0026quot;\u0026gt;\r\u0026lt;ul class=\u0026quot;crumbs\u0026quot;\u0026gt;\r\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;{% url 'index' %}\u0026quot;\u0026gt;é¦–é¡µ\u0026lt;/a\u0026gt;\u0026gt;\u0026lt;/li\u0026gt;\r\u0026lt;li\u0026gt;è¯¾ç¨‹æœºæ„\u0026lt;/li\u0026gt;\r\u0026lt;/ul\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;/section\u0026gt;\r{% endblock %}\r   å†™è·¯ç”±ï¼Œåªéœ€å†™å­ç½‘é¡µçš„è·¯ç”±å³å¯ã€‚ï¼ˆæ— éœ€å†™æ¯ç‰ˆé¡µçš„è·¯ç”±ï¼‰\nfrom django.shortcuts import render\rfrom django.views.generic import View\rclass OrgListView(View):\rdef get(self, request):\rreturn render(request, \u0026quot;org-list.html\u0026quot;)\r   åˆ†é¡µåŠŸèƒ½ geihubæœç´¢ï¼špure pagination\nInstallation  Install package from PYPI:  pip install django-pure-pagination\r â€‹\tor clone and install from repository:\ngit clone git@github.com:jamespacileo/django-pure-pagination.git\rcd django-pure-pagination\rpython setup.py install\r Add pure_pagination to INSTALLED_APPS  INSTALLED_APPS = (\r...\r'pure_pagination',\r)\r  Finally substitute from django.core.paginator import Paginator with from pure_pagination import Paginator\n  A few settings can be set within settings.py\n  PAGINATION_SETTINGS = {\r'PAGE_RANGE_DISPLAYED': 10,\r'MARGIN_PAGES_DISPLAYED': 2,\r'SHOW_FIRST_PAGE_WHEN_INVALID': True,\r}\r Usage example Following is a simple example for function based views. For generic class-based views, see bellow.\nview file: views.py\n# views.py\rfrom django.shortcuts import render_to_response\rfrom pure_pagination import Paginator, EmptyPage, PageNotAnInteger\rdef index(request):\rtry:\rpage = request.GET.get('page', 1)\rexcept PageNotAnInteger:\rpage = 1\robjects = ['john', 'edward', 'josh', 'frank']\r# Provide Paginator with the request object for complete querystring generation\r# éœ€è¦ä¼ é€’ä¸‰ä¸ªå‚æ•°ï¼Œä¸­é—´å‚æ•°ä¸ºæ¯é¡µæ˜¾ç¤ºæ•°æ®\rp = Paginator(objects, 5, request=request)\rpeople = p.page(page)\rreturn render_to_response('index.html', {\r'people': people,\r}\r template file: index.html\n{# index.html #}\r{% extends 'base.html' %}\r{% block content %}\r{% for person in people.object_list %}\r\u0026lt;div\u0026gt;\rFirst name: {{ person }}\r\u0026lt;/div\u0026gt;\r{% endfor %}\r{# The following renders the pagination html #}\r\u0026lt;div id=\u0026quot;pagination\u0026quot;\u0026gt;\r{{ people.render }} # é»˜è®¤é¡µç æ ·å¼\r\u0026lt;/div\u0026gt;\r{% endblock %}\r è‡ªå®šä¹‰é¡µç æ ·å¼\nUsage There a few different way you can make use of the features introduced within django-pure-pagination.\nEasiest way to render the pagination is to call the render method i.e. {{ page.render }}\nAlternatively you can access the Page object low level methods yourself\nSpecial note: page_obj and current_page both point to the page object within the template.\n{% load i18n %}\r\u0026lt;div class=\u0026quot;pagination\u0026quot;\u0026gt;\r{% if page_obj.has_previous %}\r\u0026lt;a href=\u0026quot;?{{ page_obj.previous_page_number.querystring }}\u0026quot; class=\u0026quot;prev\u0026quot;\u0026gt;\u0026amp;lsaquo;\u0026amp;lsaquo; {% trans \u0026quot;previous\u0026quot; %}\u0026lt;/a\u0026gt;\r{% else %}\r\u0026lt;span class=\u0026quot;disabled prev\u0026quot;\u0026gt;\u0026amp;lsaquo;\u0026amp;lsaquo; {% trans \u0026quot;previous\u0026quot; %}\u0026lt;/span\u0026gt;\r{% endif %}\r{% for page in page_obj.pages %}\r{% if page %}\r{% ifequal page page_obj.number %}\r\u0026lt;span class=\u0026quot;current page\u0026quot;\u0026gt;{{ page }}\u0026lt;/span\u0026gt;\r{% else %}\r\u0026lt;a href=\u0026quot;?{{ page.querystring }}\u0026quot; class=\u0026quot;page\u0026quot;\u0026gt;{{ page }}\u0026lt;/a\u0026gt;\r{% endifequal %}\r{% else %}\r...\r{% endif %}\r{% endfor %}\r{% if page_obj.has_next %}\r\u0026lt;a href=\u0026quot;?{{ page_obj.next_page_number.querystring }}\u0026quot; class=\u0026quot;next\u0026quot;\u0026gt;{% trans \u0026quot;next\u0026quot; %} \u0026amp;rsaquo;\u0026amp;rsaquo;\u0026lt;/a\u0026gt;\r{% else %}\r\u0026lt;span class=\u0026quot;disabled next\u0026quot;\u0026gt;{% trans \u0026quot;next\u0026quot; %} \u0026amp;rsaquo;\u0026amp;rsaquo;\u0026lt;/span\u0026gt;\r{% endif %}\r\u0026lt;/div\u0026gt;\r mxonlineåˆ†é¡µè®¾ç½®\n\u0026lt;ul class=\u0026quot;pagelist\u0026quot;\u0026gt;\r{% if all_orgs.has_previous %}\r\u0026lt;li class=\u0026quot;long\u0026quot;\u0026gt;\u0026lt;a href=\u0026quot;?{{all_orgs.previous_page_number.querystring }}\u0026quot;\u0026gt;ä¸Šä¸€é¡µ\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\r{% endif %}\r{% for page in all_orgs.pages %}\r{% if page %}\r{% ifequal page all_orgs.number %}\r\u0026lt;li class=\u0026quot;active\u0026quot;\u0026gt;\u0026lt;a href=\u0026quot;?{{ page.querystring }}\u0026quot;\u0026gt;{{ page }}\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\r{% else %}\r\u0026lt;li\u0026gt;\u0026lt;a class=\u0026quot;page\u0026quot; href=\u0026quot;?{{ page.querystring }}\u0026quot;\u0026gt;{{ page }}\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\r{% endifequal %}\r{% else %}\r\u0026lt;li class=\u0026quot;none\u0026quot;\u0026gt;\u0026lt;a href=\u0026quot;\u0026quot;\u0026gt;...\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\r{% endif %}\r{% endfor %}\r{% if all_orgs.has_next %}\r\u0026lt;li class=\u0026quot;long\u0026quot;\u0026gt;\u0026lt;a href=\u0026quot;?{{ all_orgs.next_page_number.querystring }}\u0026quot;\u0026gt;ä¸‹ä¸€é¡µ\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\r{% endif %}\r\u0026lt;/ul\u0026gt;\r åˆ†ç±»æ˜¾ç¤ºåŠè¯¾ç¨‹æ’è¡Œ å‰ç«¯é¡µé¢é€šè¿‡aæ ‡ç­¾å‘åè·³æä¾›å‚æ•°ï¼Œå¦‚ï¼š\n\u0026lt;a href=\u0026quot;?ct=pxjg\u0026amp;city={{ city.id }}\u0026quot;\u0026gt;\r viewé€»è¾‘è·å–ï¼Œå¹¶åˆ†é¡µæ˜¾ç¤º\nclass OrgListView(View):\rdef get(self, request):\r# è·å–æ‰€æœ‰æœºæ„\rall_orgs = CourseOrg.objects.all()\r# çƒ­é—¨æœºæ„\r# æ³¨æ„è¿™é‡Œï¼Œæ’åºå‚æ•°å‰å¦‚æœæœ‰â€˜-â€™åˆ™ä»£è¡¨ç€é™åºï¼Œæ²¡æœ‰åˆ™é»˜è®¤å‡åº\rhot_orgs = all_orgs.order_by(\u0026quot;-click_nums\u0026quot;)[:5]\rall_citys = CityDic.objects.all()\r# å–å‡ºç­›é€‰åŸå¸‚\rcity_id = request.GET.get('city', \u0026quot;\u0026quot;)\rif city_id:\rall_orgs = all_orgs.filter(city_id=int(city_id))\r# ç±»åˆ«ç­›é€‰\rcategory = request.GET.get('ct', \u0026quot;\u0026quot;)\rif category:\rall_orgs = all_orgs.filter(category=category)\rorg_nums = all_orgs.count()\rtry:\rpage = request.GET.get('page', 1)\rexcept PageNotAnInteger:\rpage = 1\rp = Paginator(all_orgs, 5, request=request)\rorgs = p.page(page)\rreturn render(request, \u0026quot;org-list.html\u0026quot;, {\r\u0026quot;all_orgs\u0026quot;: orgs,\r\u0026quot;org_nums\u0026quot;: org_nums,\r\u0026quot;all_citys\u0026quot;: all_citys,\r\u0026quot;city_id\u0026quot;: city_id,\r\u0026quot;category\u0026quot;: category,\r\u0026quot;hot_orgs\u0026quot;: hot_orgs\r})\r å‰ç«¯ä»¥é€šè¿‡\u0026lt;span class=\u0026quot;{% ifequal category \u0026quot;pxjg\u0026quot; %} active2{% endifequal %}\u0026quot;\u0026gt;åŸ¹è®­æœºæ„\u0026lt;/span\u0026gt;æ·»åŠ æ ·å¼\n\u0026lt;a href=\u0026quot;?city={{ city.id }}\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;{% ifequal category \u0026quot;\u0026quot; %}active2{% endifequal %}\u0026quot;\u0026gt;å…¨éƒ¨\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\r\u0026lt;a href=\u0026quot;?ct=pxjg\u0026amp;city={{ city.id }}\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;{% ifequal category \u0026quot;pxjg\u0026quot; %} active2{% endifequal %}\u0026quot;\u0026gt;åŸ¹è®­æœºæ„\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\r # è¯¾ç¨‹æ’è¡Œå‰ç«¯\r\u0026lt;div class=\u0026quot;right companyrank layout\u0026quot;\u0026gt;\r\u0026lt;div class=\u0026quot;head\u0026quot;\u0026gt;æˆè¯¾æœºæ„æ’å\u0026lt;/div\u0026gt;\r{% for hot_org in hot_orgs %}\r\u0026lt;dl class=\u0026quot;des\u0026quot;\u0026gt;\r\u0026lt;dt class=\u0026quot;num fl\u0026quot;\u0026gt;{{ forloop.counter }}\u0026lt;/dt\u0026gt;\r\u0026lt;dd\u0026gt;\r\u0026lt;a href=\u0026quot;/company/2/\u0026quot;\u0026gt;\u0026lt;h1\u0026gt;{{ hot_org.name }}\u0026lt;/h1\u0026gt;\u0026lt;/a\u0026gt;\r\u0026lt;p\u0026gt;{{ hot_org.address }}\u0026lt;/p\u0026gt;\r\u0026lt;/dd\u0026gt;\r\u0026lt;/dl\u0026gt;\r{% endfor %}\r\u0026lt;/div\u0026gt;\r é¡µé¢å†…å¼‚æ­¥æäº¤è¡¨å• å¼‚æ­¥æ“ä½œéœ€è¦ajaxæ“ä½œï¼Œå¯¹æŒ‡å®šçš„è¡¨å•å£°æ˜è‡ªå®šä¹‰script\nå¦‚å¯¹ç½‘é¡µä¸­çš„æŸä¸€è¡¨å•è¿›è¡Œå¼‚æ­¥æ“ä½œ\né…ç½®url\nurl('^add_ask/$', AddUserAskView.as_view(), name=\u0026quot;add_ask\u0026quot;),\r è¡¨å•æäº¤é€»è¾‘\nclass AddUserAskView(View):\rdef post(self, request):\ruserask_form = UserAskForm(request.POST)\rif userask_form.is_valid():\ruser_ask = userask_form.save(commit=True)\rreturn HttpResponse('{\u0026quot;status\u0026quot;:\u0026quot;success\u0026quot;}')\relse:\rreturn HttpResponse(json.dumps('{\u0026quot;status\u0026quot;:\u0026quot;fail\u0026quot;, \u0026quot;msg\u0026quot;: \u0026quot;æ·»åŠ é”™è¯¯\u0026quot;}', ensure_ascii=False), content_type=\u0026quot;application/json,charset=utf-8\u0026quot;)\r# return JsonResponse('{\u0026quot;status\u0026quot;:\u0026quot;success\u0026quot;}', safe=False)\r# else:\r# return JsonResponse('{\u0026quot;status\u0026quot;:\u0026quot;fail\u0026quot;, \u0026quot;msg\u0026quot;: \u0026quot;æ·»åŠ é”™è¯¯\u0026quot;}', safe=False)\r å¤‡æ³¨ï¼šdjangoä¸€èˆ¬ç”¨JsonResponseæ¥è¿”å›jsonæ•°æ®æ ¼å¼ï¼Œè¿™ç§æ–¹å¼è¿”å›ç®€å•ï¼Œä½†æ˜¯ä¸­æ–‡ä¼šä¹±ç \n# æ ¼å¼\rreturn JsonResponse(result, safe=False)\r å¦‚è‹¥æ˜¾ç¤ºä¸­æ–‡ï¼Œéœ€è¦æ”¹ç”¨HttpResponseæ¥è¿”å›\n# æ ¼å¼\rreturn HttpResponse(json.dumps(result,ensure_ascii=False),content_type=\u0026quot;application/json,charset=utf-8\u0026quot;)\r æ³¨æ„ï¼š æ­¤å¤„æœ‰å‘,resultè¦ä¸¥æ ¼æŒ‰ç…§JSONæ ¼å¼ä¹¦å†™.å³\nresult = {\u0026quot;status\u0026quot;:\u0026quot;success\u0026quot;}\rresult = {\u0026quot;status\u0026quot;:\u0026quot;fail\u0026quot;, \u0026quot;msg\u0026quot;: \u0026quot;æ·»åŠ é”™è¯¯\u0026quot;}\r å†™ä¸‹é¢çš„javascriptä»£ç ï¼Œå¯¹è¡¨å•æäº¤è¿›è¡Œç›‘å¬\n{% block custom_js %}\r\u0026lt;script\u0026gt;\r$(function () {\r$('#jsStayBtn').on('click', function () {\r$.ajax({\rcache: false,\rtype: \u0026quot;POST\u0026quot;,\rurl: \u0026quot;{% url 'org:add_ask' %}\u0026quot;,\rdata: $('#jsStayForm').serialize(),\rasync: true,\rsuccess: function (data) {\rconsole.log(data)\r# è£…æ¢æˆJSONæ ¼å¼ï¼Œå¦åˆ™data.statusä¸ºundefined\rdata = JSON.parse(data)\rconsole.log(data.status)\rif (data.status == 'success') {\r$('#jsStayForm')[0].reset();\ralert(\u0026quot;æäº¤æˆåŠŸ\u0026quot;)\r} else if (data.status == 'fail') {\r$('#jsCompanyTips').html(data.msg)\r}\r},\r});\r});\r})\r\u0026lt;/script\u0026gt;\r{% endblock %}\r æœºæ„é¦–é¡µ/è¯¾ç¨‹/ä»‹ç»/è®²å¸ˆ ç‚¹å‡»æœºæ„å›¾ç‰‡æŸ¥çœ‹æœºæ„è¯¦æƒ…ç­‰æ“ä½œ\nä¸å‰é¢æ“ä½œç±»ä¼¼ï¼Œå”¯ä¸€éœ€è¦æåˆ°çš„æ˜¯urlé…ç½®ï¼Œå› ä¸ºç‚¹å‡»æœºæ„å›¾ç‰‡logoçš„æ—¶å€™éœ€è¦ä¼ é€’å‚æ•°ï¼Œä»¥ä¾¿çŸ¥é“æ˜¯å“ªä¸ªæœºæ„ï¼Œæ‰€ä»¥\n# urlé…ç½®\rurl(r'^home/(?P\u0026lt;org_id\u0026gt;.*)/$', OrgHomeView.as_view(), name=\u0026quot;org_home\u0026quot;),\r # viewé€»è¾‘\rclass OrgHomeView(View):\r\u0026quot;\u0026quot;\u0026quot;\ræœºæ„é¦–é¡µ\r\u0026quot;\u0026quot;\u0026quot;\rdef get(self, request, org_id):\rcurrent_page = \u0026quot;home\u0026quot;\rcourse_org = CourseOrg.objects.get(id=int(org_id))\rhas_fav = False\rif request.user.is_authenticated:\rif UserFavorite.objects.filter(user=request.user, fav_id=course_org.id, fav_type=2):\rhas_fav = True\r# è¿™é‡Œå¯ä»¥é€šè¿‡å¤–é”®_setæ¥åå‘è·å–å¤–é”®æ•°æ®\rall_courses = course_org.course_set.all()[:3]\rall_teachers = course_org.teacher_set.all()[:2]\rreturn render(request, 'org-detail-homepage.html', {\r\u0026quot;all_courses\u0026quot;: all_courses,\r\u0026quot;all_teachers\u0026quot;: all_teachers,\r\u0026quot;course_org\u0026quot;: course_org,\r\u0026quot;current_page\u0026quot;: current_page,\r\u0026quot;has_fav\u0026quot;: has_fav\r})\rclass OrgCourseView(View):\r\u0026quot;\u0026quot;\u0026quot;\ræœºæ„è¯¾ç¨‹\r\u0026quot;\u0026quot;\u0026quot;\rdef get(self, request, org_id):\rcurrent_page = \u0026quot;course\u0026quot;\rcourse_org = CourseOrg.objects.get(id=int(org_id))\rhas_fav = False\rif request.user.is_authenticated:\rif UserFavorite.objects.filter(user=request.user, fav_id=course_org.id, fav_type=2):\rhas_fav = True\rall_courses = course_org.course_set.all()\rreturn render(request, 'org-detail-course.html', {\r\u0026quot;all_courses\u0026quot;: all_courses,\r\u0026quot;course_org\u0026quot;: course_org,\r\u0026quot;current_page\u0026quot;: current_page,\r\u0026quot;has_fav\u0026quot;: has_fav\r})\rclass OrgDescView(View):\r\u0026quot;\u0026quot;\u0026quot;\ræœºæ„ä»‹ç»\r\u0026quot;\u0026quot;\u0026quot;\rdef get(self, request, org_id):\rcurrent_page = \u0026quot;desc\u0026quot;\rcourse_org = CourseOrg.objects.get(id=int(org_id))\rhas_fav = False\rif request.user.is_authenticated:\rif UserFavorite.objects.filter(user=request.user, fav_id=course_org.id, fav_type=2):\rhas_fav = True\rreturn render(request, 'org-detail-desc.html', {\r\u0026quot;course_org\u0026quot;: course_org,\r\u0026quot;current_page\u0026quot;: current_page,\r\u0026quot;has_fav\u0026quot;: has_fav\r})\rclass OrgTeacherView(View):\r\u0026quot;\u0026quot;\u0026quot;\ræœºæ„è®²å¸ˆ\r\u0026quot;\u0026quot;\u0026quot;\rdef get(self, request, org_id):\rcurrent_page = \u0026quot;teacher\u0026quot;\rcourse_org = CourseOrg.objects.get(id=int(org_id))\rhas_fav = False\rif request.user.is_authenticated:\rif UserFavorite.objects.filter(user=request.user, fav_id=course_org.id, fav_type=2):\rhas_fav = True\rall_teachers = course_org.teacher_set.all()\rreturn render(request, 'org-detail-teachers.html', {\r\u0026quot;all_teachers\u0026quot;: all_teachers,\r\u0026quot;course_org\u0026quot;: course_org,\r\u0026quot;current_page\u0026quot;: current_page,\r\u0026quot;has_fav\u0026quot;: has_fav\r})\r # è®¿é—®æ—¶éœ€è¦åœ¨url 'org:org_home'åç©ºä¸€æ ¼ï¼Œç„¶åå¸¦ä¸Šid\r\u0026lt;a href=\u0026quot;{% url 'org:org_home' org.id %}\u0026quot;\u0026gt;\r å…¶ä»–æ“ä½œå‡ç›¸åŒï¼Œç•¥\nç”¨æˆ·æ”¶è— ç”¨æˆ·æ”¶è—æ“ä½œåŒæ ·æ˜¯å¼‚æ­¥æ“ä½œï¼Œéœ€è¦ajaxï¼Œå› ä¸ºé¡µé¢é‡‡ç”¨ç»§æ‰¿å¼ï¼Œæ‰€ä»¥åªéœ€è¦åœ¨org_base.htmlä¸­æ›´æ”¹å³å¯ï¼Œé¦–å…ˆåœ¨organizationçš„urlä¸­é…ç½®\nurl(r'^add_fav/$', AddFavoriteView.as_view(), name=\u0026quot;add_fav\u0026quot;),\r ç”±äºé¡µé¢ä¸­çš„ç»§æ‰¿ï¼Œåœ¨ç‚¹å‡»å·¦ä¾§çš„æ—¶å€™é¡µé¢ä¼šåˆ·æ–°ï¼Œå¯¼è‡´æ”¶è—æŒ‰é’®æ›´æ”¹ï¼Œæ‰€ä»¥éœ€è¦å¯¹æ¯ä¸ªæ“ä½œï¼ˆæœºæ„é¦–é¡µ/è¯¾ç¨‹/ä»‹ç»/è®²å¸ˆï¼‰ç­‰å‡è¿›è¡Œåˆ¤æ–­æ˜¯å¦æ”¶è—ï¼Œå‰ç«¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºç•Œé¢ä¸­ä¸å­˜åœ¨formè¡¨å•æäº¤ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨{% csrf-token %}ï¼Œéœ€è¦åœ¨ajaxå‘åæäº¤çš„æ—¶å€™è¡¥å……å‘é€ï¼Œå³ï¼š\n//æ”¶è—åˆ†äº«\rfunction add_fav(current_elem, fav_id, fav_type) {\r$.ajax({\rcache: false,\rtype: \u0026quot;POST\u0026quot;,\rurl: \u0026quot;{% url 'org:add_fav' %}\u0026quot;,\rdata: {'fav_id': fav_id, 'fav_type': fav_type},\rasync: true,\r# ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼\rbeforeSend: function (xhr, settings) {\rxhr.setRequestHeader(\u0026quot;X-CSRFToken\u0026quot;, \u0026quot;{{ csrf_token }}\u0026quot;);\r},\r# ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼\rsuccess: function (data) {\rdata = JSON.parse(data)\rconsole.log(data)\rconsole.log(data.status)\rconsole.log(data.msg)\rif (data.status == 'fail') {\rif (data.msg == 'ç”¨æˆ·æœªç™»å½•') {\rwindow.location.href = \u0026quot;{% url 'login' %}\u0026quot;;\r} else {\ralert(data.msg)\r}\r} else if (data.status == 'success') {\rcurrent_elem.text(data.msg)\r}\r},\r});\r}\r$('.collectionbtn').on('click', function () {\radd_fav($(this), {{ course_org.id }}, 2);\r});\r åå°é€»è¾‘\nclass AddFavoriteView(View):\r\u0026quot;\u0026quot;\u0026quot;\rç”¨æˆ·æ”¶è—\r\u0026quot;\u0026quot;\u0026quot;\rdef post(self, request):\r# æ‹¿åˆ°å‰ç«¯æ•°æ®\rfav_id = request.POST.get('fav_id', 0)\rfav_type = request.POST.get('fav_type', 0)\r# åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å½•(å³ä½¿åœ¨æœªç™»å½•çš„æƒ…å†µä¸‹ï¼Œrequestå¯¹è±¡ä¹Ÿä¼šäº§ç”Ÿä¸åŒäºè‡ªå®šä¹‰Userçš„userå¯¹è±¡ï¼Œåˆ¤æ–­æ˜¯å¦ç™»å½•)\rif not request.user.is_authenticated:\rreturn HttpResponse(json.dumps('{\u0026quot;status\u0026quot;:\u0026quot;fail\u0026quot;, \u0026quot;msg\u0026quot;: \u0026quot;ç”¨æˆ·æœªç™»å½•\u0026quot;}', ensure_ascii=False), content_type=\u0026quot;application/json, charset=utf-8\u0026quot;)\rexit_records = UserFavorite.objects.filter(user=request.user, fav_id=int(fav_id), fav_type=int(fav_type))\rif exit_records:\r# å¦‚æœå­˜åœ¨åˆ™è¯æ˜å·²æ”¶è—ï¼Œç°å–æ¶ˆæ”¶è—\rexit_records.delete()\r# è¿”å›JSONæ•°æ®\rreturn HttpResponse(json.dumps('{\u0026quot;status\u0026quot;:\u0026quot;success\u0026quot;, \u0026quot;msg\u0026quot;: \u0026quot;æ”¶è—\u0026quot;}', ensure_ascii=False), content_type=\u0026quot;application/json, charset=utf-8\u0026quot;)\relse:\ruser_fav = UserFavorite()\rif int(fav_id) \u0026gt; 0 and int(fav_type) \u0026gt; 0:\ruser_fav.user = request.user\ruser_fav.fav_id = int(fav_id)\ruser_fav.fav_type = int(fav_type)\ruser_fav.save()\rreturn HttpResponse(json.dumps('{\u0026quot;status\u0026quot;:\u0026quot;success\u0026quot;, \u0026quot;msg\u0026quot;: \u0026quot;å·²æ”¶è—\u0026quot;}', ensure_ascii=False), content_type=\u0026quot;application/json, charset=utf-8\u0026quot;)\relse:\rreturn HttpResponse(json.dumps('{\u0026quot;status\u0026quot;:\u0026quot;fail\u0026quot;, \u0026quot;msg\u0026quot;: \u0026quot;æ”¶è—å‡ºé”™\u0026quot;}', ensure_ascii=False), content_type=\u0026quot;application/json, charset=utf-8\u0026quot;)\r å…¬å¼€è¯¾ é¦–å…ˆåœ¨coursesä¸‹åˆ›å»ºurls.pyæ–‡ä»¶ï¼Œç„¶åé€šè¿‡å¯¼å…¥åˆ°é¡¹ç›®ä¸‹çš„urls.pyæ–‡ä»¶ä¸‹ï¼Œé…ç½®æ“ä½œï¼š\n# urls.py\r# é…ç½®è¯¾ç¨‹ç›¸å…³url\rurl(r'^course/', include('courses.urls', namespace=\u0026quot;course\u0026quot;)),\r# coursesä¸‹urls.py\rurl(r'^list/$', CourseListView.as_view(), name=\u0026quot;course_list\u0026quot;),\r View\nclass CourseListView(View):\rdef get(self, request):\rall_courses = Course.objects.all().order_by(\u0026quot;-add_time\u0026quot;)\rhot_courses = Course.objects.all().order_by(\u0026quot;-click_nums\u0026quot;)[:3]\rsort = request.GET.get(\u0026quot;sort\u0026quot;, \u0026quot;\u0026quot;)\rif sort:\rif sort == \u0026quot;students\u0026quot;:\rall_courses = all_courses.order_by(\u0026quot;-students\u0026quot;)\relif sort == \u0026quot;hot\u0026quot;:\rall_courses = all_courses.order_by(\u0026quot;-click_nums\u0026quot;)\rorg_nums = all_courses.count()\r# å¯¹è¯¾ç¨‹åˆ†é¡µ\rtry:\rpage = request.GET.get('page', 1)\rexcept PageNotAnInteger:\rpage = 1\rp = Paginator(all_courses, 6, request=request)\rcorses = p.page(page)\rreturn render(request, 'course-list.html', {\r\u0026quot;all_courses\u0026quot;: corses,\r\u0026quot;hot_courses\u0026quot;: hot_courses,\r\u0026quot;sort\u0026quot;: sort\r})\r è¯¾ç¨‹åˆ—è¡¨ åŒè¯¾ç¨‹æœºæ„ä¸€æ ·ï¼Œé¦–å…ˆä¿®æ”¹é¡µé¢ï¼Œåªéœ€è¦åœ¨å¯¹åº”ä½ç½®è¿›è¡Œä¿®æ”¹ï¼ˆ{% block %}ï¼‰å³å¯å®Œæˆé¡µé¢é…ç½®ï¼Œç„¶åè¿›è¡Œurlé…ç½®ï¼Œåœ¨courseä¸‹åˆ›å»ºurls.pyæ–‡ä»¶ï¼Œæœ€åç¼–å†™åå°Viewé€»è¾‘\n# url é…ç½®\rurl(r'^list/$', CourseListView.as_view(), name=\u0026quot;course_list\u0026quot;),\r class CourseListView(View):\rdef get(self, request):\rall_courses = Course.objects.all().order_by(\u0026quot;-add_time\u0026quot;)\rhot_courses = Course.objects.all().order_by(\u0026quot;-click_nums\u0026quot;)[:3]\rsort = request.GET.get(\u0026quot;sort\u0026quot;, \u0026quot;\u0026quot;)\rif sort:\rif sort == \u0026quot;students\u0026quot;:\rall_courses = all_courses.order_by(\u0026quot;-students\u0026quot;)\relif sort == \u0026quot;hot\u0026quot;:\rall_courses = all_courses.order_by(\u0026quot;-click_nums\u0026quot;)\rorg_nums = all_courses.count()\r# å¯¹è¯¾ç¨‹åˆ†é¡µ\rtry:\rpage = request.GET.get('page', 1)\rexcept PageNotAnInteger:\rpage = 1\rp = Paginator(all_courses, 6, request=request)\rcorses = p.page(page)\rreturn render(request, 'course-list.html', {\r\u0026quot;all_courses\u0026quot;: corses,\r\u0026quot;hot_courses\u0026quot;: hot_courses,\r\u0026quot;sort\u0026quot;: sort\r})\r è¯¾ç¨‹è¯¦æƒ… # è¯¾ç¨‹è¯¦æƒ…é¡µ\rurl(r'^detail/(?P\u0026lt;course_id\u0026gt;.*)/$', CourseDetailView.as_view(), name=\u0026quot;course_detail\u0026quot;),\r class CourseDetailView(View):\rdef get(self, request, course_id):\rcourse = Course.objects.get(id=int(course_id))\r# å¢åŠ è¯¾ç¨‹ç‚¹å‡»æ•°\rcourse.click_nums += 1\rcourse.save()\r# åˆ¤æ–­æ˜¯å¦æ”¶è—\rhas_fav_course = False\rhas_fav_org = False\rif request.user.is_authenticated:\rif UserFavorite.objects.filter(user=request.user, fav_id=course.id, fav_type=1):\rhas_fav_course = True\rif UserFavorite.objects.filter(user=request.user, fav_id=course.course_org.id, fav_type=2):\rhas_fav_org = True\rtag = course.tag\rif tag:\rrelate_courses = Course.objects.filter(tag=tag)[:1]\relse:\rrelate_courses = []\rreturn render(request, 'course-detail.html', {\r\u0026quot;course\u0026quot;: course,\r\u0026quot;relate_courses\u0026quot;: relate_courses,\r\u0026quot;has_fav_course\u0026quot;: has_fav_course,\r\u0026quot;has_fav_org\u0026quot;: has_fav_org,\r})\r è¯¾ç¨‹ç« èŠ‚ä¿¡æ¯é…ç½® è·å–è¯¾ç¨‹çš„ç« èŠ‚ï¼šæ‰“å¼€courses/models.pyæ–‡ä»¶ï¼Œåœ¨Courseå‡½æ•°é‡Œé¢ï¼Œæ–°å®šä¹‰å‡½æ•°def get_course_lessonç”¨äºè·å–è¯¾ç¨‹çš„ç« èŠ‚ï¼š\ndef get_course_lesson(self):\r# è·å–è¯¾ç¨‹æ‰€æœ‰ç« èŠ‚\rreturn self.lesson_set.all()\r åœ¨lessonå‡½æ•°é‡Œé¢ï¼Œæ–°å®šä¹‰å‡½æ•°def get_lesson_videoç”¨äºè·å–ç« èŠ‚çš„è§†é¢‘ä¿¡æ¯ï¼š\ndef get_lesson_video(self):\r# è·å–ç« èŠ‚è§†é¢‘ä¿¡æ¯\rreturn self.video_set.all()\r ç°åœ¨æ‰“å¼€course-video.htmlé¡µé¢ï¼Œé…ç½®æ•°æ®çš„åŠ¨æ€æ˜¾ç¤ºï¼š\n{% for lesson in course.get_course_lesson %}\r\u0026lt;div class=\u0026quot;chapter chapter-active\u0026quot; \u0026gt;\r\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;i class=\u0026quot;state-expand\u0026quot;\u0026gt;\u0026lt;/i\u0026gt;{{ lesson.name }}\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\r\u0026lt;ul class=\u0026quot;video\u0026quot;\u0026gt;\r{% for video in lesson.get_lesson_video %}\r\u0026lt;li\u0026gt;\r\u0026lt;a target=\u0026quot;_blank\u0026quot; href='/video/3662' class=\u0026quot;J-media-item studyvideo\u0026quot;\u0026gt;{{ video.name }}({{ video.learn_times }})\r\u0026lt;i class=\u0026quot;study-state\u0026quot;\u0026gt;\u0026lt;/i\u0026gt;\r\u0026lt;/a\u0026gt;\r\u0026lt;/li\u0026gt;\r{% endfor %}\r\u0026lt;/ul\u0026gt;\r\u0026lt;/div\u0026gt;\r{% endfor %}\r è¯¾ç¨‹è¯„è®º æ‰“å¼€courses/urls.pyæ–‡ä»¶ï¼Œé…ç½®è¯¾ç¨‹è¯„è®ºé¡µé¢çš„url\nfrom .views import CourseCommentView\r# è¯¾ç¨‹è¯„è®ºé¡µé¢url\rre_path('comment/(?P\u0026lt;course_id\u0026gt;.*)/', CourseCommentView.as_view(), name=\u0026quot;course_comment\u0026quot;),\r ç„¶åæ‰“å¼€courses/views.pyæ–‡ä»¶ï¼Œæ–°å®šä¹‰è¯¾ç¨‹è¯„è®ºé¡µé¢å‡½æ•°ï¼š\nfrom operation.models import CourseComments\r# è¯¾ç¨‹è¯„è®ºé¡µé¢\rclass CourseCommentView(View):\rdef get(self, request, course_id):\rcourse = Course.objects.get(id=int(course_id))\rall_resources = CourseResource.objects.filter(course=course)\rall_comments = CourseComments.objects.all()\rreturn render(request, \u0026quot;course-comment.html\u0026quot;, {\r\u0026quot;course\u0026quot;: course,\r\u0026quot;all_resources\u0026quot;: all_resources,\r\u0026quot;all_comments\u0026quot;: all_comments,\r})\r æ¥ç€æ‰“å¼€course-comment.htmlé¡µé¢,ä¿®æ”¹è·³è½¬ä»£ç ï¼š\n\u0026lt;li\u0026gt;\u0026lt;a class=\u0026quot;ui-tabs-active active\u0026quot; id=\u0026quot;learnOn\u0026quot; href=\u0026quot;{% url 'courses:course_info' course.id %}\u0026quot;\u0026gt;\u0026lt;span\u0026gt;ç« èŠ‚\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\r\u0026lt;li\u0026gt;\u0026lt;a id=\u0026quot;commentOn\u0026quot; class=\u0026quot;\u0026quot; href=\u0026quot;{% url 'course:course_comment' course.id %}\u0026quot;\u0026gt;\u0026lt;span\u0026gt;è¯„è®º\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\r ç„¶åæ‰“å¼€course-comment.htmlé¡µé¢ï¼Œä¿®æ”¹è¯¾ç¨‹ä¿¡æ¯ï¼Œèµ„æ–™ä¸‹è½½ï¼Œè®²å¸ˆæç¤ºç­‰, å’Œå‰é¢åœ¨videoé¡µé¢é…ç½®çš„ä¸€æ ·\nè¯¾ç¨‹èµ„æº ç¬¬ä¸€æ­¥ï¼Œå‰å¾€xadminåå°ä¸ºæŸä¸€é—¨è¯¾æ·»åŠ è¯¾ç¨‹èµ„æºï¼Œç¬¬äºŒæ­¥æ‰“å¼€courses/views.pyæ–‡ä»¶ï¼Œä¿®æ”¹è§†å›¾å‡½æ•°ï¼š\nfrom .models import CourseResource\rall_resources = CourseResource.objects.filter(course=course)\rreturn render(request, \u0026quot;course-video.html\u0026quot;, {\r\u0026quot;all_resources\u0026quot;: all_resources,\r})\r æ‰“å¼€course-video.htmlé¡µé¢ï¼Œé…ç½®èµ„æºä¸‹è½½çš„åŠ¨æ€æ˜¾ç¤ºï¼š\n{% for resources in all_resources %}\r\u0026lt;li\u0026gt;\r\u0026lt;span \u0026gt;\u0026lt;i class=\u0026quot;aui-iconfont aui-icon-file\u0026quot;\u0026gt;\u0026lt;/i\u0026gt;\u0026amp;nbsp;\u0026amp;nbsp;{{ resources.name }}\u0026lt;/span\u0026gt;\r\u0026lt;a href=\u0026quot;{{ MEDIA_URL }}{{ resources.download }}\u0026quot; class=\u0026quot;downcode\u0026quot; target=\u0026quot;_blank\u0026quot; download=\u0026quot;\u0026quot; data-id=\u0026quot;274\u0026quot; title=\u0026quot;\u0026quot;\u0026gt;ä¸‹è½½\u0026lt;/a\u0026gt;\r\u0026lt;/li\u0026gt;\r{% endfor %}\r ç„¶ååˆ·æ–°é¡µé¢ï¼Œå‘ç°æ˜¾ç¤ºæ²¡æœ‰é—®é¢˜ã€‚\næ¥ä¸‹åœ¨course-video.htmlé¡µé¢å®Œæˆè¯¾ç¨‹ä¿¡æ¯çš„ä¿®æ”¹ï¼š\n\u0026lt;div class=\u0026quot;static-item \u0026quot;\u0026gt;\r\u0026lt;span class=\u0026quot;meta-value\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;{{ course.get_degree_display }}\u0026lt;/strong\u0026gt;\u0026lt;/span\u0026gt;\r\u0026lt;span class=\u0026quot;meta\u0026quot;\u0026gt;éš¾åº¦\u0026lt;/span\u0026gt;\r\u0026lt;em\u0026gt;\u0026lt;/em\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;div class=\u0026quot;static-item static-time\u0026quot;\u0026gt;\r\u0026lt;span class=\u0026quot;meta-value\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;{{ course.learn_times }}åˆ†é’Ÿ\u0026lt;/strong\u0026gt;\t\u0026lt;/span\u0026gt;\r\u0026lt;span class=\u0026quot;meta\u0026quot;\u0026gt;æ—¶é•¿\u0026lt;/span\u0026gt;\r\u0026lt;em\u0026gt;\u0026lt;/em\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;div class=\u0026quot;static-item\u0026quot;\u0026gt;\r\u0026lt;span class=\u0026quot;meta-value\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;{{ course.students }}äºº\u0026lt;/strong\u0026gt;\u0026lt;/span\u0026gt;\r\u0026lt;span class=\u0026quot;meta\u0026quot;\u0026gt;å­¦ä¹ äººæ•°\u0026lt;/span\u0026gt;\r\u0026lt;em\u0026gt;\u0026lt;/em\u0026gt;\r\u0026lt;/div\u0026gt;\r åœ¨é…ç½®è®²å¸ˆæç¤ºçš„æ—¶å€™ï¼Œå‘ç°è®²å¸ˆå’Œè¯¾ç¨‹ä¹‹é—´æ²¡æœ‰å»ºç«‹å¤–é”®è¿æ¥ï¼Œæ‰€ä»¥åœ¨courses/models.pyæ–‡ä»¶çš„Courseå‡½æ•°ï¼Œæ–°å¢è®²å¸ˆå­—æ®µ :\nfrom organization.models import Teacher\rteacher = models.ForeignKey(Teacher, on_delete=models.CASCADE, verbose_name=\u0026quot;è®²å¸ˆ\u0026quot;, null=True, blank=True)\r è®°å¾—æ•°æ®åº“çš„å˜åŠ¨éœ€è¦ä¸¤éƒ¨æ›²ï¼šmakemigrationså’Œmigrateã€‚\nç„¶åå‰å¾€xadminåå°ä¸ºè¿™é—¨è¯¾æ·»åŠ ä¸€ä¸ªè®²å¸ˆã€‚ç„¶åä¿®æ”¹course-video.htmlé¡µé¢\nè¯¾ç¨‹ç›¸å…³æ¨è æ‰“å¼€courses/views.pyæ–‡ä»¶ï¼Œæ‰¾åˆ°CourseInfoViewè¿™ä¸ªå‡½æ•°ï¼Œä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼š\n# è¯¾ç¨‹ç« èŠ‚ä¿¡æ¯\rclass CourseInfoView(View):\rdef get(self, request, course_id):\rcourse = Course.objects.get(id=int(course_id))\rall_resources = CourseResource.objects.filter(course=course)\r# å–å‡ºæ‰€æœ‰é€‰è¿‡è¿™é—¨è¯¾çš„å­¦ç”Ÿ\ruser_courses = UserCourse.objects.filter(course=course)\r# å–å‡ºæ‰€æœ‰é€‰è¿‡è¿™é—¨è¯¾çš„å­¦ç”Ÿçš„id,é‡‡ç”¨é€’å½’è¡¨è¾¾å¼å½¢å¼\ruser_ids = [user_course.user.id for user_course in user_courses]\r# å–å‡ºåˆšæ‰é‚£äº›å­¦ç”Ÿé€‰è¿‡çš„æ‰€æœ‰çš„è¯¾ç¨‹\rall_user_courses = UserCourse.objects.filter(user_id__in=user_ids)\r# å–å‡ºåˆšæ‰é‚£äº›å­¦ç”Ÿé€‰è¿‡çš„æ‰€æœ‰çš„è¯¾ç¨‹çš„id,åŒæ ·é‡‡ç”¨é€’å½’è¡¨è¾¾å¼å½¢å¼\rcourse_ids = [all_user_course.course_id for all_user_course in all_user_courses]\r# å–å‡ºå­¦è¿‡è¯¥è¯¾ç¨‹ç”¨æˆ·å­¦è¿‡çš„å…¶ä»–è¯¾ç¨‹\rrelate_courses = Course.objects.filter(id__in=course_ids).order_by(\u0026quot;-click_nums\u0026quot;)[:5]\rreturn render(request, \u0026quot;course-video.html\u0026quot;, {\r\u0026quot;course\u0026quot;: course,\r\u0026quot;all_resources\u0026quot;: all_resources,\r\u0026quot;relate_courses\u0026quot;: relate_courses,\r})\r æ³¨æ„ï¼šåŒä¸‹åˆ’çº¿ä»£è¡¨ä»£è¡¨ä¼ è¿›æ¥çš„æ˜¯ä¸€ä¸ªå¯ä»¥éå†çš„listã€‚\næ¥ç€å°±æ˜¯åœ¨å‰ç«¯é¡µé¢é…ç½®åŠ¨æ€åŠ è½½ä¿¡æ¯äº†ï¼ˆè®°å¾—course-video.htmlå’Œcourse_comment.htmlè¿™ä¸¤ä¸ªé¡µé¢éƒ½éœ€è¦é…ç½®ï¼Œä¸€æ¨¡ä¸€æ ·ï¼‰ï¼š\n\u0026lt;ul class=\u0026quot;other-list\u0026quot;\u0026gt;\r{% for relate_course in relate_courses %}\r\u0026lt;li class=\u0026quot;curr\u0026quot;\u0026gt;\r\u0026lt;a href=\u0026quot;{% url 'course:course_detail' relate_course.id %}\u0026quot;target=\u0026quot;_blank\u0026quot;\u0026gt;\r\u0026lt;img src=\u0026quot;{{ MEDIA_URL }}{{ relate_course.image }}\u0026quot;alt=\u0026quot;{{ relate_course.name }}\u0026quot;\u0026gt;\r\u0026lt;span class=\u0026quot;name autowrap\u0026quot;\u0026gt;{{ relate_course.name }}\u0026lt;/span\u0026gt;\r\u0026lt;/a\u0026gt;\r\u0026lt;/li\u0026gt;\r{% endfor %}\r\u0026lt;/ul\u0026gt;\r å­˜åœ¨é—®é¢˜ï¼šé‚£å°±æ˜¯ç”¨æˆ·å¦‚æœæ²¡æœ‰ç™»å½•ï¼Œé‚£æ˜¯ä¸èƒ½è®©ä»–è¿›å…¥è¯¾ç¨‹ç« èŠ‚è¿™ä¸ªé¡µé¢çš„ï¼Œå› æ­¤éœ€è¦åˆ¤æ–­ä¸€ä¸‹ã€‚è¿™é‡Œå› ä¸ºä½¿ç”¨çš„æ˜¯æ–¹æ³•å‹ç¼–ç¨‹æ‰€ä»¥å¯ä»¥ä½¿ç”¨è£…é¥°å™¨loginrequiredæ¥è¿›è¡Œåˆ¤æ–­ã€‚\nåœ¨utilsæ–‡ä»¶å¤¹ä¸‹é¢ï¼Œæ–°å»ºä¸€ä¸ªåä¸ºmixin_utils.pyæ–‡ä»¶ï¼Œåœ¨é‡Œé¢æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š\nfrom django.contrib.auth.decorators import login_required\rfrom django.utils.decorators import method_decorator\rclass LoginRequiredMixin(object):\r@method_decorator(login_required(login_url='/login/'))\rdef dispatch(self, request, *args, **kwargs):\rreturn super(LoginRequiredMixin, self).dispatch(request, *args, **kwargs)\r æ¥ç€æ‰“å¼€courses/views.pyæ–‡ä»¶ï¼Œåœ¨é‡Œé¢ä¿®æ”¹CourseInfoViewå’ŒCourseCommentViewï¼Œä¿®æ”¹åå¦‚ä¸‹ï¼š\nfrom utils.mixin_utils import LoginRequiredMixin\r# è¯¾ç¨‹ç« èŠ‚ä¿¡æ¯\rclass CourseInfoView(LoginRequiredMixin, View):\rlogin_url = '/login/'\rredirect_field_name = 'redirect_to'\rdef get(self, request, course_id):\rcourse = Course.objects.get(id=int(course_id))\rall_resources = CourseResource.objects.filter(course=course)\r# æŸ¥è¯¢ç”¨æˆ·æ˜¯å¦å·²ç»å¼€å§‹å­¦ä¹ äº†è¯¥è¯¾ç¨‹ï¼Œå¦‚æœæ²¡æœ‰åˆ™å¼€å§‹å­¦ä¹ \ruser_courses = UserCourse.objects.filter(user=request.user, course=course)\rif not user_courses:\ruser_course = UserCourse(user=request.user, course=course)\rcourse.students += 1\rcourse.save()\ruser_course.save()\r# å–å‡ºæ‰€æœ‰é€‰è¿‡è¿™é—¨è¯¾çš„å­¦ç”Ÿ\ruser_courses = UserCourse.objects.filter(course=course)\r# å–å‡ºæ‰€æœ‰é€‰è¿‡è¿™é—¨è¯¾çš„å­¦ç”Ÿçš„id,é‡‡ç”¨é€’å½’è¡¨è¾¾å¼å½¢å¼\ruser_ids = [user_course.user.id for user_course in user_courses]\r# å–å‡ºåˆšæ‰é‚£äº›å­¦ç”Ÿé€‰è¿‡çš„æ‰€æœ‰çš„è¯¾ç¨‹\rall_user_courses = UserCourse.objects.filter(user_id__in=user_ids)\r# å–å‡ºåˆšæ‰é‚£äº›å­¦ç”Ÿé€‰è¿‡çš„æ‰€æœ‰çš„è¯¾ç¨‹çš„id,åŒæ ·é‡‡ç”¨é€’å½’è¡¨è¾¾å¼å½¢å¼\rcourse_ids = [all_user_course.course_id for all_user_course in all_user_courses]\r# å–å‡ºå­¦è¿‡è¯¥è¯¾ç¨‹ç”¨æˆ·å­¦è¿‡çš„å…¶ä»–è¯¾ç¨‹\rrelate_courses = Course.objects.filter(id__in=course_ids).order_by(\u0026quot;-click_nums\u0026quot;)[:5]\rreturn render(request, \u0026quot;course-video.html\u0026quot;, {\r\u0026quot;course\u0026quot;: course,\r\u0026quot;all_resources\u0026quot;: all_resources,\r\u0026quot;relate_courses\u0026quot;: relate_courses,\r})\r# è¯¾ç¨‹è¯„è®ºé¡µé¢\rclass CourseCommentView(LoginRequiredMixin, View):\rlogin_url = '/login/'\rredirect_field_name = 'redirect_to' def get(self, request, course_id):\rcourse = Course.objects.get(id=int(course_id))\rall_resources = CourseResource.objects.filter(course=course)\rall_comments = CourseComments.objects.all()\rreturn render(request, \u0026quot;course-comment.html\u0026quot;, {\r\u0026quot;course\u0026quot;: course,\r\u0026quot;all_resources\u0026quot;: all_resources,\r\u0026quot;all_comments\u0026quot;: all_comments,\r})\r åˆ·æ–°ä¸€ä¸‹é¡µé¢ï¼Œç‚¹å‡ ä¸ªè¯¾ç¨‹è¯•è¯•çœ‹ï¼Œå‘ç°éƒ½åœ¨è¯¥åŒå­¦è¿˜å­¦è¿‡å“ªäº›è¯¾é‡Œæ¨èäº†ã€‚\nè¯¾ç¨‹è§†é¢‘ è¯¾ç¨‹æ’­æ”¾é¡µé¢é…ç½® æ‰“å¼€courses/urls.pyæ–‡ä»¶ï¼Œæ–°å¢ä»£ç ï¼š\nfrom .views import VideoPlayView\r# è§†é¢‘æ’­æ”¾é¡µé¢url\rre_path('video/(?P\u0026lt;video_id\u0026gt;.*)/', VideoPlayView.as_view(), name=\u0026quot;video_play\u0026quot;),\ræˆ–è€… re_path('video/(?P\u0026lt;video_id\u0026gt;\\d+)/', VideoPlayView.as_view(), name=\u0026quot;video_play\u0026quot;),éƒ½æ˜¯å¯ä»¥çš„\r æ¥ç€æ‰“å¼€courses/views.pyæ–‡ä»¶ï¼Œæ–°å¢ä»£ç ï¼š\nfrom .models import Video\r# è§†é¢‘æ’­æ”¾é¡µé¢\rclass VideoPlayView(LoginRequiredMixin, View):\rlogin_url = '/login/'\rredirect_field_name = 'redirect_to'\rdef get(self, request, video_id):\rvideo = Video.objects.get(id=int(video_id))\rcourse = video.lesson.course\rall_resources = CourseResource.objects.filter(course=course)\r# æŸ¥è¯¢ç”¨æˆ·æ˜¯å¦å·²ç»å¼€å§‹å­¦ä¹ äº†è¯¥è¯¾ç¨‹ï¼Œå¦‚æœæ²¡æœ‰åˆ™å¼€å§‹å­¦ä¹ \ruser_courses = UserCourse.objects.filter(user=request.user, course=course)\rif not user_courses:\ruser_course = UserCourse(user=request.user, course=course)\rcourse.students += 1\rcourse.save()\ruser_course.save()\r# å–å‡ºæ‰€æœ‰é€‰è¿‡è¿™é—¨è¯¾çš„å­¦ç”Ÿ\ruser_courses = UserCourse.objects.filter(course=course)\r# å–å‡ºæ‰€æœ‰é€‰è¿‡è¿™é—¨è¯¾çš„å­¦ç”Ÿçš„id,é‡‡ç”¨é€’å½’è¡¨è¾¾å¼å½¢å¼\ruser_ids = [user_course.user.id for user_course in user_courses]\r# å–å‡ºåˆšæ‰é‚£äº›å­¦ç”Ÿé€‰è¿‡çš„æ‰€æœ‰çš„è¯¾ç¨‹\rall_user_courses = UserCourse.objects.filter(user_id__in=user_ids)\r# å–å‡ºåˆšæ‰é‚£äº›å­¦ç”Ÿé€‰è¿‡çš„æ‰€æœ‰çš„è¯¾ç¨‹çš„id,åŒæ ·é‡‡ç”¨é€’å½’è¡¨è¾¾å¼å½¢å¼\rcourse_ids = [all_user_course.course_id for all_user_course in all_user_courses]\r# å–å‡ºå­¦è¿‡è¯¥è¯¾ç¨‹ç”¨æˆ·å­¦è¿‡çš„å…¶ä»–è¯¾ç¨‹\rrelate_courses = Course.objects.filter(id__in=course_ids).order_by(\u0026quot;-click_nums\u0026quot;)[:5]\rreturn render(request, \u0026quot;course-play.html\u0026quot;, {\r\u0026quot;course\u0026quot;: course,\r\u0026quot;all_resources\u0026quot;: all_resources,\r\u0026quot;relate_courses\u0026quot;: relate_courses,\r\u0026quot;video\u0026quot;: video,\r})\r ä¸Šé¢çš„ä»£ç å’Œä¹‹å‰åœ¨è¯¾ç¨‹ç« èŠ‚ä¿¡æ¯é‡Œé¢å®šä¹‰çš„å‡ ä¹ä¸€æ¨¡ä¸€æ ·ï¼Œåªæ˜¯courseçš„æ¥æºä¸ä¸€æ ·ã€‚\næ¥ç€æ‰“å¼€course-video.htmlæ–‡ä»¶ï¼Œé…ç½®è·³è½¬é“¾æ¥ï¼š\n{% for video in lesson.get_lesson_video %}\r\u0026lt;li\u0026gt;\r\u0026lt;a target=\u0026quot;_blank\u0026quot; href='{% url 'course:video_play' video.id %}'\rclass=\u0026quot;J-media-item studyvideo\u0026quot;\u0026gt;{{ video.name }}({{ video.learn_times }})\r\u0026lt;i class=\u0026quot;study-state\u0026quot;\u0026gt;\u0026lt;/i\u0026gt;\r\u0026lt;/a\u0026gt;\r\u0026lt;/li\u0026gt;\r{% endfor %}\r ç„¶åæ‰“å¼€course-video.htmlæ–‡ä»¶ï¼Œé…ç½®è§†é¢‘é“¾æ¥ï¼Œè®°ä½ç”±äºæˆ‘ä»¬è¿™è¾¹æ˜¯type=\u0026lsquo;video/mp4\u0026rsquo;æ‰€ä»¥åå°æ‰€æ·»åŠ çš„è§†é¢‘å¿…é¡»æ˜¯.mp4ç»“å°¾ï¼Œå¦åˆ™ä¼šå‡ºé”™ã€‚\nå¤‡æ³¨ï¼š{{ forloop.counter|add:2 }}æ˜¯ä¸ºäº†ä»ç¬¬ä¸‰ä¸ªå¼€å§‹è®¡æ•°çš„ï¼Œè¿™æ˜¯Djangoè‡ªå¸¦çš„åŠŸèƒ½\n{% if forloop.counter|divisibleby:5 %}five{% endif %}è¡¨ç¤ºå¦‚æœèƒ½è¢«5æ•´é™¤åˆ™æ˜¾ç¤ºfiveï¼Œè¿™ä¹Ÿæ˜¯Djangoè‡ªå¸¦çš„åŠŸèƒ½\n404å’Œ500é¡µé¢çš„é…ç½® ä»å‰ç«¯èµ„æ–™é‡Œé¢æ‹·è´æˆ‘ä»¬çš„404å’Œ500é¡µé¢åˆ°templatesæ–‡ä»¶å¤¹å¹¶ä¿®æ”¹æ–‡ä»¶é‡Œé¢çš„é™æ€æ–‡ä»¶åœ°å€ã€‚æ‰“å¼€eduline/urls.pyæ–‡ä»¶ï¼Œæ–°å¢ä»£ç å¦‚ä¸‹ï¼š\n# å…¨å±€404é¡µé¢é…ç½®\rhandler404 = 'users.views.page_not_found'\r ç„¶åæ‰“å¼€users/views.pyæ–‡ä»¶ï¼Œæ–°å¢ä»¥ä¸‹ä»£ç ï¼š\n# 404é¡µé¢å¯¹åº”çš„å¤„ç†å‡½æ•°\rdef page_not_found(request):\rfrom django.shortcuts import render_to_response\rresponse = render_to_response(\u0026quot;404.html\u0026quot;, {})\r# è®¾ç½®responseçš„çŠ¶æ€ç \rresponse.status_code = 404\rreturn response\r æ¥ç€è¿è¡Œé¡¹ç›®ï¼Œéšæ„è¾“å…¥ä¸€ä¸ªåœ°å€ï¼Œå‘ç°é¡µé¢å¹¶æ²¡æœ‰å‡ºæ¥ï¼Œé‚£æ˜¯å› ä¸ºåœ¨eduline/settings.pyæ–‡ä»¶é‡Œé¢ï¼šDEBUG = Trueï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¿®æ”¹å®ƒä¸ºFalseï¼Œè¿˜æœ‰ä¸‹é¢çš„å…è®¸è®¿é—®IPåœ°å€ï¼Œå¦åˆ™404é¡µé¢ä¹Ÿæ˜¯å‡ºä¸æ¥çš„ï¼š\nDEBUG = False\rALLOWED_HOSTS = ['*']\r è¿™æ ·é‡æ–°è¿è¡Œä¸€ä¸‹é¡¹ç›®ï¼Œå‘ç°é¡µé¢æœ‰äº†ï¼Œä½†æ˜¯æ ·å­å´æ²¡åŠ è½½å‡ºæ¥ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ\nå› ä¸ºDEBUGä¸ºTrueæ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å‰å¾€STATICFILES_DIRSä¸‹å¯»æ‰¾æ–‡ä»¶ã€‚æ‰€ä»¥ä¸€èˆ¬éƒ½ä¼šé€‰æ‹©Trueï¼Œä¾¿äºé”™è¯¯ä¿¡æ¯çš„æ˜¾ç¤ºã€‚\nä½†æ˜¯ä¸€æ—¦DEBUGä¸ºFalseæ—¶ï¼Œæƒ…å†µå°±ä¸ä¸€æ ·äº†ï¼ŒDjangoå°±ä¸ä¼šä»£ç®¡é™æ€æ–‡ä»¶ï¼Œè€Œäº‹å®ä¸Šä¸€èˆ¬é™æ€æ–‡ä»¶éƒ½æ˜¯é€šè¿‡ç¬¬ä¸‰æ–¹httpæœåŠ¡å™¨æ¥ä»£ç†è½¬å‘ã€‚ï¼ˆå¦‚å¸¸è§çš„æœåŠ¡å™¨Nignx å’Œ Apacheéƒ½ä¼šè‡ªåŠ¨ä»£ç†è¿™äº›é™æ€æ–‡ä»¶ï¼‰\nä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œå¯ä»¥ï¼šæ‰“å¼€eduline/settings.pyæ–‡ä»¶ï¼Œæ–°å¢ä»£ç å¦‚ä¸‹ï¼š\nSTATIC_ROOT = os.path.join(BASE_DIR, 'static')\r æ‰“å¼€eduline/urls.pyæ–‡ä»¶ï¼Œæ–°å¢ä»£ç å¦‚ä¸‹ï¼š\nfrom eduline.settings import STATIC_ROOT\r# é…ç½®é™æ€æ–‡ä»¶ä¸Šä¼ çš„è®¿é—®å¤„ç†url\rre_path('static/(?P\u0026lt;path\u0026gt;.*)', serve, {\u0026quot;document_root\u0026quot;: STATIC_ROOT}),\r é‡æ–°è¿è¡Œé¡¹ç›®å³å¯.500çš„é¡µé¢çš„é…ç½®å’Œè¿™ä¸ªä¸€æ ·ï¼ˆæ³¨æ„å‡½æ•°åä¸ºpage_errorï¼‰\néšè—çš„å‘ï¼šæŒ‰ç…§ä¸Šè¿°æ­¥éª¤å¯ä»¥è§£å†³404/500ç­‰é—®é¢˜ï¼Œä½†æ˜¯è¿›å…¥åˆ°åå°ç®¡ç†ç•Œé¢(127.0.0.1:800/xadmin)ç•Œé¢åˆ™ä¼šå‘ç°æ ·å¼ä¸¢å¤±ï¼\näº§ç”ŸåŸå› ï¼š djangoçš„ç”Ÿäº§ç¯å¢ƒä¸åŒå¼€å‘ç¯å¢ƒï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼ˆDEBUG=Falseï¼‰,django.contrib.staticfiles æ˜¯ä¸èµ·ä»»ä½•ä½œç”¨çš„ï¼Œä¹Ÿå°±è¯´ django.contrib.staticfiles åªå¯¹å¼€å‘ç¯å¢ƒï¼ˆDEBUG=Trueï¼‰å¼€å¯ã€‚æ‰€ä»¥ä¼šå¯¼è‡´xadminæ ·å¼ä¸¢å¤±ç°è±¡ã€‚\nè§£å†³æ–¹æ¡ˆï¼š â‘  åœ¨settings.pyä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼ŒåŒæ—¶æ³¨é‡ŠSTATICFILES_DIRS\n# STATICFILES_DIRS = (\r# os.path.join(BASE_DIR, \u0026quot;static\u0026quot;),\r# )\rSTATIC_ROOT = os.path.join(BASE_DIR, 'static')\r â‘¡ ä¿®æ”¹ä¸»é¡¹ç›®ä¸­çš„urls.pyæ–‡ä»¶\nfrom.settings import STATIC_ROOT\rurlpatterns = [\r//...\rurl(r'^static/(?P\u0026lt;path\u0026gt;.*)$', serve, {\u0026quot;document_root\u0026quot;: STATIC_ROOT}),\r]\r â‘¢ åœ¨æ§åˆ¶å°æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå®ƒä¼šåœ¨æ ¹ç›®å½•ä¸‹ç”Ÿæˆstaticæ–‡ä»¶ï¼Œé‡Œè¾¹å­˜å‚¨çš„æ˜¯xadminçš„æ ·å¼æ–‡ä»¶ï¼š\n\u0026gt; collectstatic\r å¸¸è§çš„Webæ”»å‡» å…·ä½“åŒ…æ‹¬SQLæ³¨å…¥æ”»å‡»åŠé˜²æŠ¤ï¼ŒXSSæ”»å‡»åŠé˜²æŠ¤ä»¥åŠCSRFæ”»å‡»åŠé˜²æŠ¤\nSQLæ³¨å…¥æ”»å‡»åŠé˜²æŠ¤ ä»€ä¹ˆæ˜¯SQLæ³¨å…¥ï¼Ÿ\n æ‰€è°“SQLæ³¨å…¥ï¼Œå°±æ˜¯é€šè¿‡æŠŠSQLå‘½ä»¤æ’å…¥åˆ°Webè¡¨å•æäº¤æˆ–è¾“å…¥åŸŸåæˆ–é¡µé¢è¯·æ±‚çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œæœ€ç»ˆè¾¾åˆ°æ¬ºéª—æœåŠ¡å™¨æ‰§è¡Œæ¶æ„çš„SQLå‘½ä»¤ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒæ˜¯åˆ©ç”¨ç°æœ‰åº”ç”¨ç¨‹åºï¼Œå°†ï¼ˆæ¶æ„çš„ï¼‰SQLå‘½ä»¤æ³¨å…¥åˆ°åå°æ•°æ®åº“å¼•æ“æ‰§è¡Œçš„èƒ½åŠ›ï¼Œå®ƒå¯ä»¥é€šè¿‡åœ¨Webè¡¨å•ä¸­è¾“å…¥ï¼ˆæ¶æ„ï¼‰SQLè¯­å¥å¾—åˆ°ä¸€ä¸ªå­˜åœ¨å®‰å…¨æ¼æ´çš„ç½‘ç«™ä¸Šçš„æ•°æ®åº“ï¼Œè€Œä¸æ˜¯æŒ‰ç…§è®¾è®¡è€…æ„å›¾å»æ‰§è¡ŒSQLè¯­å¥ã€‚æ¯”å¦‚å…ˆå‰çš„å¾ˆå¤šå½±è§†ç½‘ç«™æ³„éœ²VIPä¼šå‘˜å¯†ç å¤§å¤šå°±æ˜¯é€šè¿‡WEBè¡¨å•é€’äº¤æŸ¥è¯¢å­—ç¬¦æš´å‡ºçš„ï¼Œè¿™ç±»è¡¨å•ç‰¹åˆ«å®¹æ˜“å—åˆ°SQLæ³¨å…¥å¼æ”»å‡»ã€‚\n SQLæ³¨å…¥çš„å±å®³:\néæ³•è¯»å–ã€ç¯¡æ”¹ã€åˆ é™¤æ•°æ®åº“ä¸­çš„æ•°æ®\nç›—å–ç”¨æˆ·çš„å„ç±»æ•æ„Ÿä¿¡æ¯ï¼Œè·å–åˆ©ç›Š\né€šè¿‡ä¿®æ”¹æ•°æ®åº“æ¥ä¿®æ”¹ç½‘é¡µä¸Šçš„å†…å®¹\næ³¨å…¥æœ¨é©¬ç­‰ç­‰\nä¸‹é¢é€šè¿‡ä¸€æ®µä»£ç äº†è§£ä¸€ä¸‹SQLæ³¨å…¥çš„è¿‡ç¨‹ï¼š\n# users/views.pyæ–‡ä»¶ï¼š\rclass LoginUnsafeView(View):\rdef get(self, request):\rreturn render(request, \u0026quot;login.html\u0026quot;, {})\rdef post(self, request):\ruser_name = request.POST.get(\u0026quot;username\u0026quot;, \u0026quot;\u0026quot;)\rpass_word = request.POST.get(\u0026quot;password\u0026quot;, \u0026quot;\u0026quot;)\rimport MySQLdb\rconn = MySQLdb.connect(host='127.0.0.1', user='root', passwd='root', db='mxonline', charset='utf8')\rcursor = conn.cursor()\rsql_select = \u0026quot;select * from users_userprofile where email='{0}' and password='{1}'\u0026quot;.format(user_name, pass_word)\rresult = cursor.execute(sql_select)\rfor row in cursor.fetchall():\r# æŸ¥è¯¢åˆ°ç”¨æˆ·\rpass\rprint 'hello'\r# eduline/urls.pyæ–‡ä»¶:\rfrom users.views import LoginUnsafeView\rurlpatterns = [\rpath('login/', LoginUnsafeView.as_view(), name='login'),\r]\r è¿™é‡Œç«Ÿç„¶æŠŠsqlè¯­å¥å†™åˆ°è¿™é‡Œï¼Œæ‰€ä»¥å¯ä»¥åœ¨å‚æ•°ä¸­åŠ å…¥sqlè¯­å¥ï¼Œä½¿ä¹‹æ‹¼æ¥å­—ç¬¦ä¸²ä»è€Œä¸ºçœŸè¢«ç³»ç»Ÿè¯†åˆ«é€šè¿‡ï¼Œç›—å–ç”¨æˆ·ä¿¡æ¯ã€‚ä½†æ˜¯åœ¨Djangoè‡ªå¸¦äº†orm,å¯ä»¥å¯¹è¿™ä¸ªè¿›è¡ŒéªŒè¯ï¼Œä»è€Œä¿è¯ç³»ç»Ÿçš„å®‰å…¨ã€‚å› æ­¤å»ºè®®é‡‡ç”¨ormè¿™ç§å½¢å¼ï¼Œä¸è¦ä½¿ç”¨åŸç”Ÿçš„sqlè¯­å¥ã€‚\nXSSæ”»å‡»åŠé˜²æŠ¤ CSRFæ”»å‡»åŠé˜²æŠ¤ xadminè¿›é˜¶ è‡ªå®šä¹‰icon ä»¥ä¿®æ”¹é‚®ç®±éªŒè¯ç ä¸ºä¾‹ï¼Œæ‰“å¼€users/adminx.pyæ–‡ä»¶ï¼Œåœ¨EmailVerifyRecordAdminå‡½æ•°æ–°å¢ä¸€è¡Œä»£ç ï¼š\nmodel_icon = 'fa fa-user'\r å…¶å®è¿™ä¸ªæ ·å¼å°±æ˜¯å¯¹åº”äºfont awesome/http://www.fontawesome.com.cn/é‡Œé¢çš„å›¾æ ‡ï¼Œä½ å¯ä»¥ä¸‹è½½æ–°çš„æºä»£ç å¯¹ç›®å½•ä¸‹çš„csså’Œfontsæ–‡ä»¶å¤¹è¿›è¡Œæ›¿æ¢ï¼š\nç„¶ååˆ·æ–°ä¸€ä¸‹å°±å‡ºç°æƒ³è¦çš„æ ·å¼iconäº†ã€‚ï¼ˆå¦‚æœä¸ºå‡ºç°ï¼Œç”¨Ctrl+F5å¼ºåˆ¶åˆ·æ–°ï¼Œè¿˜æ˜¯ä¸è¡Œçš„è¯ï¼Œæ³¨é”€é‡æ–°ç™»å½•ï¼‰\né»˜è®¤æ’åºï¼Œå­—æ®µåªè¯»ï¼Œå­—æ®µéšè— æˆ‘ä»¬ä»¥è¯¾ç¨‹ä¸ºä¾‹ï¼Œæ¥ä»‹ç»è¿™3ä¸ªå°åŠŸèƒ½ã€‚æ‰“å¼€couses/adminx.pyæ–‡ä»¶ï¼Œåœ¨CourseAdminä¸­åŠ å…¥ä»¥ä¸‹ä»£ç ï¼š\n# é»˜è®¤æ’åºï¼šä»¥ç‚¹å‡»æ•°æ’åº\rordering = ['-click_nums']\r# å­—æ®µåªè¯»ï¼šç‚¹å‡»æ•°åªå…è®¸è¯»å–\rreadonly_fields = ['click_nums', 'fav_nums']\r# å­—æ®µéšè—ï¼šæ”¶è—æ•°éšè—æ˜¾ç¤º\rexclude = ['fav_nums']\r# æ³¨æ„å­—æ®µåªè¯»å’Œå­—æ®µéšè—æ˜¯å†²çªçš„ï¼Œä¸å…è®¸è®¾ç½®ä¸€ä¸ªå­—æ®µåªè¯»åŒæ—¶éšè—\r æœç´¢æ¡† å½“è¯¾ç¨‹å¾ˆå¤šæ—¶ï¼Œæˆ‘ä»¬ä¸èƒ½ä»¥ä¸‹æ‹‰èœå•çš„å½¢å¼æ¥æŸ¥æ‰¾è¯¾ç¨‹ï¼Œéœ€è¦æœ‰æœç´¢æ¡†ã€‚è¯¾ç¨‹å®ƒæœ‰ä¸€ä¸ªå¤–é”®æ˜¯è¯¾ç¨‹æœºæ„ï¼Œå› æ­¤éœ€è¦åˆ°è¯¾ç¨‹æœºæ„é‡Œé¢è¿›è¡Œæœç´¢æ¡†çš„é…ç½®ã€‚æ‰“å¼€organization/adminx.pyæ–‡ä»¶ï¼Œåœ¨CourseOrgAdminå‡½æ•°é‡Œé¢æ·»åŠ ä¸€è¡Œä»£ç ï¼š\n# æœç´¢æ¡†ï¼Œå½“è¯¾ç¨‹æ•°æ®é‡è¿‡å¤§æ—¶ï¼Œæœ‰è¯¾ç¨‹æŒ‡å‘å®ƒï¼Œä¼šä»¥ajaxæ–¹å¼åŠ è½½\rrelfield_style = 'fk-ajax'\r inlinesæ·»åŠ æ•°æ® åœ¨è¿™ä¹‹å‰ï¼Œæ–°å¢è¯¾ç¨‹çš„æ—¶å€™æ˜¯ä¸èƒ½åŒæ—¶æ–°å¢è¯¾ç¨‹ç« èŠ‚ä¿¡æ¯çš„ï¼Œéœ€è¦è·³åˆ°å¦ä¸€ä¸ªé¡µé¢ï¼Œè¿™æ˜¯å¾ˆéº»çƒ¦çš„ã€‚æ‰€ä»¥è€ƒè™‘é‡‡ç”¨inlinesæ¥æ·»åŠ æ•°æ®ä»è€Œå®Œæˆåœ¨ä¸€ä¸ªé¡µé¢ç›´æ¥å®Œæˆç« èŠ‚ä¿¡æ¯çš„æ·»åŠ ã€‚\næ‰“å¼€couses/adminx.pyæ–‡ä»¶ï¼Œåœ¨æœ€é¡¶éƒ¨æ–°å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼š\n# è¯¾ç¨‹ç›´æ¥æ·»åŠ ç« èŠ‚\rclass LessonInline(object):\rmodel = Lesson\rextra = 0\r# åŒæ—¶åœ¨CourseAdminä¸­ï¼Œæ–°å¢ä¸€è¡Œä»£ç \r# è¯¾ç¨‹ç›´æ¥æ·»åŠ ç« èŠ‚\rclass CourseAdmin(object):\rinlines = [LessonInline] # æ•°ç»„ï¼Œæ”¯æŒå¤šä¸ª\r åˆ·æ–°ä¸€ä¸‹åå°ï¼Œå‘ç°ç« èŠ‚ä¿¡æ¯åœ¨è¯¾ç¨‹é¡µé¢åº•éƒ¨\næ”¯æŒå¤šä¸ªæ·»åŠ ï¼Œä½†ä¸æ”¯æŒåµŒå¥—æ·»åŠ ï¼ˆåªèƒ½æ·»åŠ ä¸€çº§ï¼‰\n# å†æ·»åŠ  ä¸€ä¸ªCourseRecourseInline\rclass CourseRecourseInline(object):\rmodel = CourseRecource\rextra = 0\r# åŒæ—¶åœ¨CourseAdminä¸­ï¼Œæ–°å¢ä¸€è¡Œä»£ç \r# è¯¾ç¨‹ç›´æ¥æ·»åŠ ç« èŠ‚\rclass CourseAdmin(object):\rinlines = [LessonInline, CourseRecourseInline] # æ•°ç»„ï¼Œæ”¯æŒå¤šä¸ª\r è¿™æ ·å­˜å‚¨åˆ°è¿™ä¸¤ä¸ªä¸­çš„æ•°æ®ä¼šä¿å­˜åˆ°å¯¹åº”çš„è¡¨ä¸­\nä¸€å¼ è¡¨åˆ†ä¸¤ä¸ªmodelæ¥è¿›è¡Œç®¡ç† å½•æ’­è¯¾ç¨‹ä¸éè½®æ’­è¯¾ç¨‹å¯ä»¥åˆ†å¼€ç®¡ç†ï¼Œä½†æ˜¯æœ€å¥½æ˜¯åœ¨ä¸€å¼ è¡¨é‡Œæ˜¾ç¤ºã€‚æ‰“å¼€courses/models.pyæ–‡ä»¶ï¼Œåœ¨courseå‡½æ•°ä¸‹é¢æ–°å¢ä»£ç \nclass BannerCourse(Course): # æ³¨æ„æ˜¯ç»§æ‰¿Courseè€Œä¸æ˜¯objectè¿™ä¸ªæœ€é«˜ç±»\rclass Meta:\rverbose_name = \u0026quot;è½®æ’­è¯¾ç¨‹\u0026quot;\rverbose_name_plural = verbose_name\rproxy = True # å¾ˆé‡è¦ï¼Œå¦åˆ™ä¼šç”Ÿæˆå¦å¤–ä¸€å¼ è¡¨ï¼Œè¿™æ ·è®¾ç½®å…·æœ‰modelçš„åŠŸèƒ½ï¼Œä½†ä¸ä¼šç”Ÿæˆè¡¨\r ç„¶åæ‰“å¼€courses/adminx.pyæ–‡ä»¶ï¼Œä¿®æ”¹ä¹‹å‰çš„ä»£ç ï¼š\nfrom .models import BannerCourse\rclass CourseAdmin(object):\rlist_display = ['image', ....','add_time'] # ä¸€æ¬¡æ˜¾ç¤ºä½ æƒ³å‡ºç°çš„å¤šè¡Œæ•°æ®\rsearch_fields = ['name', ...ï¼Œ'click_nums'] # æŸ¥è¯¢ä½ æƒ³è¦çš„æ•°æ®\rlist_filter = ['name', ..., 'click_nums','add_time'] # è¿‡æ»¤å™¨\r# # é»˜è®¤æ’åºï¼šä»¥ç‚¹å‡»æ•°æ’åº\r# ordering = ['-click_nums']\r#\r# # å­—æ®µåªè¯»ï¼šç‚¹å‡»æ•°åªå…è®¸è¯»å–\r# readonly_fields = ['click_nums', 'fav_nums']\r#\r# # å­—æ®µéšè—ï¼šæ”¶è—æ•°éšè—æ˜¾ç¤º\r# exclude = ['fav_nums']\r# # æ³¨æ„å­—æ®µåªè¯»å’Œå­—æ®µéšè—æ˜¯å†²çªçš„ï¼Œä¸å…è®¸è®¾ç½®ä¸€ä¸ªå­—æ®µåªè¯»åŒæ—¶éšè—\r# è¯¾ç¨‹ç›´æ¥æ·»åŠ ç« èŠ‚,è¯¾ç¨‹èµ„æº\rinlines = [LessonInline, CourseResourceInline]\r# è¿‡æ»¤åˆ—è¡¨ä¸­çš„æ•°æ®ï¼šä¸ºäº†ä¸¤ä¸ªé¡µé¢ä¿¡æ¯ä¸é‡å¤\rdef queryset(self):\rqs = super(CourseAdmin, self).queryset()\rqs = qs.filter(is_banner=False)\rreturn qs\rclass BannerCourseAdmin(object):\rlist_display = ['image', ....','add_time'] # ä¸€æ¬¡æ˜¾ç¤ºä½ æƒ³å‡ºç°çš„å¤šè¡Œæ•°æ®\rsearch_fields = ['name', ...ï¼Œ'click_nums'] # æŸ¥è¯¢ä½ æƒ³è¦çš„æ•°æ®\rlist_filter = ['name', ..., 'click_nums','add_time'] # è¿‡æ»¤å™¨\r# # é»˜è®¤æ’åºï¼šä»¥ç‚¹å‡»æ•°æ’åº\r# ordering = ['-click_nums']\r#\r# # å­—æ®µåªè¯»ï¼šç‚¹å‡»æ•°åªå…è®¸è¯»å–\r# readonly_fields = ['click_nums', 'fav_nums']\r#\r# # å­—æ®µéšè—ï¼šæ”¶è—æ•°éšè—æ˜¾ç¤º\r# exclude = ['fav_nums']\r# # æ³¨æ„å­—æ®µåªè¯»å’Œå­—æ®µéšè—æ˜¯å†²çªçš„ï¼Œä¸å…è®¸è®¾ç½®ä¸€ä¸ªå­—æ®µåªè¯»åŒæ—¶éšè—\r# è¯¾ç¨‹ç›´æ¥æ·»åŠ ç« èŠ‚,è¯¾ç¨‹èµ„æº\rinlines = [LessonInline, CourseResourceInline]\r# è¿‡æ»¤åˆ—è¡¨ä¸­çš„æ•°æ®\rdef queryset(self):\rqs = super(BannerCourseAdmin, self).queryset()\rqs = qs.filter(is_banner=True)\rreturn qs\rxadmin.site.register(BannerCourse, BannerCourseAdmin)\r ç›´æ¥åˆ—è¡¨é¡µç¼–è¾‘ å³å¯ä»¥ç›´æ¥åœ¨åˆ—è¡¨é¡µè¿›è¡Œæ›´æ”¹ç¼–è¾‘æ“ä½œï¼Œåœ¨courses/adminx.pyæ–‡ä»¶çš„CourseAdminå‡½æ•°ï¼Œæ–°å¢ä¸€è¡Œä»£ç ï¼š\n# ç›´æ¥åˆ—è¡¨é¡µç¼–è¾‘\rlist_editable = ['degree', 'desc', ]\r åˆ—è¡¨é¡µæ˜¾ç¤ºç« èŠ‚æ•° åœ¨courses/adminx.pyæ–‡ä»¶çš„CourseAdminå’ŒBannerCourseAdminå‡½æ•°çš„list_displayä¸­ï¼Œæ–°å¢æ˜¾ç¤ºå­—æ®µget_zj_numsï¼Œåˆ·æ–°åå°å‘ç°æ˜¯é»‘è‰²çš„è‹±æ–‡\néœ€è¦ä¿®æ”¹ï¼Œæ–°å¢ä¸€è¡Œä»£ç ï¼š\nget_zj_nums.short_description = \u0026quot;ç« èŠ‚æ•°\u0026quot;\r æ˜¾ç¤ºè‡ªå®šä¹‰çš„htmlä»£ç  åœ¨åˆšæ‰çš„é¡µé¢ä¸‹é¢æ–°å¢ä»¥ä¸‹ä»£ç ï¼š\ndef go_to(self):\rfrom django.utils.safestring import mark_safe\r# å¦‚æœä¸ä½¿ç”¨mark_safeï¼Œç³»ç»Ÿåˆ™ä¼šå¯¹å…¶è¿›è¡Œè½¬ä¹‰\rreturn mark_safe(\u0026quot;\u0026lt;a href='http://www.baidu.com'\u0026gt;è·³è½¬\u0026lt;/\u0026gt;\u0026quot;)\rgo_to.short_description = \u0026quot;è·³è½¬\u0026quot;\r åˆ—è¡¨é¡µå®šæ—¶åˆ·æ–° æ‰“å¼€courses/adminx.pyæ–‡ä»¶ï¼Œåœ¨ä¹‹å‰çš„CourseAdminå‡½æ•°é‡Œé¢ï¼Œæ–°å¢ä¸€è¡Œä»£ç ï¼š\n refresh_times = 3,5 # åˆ—è¡¨é¡µå®šæ—¶åˆ·æ–°3sæˆ–è€…5s\r å­—æ®µè”åŠ¨ æŸä¸€å­—æ®µå‘ç”Ÿæ”¹å˜çš„æ—¶å€™ä¸éœ€è¦æ‰‹åŠ¨æ›´æ”¹ï¼Œæ¯”å¦‚æ·»åŠ ä¸€é—¨è¯¾ç¨‹ä¹‹åï¼Œæœºæ„çš„è¯¾ç¨‹æ•°éœ€è¦+1\n# CourseAdminä¸­æ·»åŠ \rdef save_models(self):\r# åœ¨ä¿å­˜è¯¾ç¨‹çš„æ—¶å€™,ç»Ÿè®¡è¯¾ç¨‹æœºæ„çš„è¯¾ç¨‹æ•°\robj = self.new_obj\r# æ–°å¢è¯¾ç¨‹è¿˜æ²¡æœ‰ä¿å­˜ï¼Œç»Ÿè®¡çš„è¯¾ç¨‹æ•°å°±ä¼šå°‘ä¸€ä¸ª\robj.save()\r# å¿…é¡»ç¡®å®šå­˜åœ¨\rif obj.course_org is not None:\r# objå®é™…æ˜¯ä¸€ä¸ªcourseå¯¹è±¡\rcourse_org = obj.course_org\rcourse_org.course_nums = Course.objects.filter(course_org=course_org).count()\rcourse_org.save()\r xadminç›®å½• - locale å¯¹åº”è¯­è¨€åŒ…\r- migrations æ˜¯æ•°æ®è¡¨çš„è®°å½•\r- plugins æ¯ä¸€ä¸ªåå°é¡µé¢éƒ½æ˜¯ä¸€ä¸ªpluginæ’ä»¶\r- static é™æ€æ–‡ä»¶å¤¹ï¼Œé‡Œé¢æœ‰js,css\r- template è¿™æ˜¯xadminè‡ªå·±ä½¿ç”¨çš„htmlæ–‡ä»¶\r- templatetags è¿™æ˜¯tagæ¨¡æ¿\r xadminé›†æˆå¯Œæ–‡æœ¬ é¦–å…ˆç‚¹å‡»Xadmin æ’ä»¶åˆ¶ä½œï¼Œå­¦ç€å®˜ç½‘çš„ä»‹ç»ï¼Œè‡ªå·±å°è¯•åšä¸€ä¸ªæ’ä»¶:å¯Œæ–‡æœ¬ç¼–è¾‘å™¨.\næœ‰å‘çš„æ’ä»¶ï¼ï¼ï¼å…ˆçœ‹å®Œï¼ï¼ï¼ ç‚¹å‡»DjangoUeditorï¼Œè·å–DjangoUeditorçš„å®‰è£…åŒ…ï¼Œç„¶åæŒ‰ç…§å¸®åŠ©æ–‡æ¡£æˆ–è€…ä¸‹é¢çš„è¦æ±‚å®‰è£…DjangoUeditorï¼›æˆ–è€…PYPIä¸‹è½½DjangoUeditor.\n1ã€å®‰è£…æ–¹æ³•(æ³¨æ„éœ€è¦è½¬åˆ°è™šæ‹Ÿç¯å¢ƒä¸‹é¢æ‰èƒ½å®‰è£…)  æ–¹æ³•ä¸€ï¼šå°†githubæ•´ä¸ªæºç åŒ…ä¸‹è½½ï¼Œåœ¨å‘½ä»¤è¡Œè¿è¡Œ  python setup.py install\r  æ–¹æ³•äºŒï¼šä½¿ç”¨pipå·¥å…·åœ¨å‘½ä»¤è¡Œè¿è¡Œ(æ¨è)ï¼š  pip install DjangoUeditor\r 2ã€åœ¨Djangoä¸­å®‰è£…DjangoUeditor   åœ¨INSTALL_APPSé‡Œé¢å¢åŠ \nINSTALLED_APPS = [\r'captcha', # éªŒè¯ç \r'pure_pagination', # åˆ†é¡µ\r'DjangoUeditor',\r]\r   3ã€å¯Œæ–‡æœ¬ç›¸å…³pathé…ç½® é…ç½®url\n# å¯Œæ–‡æœ¬ç›¸å…³url\rurl(\u0026quot;ueditor/\u0026quot;, include('DjangoUeditor.urls')),\r 4ã€åœ¨modelsä¸­çš„ä½¿ç”¨ # courses/models.pyæ–‡ä»¶ï¼š\rfrom DjangoUeditor.models import UEditorField\rclass Course(models.Model):\rdetail = UEditorField(verbose_name='è¯¾ç¨‹è¯¦æƒ…', width=600, height=300, imagePath=\u0026quot;courses/ueditor/\u0026quot;,filePath=\u0026quot;courses/ueditor/\u0026quot;, default='')\r 5ã€ä¹¦å†™ä»£ç  åœ¨xadminçš„pluginsæ–‡ä»¶å¤¹ä¸‹é¢ï¼Œæ–°å¢ä¸€ä¸ªueditor.pyæ–‡ä»¶ï¼Œåœ¨é‡Œé¢æ–°å¢ï¼š\nimport xadmin\rfrom xadmin.views import BaseAdminPlugin, CreateAdminView, ModelFormAdminView, UpdateAdminView\rfrom DjangoUeditor.models import UEditorField\rfrom DjangoUeditor.widgets import UEditorWidget\rfrom django.conf import settings\rclass XadminUEditorWidget(UEditorWidget):\rdef __init__(self,**kwargs):\rself.ueditor_options=kwargs\rself.Media.js = None\rsuper(XadminUEditorWidget,self).__init__(kwargs)\rclass UeditorPlugin(BaseAdminPlugin):\rdef get_field_style(self, attrs, db_field, style, **kwargs):\rif style == 'ueditor':\rif isinstance(db_field, UEditorField):\rwidget = db_field.formfield().widget\rparam = {}\rparam.update(widget.ueditor_settings)\rparam.update(widget.attrs)\rreturn {'widget': XadminUEditorWidget(**param)}\rreturn attrs\r# åœ¨ç”Ÿæˆçš„é¡µé¢ä¸­æ”¾å…¥è‡ªå·±çš„jsæ–‡ä»¶\rdef block_extrahead(self, context, nodes):\rjs = '\u0026lt;script type=\u0026quot;text/javascript\u0026quot; src=\u0026quot;%s\u0026quot;\u0026gt;\u0026lt;/script\u0026gt;' % (settings.STATIC_URL + \u0026quot;ueditor/ueditor.config.js\u0026quot;) #è‡ªå·±çš„é™æ€ç›®å½•\rjs += '\u0026lt;script type=\u0026quot;text/javascript\u0026quot; src=\u0026quot;%s\u0026quot;\u0026gt;\u0026lt;/script\u0026gt;' % (settings.STATIC_URL + \u0026quot;ueditor/ueditor.all.min.js\u0026quot;) #è‡ªå·±çš„é™æ€ç›®å½•\rnodes.append(js)\r# æ–°å¢é¡µé¢\rxadmin.site.register_plugin(UeditorPlugin, UpdateAdminView)\r# ä¿®æ”¹é¡µé¢\rxadmin.site.register_plugin(UeditorPlugin, CreateAdminView)\r 6ã€å­—æ®µæ˜¾ç¤ºæ ·å¼ courses/adminx.pyæ–‡ä»¶ï¼š\nclass CourseAdmin(object):\r# å­—æ®µæ˜¾ç¤ºæ ·å¼\rstyle_fields = {\u0026quot;detail\u0026quot;: \u0026quot;ueditor\u0026quot;}\r 7ã€æ³¨å†Œè¿›å…¥plugins æ‰¾åˆ°pluginsæ–‡ä»¶å¤¹ä¸‹çš„__init__.pyæ–‡ä»¶ï¼Œåœ¨PLUGINSä¸­å†™å…¥\nPLUGINS= ('ueditor',)\t# ä¸æ–‡ä»¶åä¸€è‡´\r æœ‰å‘ï¼ï¼ï¼\nä¼šæŠ¥é”™ï¼\nåŸå› æ˜¯UEditor å¥½åƒæ˜¯æ²¡æœ‰Python3ç‰ˆæœ¬çš„ã€‚ ç›´æ¥è¿™æ ·å®‰è£…ï¼Œè¦è‡ªå·±ä¿®æ”¹é‡Œé¢çš„ä¸€äº›Python2çš„è¯­æ³•\nè§£å†³æ–¹æ³•ï¼šæ‰¾åˆ°DjangoUeditor3ä¸‹è½½å‘½ä»¤è¡Œå®‰è£…ï¼Œæˆ–è€…è§£å‹åå¤åˆ¶åˆ°é¡¹ç›®ä¸‹çš„extra_appsä¸‹\nï¼ˆå¯èƒ½è¿˜éœ€è¦å°†DjangoUeditorä¸‹staticä¸­çš„ueditoræ–‡ä»¶å¤¹æ‹·è´åˆ°æ ¹ç›®å½•ä¸‹çš„staticæ–‡ä»¶ä¸­ï¼‰\nExcelå¯¼å…¥æ’ä»¶ 1ã€æ ¹ç›®å½•ä¸‹æ‰¾åˆ°\\extra_apps\\xadmin\\plugins\\è·¯å¾„ï¼Œåˆ›å»ºexcel.pyæ–‡ä»¶\n# _*_ coding:utf-8 _*_\rimport xadmin\rfrom xadmin.views import BaseAdminPlugin, ListAdminView\rfrom django.template import loader\rfrom xadmin.plugins.utils import get_context_dict\r# excel å¯¼å…¥\rclass ListImportExcelPlugin(BaseAdminPlugin):\rimport_excel = False\rdef init_request(self, *args, **kwargs):\rreturn bool(self.import_excel)\rdef block_top_toolbar(self, context, nodes):\r# context = {\u0026quot;context\u0026quot;: context}\rnodes.append(loader.render_to_string('xadmin/excel/model_list.top_toolbar.import.html',\rcontext=get_context_dict(context)))\rxadmin.site.register_plugin(ListImportExcelPlugin, ListAdminView)\r æ³¨æ„ï¼šè¿™é‡Œæœ‰ä¸ªå‘ï¼æŒ‰ç…§è§†é¢‘æˆ–è€…ç½‘ç«™ä¸Šçš„è¯´æ³•å†™çš„excel.pyæ–‡ä»¶ä¼šæŠ¥é”™\nåŸå› æ˜¯ï¼šcontext_instanceå­—æ®µåœ¨Django1.8ä»¥åäº§ç”Ÿï¼Œè€Œåœ¨Django1.10ä¹‹åå°±ç§»é™¤äº†ï¼ŒæŒ‰ç…§ç½‘ä¸Šçš„ä¿®æ”¹æ–¹æ³•å°†æ”¹æˆcontextï¼Œå³ï¼š\nnodes.append(loader.render_to_string('xadmin/excel/model_list.top_toolbar.import.html', context))\r ä»ä¼šæŠ¥é”™ï¼\nå†æ›´æ”¹ä¸º\ncontext = {\u0026quot;context\u0026quot;: context}\rnodes.append(loader.render_to_string('xadmin/excel/model_list.top_toolbar.import.html', context))\r å¯ä»¥å®Œæˆæ“ä½œï¼Œä½†æ˜¯ä¼šæŠ¥è­¦å‘Šï¼\n2ã€é…ç½®.htmlæ–‡ä»¶ï¼Œå³é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰¾åˆ°\\extra_apps\\xadmin\\templates\\xadminï¼Œåˆ›å»ºexcelæ–‡ä»¶å¤¹ï¼Œåœ¨excelæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºmodel_list.top_toolbar.import.htmlæ–‡ä»¶ï¼Œå¤åˆ¶ä»¥ä¸‹ä»£ç .\n{% load i18n %}\r\u0026lt;div class=\u0026quot;btn-group export\u0026quot;\u0026gt;\r\u0026lt;a class=\u0026quot;dropdown-toggle btn btn-default btn-sm\u0026quot; data-toggle=\u0026quot;dropdown\u0026quot; href=\u0026quot;#\u0026quot;\u0026gt;\r\u0026lt;i class=\u0026quot;icon-share\u0026quot;\u0026gt;\u0026lt;/i\u0026gt; å¯¼å…¥ \u0026lt;span class=\u0026quot;caret\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\r\u0026lt;/a\u0026gt;\r\u0026lt;ul class=\u0026quot;dropdown-menu\u0026quot; role=\u0026quot;menu\u0026quot; aria-labelledby=\u0026quot;dLabel\u0026quot;\u0026gt;\r\u0026lt;li\u0026gt;\u0026lt;a data-toggle=\u0026quot;modal\u0026quot; data-target=\u0026quot;#export-modal-import-excel\u0026quot;\u0026gt;\u0026lt;i class=\u0026quot;icon-circle-arrow-down\u0026quot;\u0026gt;\u0026lt;/i\u0026gt; å¯¼å…¥ Excel\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\r\u0026lt;/ul\u0026gt;\r\u0026lt;script\u0026gt;\rfunction fileChange(target){\r//æ£€æµ‹ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹\rvar imgName = document.all.submit_upload.value;\rvar ext,idx;\rif (imgName == ''){\rdocument.all.submit_upload_b.disabled=true;\ralert(\u0026quot;è¯·é€‰æ‹©éœ€è¦ä¸Šä¼ çš„ xls æ–‡ä»¶!\u0026quot;);\rreturn;\r} else {\ridx = imgName.lastIndexOf(\u0026quot;.\u0026quot;);\rif (idx != -1){\rext = imgName.substr(idx+1).toUpperCase();\rext = ext.toLowerCase( );\r{# alert(\u0026quot;ext=\u0026quot;+ext);#}\rif (ext != 'xls' \u0026amp;\u0026amp; ext != 'xlsx'){\rdocument.all.submit_upload_b.disabled=true;\ralert(\u0026quot;åªèƒ½ä¸Šä¼  .xls ç±»å‹çš„æ–‡ä»¶!\u0026quot;);\rreturn;\r}\r} else {\rdocument.all.submit_upload_b.disabled=true;\ralert(\u0026quot;åªèƒ½ä¸Šä¼  .xls ç±»å‹çš„æ–‡ä»¶!\u0026quot;);\rreturn;\r}\r}\r}\r\u0026lt;/script\u0026gt;\r\u0026lt;div id=\u0026quot;export-modal-import-excel\u0026quot; class=\u0026quot;modal fade\u0026quot;\u0026gt;\r\u0026lt;div class=\u0026quot;modal-dialog\u0026quot;\u0026gt;\r\u0026lt;div class=\u0026quot;modal-content\u0026quot;\u0026gt;\r\u0026lt;form method=\u0026quot;post\u0026quot; action=\u0026quot;\u0026quot; enctype=\u0026quot;multipart/form-data\u0026quot;\u0026gt;\r{% csrf_token %}\r\u0026lt;div class=\u0026quot;modal-header\u0026quot;\u0026gt;\r\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;close\u0026quot; data-dismiss=\u0026quot;modal\u0026quot; aria-hidden=\u0026quot;true\u0026quot;\u0026gt;Ã—\u0026lt;/button\u0026gt;\r\u0026lt;h4 class=\u0026quot;modal-title\u0026quot;\u0026gt;å¯¼å…¥ Excel\u0026lt;/h4\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;div class=\u0026quot;modal-body\u0026quot;\u0026gt;\r\u0026lt;input type=\u0026quot;file\u0026quot; Î¿nchange=\u0026quot;fileChange(this)\u0026quot; name=\u0026quot;excel\u0026quot; id=\u0026quot;submit_upload\u0026quot;\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;div class=\u0026quot;modal-footer\u0026quot;\u0026gt;\r\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;btn btn-default\u0026quot; data-dismiss=\u0026quot;modal\u0026quot;\u0026gt;{% trans \u0026quot;Close\u0026quot; %}\u0026lt;/button\u0026gt;\r\u0026lt;button class=\u0026quot;btn btn-success\u0026quot; type=\u0026quot;submit\u0026quot; id=\u0026quot;submit_upload_b\u0026quot;\u0026gt;\u0026lt;i class=\u0026quot;icon-share\u0026quot;\u0026gt;\u0026lt;/i\u0026gt; å¯¼å…¥\u0026lt;/button\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;/form\u0026gt;\r\u0026lt;/div\u0026gt;\u0026lt;!-- /.modal-content --\u0026gt;\r\u0026lt;/div\u0026gt;\u0026lt;!-- /.modal-dalog --\u0026gt;\r\u0026lt;/div\u0026gt;\u0026lt;!-- /.modal --\u0026gt;\r\u0026lt;/div\u0026gt;\r 3ã€åœ¨æƒ³å¯¼å…¥çš„XxxAdminä¸‹æ·»åŠ impotr_excel = Trueï¼Œå¹¶ä¸”é‡å†™postæ–¹æ³•\ndef post(self, request, *args, **kwargs):\r# å¯¼å…¥é€»è¾‘\rif 'excel' in request.FILES:\rpass\rreturn super(CourseAdmin, self).post(request, args, kwargs)\r 4ã€æœ€ååœ¨xadmin/pluginsæ–‡ä»¶å¤¹ä¸‹æ‰¾åˆ°__init__.pyæ–‡ä»¶å¤¹ï¼Œæ·»åŠ \nPLUGINS = (\r'excel',\r)\r ","date":1612051200,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1612051200,"objectID":"781a6e1446b01330eb20050255d08d58","permalink":"https://CoMath21.github.io/post/1-%E6%85%95%E8%AF%BE%E7%BD%91mxonline/","publishdate":"2021-01-31T00:00:00Z","relpermalink":"/post/1-%E6%85%95%E8%AF%BE%E7%BD%91mxonline/","section":"post","summary":"æ…•è¯¾ç½‘ MxOnline æ•´ç†ç¬”è®°.","tags":["ç¼–ç¨‹è¯­è¨€","Django","Python"],"title":"Djangoå­¦ä¹ ç¬”è®°","type":"post"},{"authors":["Xinæ€å¥½å…ˆç”Ÿ","CoMath"],"categories":["å­¦ä¹ ç¬”è®°","ç¼–ç¨‹è¯­è¨€"],"content":"å‡†å¤‡å·¥ä½œ ã€€é¦–å…ˆéœ€è¦æ‰¾åˆ°å¼€å‘è½¯ä»¶ï¼šEclipse-J2EEç‰ˆæœ¬ï¼Œå¹¶ä¸”å®‰è£…ç›¸åº”æ’ä»¶ï¼ˆæœ€å¥½å®‰è£…ï¼Œä¾¿äºåˆæœŸç®€å•ç¼–ç¨‹ï¼‰.\næ³¨ï¼šäº‘ç›˜ä¸­ä¸€ä¸ªå‹ç¼©åŒ…ä¸­æœ‰å®Œæ•´è½¯ä»¶.\nå®‰è£…æ’ä»¶æ­¥éª¤ï¼š æ‰“å¼€Eclipse-J2EEç‰ˆæœ¬ï¼Œæ‰¾åˆ°Helpâ†’Install New SoftWare â†’ Work withå³é¢çš„Add ï¼Œåœ¨Archiveâ€¦ä¸­æ‰¾åˆ°å¯¹åº”è½¯ä»¶çš„è·¯å¾„ï¼Œç‚¹é›†OKå³å¯. éœ€è¦çš„è½¯ä»¶ï¼š\n hibernateçš„æ’ä»¶ï¼šhibernatetools-Update-4.1.1.Final_2013-12-08_01-06-33-B605.zip Springçš„æ’ä»¶ï¼šspringsource-tool-suite-3.4.0.RELEASE-e4.3.1-updatesite.zip  å¦‚æœæ²¡æœ‰æœåŠ¡å™¨ï¼Œéœ€è¦å®‰è£…TomcatæœåŠ¡å™¨.\nSpringâ†’Hibernateâ†’Strutsçš„é¡ºåºæ•´åˆæ¡†æ¶ 1. åŠ å…¥Spring 1)\tåŠ å…¥ Spring æ‰€éœ€è¦çš„ Jar åŒ…æ–‡ä»¶ ã€€æ‰¾åˆ° Spring çš„ jar åŒ…æ–‡ä»¶å¤¹ï¼Œ\\JaråŒ…æ–‡ä»¶\\Spring4.0.0\\spring-framework-4.0.0.RELEASE\\requiredï¼Œå¤§çº¦15ä¸ªå·¦å³ï¼›\n com.springsource.net.sf.cglib-2.2.0.jar com.springsource.org.aopalliance-1.0.0.jar com.springsource.org.aspectj.weaver-1.6.8.RELEASE.jar commons-logging-1.2.jar spring-aop-4.0.0.RELEASE.jar spring-aspects-4.0.0.RELEASE.jar spring-beans-4.0.0.RELEASE.jar spring-context-4.0.0.RELEASE.jar spring-core-4.0.0.RELEASE.jar spring-expression-4.0.0.RELEASE.jar spring-jdbc-4.0.0.RELEASE.jar spring-orm-4.0.0.RELEASE.jar spring-tx-4.0.0.RELEASE.jar spring-web-4.0.0.RELEASE.jar spring-webmvc-4.0.0.RELEASE.jar  2)\té…ç½® web.xml æ–‡ä»¶ ã€€é…ç½®web.xmlæ–‡ä»¶å¯ä»¥æ‰¾åˆ°ContextLoaderListenerä¼šè‡ªåŠ¨ç”Ÿæˆä»¥ä¸‹ä»£ç ï¼Œéšåå°†Locationæ”¹ä¸ºapplicationContextï¼ˆSpringé…ç½®æ–‡ä»¶ï¼‰çš„è·¯å¾„.\n\u0026lt;!-- é…ç½® Spring é…ç½®æ–‡ä»¶çš„åç§°å’Œä½ç½® --\u0026gt; \u0026lt;context-param\u0026gt; \u0026lt;param-name\u0026gt;contextConfigLocation\u0026lt;/param-name\u0026gt; \u0026lt;param-value\u0026gt;classpath:applicationContext.xml\u0026lt;/param-value\u0026gt; \u0026lt;/context-param\u0026gt; \u0026lt;!-- å¯åŠ¨ IOC å®¹å™¨çš„ ServletContextListener --\u0026gt; \u0026lt;listener\u0026gt; \u0026lt;listener-class\u0026gt; org.springframework.web.context.ContextLoaderListener \u0026lt;/listener-class\u0026gt; \u0026lt;/listener\u0026gt;  3)\tåŠ å…¥ Spring çš„é…ç½®æ–‡ä»¶ ã€€å¯ä»¥å…ˆåˆ›å»ºä¸€ä¸ªèµ„æºæ–‡ä»¶confï¼Œå°†èµ„æºæ–‡ä»¶æ”¾å…¥å…¶ä¸­ï¼ˆä¹Ÿå¯ä»¥ç›´æ¥åœ¨srcä¸‹åˆ›å»ºï¼‰ï¼Œåœ¨èµ„æºæ–‡ä»¶ä¸‹åˆ›å»ºä¸€ä¸ªSpringçš„é…ç½®æ–‡ä»¶ç‚¹å‡»å³é”®æ‰¾åˆ°Spring Bean Configuration Fileï¼Œè¾“å…¥é…ç½®æ–‡ä»¶çš„åå­—ï¼Œï¼ˆæ³¨æ„è¿™é‡Œé¢çš„åå­—è¦ä¸web.xmlä¸‹çš„çš„é…ç½®æ–‡ä»¶çš„åå­—ç›¸åŒï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼‰ï¼›ç„¶åé€‰ä¸­aopã€beansã€contextã€txç­‰é€‰é¡¹ï¼Œï¼ˆæ³¨æ„è¿™é‡Œé¢æ‰€é€‰å–çš„æ˜¯æœ€åŸºæœ¬çš„ï¼Œæ ¹æ®éœ€è¦å¯ä»¥è‡ªè¡Œæ·»åŠ å…¶ä»–é€‰é¡¹ï¼‰ï¼›æœ€åFinishå³å¯. 2.\tåŠ å…¥Hibernate 1). å»ºç«‹æŒä¹…åŒ–ç±», å’Œå…¶å¯¹åº”çš„ .hbm.xml æ–‡ä»¶, ç”Ÿæˆå¯¹åº”çš„æ•°æ®è¡¨ i. é…ç½®hibernate.cfg.xmlæ–‡ä»¶ï¼š\nã€€é¼ æ ‡å³é”®æ‰¾åˆ°Hibernate Configuration File(cfg.xml)åˆ›å»ºhibernate.cfg.xmlé…ç½®æ–‡ä»¶å¹¶é…ç½®åŸºæœ¬ä¿¡æ¯ï¼ˆå¯æ ¹æ®éœ€æ±‚è‡ªè¡Œæ·»åŠ ï¼‰.\n\u0026lt;hibernate-configuration\u0026gt; \u0026lt;session-factory\u0026gt; \u0026lt;!-- é…ç½®åŸºæœ¬å±æ€§ --\u0026gt; \u0026lt;!-- æ–¹è¨€ --\u0026gt; \u0026lt;property name=\u0026quot;hibernate.dialect\u0026quot;\u0026gt;org.hibernate.dialect.SQLServer2008Dialect \u0026lt;/property\u0026gt; \u0026lt;property name=\u0026quot;hibernate.dialect\u0026quot;\u0026gt; org.hibernate.dialect.MySQL5InnoDBDialect\u0026lt;/property\u0026gt; \u0026lt;!-- æ˜¯å¦æ˜¾ç¤ºåŠæ ¼å¼åŒ–SQL --\u0026gt; \u0026lt;property name=\u0026quot;hibernate.show_sql\u0026quot;\u0026gt;true\u0026lt;/property\u0026gt; \u0026lt;property name=\u0026quot;hibernate.format_sql\u0026quot;\u0026gt;true\u0026lt;/property\u0026gt; \u0026lt;property name=\u0026quot;hibernate.temp.use_jdbc_metadata_defaults\u0026quot;\u0026gt;false\u0026lt;/property\u0026gt; \u0026lt;!-- ç”Ÿæˆæ•°æ®è¡¨çš„ç­–ç•¥ --\u0026gt; \u0026lt;property name=\u0026quot;hibernate.hbm2ddl.auto\u0026quot;\u0026gt;update\u0026lt;/property\u0026gt; \u0026lt;!-- ç”ŸæˆäºŒçº§ç¼“å­˜ --\u0026gt; \u0026lt;/session-factory\u0026gt; \u0026lt;/hibernate-configuration\u0026gt;  ii. å»ºç«‹æŒä¹…åŒ–ç±»:\nã€€ä¹Ÿå°±æ˜¯å¹³æ—¶æ‰€è¯´çš„å¯¹è±¡ç±»ã€beansï¼ˆä¸€èˆ¬åˆ›å»ºåœ¨domainåŒ…ä¸‹æˆ–è€…entitiesä¸‹ï¼‰ï¼Œå¹¶ç”Ÿæˆå¯¹åº”å‚æ•°çš„getter and setterï¼›ä¹‹åé¼ æ ‡å³é”®åˆ›å»ºHibernate XML Mapping file (hbm.xml)æ–‡ä»¶ï¼Œç›´æ¥åˆ›å»ºå³å¯. å°±ä¼šç”Ÿæˆå¯¹åº”çš„*. hbm.xmlæ–‡ä»¶ï¼ˆæ ¹æ®ä¸åŒçš„éœ€æ±‚å¯èƒ½å¤Ÿå¯¹*. hbm.xmlæ–‡ä»¶è¿›è¡Œé€‚å½“çš„ä¿®æ”¹ï¼‰\n2). Spring æ•´åˆ Hibernate æ­¥éª¤\nâ‘  åŠ å…¥ jar åŒ…: æ‰¾åˆ° Hibernate çš„ jar åŒ…æ–‡ä»¶å¤¹ï¼Œ\\JaråŒ…æ–‡ä»¶\\JaråŒ…æ–‡ä»¶\\Hibernate4.2.21\\hibernate-release-4.2.21.Final\\lib\\requiredè·¯å¾„ä¸‹çš„æ‰€æœ‰ jar åŒ….\n antlr-2.7.7.jar dom4j-1.6.1.jar hibernate-commons-annotations-4.0.2.Final.jar hibernate-core-4.2.21.Final.jar hibernate-jpa-2.0-api-1.0.1.Final.jar javassist-3.18.1-GA.jar jboss-logging-3.1.0.GA.jar jboss-transaction-api_1.1_spec-1.0.1.Final.jar  â‘¡ åœ¨ç±»è·¯å¾„ä¸‹åŠ å…¥ hibernate.cfg.xml æ–‡ä»¶ï¼Œå¹¶åœ¨å…¶ä¸­é…ç½® hibernate çš„åŸºæœ¬å±æ€§\nâ‘¢ å»ºç«‹æŒä¹…åŒ–ç±»å’Œå…¶å¯¹åº”çš„ .hbm.xml æ–‡ä»¶ï¼ˆè¿‡ï¼‰\nâ‘£ å’Œ Spring è¿›è¡Œæ•´åˆï¼ˆè¿‡ï¼‰\n åŠ å…¥c3p0å’ŒSQLServerçš„é©±åŠ¨ï¼ˆéœ€è¦å¼•å…¥ç›¸å…³jaråŒ…æ–‡ä»¶ï¼šc3p0-0.9.2.1.jarã€sqljdbc4.jarï¼ˆSQL2005ï¼‰ï¼‰  ï¼ˆc3p0:æ˜¯ä¸€ä¸ª æ•°æ®åº“è¿æ¥æ±  ï¼Œåˆ©ç”¨ sqljdbc4 å»ºç«‹ä¸æ•°æ®åº“çš„è¿æ¥ ï¼Œ å¹¶ä¸”ç®¡ç†è¿™äº›è¿æ¥ï¼Œä¸ç”¨æ¯æ¬¡è®¿é—®æ•°æ®åº“éƒ½ é‡æ–°å‘å‡ºæ•°æ®åº“è¿æ¥è¯·æ±‚ï¼›å¤§å¤§æå‡æ€§èƒ½ï¼‰\nå…·ä½“å®ç°ï¼š é¦–å…ˆè¦åˆ›å»º*.propertiesæ–‡ä»¶ï¼Œå¹¶å¯¹å…¶è¿›è¡Œé…ç½®ï¼Œä¸»è¦ä¸ºæ•°æ®åº“çš„ç›¸å…³å‚æ•°è®¾ç½®.\n\u0026lt;!-- èµ„æºæ–‡ä»¶æ ·å¼ --\u0026gt; jdbc.user=sa jdbc.password=sa123 jdbc.driverClass=com.microsoft.sqlserver.jdbc.SQLServerDriver jdbc.jdbcUrl=jdbc:sqlserver://localhost:1433; DatabaseName=PwdManagerTest jdbc.initialPoolSize=5 jdbc.maxPoolSize=10  ç„¶ååœ¨applicationContext.xmlä¸­æ·»åŠ \n\u0026lt;!-- å¯¼å…¥èµ„æºæ–‡ä»¶ --\u0026gt; \u0026lt;context:property-placeholder location=\u0026quot;classpath:db.properties\u0026quot; /\u0026gt; \u0026lt;!-- é…ç½® C3P0 æ•°æ®æº --\u0026gt; \u0026lt;bean id=\u0026quot;dataSource\u0026quot; class=\u0026quot;com.mchange.v2.c3p0.ComboPooledDataSource\u0026quot;\u0026gt; \u0026lt;property name=\u0026quot;user\u0026quot; value=\u0026quot;${jdbc.user}\u0026quot;\u0026gt;\u0026lt;/property\u0026gt; \u0026lt;property name=\u0026quot;password\u0026quot; value=\u0026quot;${jdbc.password}\u0026quot;\u0026gt;\u0026lt;/property\u0026gt; \u0026lt;property name=\u0026quot;driverClass\u0026quot; value=\u0026quot;${jdbc.driverClass}\u0026quot;\u0026gt;\u0026lt;/property\u0026gt; \u0026lt;property name=\u0026quot;jdbcUrl\u0026quot; value=\u0026quot;${jdbc.jdbcUrl}\u0026quot;\u0026gt;\u0026lt;/property\u0026gt; \u0026lt;property name=\u0026quot;initialPoolSize\u0026quot; value=\u0026quot;${jdbc.initialPoolSize}\u0026quot;\u0026gt;\u0026lt;/property\u0026gt; \u0026lt;property name=\u0026quot;maxPoolSize\u0026quot; value=\u0026quot;${jdbc.maxPoolSize}\u0026quot;\u0026gt;\u0026lt;/property\u0026gt; \u0026lt;/bean\u0026gt;  è¿™é‡Œä¼šæŠ¥ä¸€ä¸ªé”™è¯¯ï¼šError creating bean with name \u0026lsquo;dataSource\u0026rsquo; defined in class path resource [applicationContext.xml]:\u0026hellip;\né”™è¯¯åŸå› ï¼šç¼ºå°‘mchange-commons-java-0.2.3.4.jaråŒ….\nä½œç”¨ï¼šmchange-commons-java-0.2.3.4.jaråŒ…æ˜¯c3p0æ•°æ®åº“è¿æ¥æ± çš„è¾…åŠ©åŒ…ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªåŒ…ç³»ç»Ÿå¯åŠ¨æ—¶ä¼šæŠ¥classnotfoundexceptionï¼Œè¿™æ˜¯æ›´æ–°c3p0-0.9.2ç‰ˆæœ¬ååˆ†ç¦»å‡ºæ¥çš„åŒ…ï¼Œ0.9.1çš„æ—¶å€™è¿˜æ˜¯åªæ˜¯ä¸€ä¸ªåŒ….\nè§£å†³æ–¹æ³•ï¼šå¯¼å…¥mchange-commons-java-0.2.3.4.jaråŒ…å³å¯.\nè·¯å¾„ï¼šJaråŒ…æ–‡ä»¶\\C3P0\\C3P0-0.9-2.1JAR\\c3p0-0.9.2.1\\lib...\n åœ¨Spring çš„é…ç½®æ–‡ä»¶ä¸­é…ç½®:æ•°æ®æºdataSource,SessionFactory,å£°æ˜å¼äº‹åŠ¡ï¼ˆå…ˆäº†è§£äº‹åŠ¡ï¼ŒåŒ…æ‹¬äº‹åŠ¡éš”ç¦»çº§åˆ«ç­‰ï¼‰  \u0026lt;!-- é…ç½® SessionFactory --\u0026gt; \u0026lt;bean id=\u0026quot;sessionFactory\u0026quot;\tclass=\u0026quot;org.springframework.orm.hibernate4.LocalSessionFactoryBean\u0026quot;\u0026gt; \u0026lt;property name=\u0026quot;dataSource\u0026quot; ref=\u0026quot;dataSource\u0026quot;\u0026gt;\u0026lt;/property\u0026gt; \u0026lt;property name=\u0026quot;configLocation\u0026quot; value=\u0026quot;classpath:hibernate.cfg.xml\u0026quot;/\u0026gt; \u0026lt;property name=\u0026quot;mappingLocations\u0026quot; value=\u0026quot;classpath:com/PwdManager/domain/*.hbm.xml\u0026quot; /\u0026gt; \u0026lt;/bean\u0026gt;  è¯´æ˜ï¼šæ‰§è¡Œåˆ°å½“å‰æ“ä½œå³å¯æ‰“å¼€æœåŠ¡å™¨ï¼Œè¿è¡Œå½“å‰é¡¹ç›®æ£€æµ‹ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸ä¼šæŠ¥é”™ï¼Œæ²¡æœ‰é”™è¯¯ä¿¡æ¯ï¼Œè€Œä¸”åœ¨æ•°æ®åº“ä¸­ä¼šç”Ÿæˆå¯¹åº”çš„è¡¨ç»“æ„. \n\u0026lt;!-- é…ç½® Spring çš„å£°æ˜å¼äº‹åŠ¡ --\u0026gt; \u0026lt;!-- 1. é…ç½® Hibernate çš„äº‹åŠ¡ç®¡ç†å™¨ --\u0026gt; \u0026lt;bean id=\u0026quot;transactionManager\u0026quot; class=\u0026quot;org.springframework.orm.hibernate4.HibernateTransactionManager\u0026quot;\u0026gt; \u0026lt;property name=\u0026quot;sessionFactory\u0026quot; ref=\u0026quot;sessionFactory\u0026quot;\u0026gt;\u0026lt;/property\u0026gt; \u0026lt;/bean\u0026gt; \u0026lt;!-- 2. é…ç½®äº‹åŠ¡å±æ€§ --\u0026gt; \u0026lt;tx:advice id=\u0026quot;txAdvice\u0026quot; transaction-manager=\u0026quot;transactionManager\u0026quot;\u0026gt; \u0026lt;tx:attributes\u0026gt; \u0026lt;tx:method name=\u0026quot;get*\u0026quot; read-only=\u0026quot;true\u0026quot;/\u0026gt; \u0026lt;tx:method name=\u0026quot;*\u0026quot;/\u0026gt; \u0026lt;/tx:attributes\u0026gt; \u0026lt;/tx:advice\u0026gt; \u0026lt;!-- 3. é…ç½®äº‹åŠ¡åˆ‡å…¥ç‚¹,å†æŠŠäº‹åŠ¡å±æ€§å’Œäº‹åŠ¡åˆ‡å…¥ç‚¹å…³è”èµ·æ¥ --\u0026gt; \u0026lt;aop:config\u0026gt; \u0026lt;!-- ä»»ä¸€ä¿®é¥°ç¬¦,ä»»æ„è¿”å›å€¼ ..ä¸‹çš„æ‰€æœ‰ç±»ä¸‹çš„æ‰€æœ‰æ–¹æ³•,å‚æ•°å€¼ä»»æ„--\u0026gt; \u0026lt;aop:pointcut expression=\u0026quot;execution(* com.PwdManager.service.*.*(..))\u0026quot; id=\u0026quot;txPointcut\u0026quot;/\u0026gt; \u0026lt;!-- æŠŠäº‹åŠ¡å±æ€§å’Œäº‹åŠ¡åˆ‡å…¥ç‚¹å…³è”èµ·æ¥ --\u0026gt; \u0026lt;aop:advisor advice-ref=\u0026quot;txAdvice\u0026quot; pointcut-ref=\u0026quot;txPointcut\u0026quot;/\u0026gt; \u0026lt;/aop:config\u0026gt;  3. åŠ å…¥ Stuts2 1) åŠ å…¥ jar åŒ… ã€€æ‰¾åˆ° Stuts2 çš„ jar åŒ…æ–‡ä»¶å¤¹ï¼Œ\\JaråŒ…æ–‡ä»¶ \\JaråŒ…æ–‡ä»¶\\Struts2.3.34\\struts-2.3.34\\apps\\struts2-blank\\WEB-INF\\libè·¯å¾„ä¸‹çš„æ‰€æœ‰ jar åŒ….\n xwork-core-2.3.34.jar struts2-spring-plugin-2.3.34.jar struts2-json-plugin-2.3.34.jar struts2-core-2.3.34.jar ognl-3.0.21.jar log4j-core-2.3.jar log4j-api-2.3.jar javassist-3.11.0.GA.jar freemarker-2.3.22.jar commons-lang3-3.2.jar commons-io-2.2.jar commons-fileupload-1.3.2.jar asm-tree-3.3.jar asm-commons-3.3.jar asm-3.3.jar  2) åœ¨web.xmlæ–‡ä»¶ä¸­é…ç½®Struts2çš„Filter \u0026lt;!-- é…ç½® Struts2 çš„ Filter --\u0026gt; \u0026lt;filter\u0026gt; \u0026lt;filter-name\u0026gt;struts2\u0026lt;/filter-name\u0026gt; \u0026lt;filter-class\u0026gt; org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter \u0026lt;/filter-class\u0026gt; \u0026lt;/filter\u0026gt; \u0026lt;filter-mapping\u0026gt; \u0026lt;filter-name\u0026gt;struts2\u0026lt;/filter-name\u0026gt; \u0026lt;url-pattern\u0026gt;/*\u0026lt;/url-pattern\u0026gt; \u0026lt;/filter-mapping\u0026gt;  3) åŠ å…¥ Struts2 çš„é…ç½®æ–‡ä»¶ ã€€å¯ä»¥æ‹·è´ä¾‹å­ä¸‹çš„struts.xmlæ–‡ä»¶ï¼Œä¾‹å­å¯ä»¥åœ¨JaråŒ…æ–‡ä»¶\\Struts2.3.34\\struts-2.3.34\\apps\\struts2-blank\\WEB-INF\\src\\java\\struts.xmlæ–‡ä»¶å‚è€ƒ.\n\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot; ?\u0026gt; \u0026lt;!DOCTYPE struts PUBLIC \u0026quot;-//Apache Software Foundation//DTD Struts Configuration 2.3//EN\u0026quot; \u0026quot;http://struts.apache.org/dtds/struts-2.3.dtd\u0026quot;\u0026gt; \u0026lt;struts\u0026gt; \u0026lt;constant name=\u0026quot;struts.enable.DynamicMethodInvocation\u0026quot; value=\u0026quot;false\u0026quot; /\u0026gt; \u0026lt;constant name=\u0026quot;struts.devMode\u0026quot; value=\u0026quot;true\u0026quot; /\u0026gt; \u0026lt;package name=\u0026quot;default\u0026quot; namespace=\u0026quot;/\u0026quot; extends=\u0026quot;struts-default\u0026quot;\u0026gt; \u0026lt;action name=\u0026quot;index\u0026quot;\u0026gt; \u0026lt;result type=\u0026quot;redirectAction\u0026quot;\u0026gt; \u0026lt;param name=\u0026quot;actionName\u0026quot;\u0026gt;HelloWorld\u0026lt;/param\u0026gt; \u0026lt;/result\u0026gt; \u0026lt;/action\u0026gt; \u0026lt;/package\u0026gt; \u0026lt;!-- Add packages here --\u0026gt; \u0026lt;/struts\u0026gt;  4) æ•´åˆ Spring â‘  åŠ å…¥ Struts2 çš„ Spring æ’ä»¶çš„ jar åŒ… struts2-spring-plugin-2.3.34.jar.\nâ‘¡ åœ¨ Spring çš„é…ç½®æ–‡ä»¶ä¸­æ­£å¸¸é…ç½® Action ,æ³¨æ„ Action ä¸­éœ€è¦é…ç½® scope å±æ€§ä¸º prototype ä¸æ˜¯å•ä¾‹çš„.\n\u0026lt;bean id=\u0026quot;XxxAction\u0026quot;\u0026gt; class=\u0026quot;\u0026quot; scope=\u0026quot;prototype\u0026quot;\u0026gt; \u0026lt;property name=\u0026quot;\u0026quot; ref=\u0026quot;\u0026quot; \u0026gt;\u0026lt;/property\u0026gt; \u0026lt;/bean\u0026gt; \u0026lt;!-- å®ä¾‹ --\u0026gt; \u0026lt;bean id=\u0026quot;userloginDao\u0026quot; class=\u0026quot;com.dao.userLoginDao\u0026quot;\u0026gt; \u0026lt;property name=\u0026quot;sessionFactory\u0026quot; ref=\u0026quot;sessionFactory\u0026quot;\u0026gt;\u0026lt;/property\u0026gt; \u0026lt;/bean\u0026gt; \u0026lt;bean id=\u0026quot;userloginService\u0026quot; class=\u0026quot;com.service.userLoginService\u0026quot;\u0026gt; \u0026lt;property name=\u0026quot;userLoginDao\u0026quot; ref=\u0026quot;userloginDao\u0026quot;/\u0026gt; \u0026lt;/bean\u0026gt; \u0026lt;bean id=\u0026quot;userloginAction\u0026quot; class=\u0026quot;com.action.userLoginAction\u0026quot; scope=\u0026quot;prototype\u0026quot;\u0026gt; \u0026lt;property name=\u0026quot;userLoginService\u0026quot; ref=\u0026quot;userloginService\u0026quot;/\u0026gt;\t\u0026lt;/bean\u0026gt;  è¿™é‡Œé¢éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¦‚æœæ˜¯åœ¨æ­å»ºåˆæœŸåªæ˜¯ä¸ºäº†æµ‹è¯•æ˜¯å¦æˆåŠŸï¼Œåœ¨åˆ›å»ºå¯¹åº”çš„Packageå’ŒClassåï¼Œåœ¨å±æ€§å€¼ä¸ºsessionFactoryçš„Classä¸‹è¦åˆ›å»ºsessionFactoryçš„å®ä¾‹å¯¹è±¡å¹¶è®¾ç½®setteræ–¹æ³•ï¼Œå³\u0026lt;property name=\u0026quot;sessionFactory\u0026quot; ref=\u0026quot;sessionFactory\u0026quot;/\u0026gt;çš„\u0026lt;bean id=\u0026quot;userloginDao\u0026quot; class=\u0026quot;com.dao.userLoginDao\u0026quot;\u0026gt;éœ€è¦åœ¨ç±»userLoginDaoä¸‹å®ä¾‹ï¼šprivate SessionFactory sessionFactory;å¹¶è®¾ç½®setteræ–¹æ³•ï¼ˆå¯ä»¥å¸¦ä¸Šgetteræ–¹æ³•ï¼‰ï¼Œä»¥ä¸‹å…¶ä»–beanç›¸åŒ. ï¼ˆä¾èµ–æ³¨å…¥ç›¸å…³çŸ¥è¯†ï¼‰\nâ‘¢ åœ¨Struts2çš„é…ç½®æ–‡ä»¶ä¸­é…ç½®Actionæ—¶,class å±æ€§æŒ‡å‘è¯¥ Action åœ¨Spring IOCä¸­çš„id.\né¦–å…ˆè¦å®šä¹‰æ‹¦æˆªå™¨ I. åœ¨JSPé¡µé¢å¦‚æœæ²¡æœ‰é‡‡ç”¨Ajaxå¯ä»¥ç›´æ¥ä½¿ç”¨ä»¥ä¸‹action\n\u0026lt;action name=\u0026quot;XxxName\u0026quot; class=\u0026quot;XxxAction\u0026quot;\u0026gt; \u0026lt;result\u0026gt;/success.jsp\u0026lt;/result\u0026gt; \u0026lt;/action\u0026gt;  JSP\té¡µé¢formè¡¨å•æäº¤ç›´æ¥äº¤ç»™XxxNameï¼Œå³ï¼š\u0026lt;form action=\u0026quot;XxxName\u0026quot;\u0026gt; è¿™ç§æƒ…å†µéœ€è¦æ¥å—çš„actionä¸­æä¾›formè¡¨å•ä¸­inputçš„nameæ‰€å¯¹åº”çš„getterå’Œsetter ç„¶åå¯ä»¥ç›´æ¥è·å–åˆ°formè¡¨å•ä¸­çš„å€¼. II. å¦‚æœJSPé¡µé¢ä½¿ç”¨äº†Ajaxåˆ™éœ€è¦ä½¿ç”¨ä»¥ä¸‹action\n\u0026lt;action name=\u0026quot;userJson-*\u0026quot; class=\u0026quot;com.action.userJsonAction\u0026quot; method=\u0026quot;{1}\u0026quot;\u0026gt; \u0026lt;result name=\u0026quot;success\u0026quot; type=\u0026quot;json\u0026quot;\u0026gt; \u0026lt;param name=\u0026quot;root\u0026quot;\u0026gt;result\u0026lt;/param\u0026gt; \u0026lt;/result\u0026gt; \u0026lt;/action\u0026gt;  resultä¸ºè¿”å›ajaxçš„dataæ•°æ®\nè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯åœ¨ä½¿ç”¨Ajaxæ­é…Jsonå®ç°æ•°æ®çš„äº¤äº’æ—¶ï¼Œéœ€è¦å®šä¹‰æ‹¦æˆªå™¨çš„æ—¶å€™ç»§æ‰¿json-defaultæ‹¦æˆªå™¨ï¼ŒåŒæ—¶ç»§æ‰¿ä¸¤è€…ä¹Ÿå¯ä»¥. è¿™é‡Œè¦æ˜¯é‡‡ç”¨AJAXçš„æ–¹å¼ï¼Œå¯èƒ½éœ€è¦å¼•å…¥JSONçš„ç›¸å…³JaråŒ…ï¼š ä½†æ˜¯è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯å­˜åœ¨ä¸¤ç§ä¸åŒçš„JSONçš„JaråŒ…ï¼Œä¸»è¦åŒºåˆ«åœ¨äºå®ç°æ„é€ æ–¹æ³•çš„å˜é‡ä¸åŒ.\nä¾‹å¦‚ï¼š âˆš\nJSONObject json = new JSONObject(map);å¸¦å‚æ„é€ éœ€è¦å¼•å…¥org.json.JSONObject; JSONObject json = new JSONObject(); æ— å‚æ„é€ å¼•å…¥çš„æ˜¯net.sf.json.JSONObject org.json.JSONObjectç±»åœ¨json.jaråŒ…ä¸‹â€”â€” \\JaråŒ…æ–‡ä»¶\\JSON\\org.json net.sf.json.JSONObjectå…¶ä»–åŒ…ä¸­â€”â€” \\JaråŒ…æ–‡ä»¶\\JSON\\net.sf.json\n{\n commons-beanutils-1.7.0.jar commons-collections-3.2.1.jar commons-httpclient-3.1.jar commons-lang-2.3.jar commons-logging-1.1.1.jar ezmorph-1.0.3.jar json-lib-2.2.3-jdk15.jar  }\nè·å–ajaxä¼ è¿‡æ¥çš„å‚æ•°éœ€è¦ä½¿ç”¨ï¼š\n// ç”¨äºè·å–dataæ•°æ®ï¼Œå®šä¹‰request HttpServletRequest request = null; request = ServletActionContext.getRequest(); String UserID = request.getParameter(\u0026quot;UserID\u0026quot;);  å®ä¾‹ï¼š\n\u0026lt;struts\u0026gt;\t\u0026lt;constant name=\u0026quot;struts.i18n.encoding\u0026quot; value=\u0026quot;UTF-8\u0026quot;\u0026gt;\u0026lt;/constant\u0026gt; \u0026lt;constant name=\u0026quot;struts.enable.DynamicMethodInvocation\u0026quot; value=\u0026quot;false\u0026quot; /\u0026gt; \u0026lt;constant name=\u0026quot;struts.devMode\u0026quot; value=\u0026quot;true\u0026quot; /\u0026gt; \u0026lt;package name=\u0026quot;default\u0026quot; namespace=\u0026quot;/\u0026quot; extends=\u0026quot;json-default,struts-default\u0026quot;\u0026gt; \u0026lt;!-- å®šä¹‰æ–°çš„æ‹¦æˆªå™¨æ ˆ, é…ç½®prepareæ‹¦æˆªå™¨æ ˆçš„alwaysInvokePrepareå‚æ•°å€¼ä¸ºfalse --\u0026gt; \u0026lt;interceptors\u0026gt; \u0026lt;interceptor-stack name=\u0026quot;sshStack\u0026quot;\u0026gt; \u0026lt;interceptor-ref name=\u0026quot;paramsPrepareParamsStack\u0026quot;\u0026gt; \u0026lt;param name=\u0026quot;prepare.alwaysInvokePrepare\u0026quot;\u0026gt;false\u0026lt;/param\u0026gt; \u0026lt;/interceptor-ref\u0026gt; \u0026lt;/interceptor-stack\u0026gt; \u0026lt;/interceptors\u0026gt; \u0026lt;!-- ä½¿ç”¨æ–°çš„æ‹¦æˆªå™¨æ ˆ --\u0026gt; \u0026lt;default-interceptor-ref name=\u0026quot;sshStack\u0026quot;\u0026gt;\u0026lt;/default-interceptor-ref\u0026gt; \u0026lt;action name=\u0026quot;userJson-*\u0026quot; class=\u0026quot;com.action.userJsonAction\u0026quot; method=\u0026quot;{1}\u0026quot;\u0026gt; \u0026lt;result name=\u0026quot;success\u0026quot; type=\u0026quot;json\u0026quot;\u0026gt; \u0026lt;param name=\u0026quot;root\u0026quot;\u0026gt;result\u0026lt;/param\u0026gt; \u0026lt;/result\u0026gt; \u0026lt;/action\u0026gt; \u0026lt;/package\u0026gt;\t\u0026lt;/struts\u0026gt;  $.ajax({ url : \u0026quot;blogJson-readArticle\u0026quot;, type : \u0026quot;POST\u0026quot;,\tdata : { userID : \u0026quot;132\u0026quot;, artID : $(\u0026quot;input:hidden[name='artID']\u0026quot;).val() }, timeout : 30000, dataType : \u0026quot;json\u0026quot;,// è®¾ç½®éœ€è¦è¿”å›çš„æ•°æ®ç±»å‹ scriptCharset : 'utf-8', success : function(data) { var obj = $.parseJSON(data); var data = obj.data; }, error : function(XMLHttpRequest, textStatus, errorThrown) { alert(errorThrown + 123); } });  4. å®ŒæˆåŠŸèƒ½ ã€€å…·ä½“æ–¹å¼å¯ä»¥æŒ‰ç…§è‡ªå·±çš„è¦æ±‚å®æ–½ï¼Œå¤§è‡´æ–¹æ³•ï¼š åœ¨daoå±‚å¯ä»¥ç›´æ¥ç®¡ç†æœ‰å…³æ•°æ®åº“çš„ä¸€åˆ‡æ–¹æ³•ï¼Œé€šè¿‡serviceå±‚è°ƒç”¨daoå±‚çš„æ–¹æ³•ï¼Œåœ¨actionå±‚å¯¹serviceæ–¹æ³•è¿›è¡Œè°ƒç”¨å³å¯ï¼›è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ç‚¹ï¼Œå°±æ˜¯å…³äºä¸€äº›å±æ€§çš„è®¾ç½®é—®é¢˜ï¼Œå…·ä½“è·Ÿä¸Šè¿°ä½¿ç”¨JSONæ—¶æ³¨æ„çš„äº‹é¡¹ä¸€æ ·.\n","date":1612051200,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1612051200,"objectID":"504fa6dda978566d8b6f66877141af40","permalink":"https://CoMath21.github.io/post/1-ssh%E6%A1%86%E6%9E%B6%E6%95%B4%E5%90%88/","publishdate":"2021-01-31T00:00:00Z","relpermalink":"/post/1-ssh%E6%A1%86%E6%9E%B6%E6%95%B4%E5%90%88/","section":"post","summary":"Spring+Struts+hibernateæ•´åˆç¯å¢ƒ(Struts2.1.6ã€hibernate3.3.2ã€spring2.5.6)","tags":["ç¼–ç¨‹è¯­è¨€","SSH","Java"],"title":"SSHæ¡†æ¶æ•´åˆåŸºæœ¬æ­¥éª¤","type":"post"},{"authors":["Xinæ€å¥½å…ˆç”Ÿ","CoMath"],"categories":["å­¦ä¹ ç¬”è®°","ç¼–ç¨‹è¯­è¨€"],"content":"ä¸€ã€xmlè¯­æ³•  æ–‡æ¡£å£°æ˜  ã€€ç”¨æ¥å£°æ˜xmlçš„åŸºæœ¬å±æ€§,ç”¨æ¥æŒ‡æŒ¥è§£æå¼•æ“å¦‚ä½•å»è§£æå½“å‰xml.é€šå¸¸ä¸€ä¸ªxmléƒ½è¦åŒ…å«å¹¶ä¸”åªèƒ½åŒ…å«ä¸€ä¸ªæ–‡æ¡£å£°æ˜.xmlçš„æ–‡æ¡£å¿…é¡»åœ¨æ•´ä¸ªxmlçš„æœ€å‰é¢,åœ¨æ–‡æ¡£å£°æ˜ä¹‹å‰ä¸èƒ½æœ‰ä»»ä½•å†…å®¹.\n\u0026lt;?xml version=\u0026quot;1.0\u0026quot; ?\u0026gt; \u0026lt;!-- versionæ˜¯å¿…é¡»å­˜åœ¨çš„å±æ€§,è¡¨æ˜å½“å‰xmlæ‰€éµå¾ªè§„èŒƒçš„ç‰ˆæœ¬,ç›®å‰ä½ç½®éƒ½å†™1.0å°±å¯ä»¥äº†. --\u0026gt; \u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;utf-8\u0026quot; ?\u0026gt; \u0026lt;!-- encodingç”¨æ¥åªä¼šè§£æå¼•æ“åœ¨è§£æxmlæ—¶ä½¿ç”¨çš„ç¼–ç ,ä¸€å®šè¦ä¿è¯xmlæ ¼å¼çš„æ•°æ®åœ¨ä¿å­˜æ—¶ä½¿ç”¨çš„ç¼–ç å’Œè§£ææ—¶ä½¿ç”¨çš„ç¼–ç å¿…é¡»ä¸€è‡´,æ‰ä¸ä¼šæœ‰ä¹±ç é—®é¢˜. --\u0026gt; \u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;utf-8\u0026quot; standalone=\u0026quot;yes\u0026quot; ?\u0026gt; \u0026lt;!-- standaloneå±æ€§ç”¨æ¥æŒ‡æ˜å½“å‰xmlæ˜¯å¦æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„xml,é»˜è®¤å€¼æ˜¯yesè¡¨æ˜å½“å‰æ–‡æ¡£ä¸éœ€è¦ä¾èµ–äºå…¶ä»–æ–‡æ¡£,å¦‚æœå½“å‰æ–‡æ¡£ä¾èµ–å…¶ä»–æ–‡æ¡£è€Œå­˜åœ¨åˆ™éœ€è¦å°†æ­¤å€¼è®¾ç½®ä¸ºno. --\u0026gt;  å…ƒç´    ä¸€ä¸ªxmlæ ‡ç­¾å°±æ˜¯ä¸€ä¸ªå…ƒç´ ; ä¸€ä¸ªæ ‡ç­¾åˆ†ä¸ºå¼€å§‹æ ‡ç­¾å’Œç»“æŸæ ‡ç­¾; åœ¨å¼€å§‹æ ‡ç­¾å’Œç»“æŸæ ‡ç­¾ä¹‹é—´å¯ä»¥åŒ…å«æ–‡æœ¬å†…å®¹,è¿™æ ·çš„æ–‡æœ¬å†…å®¹å«åšæ ‡ç­¾ä½“; å¦‚æœæ ‡ç­¾çš„å¼€å§‹æ ‡ç­¾å’Œç»“æŸæ ‡ç­¾ä¹‹é—´ä¸åŒ…å«æ ‡ç­¾å’Œå­æ ‡ç­¾åˆ™å¯ä»¥å°†å¼€å§‹æ ‡ç­¾å’Œç»“æŸæ ‡ç­¾è¿›è¡Œåˆå¹¶,è¿™æ ·çš„æ ‡ç­¾å°±å«åšè‡ªé—­æ ‡ç­¾; ä¸€ä¸ªæ ‡ç­¾ä¸­ä¹Ÿå¯ä»¥åŒ…å«ä»»æ„å¤šä¸ªå­æ ‡ç­¾,ä½†æ˜¯ä¸€å®šè¦æ³¨æ„æ ‡ç­¾ä¸€å®šè¦åˆç†åµŒå¥—; ä¸€ä¸ªæ ¼å¼è‰¯å¥½çš„xmlè¦åŒ…å«å¹¶ä¸”åªèƒ½åŒ…å«ä¸€ä¸ªæ ¹æ ‡ç­¾,å…¶ä»–çš„æ ‡ç­¾éƒ½åº”è¯¥æ˜¯è¿™ä¸ªæ ‡ç­¾çš„å­å­™æ ‡ç­¾;  æ³¨æ„\n åŒºåˆ†å¤§å°å†™ï¼Œä¾‹å¦‚ï¼Œ\u0026lt;P\u0026gt;å’Œ\u0026lt;p\u0026gt;æ˜¯ä¸¤ä¸ªä¸åŒçš„æ ‡è®°. ä¸èƒ½ä»¥æ•°å­—æˆ–æ ‡ç‚¹ç¬¦å·æˆ–\u0026quot;_\u0026ldquo;å¼€å¤´. ä¸èƒ½ä»¥xml(æˆ–XMLã€æˆ–Xml ç­‰)å¼€å¤´. ä¸èƒ½åŒ…å«ç©ºæ ¼. åç§°ä¸­é—´ä¸èƒ½åŒ…å«å†’å·ï¼ˆ:ï¼‰.   å±æ€§ ä¸€ä¸ªæ ‡ç­¾å¯ä»¥æœ‰å¤šä¸ªå±æ€§ï¼Œæ¯ä¸ªå±æ€§éƒ½æœ‰å®ƒè‡ªå·±çš„åç§°å’Œå–å€¼ï¼Œä¾‹å¦‚ï¼š\u0026lt;china capital=\u0026quot;beijing\u0026quot;/\u0026gt;. å±æ€§çš„ååœ¨å®šä¹‰æ—¶è¦éµå¾ªå’Œxmlå…ƒç´ ç›¸åŒçš„å‘½åè§„åˆ™;å±æ€§çš„å€¼éœ€è¦ç”¨å•å¼•å·æˆ–åŒå¼•å·æ‹¬èµ·æ¥.\n  æ³¨é‡Š\n  \u0026lt;!-- æ³¨é‡Šå†…å®¹ --\u0026gt;  æ³¨é‡Šå¯ä»¥å‡ºç°åœ¨xmlæ–‡æ¡£çš„ä»»æ„ä½ç½®é™¤äº†æ•´ä¸ªæ–‡æ¡£çš„æœ€å‰é¢.ä¸èƒ½å‡ºç°åœ¨æ–‡æ¡£å£°æ˜ä¹‹å‰;æ³¨é‡Šä¸èƒ½åµŒå¥—æ³¨é‡Š.\nCDATAåŒº/è½¬ä¹‰å­—ç¬¦  \u0026lt;![CDATA[è½¬ä¹‰çš„å†…å®¹]]\u0026gt;\n å½“XMLä¸­ä¸€æ®µå†…å®¹ä¸å¸Œæœ›è¢«è§£æå™¨è§£ææ—¶å¯ä»¥ä½¿ç”¨CDATAåŒºå°†å…¶åŒ…ä½; å½“è§£æå™¨é‡åˆ°CDATAåŒºæ—¶ä¼šå°†å…¶å†…å®¹å½“ä½œæ–‡æœ¬å¯¹å¾…ï¼Œä¸ä¼šè¿›è¡Œè§£æ; è¯­æ³•ï¼š\u0026lt;![CDATA[ å†…å®¹ ]]\u0026gt;.  è½¬ä¹‰å­—ç¬¦:\n \u0026amp; \u0026ndash;\u0026gt; \u0026amp;amp; \u0026lt; \u0026ndash;\u0026gt; \u0026amp;lt;   \u0026ndash;\u0026gt; \u0026amp;gt;\n  \u0026quot; \u0026ndash;\u0026gt; \u0026amp;quot; ' \u0026ndash;\u0026gt; \u0026amp;apos;  å¤„ç†æŒ‡ä»¤  ã€€å¤„ç†æŒ‡ä»¤ï¼Œç®€ç§°PI ï¼ˆprocessing instructionï¼‰. å¤„ç†æŒ‡ä»¤ç”¨æ¥æŒ‡æŒ¥è§£æå¼•æ“å¦‚ä½•è§£æXMLæ–‡æ¡£å†…å®¹.\n\u0026lt;?xml-stylesheet type=\u0026quot;text/css\u0026quot; href=\u0026quot;1.css\u0026quot;?\u0026gt;  äºŒã€dtdè¯­æ³• \u0026mdash; äº†è§£è¯­æ³•,çœ‹å¾—æ‡‚dtdå°±å¯ä»¥  å¦‚ä½•åœ¨xmlä¸­å¼•å…¥dtd  (1)å¤–éƒ¨å¼•å…¥\nã€€å¯ä»¥å°†dtdçš„çº¦æŸå†…å®¹å†™åœ¨å¤–ç½®çš„dtdæ–‡ä»¶ä¸­,è¿™ä¸ªæ–‡ä»¶åç¼€å¿…é¡»ä¸º.dtdè€Œæ–‡ä»¶ä¿å­˜æ—¶å¿…é¡»ç”¨utf-8ç¼–ç ä¿å­˜.ã€€å†åœ¨xmlæ–‡ä»¶ä¸­ä½¿ç”¨ \u0026lt;!DOCTYPE æ ¹å…ƒç´ åç§° SYSTEM æ–‡ä»¶çš„ä½ç½®\u0026gt;\nã€€å¦‚æœå†™çš„æ˜¯SYSTEMè¡¨æ˜å½“å‰å¼•å…¥çš„dtdåœ¨å½“å‰æ–‡ä»¶ç³»ç»Ÿä¸­,åé¢åˆ¶å®šçš„æ–‡ä»¶ä½ç½®æ˜¯å½“å‰ç¡¬ç›˜ä¸­çš„ä½ç½® \u0026lt;!DOCTYPE æ–‡æ¡£æ ¹ç»“ç‚¹ PUBLIC \u0026quot;DTDåç§°\u0026quot; \u0026quot;DTDæ–‡ä»¶çš„URL\u0026quot;\u0026gt;\nã€€å¦‚æœå†™çš„æ˜¯PUBLICè¡¨æ˜å½“å‰å¼•å…¥çš„dtdåœ¨ç½‘ç»œå…¬å…±ä½ç½®ä¸­,åé¢è¦æŒ‡æ˜dtdçš„åå­—å’Œdtdæ‰€åœ¨ç½‘ç»œä½ç½®URLåœ°å€.\n(2)å†…éƒ¨å¼•å…¥\nã€€ç›´æ¥åœ¨xmlä¸­ä¹¦å†™dtd\n \u0026lt;!DOCTYPE æ ¹å…ƒç´ åç§°[ dtdçº¦æŸ.... ]\u0026gt;  dtdè¯­æ³•  (1)å…ƒç´  \u0026lt;!ELEMENT å…ƒç´ åç§° å…ƒç´ çº¦æŸ\u0026gt;\n å…ƒç´ çº¦æŸ: å­˜æ”¾ç±»å‹:ANY/EMPTY. å…ƒç´ çº¦æŸ:å­å…ƒç´ çš„åˆ—è¡¨,å°†å¯ä»¥åŒ…å«çš„å­å…ƒç´ ç”¨å°æ‹¬å·æ‹¬èµ·æ¥  å­å…ƒç´ ä¹‹é—´å¯ä»¥ä½¿ç”¨é€—å·è¿›è¡Œåˆ†å‰²,è¡¨æ˜å­å…ƒç´ å¿…é¡»æŒ‰ç…§é¡ºåºå‡ºç° å­å…ƒç´ ä¹‹é—´å¯ä»¥ä½¿ç”¨ç«–çº¿è¿›è¡Œåˆ†å‰²,è¡¨é¢å­å…ƒç´ å‡ºç°å…¶ä¸­ä¹‹ä¸€.    #PCDATA è¡¨æ˜åŒ…å«æ ‡ç­¾ä½“\n+ : è¡¨ç¤ºä¸€æ¬¡æˆ–å¤šæ¬¡;\n* : 0æ¬¡æˆ–å¤šæ¬¡;\n? : 0æ¬¡æˆ–ä¸€æ¬¡.\nä¹Ÿå¯ä»¥ä½¿ç”¨å°æ‹¬å·è¿›è¡Œç»„çš„æ“ä½œ.\n(2)å±æ€§\n\u0026lt;!ATTLIST å…ƒç´ å å±æ€§å å±æ€§ç±»å‹ å±æ€§çº¦æŸ å±æ€§å2 å±æ€§ç±»å‹ å±æ€§çº¦æŸ ...... \u0026gt;    å±æ€§ç±»å‹:\n CDATA:è¡¨ç¤ºå±æ€§çš„å€¼æ˜¯ä¸€ä¸ªæ™®é€šå­—ç¬¦ä¸² ENUMERATED : å±æ€§çš„å€¼æ˜¯ä¸€ä¸ªæšä¸¾åˆ—è¡¨ä¸­çš„å€¼ ID: è¡¨æ˜å±æ€§çš„å€¼å¿…é¡»åœ¨æ•´ä¸ªæ–‡æ¡£ä¸­éƒ½æ˜¯å”¯ä¸€çš„,å¦‚æœæœ‰é‡å¤çš„idåˆ™æ ¡éªŒä¸é€šè¿‡,ID å±æ€§çš„å€¼åªèƒ½ç”±å­—æ¯ï¼Œä¸‹åˆ’çº¿å¼€å§‹ï¼Œä¸èƒ½ä½¿ç”¨æ•°å­—ï¼Œä¸èƒ½å‡ºç°ç©ºç™½å­—ç¬¦    å±æ€§çº¦æŸ:\n #REQUIRED \u0026mdash; è¡¨æ˜å½“å‰å±æ€§æ˜¯ä¸€ä¸ªå¿…é¡»å­˜åœ¨çš„å±æ€§,å¦‚æœè¿™æ ·çš„å±æ€§ä¸å­˜åœ¨åˆ™åœ¨æ ¡éªŒæ—¶ä¼šæŠ¥é”™ #IMPLIED \u0026mdash; è¡¨æ˜å½“å‰å±æ€§æ˜¯ä¸€ä¸ªå¯é€‰çš„å±æ€§,å¯ä»¥æœ‰ä¹Ÿå¯ä»¥æ²¡æœ‰ #FIXED \u0026lsquo;å›ºå®šå€¼\u0026rsquo; \u0026mdash; è¡¨æ˜å½“å‰å±æ€§å…·æœ‰ä¸€ä¸ªå›ºå®šå€¼,è¿™æ ·çš„å±æ€§ä¸éœ€è¦è¿›è¡Œèµ‹å€¼,è‡ªåŠ¨å°±ä¼šå–è¿™ä¸ªå›ºå®šå€¼ä¸ºå€¼.å¦‚æœè¿™æ ·çš„å±æ€§æŒ‡å®šäº†ä¸€ä¸ªä¸æ˜¯å›ºå®šå€¼çš„å€¼åˆ™æ ¡éªŒæŠ¥é”™ \u0026lsquo;é»˜è®¤å€¼\u0026rsquo; \u0026mdash; è¡¨æ˜å½“å‰å±æ€§å…·æœ‰ä¸€ä¸ªé»˜è®¤å€¼,å¦‚æœç»™äº†å…¶ä»–çš„å€¼å°±ç”¨å…¶ä»–å€¼,å¦‚æœæ²¡æœ‰ç»™å€¼åˆ™å–è¿™ä¸ªé»˜è®¤å€¼    (3)ENTITY(å®ä½“)\n\u0026lt;!ENTITY \u0026gt;,å°±æ˜¯å¯¹ä¸€å¤§æ®µå†…å®¹çš„å¼•ç”¨,å¯ä»¥ç®€åŒ–ä»£ç çš„å¤ç”¨.\nå¼•ç”¨å®ä½“:åœ¨xmlä¸­å¼•ç”¨çš„å®ä½“å«åšå¼•ç”¨å®ä½“\n\u0026lt;!ENTITY å®ä½“åç§° â€œå®ä½“å†…å®¹â€ \u0026gt; \u0026amp;å®ä½“åç§°;  å‚æ•°å®ä½“:åœ¨dtdä¸­å¼•ç”¨çš„å®ä½“å«åšå‚æ•°å®ä½“\n\u0026lt;!ENTITY % å®ä½“åç§° \u0026quot;å®ä½“å†…å®¹\u0026quot;\u0026gt; %å®ä½“åç§°;  ä¸‰ã€XMLç¼–ç¨‹:åˆ©ç”¨javaç¨‹åºå»å¢åˆ æ”¹æŸ¥(CRUD)xmlä¸­çš„æ•°æ® è§£ææ€æƒ³:\n domè§£æ saxè§£æ  åŸºäºè¿™ä¸¤ç§è§£ææ€æƒ³å¸‚é¢ä¸Šå°±æœ‰äº†å¾ˆå¤šçš„è§£æapi\n sun jaxpæ—¢æœ‰domæ–¹å¼ä¹Ÿæœ‰saxæ–¹å¼,å¹¶ä¸”è¿™å¥—è§£æapiå·²ç»åŠ å…¥åˆ°j2seçš„è§„èŒƒä¸­,æ„å‘³è¿™ä¸éœ€è¦å¯¼å…¥ä»»ä½•ç¬¬ä¸‰æ–¹å¼€å‘åŒ…å°±å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ç§è§£ææ–¹å¼.ä½†æ˜¯è¿™ç§è§£ææ–¹å¼æ•ˆç‡ä½ä¸‹,æ²¡ä»€ä¹ˆäººç”¨. dom4j å¯ä»¥ä½¿ç”¨domæ–¹å¼é«˜æ•ˆçš„è§£æxml. pull  !!dom4j: å¯¼å…¥å¼€å‘åŒ…,é€šå¸¸åªéœ€è¦å¯¼å…¥æ ¸å¿ƒåŒ…å°±å¯ä»¥äº†,å¦‚æœåœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­æç¤ºå°‘ä»€ä¹ˆåŒ…åˆ°libç›®å½•ä¸‹åœ¨å¯¼å…¥ç¼ºå°‘çš„åŒ…å³å¯.\nå››ã€Schema \u0026ndash; xmlçš„çº¦æŸæŠ€æœ¯ \u0026mdash; éœ€è¦æŒæ¡åç§°ç©ºé—´çš„æ¦‚å¿µ,ä¼šè¯»ç®€å•çš„Schemaå°±å¯ä»¥äº†,ä¸éœ€è¦å¤§å®¶è‡ªå·±ä¼šå†™ ã€€Schemaæ˜¯xmlçš„çº¦æŸæŠ€æœ¯,å‡ºç°çš„ç›®çš„æ˜¯ä¸ºäº†æ›¿ä»£dtd. æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªxml,éå¸¸æ–¹ä¾¿ä½¿ç”¨xmlçš„è§£æå¼•æ“è¿›è¡Œè§£æ. å¯¹åç§°ç©ºé—´æœ‰éå¸¸å¥½çš„æ”¯æŒ;æ”¯æŒæ›´å¤šçš„æ•°æ®ç±»å‹,å¹¶ä¸”æ”¯æŒç”¨æˆ·è‡ªå®šä¹‰æ•°æ®ç±»å‹;å¯ä»¥è¿›è¡Œè¯­ä¹‰çº§åˆ«çš„é™å®š,é™å®šèƒ½åŠ›å¤§å¤§å¼ºäºdtd;ç›¸å¯¹äºdtdä¸æ”¯æŒå®ä½“;ç›¸å¯¹äºdtdå¤æ‚çš„å¤š,å­¦ä¹ æˆæœ¬æ¯”è¾ƒçš„é«˜.\nã€€å¦‚ä½•åœ¨xmlä¸­å¼•å…¥Schema \u0026mdash; !!!!!åç§°ç©ºé—´çš„æ¦‚å¿µ:å…¨ä¸–ç•Œç‹¬ä¸€æ— äºŒçš„åå­—,ç”¨æ¥å”¯ä¸€çš„æ ‡è¯†æŸä¸ªèµ„æº,é€šå¸¸æ˜¯å…¬å¸çš„åŸŸå,åªæ˜¯åå­—è€Œå·²å¹¶ä¸çœŸçš„è¡¨ç¤ºèµ„æºçš„ä½ç½®.\nSchemaçš„è¯­æ³•\u0026mdash;å‚ç…§Schemaçš„æ–‡æ¡£,äº†è§£å³å¯\n","date":1612051200,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1612051200,"objectID":"960776ba8fc504faf823651334efed86","permalink":"https://CoMath21.github.io/post/1-xml%E7%AC%94%E8%AE%B0/","publishdate":"2021-01-31T00:00:00Z","relpermalink":"/post/1-xml%E7%AC%94%E8%AE%B0/","section":"post","summary":"XMLçš„ç›¸å…³å†…å®¹.","tags":["ç¼–ç¨‹è¯­è¨€","XML"],"title":"XMLå­¦ä¹ ç¬”è®°","type":"post"},{"authors":["Xinæ€å¥½å…ˆç”Ÿ","CoMath"],"categories":["å­¦ä¹ ç¬”è®°","ç¼–ç¨‹è¯­è¨€"],"content":"Ajaxï¼šAsynchronous javascript and xml ï¼ˆå¼‚æ­¥javascriptå’Œxmlï¼‰.AJax ä¸æ˜¯æ–°çš„ç¼–ç¨‹è¯­è¨€ï¼Œè€Œæ˜¯ä¸€ç§ä½¿ç”¨ç°æœ‰æ ‡å‡†çš„æ–°æ–¹æ³•.\nåˆ›å»ºajaxå¯¹è±¡ï¼š   ä¸»æµæµè§ˆå™¨æ–¹å¼ï¼š ç«ç‹ã€Googleã€è‹¹æœSafariã€operaåŒ…æ‹¬IE7ä»¥ä¸Šç‰ˆæœ¬çš„æµè§ˆå™¨ var xhr = new XMLHTTPRequest();\n  IE(6/7/8 )æ–¹å¼ï¼š var xhr = new ActiveObject(â€œMicrosoft.XMLHTTPâ€);\t//æœ€åŸå§‹æ–¹å¼ var xhr = new ActiveObject(â€œMsxml2.XMLHTTPâ€); var xhr = new ActiveObject(â€œMsxml2.XMLHTTP.3.0â€); var xhr = new ActiveObject(â€œMsxml2.XMLHTTP.5.0â€); var xhr = new ActiveObject(â€œMsxml2.XMLHTTP.6.0â€);\t//IEç»´æŠ¤çš„æœ€é«˜ç‰ˆæœ¬\n  å‘èµ·å¯¹æœåŠ¡å™¨çš„è¯·æ±‚\n  \u0026lt;script type=\u0026quot;\u0026quot;\u0026gt;\rfunction f() {\r//â‘ åˆ›å»ºajaxå¯¹è±¡\rvar xhr = new XMLHttpRequest();\r//â‘¡åˆ›å»ºæ–°çš„httpè¯·æ±‚ï¼ˆå¹¶è®¾ç½®è¯·æ±‚åœ°å€ï¼‰\r//open(è¯·æ±‚æ–¹å¼get/postï¼Œurlè¯·æ±‚åœ°å€)\rxhr.open(â€˜getâ€™,â€™./xxx.phpâ€™);\r//â‘¢å‘é€è¯·æ±‚\r//send(get---null/post---ç»™æœåŠ¡å™¨ä¼ é€’çš„ä¿¡æ¯)\rxhr.send(null);\r}\r\u0026lt;/script\u0026gt;\r æ¥æ”¶æœåŠ¡å™¨ç«¯è¿”å›çš„ä¿¡æ¯  ajaxå¯¹è±¡çš„æˆå‘˜\n å±æ€§ï¼š   responseTextï¼šä»¥å­—ç¬¦ä¸²å½¢å¼æ¥æ”¶æœåŠ¡å™¨ç«¯è¿”å›çš„ä¿¡æ¯.\n  readyStateï¼š\nåˆšåˆ›å»ºajaxå¯¹è±¡. å·²ç»è°ƒç”¨openæ–¹æ³•. å·²ç»è°ƒç”¨sendæ–¹æ³•. å·²ç»è¿”å›éƒ¨åˆ†æ•°æ®. è¯·æ±‚å®Œæˆï¼Œæ•°æ®è¿”å›å®Œæ•´.    onreadstatechangeï¼šäº‹ä»¶ï¼Œå½“ajaxçŠ¶æ€readStateå‘ç”Ÿå˜åŒ–çš„æ—¶å€™å¤„è§¦å‘æ‰§è¡Œï¼Œä¸ºäº†è·å¾—è¾ƒå¤šçš„çŠ¶æ€ï¼Œæœ€å¥½åœ¨åˆ›å»ºå¥½é˜¿åŠ è¥¿å¯¹è±¡åå°±è®¾ç½®.æœ€å¤šå¯ä»¥æ„ŸçŸ¥1/2/3/4 å››ç§çŠ¶æ€.\n   æ–¹æ³•ï¼š  open(); åˆ›å»ºæ–°çš„httpè¯·æ±‚. send(); æŠŠè¯·+ æ±‚å‘é€ç»™æœåŠ¡å™¨ç«¯.ã€€    \u0026lt;script type=\u0026quot;\u0026quot;\u0026gt;\rfunction f() {\r//â‘ åˆ›å»ºajaxå¯¹è±¡\rvar xhr = new XMLHttpRequest();\r//â‘£ ç»™ajaxè®¾ç½®äº‹ä»¶\rxhr.onreadystatechange = function(){\r//console.log(xhr.readState);\rif(xhr.readyState==4){\r//console.log(xhr.responseText);\r//æŠŠæœåŠ¡ç«¯è¿”å›çš„ä¿¡æ¯æ˜¾ç¤ºåœ¨é¡µé¢ä¸Š\rdocument.getElementById(â€˜requestâ€™).innerHTML = xhr.responseText;\r}\r}\r//â‘¡åˆ›å»ºæ–°çš„httpè¯·æ±‚ï¼ˆå¹¶è®¾ç½®è¯·æ±‚åœ°å€ï¼‰\r//open(è¯·æ±‚æ–¹å¼get/postï¼Œurlè¯·æ±‚åœ°å€)\rxhr.open(â€˜getâ€™,â€™./xxx.phpâ€™);\r//â‘¢å‘é€è¯·æ±‚\r//send(get---null/post---ç»™æœåŠ¡å™¨ä¼ é€’çš„ä¿¡æ¯)\rxhr.send(null);\r}\r\u0026lt;/script\u0026gt;\r  getè¯·æ±‚æ³¨æ„äº‹é¡¹ï¼š\nâ‘ \tåœ¨urlåœ°å€åé¢ä»¥è¯·æ±‚å­—ç¬¦ä¸²ï¼ˆä¼ é€’çš„getå‚æ•°ä¿¡æ¯ï¼‰å½¢å¼ä¼ é€’æ•°æ®.\nâ‘¡\tå¯¹ä¸­æ–‡ã€=ã€\u0026amp;ç­‰ç‰¹æ®Šç¬¦å·å¤„ç†.\n  å¯¹ç‰¹æ®Šä¿¡æ¯çš„å¤„ç†ï¼š\nã€€åœ¨æµè§ˆå™¨é‡Œé€šè¿‡getå‚æ•°ä¼ é€’ä¸€äº›ç‰¹æ®Šç¬¦å·ä¿¡æ¯ä¼šè¢«è¯¯è§£æ··æ·†ï¼Œä¾‹å¦‚ï¼š=ã€\u0026amp;ç­‰.ä¸ºäº†é¿å…ç‰¹æ®Šç¬¦å·è¢«è¯¯è§£äº§ç”Ÿæ­§ä¹‰ï¼Œéœ€è¦å¯¹å…¶è¿›è¡Œç¼–ç å¤„ç†ï¼šåœ¨javascripté‡Œé¢å¯ä»¥é€šè¿‡encodeURLComponent()å¯¹ç‰¹æ®Šç¬¦å·ç­‰ä¿¡æ¯è¿›è¡Œç¼–ç ;ç¼–ç åçš„ä¿¡æ¯å¯ä»¥è¢«æ­£å¸¸æ¥æ”¶ä½¿ç”¨ï¼Œæ— éœ€è§£ç .\n postè¯·æ±‚çš„æ³¨æ„äº‹é¡¹ï¼š\nâ‘ \tç»™æœåŠ¡å™¨ä¼ é€’æ•°æ®éœ€è¦è°ƒç”¨send(è¯·æ±‚å­—ç¬¦ä¸²æ•°æ®)æ–¹æ³•; â‘¡\tè°ƒç”¨æ–¹æ³•sentRequestHeader()æŠŠä¼ é€’çš„æ•°æ®ç»„ç»‡ä¸ºxmlæ ¼å¼ï¼ˆæ¨¡ä»¿formè¡¨å•ä¼ é€’æ•°æ®ï¼‰; â‘¢\tä¼ é€’çš„ä¸­æ–‡ä¿¡æ¯æ— éœ€ç¼–ç ï¼Œç‰¹æ®Šç¬¦å· \u0026amp;ã€=ç­‰ä»éœ€ç¼–ç ; â‘£\tè¯¥æˆ¿æ˜¯è¯·æ±‚çš„åŒæ—¶ä¹Ÿå¯ä»¥ä¼ é€’getå‚æ•°ä¿¡æ¯ï¼ŒåŒæ ·é€‚ç”¨$_GRT æ¥å—ä¿¡æ¯.\n  åŒæ­¥ã€å¼‚æ­¥\najaxå¯¹è±¡.open(æ–¹å¼get/postï¼Œurlåœ°å€ï¼Œ[å¼‚æ­¥true]åŒæ­¥false);\n   å¼‚æ­¥ï¼šåŒä¸€æ—¶é—´ç‚¹å…è®¸æ‰§è¡Œå¤šä¸ªçº¿ç¨‹. åŒæ­¥ï¼šåŒä¸€æ—¶é—´ç‚¹åªå…è®¸æ‰§è¡Œä¸€ä¸ªçº¿ç¨‹.   æ— åˆ·æ–°åˆ†é¡µæ•ˆæœï¼š\najaxåˆ·æ–°æ— åˆ†é¡µæ•ˆæœæ˜¯å¯¹ä¼ ç»Ÿåˆ†é¡µæ•ˆæœçš„å°è£…;å…ˆå°†ä¼ ç»Ÿåˆ†é¡µæ•ˆæœåˆ¶ä½œå‡ºæ¥,åœ¨javascriptä»£ç å—ä¸­å®šä¹‰å‡½æ•°ï¼Œå†åˆ›å»ºajaxå¯¹è±¡ï¼Œåˆ›å»ºäº‹ä»¶ï¼Œæ‰“å¼€openï¼Œsendï¼Œå…¶ä¸­åœ¨åˆ›å»ºäº‹ä»¶çš„æ—¶å€™å°†åŠ è½½åçš„ä¿¡æ¯æ˜¾ç¤ºåˆ°æŒ‡å®šä½ç½®ï¼Œä¸ºäº†å®ç°åˆ†é¡µè·³è½¬ï¼Œåˆ™éœ€è¦å°†urlåœ°å€ä¼ ç»™å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå…¶åŸå› ä¸»è¦æ˜¯å› ä¸ºåˆ†é¡µæ•ˆæœå…¶å®å°±æ˜¯å®ç°çš„è¶…é“¾æ¥ï¼Œè€Œajaxå®ç°æ— åˆ·æ–°åˆ†é¡µæ•ˆæœåˆ™æ˜¯å°†è¶…é“¾æ¥æ›¿æ¢æˆå®šä¹‰çš„å‡½æ•°.   ajaxå¯¹xmlä¿¡æ¯çš„æ¥æ”¶å’Œå¤„ç†\najaxè´Ÿè´£è¯·æ±‚xmlå’Œæ¥æ”¶xmlä¿¡æ¯ï¼Œéƒ½æ²¡è´Ÿè´£å¤„ç†xmlä¿¡æ¯;\ndomï¼šjavascripté‡Œï¼Œdomæ˜¯è´Ÿè´£javascriptä¸html(xml)ä¹‹é—´æ²Ÿé€šçš„æ¡¥æ¢.\n  ajaxå¯¹ç¼“å­˜çš„å¤„ç†\nâ‘ \tç»™è¯·æ±‚çš„åœ°å€è®¾ç½®éšæœºæ•°ï¼Œå³ï¼šä¿è¯æ¯æ¬¡è¯·æ±‚çš„åœ°å€ä¸ä¸€æ ·ï¼› url?Math.random();\nâ‘¡\tç»™åŠ¨æ€ç¨‹åºè®¾ç½®headerå¤´ä¿¡æ¯ï¼Œç¦æ­¢æµè§ˆå™¨å¯¹å…¶ç¼“å­˜ï¼ˆPHPä¸­è¿™æ ·è®¾ç½®ï¼‰.\n  header(â€œCache-Control:no-cacheâ€)\rheader(â€œPragma: :no-cacheâ€)\rheader(â€œExpires:-1â€)\r ","date":1611964800,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1611964800,"objectID":"ac953194eea58abd82f41ac96f422ee3","permalink":"https://CoMath21.github.io/post/1-ajax%E7%AE%80%E4%BB%8B/","publishdate":"2021-01-30T00:00:00Z","relpermalink":"/post/1-ajax%E7%AE%80%E4%BB%8B/","section":"post","summary":"Ajaxçš„å¿«é€Ÿå…¥é—¨.","tags":["Ajax"],"title":"Ajaxç®€ä»‹","type":"post"},{"authors":["Xinæ€å¥½å…ˆç”Ÿ","CoMath"],"categories":["å­¦ä¹ ç¬”è®°","ç»éªŒåˆ†äº«"],"content":"","date":1611964800,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1611964800,"objectID":"c58309501e24068e9525fa4fb9f6f459","permalink":"https://CoMath21.github.io/post/3-hugo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/","publishdate":"2021-01-30T00:00:00Z","relpermalink":"/post/3-hugo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/","section":"post","summary":"HuGoæ­å»ºä¸ªäººåšå®¢å¿ƒå¾—.","tags":["HuGo","åšå®¢"],"title":"HuGoæ­å»ºä¸ªäººåšå®¢","type":"post"},{"authors":["Xinæ€å¥½å…ˆç”Ÿ","CoMath"],"categories":["å­¦ä¹ ç¬”è®°","ç¼–ç¨‹è¯­è¨€"],"content":"ä¸ºä»€ä¹ˆè¦JSPæŠ€æœ¯? ã€€å¼€å‘webç½‘ç«™çš„æ—¶å€™ï¼Œservletåšç•Œé¢æ¯”è¾ƒéº»çƒ¦. JSP æ˜¯åŸºäº Servlet API çš„ï¼Œæ‰€ä»¥æ‹¥æœ‰ Servlet æ‹¥æœ‰çš„ä¸€ç³»åˆ—å¥½å¤„.\n jspè¿è¡Œåœ¨æœåŠ¡å™¨ç«¯ jspï¼ˆjava service pageï¼‰ jspçš„åŸºç¡€æ˜¯servlet jspæ˜¯ä¸€ä¸ªç»¼åˆæŠ€æœ¯ jsp=html+css+javascript+javaä»£ç +jspæ ‡ç­¾(Servlet) jspæ— éœ€é…ç½®ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼›å¦‚æœä¿®æ”¹äº†jspæ–‡ä»¶ï¼Œä¸éœ€è¦é‡æ–°reload webåº”ç”¨ jspè®¿é—®æ–¹æ³•ï¼šhttp://ip:8080/webåº”ç”¨å/jspè·¯å¾„  ç‰¹ç‚¹ï¼š\n å†…å®¹çš„ç”Ÿæˆå’Œæ˜¾ç¤ºç›¸åˆ†ç¦» å¯ç§»æ¤æ€§ é‡‡ç”¨æ ‡ç­¾ç®€åŒ–é¡µé¢å¼€å‘ ä½¿ç”¨å¯é‡ç”¨ç»„ä»¶ å®Œå–„çš„å­˜å‚¨ç®¡ç†å’Œå®‰å…¨æ€§   JSPè¯­æ³•åŸºç¡€ï¼š åŸºæœ¬å…ƒç´ ï¼š æ³¨é‡Š(JSPè‡ªå¸¦çš„æ³¨é‡Šè§„èŒƒæ˜¯éšå¼æ³¨é‡Š,HTML/XMLçš„æ³¨é‡Šæ˜¯æ˜¾ç¤ºæ³¨é‡Š) HTML/XMLçš„æ³¨é‡Š(æ˜¾ç¤ºæ³¨é‡Š)ï¼š\n\u0026lt;!-- ä¸ªæ³¨é‡Š --\u0026gt; \u0026lt;!-- ä¸ªæ³¨é‡Š ï¼š\u0026lt;%counter++;%\u0026gt;--\u0026gt;  è¿™é‡Œä¼šå¯¹counter++è¿›è¡Œç¼–è¯‘,æ˜¾ç¤ºç¼–è¯‘åçš„ç»“æœ éšå¼æ³¨é‡Šï¼š\n\u0026lt;%-- æ³¨é‡Š --%\u0026gt;  JSPåœ¨ç¼–è¯‘æ—¶ä¸ä¼šå¯¹\u0026lt;%\u0026ndash;å’Œ\u0026ndash;%\u0026gt;ä¸­çš„è¿›è¡Œç¼–è¯‘;\nScriptletsä¸­çš„æ³¨é‡Šï¼šè·Ÿjavaæ³¨é‡Šä¸€è‡´.  æŒ‡ä»¤å…ƒç´   é¡µé¢(page)æŒ‡ä»¤ï¼š é¡µé¢pageæŒ‡ä»¤ç”¨äºå®šä¹‰JSPæ–‡ä»¶ä¸­çš„å…¨å±€å±æ€§,ä¸€ä¸ªJSPé¡µé¢å¯ä»¥åŒ…å«å¤šä¸ªé¡µé¢æŒ‡ä»¤.é™¤äº†importæŒ‡ä»¤å¤–å…¶ä»–çš„é¡µé¢æŒ‡ä»¤å®šä¹‰çš„å±æ€§æˆ–å€¼åªèƒ½å‡ºç°ä¸€æ¬¡.  \u0026lt;%@ page attribute=\u0026quot;value\u0026quot;%\u0026gt;  å…¶ä¸­attributeçš„å¯å–å€¼ä¸ºï¼š\n language(å®šä¹‰ä½¿ç”¨çš„è„šæœ¬\u0026mdash;è¯­è¨€é»˜è®¤java)ã€import(å®šä¹‰JSPç½‘é¡µä½¿ç”¨çš„java API)ã€ contentType(å®šä¹‰MIMEç±»å‹å’ŒJSPç½‘é¡µçš„ç¼–ç æ–¹å¼â€”é»˜è®¤TYPE=text/html CHARSET=iso-8859-1)ã€ pageEncoding(JSPé¡µé¢çš„å­—ç¬¦ç¼–ç \u0026mdash;é»˜è®¤pageEncoding=\u0026ldquo;iso-8859-1\u0026rdquo;)ã€ åŒºåˆ«ï¼šcontentTypeâ€”pageEncoding.  contentTypeï¼šåªèƒ½æŒ‡å®šç½‘é¡µä»¥ä»€ä¹ˆæ–¹å¼æ˜¾ç¤º pageEncodingï¼šé™¤äº†æ˜¾ç¤ºä¹‹å¤–è¿˜å¯ä»¥ä»¥æŒ‡å®šå½¢å¼ä¿å­˜   session(å®šä¹‰è¯¥JSPç½‘é¡µæ˜¯å¦å¯ä»¥ä½¿ç”¨sessionå¯¹è±¡â€”-é»˜è®¤true)ã€ buffer(æŒ‡å®šå®¢æˆ·è¾“å‡ºæµçš„ç¼“å†²æ¨¡å¼,å¦‚æœæ˜¯none,åˆ™ä¸ç¼“å†²,å¦‚æœæŒ‡å®šæ•°å€¼,å°±å®šä¹‰äº†ç¼“å†²åŒºçš„å¤§å°)ã€é»˜è®¤8K autoFlush(å®šä¹‰è¾“å‡ºæµçš„ç¼“å­˜åŒºæ˜¯å¦è¦è‡ªåŠ¨æ¸…é™¤-â€”é»˜è®¤true)ã€ isThreadSafe(å®šä¹‰è¯¥JSPé¡µé¢æ˜¯å¦èƒ½å¤„ç†å¤šä¸ªè¯·æ±‚\u0026mdash;é»˜è®¤true)ã€ info(å®šä¹‰è¯¥JSPç½‘é¡µçš„ç›¸å…³ä¿¡æ¯-â€”é»˜è®¤å¿½ç•¥)ã€ errorPage(å®šä¹‰æ­¤é¡µé¢å‡ºç°æ„å¤–æ—¶çš„è°ƒç”¨çš„é¡µé¢â€”-é»˜è®¤å¿½ç•¥)ã€è·³è½¬åˆ°é”™è¯¯é¡µé¢ isErrorPage(å®šä¹‰è¯¥JSPç½‘é¡µæ˜¯å¦ä¸ºå¤„ç†æ„å¤–é”™è¯¯çš„ç½‘é¡µâ€”-é»˜è®¤false)ã€ extends().   includeæŒ‡ä»¤ï¼š includeæŒ‡ä»¤é€šçŸ¥å®¹å™¨åœ¨å½“å‰JSPé¡µé¢ä¸­æŒ‡å®šä½ç½®åŒ…å«å¦ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹. è¢«åŒ…å«çš„æ–‡ä»¶å†…å®¹å¯ä»¥è¢«JSPå¼•æ“è§£æ,è¿™ç§è§£æå‘ç”Ÿåœ¨ç¼–è¯‘æœŸé—´ \u0026lt;%@ include file=\u0026ldquo;filename\u0026rdquo;%\u0026gt; includeåªæœ‰è¿™ä¸€ä¸ªå±æ€§. å…¶ä¸­filenameä¸ºåŒ…å«çš„æ–‡ä»¶è·¯å¾„,ä¸€èˆ¬æ¥è¯´æ˜¯æŒ‡ç›¸å¯¹è·¯å¾„. ç”±äºè¢«åŒ…å«çš„å†…å®¹å¸¸å¸¸æ˜¯ä»£ç ç‰‡æ–­,å› æ­¤ä»£ç ç‰‡æ–­çš„åç¼€åæœ€å¥½ä»¥â€œfâ€(è¡¨ç¤ºfragment)ç»“å°¾,ä¾‹å¦‚.htmlf æ ‡ç­¾åº“taglibæŒ‡ä»¤ï¼š taglibæŒ‡ä»¤å…è®¸é¡µé¢ä½¿ç”¨è€…è‡ªå®šä¹‰æ ‡ç­¾. å…ˆç”¨æˆ·å¼€å‘æ ‡ç­¾åº“ï¼Œä¸ºæ ‡ç­¾åº“ç¼–å†™.tldé…ç½®æ–‡ä»¶ï¼Œç„¶åå†JSPé¡µé¢ä½¿ç”¨è‡ªå®šä¹‰æ ‡ç­¾. \u0026lt;%@ taglib uri=\u0026ldquo;URL\u0026rdquo; prefix=\u0026ldquo;tagPrefix\u0026rdquo;%\u0026gt; uri ç”¨æ¥è¡¨ç¤ºæ ‡ç­¾æè¿°ç¬¦ï¼Œä¹Ÿå°±æ˜¯å¦‚ä½•æ‰¾åˆ°æ ‡ç­¾æ–‡ä»¶å’Œæ ‡ç­¾åº“ï¼› tagPrefix å®šä¹‰äº†å­JSPé¡µé¢é‡Œå¼•ç”¨è¿™ä¸ªæ ‡ç­¾çš„å‰ç¼€.  è„šæœ¬å…ƒç´   å£°æ˜(Declaration) å£°æ˜å°±æ˜¯åœ¨JSPç¨‹åºä¸­å£°æ˜åˆæ³•çš„å˜é‡å’Œæ–¹æ³•,ç”¨\u0026lt;%!å’Œ%\u0026gt;æ¥è¡¨ç¤º)ï¼š å½“ä»£ç åªç”¨äºå•ä¸€é¡µé¢æ—¶ï¼š  \u0026lt;%! variable declaration; method declaration(paramType param,...) %\u0026gt; \u0026lt;%! private static int counter; public void counterInit(){ counter = 0 ; }; %\u0026gt;   è¡¨è¾¾å¼(Expression)â€”ç”¨æ¥å§javaæ•°æ®ç›´æ¥æ’å…¥åˆ°è¾“å‡ºï¼š  è¡¨è¾¾å¼æ˜¯ä½äº\u0026lt;%=å’Œ%\u0026gt;ä¹‹é—´çš„ä»£ç \n\u0026lt;%= \u0026quot;ä½ æ˜¯ç¬¬\u0026quot;+counter+\u0026quot;æ¬¡è®¿é—®\u0026quot; %\u0026gt; \u0026lt;%= \u0026quot;hello world\u0026quot; %\u0026gt;  WebæœåŠ¡å™¨å°†å…¶ç¼–è¯‘æˆServletåï¼Œå˜æˆï¼š\nout.wreite(String.valueOf(\u0026quot;hello world\u0026quot;));  ç›¸å½“äºJSPé¡µé¢ä¸­çš„ï¼š\nout.println(\u0026quot;hello world\u0026quot;);  æ³¨ï¼šè¡¨è¾¾å¼ç»“æŸå¤„å¯ä»¥ä¸ä½¿ç”¨çœç•¥å·ï¼Œè¡¨è¾¾å¼å¯ä»¥åŒ…å«è¡¨è¾¾å¼.\n è„šæœ¬å°ç¨‹åº(Scriptlet)\u0026mdash;å¯ä»¥åœ¨å¤„ç†è¯·æ±‚æ—¶é—´æ‰§è¡Œçš„javaä»£ç ï¼š  Scriptletåˆ™ä½äº\u0026lt;%å’Œ%\u0026gt;ä¹‹é—´,ä»–ä»¬æ˜¯åˆæ³•çš„javaä»£ç  \u0026lt;%counter++;%\u0026gt;\nåŠ¨ä½œå…ƒç´  ã€€JSPè§„èŒƒå®šä¹‰äº†ä¸€ç³»åˆ—çš„æ ‡å‡†åŠ¨ä½œ. ä»¥jspä½œä¸ºå‰ç¼€,ä¾‹å¦‚ä½¿ç”¨JavaBeançš„åŠ¨ä½œå…ƒç´ \u0026lt;jsp:useBean\u0026gt;\n\u0026lt;!-- æ ¼å¼ï¼š --\u0026gt; \u0026lt;jsp:tag attribute=value attribute=value.../\u0026gt; \u0026lt;!-- æˆ–è€… --\u0026gt; \u0026lt;jsp:tag attribute=value attribute=value...\u0026gt; ... \u0026lt;/jsp:tag\u0026gt;  åŠ¨ä½œå…ƒç´ æ˜¯åœ¨è¯·æ±‚å¤„ç†é˜¶æ®µèµ·ä½œç”¨çš„.\n æ–‡æœ¬å¯¼å…¥æ ‡ç­¾\u0026lt;jsp:include\u0026gt;  \u0026lt;!-- æ ¼å¼ï¼š --\u0026gt; \u0026lt;jsp:include page=\u0026quot;filename\u0026quot; flush=\u0026quot;true\u0026quot;/\u0026gt; \u0026lt;!-- æˆ–è€… --\u0026gt; \u0026lt;jsp:include page=\u0026quot;filename\u0026quot; flush=\u0026quot;true\u0026quot;\u0026gt; \u0026lt;jsp:param name=\u0026quot;paramName\u0026quot; value=\u0026quot;paramValue\u0026quot;/\u0026gt; ... \u0026lt;/jsp:include\u0026gt;  ã€€\u0026lt;jsp:param\u0026gt;ç”¨äºä¼ é€’ä¸€ä¸ªæˆ–è€…å¤šä¸ªå‚æ•°ç»™åŠ¨æ€é¡µé¢;\u0026lt;jsp:include\u0026gt;åŠ¨ä½œä¸\u0026lt;%@include%\u0026gt;æŒ‡ä»¤çš„ä¸åŒæ˜¯ï¼šå‰è€…åŒ…å«çš„å†…å®¹å¯ä»¥æ˜¯åŠ¨æ€æ”¹å˜çš„ï¼Œå®ƒåœ¨æ‰§è¡Œæ—¶æ‰ç¡®å®šï¼›è€Œåè€…åŒ…å«çš„å†…å®¹æ˜¯å›ºå®šä¸å˜çš„ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µå°±å·²ç»ç¡®å®šè€Œä¸èƒ½æ”¹å˜.\næ¡ˆä¾‹ï¼šLogin.htmlã€Ex1.jspã€Ex2.jsp\n é¡µé¢è½¬å‘æ ‡ç­¾\u0026lt;jsp:forward\u0026gt;è¯¥æ“ä½œå…è®¸å°†è¯·æ±‚è½¬å‘åˆ°å¦ä¸€ä¸ªJSPã€Servletæˆ–è€…å…¶ä»–é™æ€èµ„æºæ–‡ä»¶. è¯·æ±‚è¢«è½¬è‡³çš„èµ„æºå¿…é¡»ä½äºåŒJSPå‘é€è¯·æ±‚ç›¸åŒçš„ä¸Šä¸‹æ–‡ç¯å¢ƒä¹‹ä¸­. æ¯å½“é‡åˆ°\u0026lt;jsp:forward\u0026gt;æ“ä½œæ—¶ï¼Œå°±åœæ­¢æ‰§è¡Œå½“å‰çš„JSPï¼Œè½¬è‡³æ‰§è¡Œè¢«è½¬å‘çš„èµ„æº.  \u0026lt;!-- æ ¼å¼ï¼š --\u0026gt; \u0026lt;jsp:forward page=\u0026quot;uri\u0026quot;/\u0026gt; \u0026lt;!-- æˆ–è€… --\u0026gt; \u0026lt;jsp:forward\u0026gt; \u0026lt;jsp:param name=\u0026quot;paramName\u0026quot; value=\u0026quot;paramValue\u0026quot;/\u0026gt; ... \u0026lt;/jsp:forward\u0026gt;  å…¶ä¸­page=\u0026ldquo;uri\u0026rdquo; æŒ‡æ˜å°†è¦å®šå‘çš„æ–‡ä»¶æˆ–urlåœ°å€,\u0026lt;jsp:param name=\u0026quot;paramName\u0026quot; value=\u0026quot;paramValue\u0026quot;/\u0026gt;ä¸­nameæŒ‡å®šå‚æ•°åï¼ŒvalueæŒ‡å®šå‚æ•°å€¼. å‚æ•°è¢«å‘é€åˆ°ä¸€ä¸ªåŠ¨æ€æ–‡ä»¶ï¼Œå‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªå€¼ï¼Œè€Œè¿™ä¸ªæ–‡ä»¶å´å¿…é¡»æ˜¯åŠ¨æ€æ–‡ä»¶.\næ¡ˆä¾‹ï¼šEx3.jspã€Ex4.jspã€Ex5.jsp\n å®ä¾‹åŒ–JavaBeanæ ‡ç­¾jsp:useBean  \u0026lt;!-- æ ¼å¼ï¼š --\u0026gt; \u0026lt;jsp:useBean id=\u0026quot;id\u0026quot; scope=\u0026quot;page|request|session|application typeSpec\u0026quot;/\u0026gt; \u0026lt;!-- id æ˜¯å¤§å°å†™ç›¸å…³çš„åå­—,ç”¨æ¥è¡¨ç¤ºè¿™ä¸ªå®ä¾‹;scopeè¡¨ç¤ºæ­¤å¯¹è±¡ä½œç”¨çš„èŒƒå›´ï¼›typeSpaceå¯ä»¥æ˜¯ä»¥ä¸‹å››è€…ä¹‹ä¸€ï¼šclass=\u0026quot;className\u0026quot; --\u0026gt; class=\u0026quot;className\u0026quot; type=\u0026quot;typeName\u0026quot; beanName=\u0026quot;beanName\u0026quot; type=\u0026quot;typeName\u0026quot; type=\u0026quot;typeName\u0026quot;  scopeè¡¨ç¤ºBeançš„ä½œç”¨åŸŸï¼Œæ­¤å±æ€§æ˜¯å¯é€‰çš„ï¼Œé»˜è®¤æ˜¯page.\nâ‘  pageï¼š èƒ½å¤Ÿåœ¨åŒ…å«\u0026lt;jsp:useBean\u0026gt;æ ‡ç­¾çš„JSPæ–‡ä»¶ä»¥åŠæ­¤æ–‡ä»¶ä¸­çš„æ‰€æœ‰é™æ€åŒ…å«æ–‡ä»¶ä¸­ä½¿ç”¨Beanï¼Œç›´åˆ°é¡µé¢æ‰§è¡Œå®Œæ¯•å®¢æˆ·ç«¯å‘å›å“åº”æˆ–è½¬åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ä¸ºæ­¢. è¶…å‡ºè¿™ä¸ªèŒƒå›´Beanå°±å¤±æ•ˆäº†.\nâ‘¡ requestï¼š å¦‚æœè¯¥Beanä¸æ˜¯è¯·æ±‚ä¸Šä¸‹æ–‡çš„ä¸€éƒ¨åˆ†ï¼Œå°†åœ¨è¯·æ±‚ä¸Šä¸‹æ–‡ä¸­åˆ›å»ºå¹¶ä¿å­˜è¯¥Bean.\nâ‘¢ sessionï¼š ä»åˆ›å»ºBeanå¼€å§‹ï¼Œå°±å¼€å§‹åœ¨sessionæœ‰æ•ˆèŒƒå›´å†…ä½¿ç”¨è¿™ä¸ªBeanï¼Œè¿™ä¸ªBeanå¯¹äºJSPæ¥è¯´æ˜¯å…±äº«çš„. ä½†åœ¨åˆ›å»ºBeançš„JSPæ–‡ä»¶é‡Œï¼ŒpageæŒ‡ä»¤å¿…é¡»æŒ‡å®šsession=True.\nâ‘£ applicationï¼š å¦‚æœæ­¤Beanå°šä¸å­˜åœ¨äºWebåº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­ï¼Œåˆ™åœ¨åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­åˆ›å»ºå¹¶å‚¨å­˜æ­¤Bean. applicationå¯¹è±¡åœ¨åº”ç”¨æœåŠ¡å™¨å¯ä¸œå¸‚å°±åˆ›å»ºäº†ï¼Œç›´åˆ°åº”ç”¨æœåŠ¡å™¨å…³é—­. è¿™ä¸ªBeanå­˜åœ¨äºæ•´ä¸ªapplicationç”Ÿå‘½å‘¨æœŸå†…ï¼Œä»»ä½•åœ¨æ­¤åˆ†äº«applicationçš„JSPæ–‡ä»¶éƒ½èƒ½ä½¿ç”¨åŒä¸€ä¸ªBean. class=\u0026ldquo;className\u0026quot;ä»£è¡¨çš„æ˜¯Beançš„ç±»è·¯å¾„å’Œç±»å. è¿™ä¸ªclassä¸æ˜¯æŠ½è±¡çš„ï¼Œå¿…é¡»æœ‰ä¸€ä¸ªå…¬ç”¨çš„ã€æ²¡æœ‰å‚æ•°çš„æ„é€ å™¨. beanName=\u0026ldquo;beanName\u0026rdquo; è¡¨ç¤ºBeançš„åç§°ï¼Œè€ŒType=\u0026ldquo;typeName\u0026quot;åˆ™ç”¨äºæŒ‡å®šBeançš„ç±»å‹. type=\u0026ldquo;typeName\u0026quot;æŒ‡å®šé›·é¸£ï¼Œæ—¢å¯ä»¥æ˜¯æœ¬èº«ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªç±»çš„çˆ¶ç±»ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªç±»çš„æ¥å£. å¦‚æœæ²¡æœ‰ä½¿ç”¨classæˆ–è€…BeanNameæŒ‡å®štypeï¼ŒBeanå°†ä¸ä¼šè¢«å®ä¾‹åŒ–.\n è®¾ç½®JavaBeanå±æ€§æ ‡ç­¾\u0026lt;jsp:setProperty\u0026gt; è¯¥åŠ¨ä½œä¸»è¦ç”¨äºè®¾å®šJavaBeançš„å±æ€§ï¼Œå› æ­¤å¿…é¡»å’ŒuseBeanä¸€èµ·åä½œ. \u0026lt;jsp:setProperty\u0026gt;æ ‡ç­¾é€šè¿‡JavaBeanç»™å®šçš„setXXX()æ–¹æ³•ï¼Œåœ¨javaBeanä¸­è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ªå±æ€§å€¼. åˆ©ç”¨æ­¤åŠ¨ä½œæ ‡ç­¾è®¾ç½®å±æ€§å€¼æœ‰å¤šç§æ–¹æ³•ï¼š  \u0026lt;!-- æ ¼å¼ï¼š --\u0026gt; \u0026lt;jsp:setProperty name=\u0026quot;beanInstanceName\u0026quot; propertyDetails/\u0026gt;  å…¶ä¸­beanInstanceNameæ˜¯å¿…é€‰å±æ€§ï¼Œå³JavaBeanå®ä¾‹çš„åå­—ï¼Œåœ¨ä½¿ç”¨å‰é€šè¿‡\u0026lt;jsp:useBean\u0026gt;å¼•å…¥. propertyDetailsæŒ‡å¯ä»¥é€šè¿‡ä¸‰ç§ä¸åŒçš„æ–¹å¼æ¥æŒ‡å®šå±æ€§ä¿¡æ¯ï¼š\n property=\u0026quot;*\u0026quot;: è¿™ç§èµ‹å€¼æ–¹å¼è¡¨ç¤ºè¯·æ±‚å‚æ•°çš„æ‰€æœ‰å€¼. åœ¨Beanä¸­çš„å±æ€§åå­—å¿…é¡»å’ŒRequestå¯¹è±¡ä¸­çš„å‚æ•°åä¸€è‡´. property=\u0026ldquo;propertyName\u0026rdquo;[param=\u0026ldquo;parameterName\u0026rdquo;]: è¿™ç§èµ‹å€¼æ–¹å¼ä½¿ç”¨requestä¸­çš„ä¸€ä¸ªå‚æ•°å€¼æ¥æŒ‡å®šBeanä¸­çš„ä¸€ä¸ªå±æ€§å€¼. propertyæŒ‡å®šBeançš„å±æ€§åï¼ŒparamæŒ‡å®šrequestä¸­çš„å‚æ•°å. å¦‚æœBeanå±æ€§å’Œrequestå‚æ•°çš„åå­—ä¸åŒï¼Œnameå°±å¿…é¡»æŒ‡å®špropertyå’Œparamçš„å€¼ï¼›è‹¥æœåŒåï¼Œåˆ™éœ€è¦æŒ‡æ˜propertyå°±å¯ä»¥äº†. å‚æ•°å€¼ä¸ºç©ºï¼Œé‚£ä¹ˆå¯¹åº”çš„å±æ€§å€¼ä¹Ÿä¸ä¼šè¢«è®¾å®š. property=\u0026ldquo;propertyName\u0026rdquo; value=\u0026ldquo;propertyValue\u0026rdquo;: è¿™ç§èµ‹å€¼æ–¹å¼ä½¿ç”¨æŒ‡å®šçš„å€¼æ¥è®¾å®šBeanå±æ€§. propertyValueå¯ä»¥æ˜¯å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥æ˜¯è¡¨è¾¾å¼. å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆä»–å°±ä¼šè¢«è½¬æ¢æˆBeanå±æ€§ç±»å‹. å¦‚æœæ˜¯è¡¨è¾¾å¼ï¼Œé‚£ä¹ˆå®ƒçš„ç±»å‹å°±å¿…é¡»å’Œå®ƒå°†è¦è®¾å®šçš„å±æ€§å€¼ç±»å‹ä¿æŒä¸€è‡´. æ³¨ï¼šä¸èƒ½åœ¨ä¸€ä¸ª\u0026lt;jsp:setProperty\u0026gt;ä¸­åŒæ—¶ä½¿ç”¨paramå’Œvalue.   è·å–JavaBeanå¯¹è±¡å±æ€§æ ‡ç­¾\u0026lt;jsp:getproperty\u0026gt; ä¸\u0026lt;jsp:setproperty\u0026gt;ç›¸å¯¹åº”ï¼Œè®¿é—®ä¸€ä¸ªJavaBeanå±æ€§ï¼Œå› æ­¤ä½¿ç”¨è¯¥åŠ¨ä½œæ ‡ç­¾ä¹‹å‰å¿…é¡»ç”¨\u0026lt;jsp:useBean\u0026gt;å¼•å…¥ä¸€ä¸ªJavaBeanå¯¹è±¡.  \u0026lt;!-- æ ¼å¼ï¼š --\u0026gt; \u0026lt;jdp:getProperty name=\u0026quot;beanInstanceName\u0026quot; property=\u0026quot;propertyName\u0026quot;/\u0026gt;  å…¶ä¸­beanInstanceNameå¯¹åº”\u0026lt;jsp:useBean\u0026gt;çš„idï¼Œå› æ­¤nameè¦å’Œ\u0026lt;jsp:useBean\u0026gt;çš„idç›¸åŒ. propertyNameæ˜¯è¦è·å¾—çš„å±æ€§å€¼.\nc.d.e.çš„æ¡ˆä¾‹ï¼šZhuce.jspã€Ex6.jspã€StudentBean.java\n è¿½åŠ å‚æ•°æ ‡ç­¾\u0026lt;jsp:param\u0026gt; ï¼¼jsp:paramæ ‡ç­¾ç”¨æ¥æä¾›key/valueçš„å€¼ï¼Œä¸jsp:incldeã€jsp:forwadrdç­‰æ ‡ç­¾ä¸€èµ·æ­é…ä½¿ç”¨.  \u0026lt;!-- æ ¼å¼ï¼š --\u0026gt; \u0026lt;jsp:param name=\u0026quot;parameterName\u0026quot; value=\u0026quot;parameterValue\u0026quot;/\u0026gt;  name=\u0026ldquo;parameterName\u0026rdquo; ï¼šè¯¥å±æ€§è¡¨ç¤ºå‚æ•°çš„åå­— value=\u0026ldquo;parameterValue\u0026rdquo;ï¼šè¡¨ç¤ºå‚æ•°çš„å€¼ï¼\nServletå®¹å™¨æ¦‚å¿µ ã€€Servletå®¹å™¨ä¸ºJava_Webåº”ç”¨æä¾›è¿è¡Œæ—¶ç¯å¢ƒ,å®ƒè´Ÿè´£ç®¡ç†Servletå’ŒJSPçš„ç”Ÿå‘½å‘¨æœŸ,ä»¥åŠç®¡ç†ä»–ä»¬çš„å…±äº«æ•°æ®. Servletå®¹å™¨ä¹Ÿç§°ä¸ºJava_Webåº”ç”¨å®¹å™¨,æˆ–è€…Servlet/JSPå®¹å™¨ï¼\næµè¡Œçš„Servletå®¹å™¨è½¯ä»¶\n â€”Tomcat â€”Resin   éƒ¨ç½²tomcatæœåŠ¡å™¨ï¼š  è§£å‹æ–‡ä»¶apache-tomcat å¯åŠ¨ï¼šstartup.bat\u0026mdash;\u0026mdash;å¯åŠ¨æœåŠ¡å™¨ éœ€è¦é…ç½®ç¯å¢ƒï¼šJAVA_HOME java jdkçš„æ ¹ç›®å½• æƒ³åœ¨ä»»æ„ç›®å½•ä¸‹æ‰“å¼€æœåŠ¡å™¨  è®¾ç½®ç¯å¢ƒCATALINA_HOME\u0026mdash;-bin/catalina.bat Tomcatçš„ç®¡ç†ç¨‹(manager)ï¼šè¦è®¿é—®manager webåº”ç”¨ç¨‹åº,éœ€è¦æ·»åŠ å…·æœ‰ç®¡ç†å‘˜æƒé™çš„è´¦å·,ç¼–è¾‘confç›®å½•ä¸‹çš„tomcat-users.xmlæ–‡ä»¶,æ·»åŠ managerè§’è‰²è®¾ç½®ç”¨æˆ·åå¯†ç     ç¬¬ä¸€ä¸ªwebç¨‹åºï¼š   åœ¨Eclipseæ–°å»ºä¸€ä¸ªJava Project\n  åœ¨Javaé¡¹ç›®ä¸‹åˆ›å»ºWebå¼€å‘çš„ç›®å½•ç»“æ„   åœ¨WebContentç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªJSPæ–‡ä»¶ï¼š\n  æŠŠWebContent ç›®å½•å¤åˆ¶åˆ°Tomcatçš„webappsç›®å½•ä¸‹\n  æœ€ååœ¨æµè§ˆå™¨æ‰“å¼€\n  JavaEEnç‰ˆ Eclipseå¼€å‘web  æ˜¾åˆ‡æ¢åˆ°JavaEE Serversä¸‹æ–°å»ºä¸€ä¸ªTomcatæœåŠ¡å™¨\u0026ndash;\u0026gt;å…³è”åˆ°Tomcatæ ¹ç›®å½• æ–°å»ºä¸€ä¸ªDynamic Web Project å…¶ä¸­Target Runtimeéœ€é€‰ä¸­ å¼€å‘åº”ç”¨ å¯ä»¥é€šè¿‡run so server æ¥è¿è¡ŒWEBé¡¹ç›®  Servlet çš„HelloWorld  åˆ›å»ºä¸€ä¸ªServletæ¥å£çš„å®ç°ç±»  public class HelloWorld implements Servlet  åœ¨web.xml æ–‡ä»¶ä¸­é…ç½®å’Œæ˜ å°„è¿™ä¸ªServlet  \u0026lt;!-- é…ç½®å’Œæ˜ å°„Servlet --\u0026gt; \u0026lt;Servlet\u0026gt; \u0026lt;!â€”Servlet æ³¨å†Œçš„åå­— â€“\u0026gt; \u0026lt;servlet-name\u0026gt;ç±»å\u0026lt;/servlet-name\u0026gt; \u0026lt;!â€”Servlet çš„å…¨ç±»å --\u0026gt; \u0026lt;servlet-class\u0026gt;åŒ…å\u0026lt;/servlet-class\u0026gt; \u0026lt;/Servlet\u0026gt; \u0026lt;servlet-mapping\u0026gt; \u0026lt;!â€”éœ€è¦å’ŒæŸä¸€ä¸ªServlet èŠ‚ç‚¹çš„servlet-name å­èŠ‚ç‚¹çš„æ–‡æœ¬èŠ‚ç‚¹ä¸€è‡´â€“\u0026gt; \u0026lt;servlet-name\u0026gt;ç±»å\u0026lt;/servlet-name\u0026gt; \u0026lt;!â€”æ˜ å°„å…·ä½“çš„è®¿é—®è·¯å¾„ï¼š/ä»£è¡¨å½“å‰WEBåº”ç”¨çš„æ ¹ç›®å½• â€“\u0026gt; \u0026lt;url-pattern\u0026gt;/hello\u0026lt;/url-pattern\u0026gt; \u0026lt;/servlet-mapping\u0026gt;  å…³äºservlet-mappingï¼š  åŒä¸€ä¸ªServletå¯ä»¥è¢«æ˜ å°„åˆ°å¤šä¸ªURLä¸Š,å³å¤šä¸ªå…ƒç´ çš„å­å…ƒç´ çš„è®¾ç½®å€¼å¯ä»¥æ˜¯åŒä¸€ä¸ªServletçš„æ³¨å†Œå. åœ¨Servletæ˜ å°„åˆ°çš„URLä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨é€šé…ç¬¦,ä½†æ˜¯åªèƒ½æœ‰ä¸¤ç§å›ºå®šçš„æ ¼å¼ï¼šä¸€ç§æ ¼å¼æ˜¯â€œ.æ‰©å±•åâ€,å¦ä¸€ç§æ ¼å¼æ˜¯ä»¥æ­£æ–œæ ï¼ˆ/ï¼‰å¼€å¤´å¹¶ä»¥â€œ/*â€ç»“å°¾.  Servlet å®¹å™¨ï¼š  å¯ä»¥åˆ›å»ºServlet,å¹¶è°ƒç”¨Servletçš„ç›¸å…³ç”Ÿå‘½å‘¨æœŸ JSP,Filter,Listener  Servlet ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼šä»¥ä¸‹æ–¹æ³•éƒ½æ˜¯Servletå®¹å™¨è´Ÿè´£è°ƒç”¨  æ„é€ å™¨ï¼šåªè¢«è°ƒç”¨ä¸€æ¬¡,åªæœ‰ç¬¬ä¸€æ¬¡è¯·æ±‚Servletæ—¶,åˆ›å»ºServletçš„å®ä¾‹,è°ƒç”¨æ„é€ å™¨,è¿™è¯´æ˜Servletæ˜¯å•å®ä¾‹çš„. initæ–¹æ³•ï¼šåªè¢«è°ƒç”¨ä¸€æ¬¡,åœ¨åˆ›å»ºå¥½çš„å®ä¾‹åå³è¢«è°ƒç”¨,ç”¨äºåˆå§‹åŒ–å½“å‰Servlet. serviceï¼šè¢«å¤šæ¬¡è°ƒç”¨. æ¯æ¬¡è¯·æ±‚éƒ½ä¼šè°ƒç”¨serviceæ–¹æ³•,å®é™…å“åº”è¯·æ±‚çš„. destroyï¼šåªè¢«è°ƒç”¨ä¸€æ¬¡,åœ¨å½“å‰Servletæ‰€åœ¨çš„Webåº”ç”¨è¢«å¸è½½å‰è°ƒç”¨,ç”¨äºé‡Šæ”¾å½“å‰çš„Servletæ‰€å ç”¨çš„èµ„æº  loda-on-start-upå‚æ•°ï¼š  é…ç½®åœ¨servletèŠ‚ç‚¹ä¸­  \u0026lt;Servlet\u0026gt; \u0026lt;!â€”Servlet æ³¨å†Œçš„åå­— â€“\u0026gt; \u0026lt;servlet-name\u0026gt;ç±»å1\u0026lt;/servlet-name\u0026gt; \u0026lt;!â€”Servlet çš„å…¨ç±»å --\u0026gt; \u0026lt;servlet-class\u0026gt;åŒ…å\u0026lt;/servlet-class\u0026gt; \u0026lt;!â€”å¯ä»¥æŒ‡å®šServlet è¢«åˆ›å»ºçš„æ—¶æœº --\u0026gt; \u0026lt;load-on-startup\u0026gt;2\u0026lt;/load-on-startup\u0026gt; \u0026lt;/Servlet\u0026gt;  load-on-startupï¼šå¯ä»¥æŒ‡å®šServletè¢«åˆ›å»ºçš„æ—¶æœº.å¦‚ä¸ºè´Ÿæ•°,åˆ™åœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚æ—¶åˆ›å»º;è‹¥ä¸º0æˆ–æ­£æ•°,åˆ™åœ¨å½“å‰WEBåº”ç”¨è¢«Servlet å®¹å™¨åŠ è½½æ—¶åˆ›å»ºå®ä¾‹,ä¸”è¶Šå°è¶Šæ—©è¢«åˆ›å»º.  ","date":1611964800,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1611964800,"objectID":"6fd502dd477256f5c1ebe46e2c0c1410","permalink":"https://CoMath21.github.io/post/1-jsp%E7%AE%80%E4%BB%8B/","publishdate":"2021-01-30T00:00:00Z","relpermalink":"/post/1-jsp%E7%AE%80%E4%BB%8B/","section":"post","summary":"Java Server Pageså¿«é€Ÿå…¥é—¨.","tags":["Java","JSP"],"title":"JSPç®€ä»‹","type":"post"},{"authors":["Xinæ€å¥½å…ˆç”Ÿ","CoMath"],"categories":["å­¦ä¹ ç¬”è®°","ç¼–ç¨‹è¯­è¨€"],"content":"ä»€ä¹ˆæ˜¯node.js  node.jsæ˜¯ä¸€ä¸ªå¼€å‘å¹³å°ï¼Œå°±åƒJavaå¼€å‘å¹³å°ã€.Netå¼€å‘å¹³å°ã€PHPå¼€å‘å¹³å°ã€Appleå¼€å‘å¹³å°ä¸€æ ·ã€‚ -ä½•ä¸ºå¼€å‘å¹³å°ï¼Ÿæœ‰å¯¹åº”çš„ç¼–ç¨‹è¯­è¨€ã€æœ‰è¯­è¨€è¿è¡Œæ—¶ã€æœ‰èƒ½å®ç°ç‰¹å®šåŠŸèƒ½çš„APIï¼ˆSDK:Software Development Kitï¼‰ è¯¥å¹³å°ä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€æ˜¯Javascript è¯­è¨€ã€‚ node.jså¹³å°æ˜¯åŸºäºChrome V8 Javascriptå¼•æ“æ„å»ºã€‚ åŸºäºnode.jså¯ä»¥å¼€å‘æ§åˆ¶å°ç¨‹åºï¼ˆå‘½ä»¤è¡Œç¨‹åºã€CLIç¨‹åºï¼‰ã€æ¡Œé¢åº”ç”¨ç¨‹åºï¼ˆGUIï¼‰ï¼ˆå€ŸåŠ© node-webkitã€electronç­‰æ¡†æ¶å®ç°ï¼‰ã€Webåº”ç”¨ç¨‹åºï¼ˆç½‘ç«™ï¼‰  PHPå¼€å‘æŠ€æœ¯æ ˆï¼šLAMP-Linux Apache MySQL PHP\nnode.jså…¨æ ˆå¼€å‘æŠ€æœ¯æ ˆï¼šMEAN-MongoDB Express Angular Node.js\nnode.jsæœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿ  äº‹ä»¶é©±åŠ¨ï¼ˆå½“äº‹ä»¶è¢«è§¦å‘æ—¶ï¼Œæ‰§è¡Œä¼ é€’è¿‡å»çš„å›è°ƒå‡½æ•°ï¼‰ éé˜»å¡I/0æ¨¡å‹ï¼ˆå½“æ‰§è¡ŒI/0æ“ä½œæ—¶ï¼Œä¸ä¼šé˜»å¡çº¿ç¨‹ï¼‰ å•çº¿ç¨‹ æ‹¥æœ‰ä¸–ç•Œæœ€å¤§çš„å¼€æºåº“ç”Ÿæ€ç³»ç»Ÿä¸€npmã€‚  node.jsç½‘ç«™  [node.jså®˜æ–¹ç½‘ç«™]ï¼ˆhttps://nodejs.org/ï¼‰ [node.jsä¸­æ–‡ç½‘]ï¼ˆhttp://nodejs.cn/ï¼‰ [node.jsä¸­æ–‡ç¤¾åŒº]ï¼ˆhttps://cnodejs.org/ï¼‰  ä¸ºä»€ä¹ˆè¦å­¦ä¹ Node.jsï¼Ÿ  é€šè¿‡å­¦ä¹ Node.jså¼€å‘æ·±å…¥ç†è§£æœåŠ¡å™¨å¼€å‘ã€*Webè¯·æ±‚å’Œå“åº”è¿‡ç¨‹ã€*äº†è§£æœåŠ¡å™¨ç«¯å¦‚ä½•ä¸å®¢æˆ·ç«¯é…åˆ å­¦ä¹ æœåŠ¡å™¨ç«¯æ¸²æŸ“ å­¦ä¹ æœåŠ¡å™¨ç«¯ä¸ºå®¢æˆ·ç«¯ç¼–å†™æ¥å£ ç°åœ¨å‰ç«¯å·¥ç¨‹å¸ˆé¢è¯•ï¼Œå¯¹Node.jså¼€å‘æœ‰è¦æ±‚ è¡¥å……æé—®ï¼š -åœ¨Node.jså¹³å°å¼€å‘æ—¶ï¼Œèƒ½ä½¿ç”¨Dom APIå—ï¼Ÿæ¯”å¦‚ï¼šdocument.getElementByIdï¼ˆ\u0026lsquo;id\u0026rsquo;ï¼‰ï¼›window.locationç­‰ï¼Ÿ å¤ä¹ æµè§ˆå™¨ç«¯JavaScript ç»„æˆï¼šECMAscriptã€Domã€Bom  å­¦ä¹ ç›®æ ‡  äº†è§£æœåŠ¡å™¨å¼€å‘è¿‡ç¨‹ ä¼šä½¿ç”¨node.jså¼€å‘åŸºæœ¬çš„httpæœåŠ¡ç¨‹åºï¼ˆWebåº”ç”¨ç¨‹åºï¼‰  Node.jså®‰è£…å’Œé…ç½®  ä¸‹è½½åœ°å€   [å½“å‰ç‰ˆæœ¬]ï¼ˆhttps://nodejs.org/en/download/ï¼‰ [å†å²ç‰ˆæœ¬]ï¼ˆhttps://nodejs.org/en/download/releases/ï¼‰  å®˜ç½‘æœ¯è¯­è§£é‡Š   LTSç‰ˆæœ¬ï¼šLong-term Supportç‰ˆæœ¬ï¼Œé•¿æœŸæ”¯æŒç‰ˆï¼Œå³ç¨³å®šç‰ˆã€‚ Current ç‰ˆæœ¬ï¼šLatest Featuresç‰ˆæœ¬ï¼Œæœ€æ–°ç‰ˆæœ¬ï¼Œæ–°ç‰¹æ€§ä¼šåœ¨è¯¥ç‰ˆæœ¬ä¸­æœ€å…ˆåŠ å…¥ã€‚  æ³¨æ„ï¼š   å®‰è£…å®Œæ¯•åé€šè¿‡å‘½ä»¤ï¼šnode-væ¥ç¡®å®šæ˜¯å¦å®‰è£…æˆåŠŸã€æ³¨æ„ï¼šæ‰“å¼€â€œå‘½ä»¤çª—å£â€çš„æ—¶å€™å»ºè®®ä½¿ç”¨â€œç®¡ç†å‘˜æ–¹å¼â€œæ‰“å¼€ã€‘ å¦‚æœéœ€è¦åˆ™é…ç½®ç¯å¢ƒå˜é‡ã€‚ ï¼ [é…ç½®ç¯å¢ƒå˜é‡]ï¼ˆimgs/env_pathpngï¼‰  é€šè¿‡nvm-windowsç®¡ç†ä¸€å°è®¡ç®—æœºä¸Šçš„å¤šä¸ªnodeç‰ˆæœ¬  Node Version Managerï¼ˆNode ç‰ˆæœ¬ç®¡ç†å™¨ï¼‰ nvmï¼ˆLinuxã€Unixã€OS-Xï¼‰   https://github.com/creationix/nvm\n  äº§ç”¨å‘½ä»¤ï¼š\n    nvm-install-nodeï¼ˆå®‰è£…æœ€æ–°ç‰ˆæœ¬çš„nodeï¼‰\n  nvm-use node-ï¼ˆä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„nodeï¼‰\n  nvm-windowsÂ·ï¼ˆWindowsï¼‰   https://github.com/coreybutler/nvm-windows\n  å¸¸ç”¨å‘½ä»¤ï¼š\n  nvm-version\nnvm-install-latest\nnvm-instal1-ç‰ˆæœ¬å·\nnvm-uninstallç‰ˆæœ¬å·\nnvm-list\nnvm-use ç‰ˆæœ¬å· #åœ¨node.jsä¸Šç¼–å†™ç¨‹åº ##REPLä»‹ç»\n REPLå…¨ç§°ï¼šRead-Eval-Print-Loopï¼ˆäº¤äº’å¼è§£é‡Šå™¨ï¼‰   R è¯»å–-è¯»å–ç”¨æˆ·è¾“å…¥ï¼Œè§£æè¾“å…¥äº†Javascript æ•°æ®ç»“æ„å¹¶å­˜å‚¨å†…å­˜ä¸­ã€‚ E æ‰§è¡Œ-æ‰§è¡Œè¾“å…¥çš„æ•°æ®ç»“æ„ P æ‰“å°-è¾“å‡ºç»“æœ Lå¾ªç¯-å¾ªç¯æ“ä½œä»¥ä¸Šæ­¥éª¤ç›´åˆ°ç”¨æˆ·ä¸¤æ¬¡æŒ‰ä¸‹ctrl-cæŒ‰é’®é€€å‡ºã€‚  åœ¨REPLä¸­ç¼–å†™ç¨‹åºï¼ˆç±»ä¼¼äºæµè§ˆå™¨å¼€å‘äººå‘˜å·¥å…·ä¸­çš„æ§åˆ¶å°åŠŸèƒ½ï¼‰   ç›´æ¥åœ¨æ§åˆ¶å°è¾“å…¥nodeå‘½ä»¤è¿›å…¥REPLç¯å¢ƒ  æŒ‰ä¸¤æ¬¡Control+Cé€€å‡ºREPLç•Œé¢æˆ–è€…è¾“å…¥exité€€å‡ºREPLç•Œé¢   æŒ‰ä½controlé”®ä¸è¦æ”¾å¼€ï¼Œç„¶åæŒ‰ä¸¤ä¸‹cé”® ##åˆ›å»ºJavaScriptæ–‡ä»¶ç¼–å†™ç¨‹åº ###ç¼–ç¨‹æ³¨æ„äº‹é¡¹ é…ç½®ä¸€ä¸‹Sublime Textçš„ä»£ç ç¼©è¿›æ ¼å¼ä¸º2ä¸ªç©ºæ ¼ æ–¹å¼ä¸€  ï¼[@é…ç½®æ–¹å¼1]ï¼ˆimgs/sublimeconf1.pngï¼‰\n æ–¹å¼äºŒ  ï¼[@é…ç½®æ–¹å¼2-ç¬¬ä¸€æ­¥]ï¼ˆimgs/sublimeconf21.pngï¼‰\nï¼[é…ç½®æ–¹å¼2-ç¬¬äºŒæ­¥]ï¼ˆimgs/sublimeconf22.pngï¼‰ ##å†™å…¥æ–‡ä»¶æ“ä½œ\n //æ‰§è¡Œæ–‡ä»¶æ“ä½œ\n//\u0026mdash;\u0026mdash;\u0026mdash;-å®ç°æ–‡ä»¶å†™å…¥æ“ä½œ\u0026ndash;\n//1.åŠ è½½æ–‡ä»¶æ“ä½œæ¨¡å—ï¼Œfsæ¨¡å—ã€‚\nvar fs=requireï¼ˆ\u0026lsquo;fs\u0026rsquo;ï¼‰ï¼›\n//2.å®ç°æ–‡ä»¶å†™å…¥æ“ä½œ\nvar msg=\u0026lsquo;Hello worldï¼Œä½ å¥½ä¸–ç•Œï¼â€™ï¼›\n//è°ƒç”¨fs.writeFileï¼ˆï¼‰è¿›è¡Œæ–‡ä»¶å†™å…¥\n//fs.writeFileï¼ˆfileï¼Œdatalï¼Œoptions]ï¼Œcallbackï¼‰\nfs.writeFileï¼ˆ\u0026rsquo;./hello.txt'ï¼Œmsgï¼Œ\u0026lsquo;utf8\u0026rsquo;ï¼Œfunctionï¼ˆerrï¼‰{\n//body..\n//å¦‚æœerr===nullï¼Œè¡¨ç¤ºå†™å…¥æ–‡ä»¶æˆåŠŸï¼Œæ²¡æœ‰é”™è¯¯ï¼\n//åªè¦erré‡Œé¢ä¸æ˜¯nullï¼Œå°±è¡¨ç¤ºå†™å…¥æ–‡ä»¶å¤±è´¥äº†ï¼\nifï¼ˆerrï¼‰{\nconsole.1ogï¼ˆ\u0026lsquo;å†™æ–‡ä»¶å‡ºé”™å•¦ï¼å…·ä½“é”™è¯¯ï¼šâ€˜+errï¼‰ï¼›\n}else{\nconsole.logï¼ˆ\u0026lsquo;ok\u0026quot;ï¼‰ï¼›\n} }ï¼‰ï¼›\n ##è¯»å–æ–‡ä»¶æ“ä½œ\n //\u0026mdash;\u0026mdash;\u0026mdash;-å®ç°æ–‡ä»¶å†™å…¥æ“ä½œ\u0026ndash; //1.åŠ è½½æ–‡ä»¶æ“ä½œæ¨¡å—ï¼Œfsæ¨¡å—ã€‚\nvar fs=require(\u0026lsquo;fs\u0026rsquo;)ï¼›\nè°ƒç”¨fs.readFileï¼ˆï¼‰æ–¹æ³•æ¥è¯»å–æ–‡ä»¶\n//fs.readFileï¼ˆfilelï¼Œoptions]ï¼Œcallbackï¼‰\nfs.readFileï¼ˆ\u0026rsquo;./hello.txt\u0026rsquo;ï¼Œfunction-ï¼ˆerrï¼Œ-dataï¼‰-{\nif(err){ throw-errï¼›}\n//dataå‚æ•°çš„æ•°æ®ç±»å‹æ˜¯ä¸€ä¸ªBufferå¯¹è±¡ï¼Œé‡Œé¢ä¿å­˜çš„å°±æ˜¯ä¸€ä¸ªä¸€ä¸ªçš„å­—èŠ‚ï¼ˆç†è§£ä¸ºå­—èŠ‚æ•°ç»„ï¼‰\n//æŠŠbufferå¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œè°ƒç”¨tostringï¼ˆï¼‰æ–¹æ³•\n//console.logï¼ˆdataï¼‰ï¼›console.logï¼ˆdata.toString ï¼ˆ\u0026lsquo;utf8\u0026rsquo;ï¼‰ï¼‰; }ï¼‰;\n  æ³¨æ„: //æ­¤å¤„çš„./ç›¸å¯¹è·¯å¾„ï¼Œç›¸å¯¹çš„æ˜¯æ‰§è¡Œnodeå‘½ä»¤çš„è·¯å¾„\n//è€Œä¸æ˜¯ç›¸å¯¹äºæ­£åœ¨æ‰§è¡Œçš„è¿™ä¸ªjsæ–‡ä»¶æ¥æŸ¥æ‰¾hello.txt\n//è§£å†³åœ¨æ–‡ä»¶è¯»å–ä¸­./ç›¸å¯¹è·¯å¾„çš„é—®é¢˜\n//è§£å†³ï¼šdirnameã€filename\n//dirnameï¼šè¡¨ç¤ºï¼Œå½“å‰æ­£åœ¨æ‰§è¡Œçš„jsæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•\n//filenameï¼šè¡¨ç¤ºï¼Œå½“å‰æ­£åœ¨æ‰§è¡Œçš„jsæ–‡ä»¶çš„å®Œæ•´è·¯å¾„\n è·¯å¾„æ‹¼æ¥ï¼špath.join('/foo',\u0026lsquo;bar\u0026rsquo;,'/ad','\u0026hellip;');  HTTPæœåŠ¡ç¨‹åº  //åˆ›å»ºä¸€ä¸ªç®€å•çš„httpæœåŠ¡å™¨ç¨‹åº\n//1.åŠ è½½httpæ¨¡å—\nvar http=requireï¼ˆ\u0026lsquo;http\u0026rsquo;ï¼‰ï¼›\n//2.åˆ›å»ºä¸€ä¸ªhttpæœåŠ¡å¯¹è±¡\nvar server=http.createServerï¼ˆï¼‰ï¼›\n//3.ç›‘å¬ç”¨æˆ·çš„è¯·æ±‚äº‹ä»¶ï¼ˆrequestäº‹ä»¶ï¼‰\n//request å¯¹è±¡åŒ…å«äº†ç”¨æˆ·è¯·æ±‚æŠ¥æ–‡ä¸­çš„æ‰€æœ‰å†…å®¹ï¼Œé€šè¿‡requestå¯¹è±¡å¯ä»¥è·å–æ‰€æœ‰ç”¨æˆ·æäº¤è¿‡æ¥çš„æ•°æ®\n//response å¯¹è±¡ç”¨æ¥å‘ç”¨æˆ·å“åº”ä¸€äº›æ•°æ®ï¼Œå½“æœåŠ¡å™¨è¦å‘å®¢æˆ·ç«¯å“åº”æ•°æ®çš„æ—¶å€™å¿…é¡»ä½¿ç”¨response.å¯¹è±¡\n//æœ‰äº†requestå¯¹è±¡å’Œresponseå¯¹è±¡ï¼Œå°±æ—¢å¯ä»¥è·å–ç”¨æˆ·æäº¤çš„æ•°æ®ï¼Œä¹Ÿå¯ä»¥å‘ç”¨æˆ·å“åº”æ•°æ®äº† server.onï¼ˆ\u0026lsquo;request\u0026rsquo;ï¼Œfunctionï¼ˆre4ï¼Œresï¼‰{\n//body\u0026hellip;\n//è§£å†³ä¹±ç çš„æ€è·¯ï¼šæœåŠ¡å™¨é€šè¿‡è®¾ç½®httpå“åº”æŠ¥æ–‡å¤´ï¼Œå‘Šè¯‰æµè§ˆå™¨ä½¿ç”¨ç›¸åº”çš„ç¼–ç æ¥è§£æç½‘é¡µres.setHeader(\u0026lsquo;Content-Type\u0026rsquo;,\u0026lsquo;text/plain;charset=utf-8\u0026rsquo;)ï¼› res.writeï¼ˆ\u0026lsquo;Hello worldï¼ï¼ï¼ï¼'ï¼‰ï¼›\n//å¯¹äºæ¯ä¸€ä¸ªè¯·æ±‚ï¼ŒæœåŠ¡å™¨å¿…é¡»ç»“æŸå“åº”ï¼Œå¦åˆ™å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ä¼šä¸€ç›´ç­‰å¾…æœåŠ¡å™¨å“åº”ç»“æŸ\nres.endï¼ˆï¼‰; }ï¼‰;\n  //4.å¯åŠ¨æœåŠ¡\nserver.listen(8080ï¼Œfunction(){ console.1og(\u0026lsquo;æœåŠ¡å™¨å¯åŠ¨äº†ï¼Œè¯·è®¿é—®ï¼šhttp://1ocalhostï¼š8080\u0026rsquo;ï¼› });\n è·å–ç”¨æˆ·è¯·æ±‚è·¯å¾„  req.url\né€šè¿‡ req.url ååŒºç”¨æˆ·è¯·æ±‚çš„è·¯å¾„ï¼Œæ ¹æ®ä¸åŒè¯·æ±‚ä½œå‡ºä¸åŒçš„å“åº”   if(req.url === \u0026lsquo;/\u0026rsquo; || req.u === \u0026lsquo;/index\u0026rsquo;){\nres.end(\u0026lsquo;Hello World\u0026rsquo;);\n}else if(\u0026rsquo;\u0026hellip;'){\n  }\n ###æ ¹æ®ç”¨æˆ·ä¸åŒè¯·æ±‚ç›¸åº”ä¸åŒé¡µé¢\n var http=require(\u0026lsquo;http\u0026rsquo;);\n//åŠ è½½fsæ¨¡å—\nvar fs=require(\u0026lsquo;fs\u0026rsquo;);\n//åŠ è½½pathæ¨¡å—\nvar path=require(\u0026lsquo;path\u0026rsquo;);\n//åˆ›å»ºhttpæœåŠ¡ï¼Œå¹¶å¯åŠ¨è¯¥æœåŠ¡\nhttp.createServer(function(reqï¼Œres){\n//é€šè¿‡req.urlè·å–ç”¨æˆ·è¯·æ±‚çš„è·¯å¾„ï¼Œæ ¹æ®ä¸åŒçš„è¯·æ±‚è·¯å¾„æœåŠ¡å™¨åšå‡ºä¸åŒçš„å“åº”\nif(req.url==='/'|| req.url===\u0026quot;/index'){\n//è¯»å–index.htmlæ–‡ä»¶\nfs.readFileï¼ˆpath.join(__dirname, \u0026lsquo;htmls\u0026rsquo;, \u0026lsquo;index.html\u0026quot;), function(err, data){\nif(err){\nthrow err;\n//æŠŠè¯»å–åˆ°çš„index.htmlä¸­çš„å†…å®¹ç›´æ¥å‘é€ç»™æµè§ˆå™¨\nres.end(data);\n});\n}else if(req.url-==Â·\u0026quot;/login)}else if(req.url-==Â·\u0026quot;/list)\n}else if(req.url===\u0026quot;/register\u0026rsquo;){\n}else{\n}).listenï¼ˆ9090ï¼Œfunction(){\nconsole.1log(\u0026lsquo;http://1ocalhost:9090\u0026rsquo;)ï¼›\n});\n ","date":1611964800,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1611964800,"objectID":"c07e9ee97bc8fff1eaf5c095f2a5e152","permalink":"https://CoMath21.github.io/post/1-node.js/","publishdate":"2021-01-30T00:00:00Z","relpermalink":"/post/1-node.js/","section":"post","summary":"node.jsä»‹ç» .","tags":["ç¼–ç¨‹è¯­è¨€","Node"],"title":"node.jsä»‹ç»(ä¸€)","type":"post"},{"authors":["Xinæ€å¥½å…ˆç”Ÿ","CoMath"],"categories":["å­¦ä¹ ç¬”è®°","ç¼–ç¨‹è¯­è¨€"],"content":"1ã€ä»€ä¹ˆæ˜¯Spring ã€€Springæ˜¯ä¸€ä¸ªå¼€æºçš„æ§åˆ¶åè½¬(Inversion of Control,IoC)å’Œé¢å‘åˆ‡é¢(AOP)çš„å®¹å™¨æ¡†æ¶ï¼Œå®ƒçš„ä¸»è¦ç›®çš„æ˜¯ç®€åŒ–ä¼ä¸šå¼€å‘. ç”¨äºé…ç½®bean,å¹¶ç»´æŠ¤beanä¹‹é—´å…³ç³»çš„æ¡†æ¶.\nã€€åœ¨SSHæ¡†æ¶ä¸­springå……å½“äº†ç®¡ç†å®¹å™¨çš„è§’è‰². æˆ‘ä»¬éƒ½çŸ¥é“Hibernateç”¨æ¥åšæŒä¹…å±‚ï¼Œå› ä¸ºå®ƒå°†JDBCåšäº†ä¸€ä¸ªè‰¯å¥½çš„å°è£…ï¼Œç¨‹åºå‘˜åœ¨ä¸æ•°æ®åº“è¿›è¡Œäº¤äº’æ—¶å¯ä»¥ä¸ç”¨ä¹¦å†™å¤§é‡çš„SQLè¯­å¥. Strutsæ˜¯ç”¨æ¥åšåº”ç”¨å±‚çš„ï¼Œä»–å®ƒè´Ÿè´£è°ƒç”¨ä¸šåŠ¡é€»è¾‘serivceå±‚. æ‰€ä»¥SSHæ¡†æ¶çš„æµç¨‹å¤§è‡´æ˜¯ï¼šJspé¡µé¢\u0026mdash;-Struts\u0026mdash;\u0026mdash;Serviceï¼ˆä¸šåŠ¡é€»è¾‘å¤„ç†ç±»ï¼‰\u0026mdash;Hibernateï¼ˆå·¦åˆ°å³ï¼‰. Strutsè´Ÿè´£æ§åˆ¶Serviceï¼ˆä¸šåŠ¡é€»è¾‘å¤„ç†ç±»ï¼‰ï¼Œä»è€Œæ§åˆ¶äº†Serviceçš„ç”Ÿå‘½å‘¨æœŸï¼Œè¿™æ ·å±‚ä¸å±‚ä¹‹é—´çš„ä¾èµ–å¾ˆå¼ºï¼Œå±äºè€¦åˆ. è¿™æ—¶ï¼Œä½¿ç”¨springæ¡†æ¶å°±èµ·åˆ°äº†æ§åˆ¶Actionå¯¹è±¡ï¼ˆStrusä¸­çš„ï¼‰å’ŒServiceç±»çš„ä½œç”¨ï¼Œä¸¤è€…ä¹‹é—´çš„å…³ç³»å°±æ¾æ•£äº†ï¼ŒSpringçš„Iocæœºåˆ¶ï¼ˆæ§åˆ¶åè½¬å’Œä¾èµ–æ³¨å…¥ï¼‰æ­£æ˜¯ç”¨åœ¨æ­¤å¤„.\nã€€Springçš„Iocï¼ˆæ§åˆ¶åè½¬å’Œä¾èµ–æ³¨å…¥ï¼‰\nã€€æ§åˆ¶åè½¬ï¼šå°±æ˜¯ç”±å®¹å™¨æ§åˆ¶ç¨‹åºä¹‹é—´çš„ï¼ˆä¾èµ–ï¼‰å…³ç³»ï¼Œè€Œéä¼ ç»Ÿå®ç°ä¸­ï¼Œç”±ç¨‹åºä»£ç ç›´æ¥æ“æ§. åº”ç”¨æœ¬èº«ä¸è´Ÿè´£ä»¥æ¥å¯¹è±¡çš„è€Œåˆ›å»ºå’Œç»´æŠ¤ï¼Œä»¥æ¥å¯¹è±¡çš„åˆ›å»ºå’Œç»´æŠ¤æ˜¯ç”±å¤–éƒ¨å®¹å™¨è´Ÿè´£çš„. è¿™æ ·æ§åˆ¶æƒå°±æœ‰åº”ç”¨è½¬åˆ°äº†å¤–éƒ¨å®¹å™¨ï¼Œæ§åˆ¶æƒçš„è½¬ç§»å°±æ˜¯æ‰€è°“åè½¬.\nã€€ä¾èµ–æ³¨å…¥ï¼šç»„ä»¶ä¹‹é—´çš„ä¾èµ–å…³ç³»ç”±å®¹å™¨åœ¨è¿è¡ŒæœŸå†³å®š ï¼Œç”±å®¹å™¨åŠ¨æ€çš„å°†æŸç§ä¾èµ–å…³ç³»æ³¨å…¥åˆ°ç»„ä»¶ä¹‹ä¸­ .\n2ã€ä¸ºä»€ä¹ˆè¦ä½¿ç”¨Springï¼ˆSpringçš„å¥½å¤„ï¼‰  é™ä½ç»„å»ºä¹‹é—´çš„è€¦åˆåº¦ï¼Œå®ç°è½¯ä»¶éš”å±‚ä¹‹é—´çš„è§£è€¦ï¼› å¯ä»¥ä½¿ç”¨å®¹å™¨æä¾›çš„ä¼—å¤šæœåŠ¡ï¼Œå¦‚ï¼šäº‹åŠ¡ç®¡ç†æœåŠ¡ã€æ¶ˆæ¯æœåŠ¡ç­‰ç­‰. å½“æˆ‘ä»¬ä½¿ç”¨å®¹å™¨ç®¡ç†æœåŠ¡æ—¶ï¼Œå¼€å‘äººå‘˜å°±ä¸åœ¨éœ€è¦æ‰‹å·¥æ§åˆ¶äº‹åŠ¡ï¼Œä¹Ÿä¸éœ€è¦å¤„ç†å¤æ‚çš„äº‹åŠ¡ä¼ æ’­ï¼› å®¹å™¨æä¾›å•ä¾‹æ¨¡å¼æ”¯æŒï¼Œå¼€å‘äººå‘˜ä¸éœ€è¦è‡ªå·±ç¼–å†™å®ç°ä»£ç ï¼› å®¹å™¨æä¾›AOPæŠ€æœ¯ï¼Œåˆ©ç”¨è¿™äº›ç±»èƒ½å¤Ÿå¤ŸåŠ å¿«åº”ç”¨çš„å¼€å‘ï¼Œå¦‚ï¼šJdbcTemplateã€HibernateTemplateï¼› Springå¯¹äºä¸»æµçš„åº”ç”¨æ¡†æ¶æä¾›äº†é›†æˆæ”¯æŒï¼Œå¦‚ï¼šé›†æˆHibernateã€JPAã€Strutsç­‰ï¼Œè¿™æ ·æ›´ä¾¿äºåº”ç”¨å¼€å‘.  è½»é‡çº§ä¸é‡é‡çº§æ¦‚å¿µçš„åŒºåˆ†\nã€€ä¸»è¦çœ‹å®ƒä½¿ç”¨äº†å¤šå°‘æœåŠ¡ï¼Œä½¿ç”¨æœåŠ¡è¶Šå¤šï¼Œå®¹å™¨ä¸ºjavaå¯¹è±¡åšçš„å·¥ä½œå°±è¶Šå¤šï¼Œå¿…ç„¶ä¼šå½±å“åˆ°åº”ç”¨çš„å‘å¸ƒæ—¶é—´æˆ–è€…è¿è¡Œæ€§èƒ½.\nã€€å¯¹äºSpringå®¹å™¨ï¼Œå®ƒæä¾›äº†å¾ˆå¤šæœåŠ¡ï¼Œä½†è¿™äº›æœåŠ¡å¹¶ä¸æ˜¯é»˜è®¤åº”ç”¨æ‰“å¼€çš„ï¼Œåº”ç”¨éœ€è¦æŸç§æœåŠ¡ï¼Œè¿˜éœ€è¦çŸ¥åä½¿ç”¨è¯¥æœåŠ¡ï¼Œå¦‚æœåº”ç”¨ä½¿ç”¨çš„æœåŠ¡å¾ˆå°‘ï¼Œå¦‚ï¼šåªæ˜¯ç”¨äº†Springçš„æ ¸å¿ƒæœåŠ¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è®¤ä¸ºæ­¤æ—¶åº”ç”¨å±äºè½»é‡çº§çš„ï¼Œå¦‚æœä½¿ç”¨äº†Springæä¾›çš„å¤§éƒ¨åˆ†æœåŠ¡ï¼Œè¿™æ—¶åº”ç”¨å±äºé‡é‡çº§çš„ï¼Œç›®å‰EJBå®¹å™¨å°±å› ä¸ºå®ƒé»˜è®¤ä¸ºåº”ç”¨æä¾›äº†EJBè§„èŒƒä¸­çš„æ‰€æœ‰åŠŸèƒ½ï¼Œæ‰€ä»¥å®ƒå±äºé‡é‡çº§çš„.\n3ã€é…ç½®springæ‰€éœ€è¦çš„jaråŒ… ã€€spring.jaræ˜¯åŒ…å«æœ‰å®Œæ•´å‘å¸ƒçš„å•ä¸ªjar åŒ…ï¼Œspring.jarä¸­åŒ…å«é™¤äº†spring-mock.jaré‡Œæ‰€åŒ…å«çš„å†…å®¹å¤–å…¶å®ƒæ‰€æœ‰jaråŒ…çš„å†…å®¹ï¼Œå› ä¸ºåªæœ‰åœ¨å¼€å‘ç¯å¢ƒä¸‹æ‰ä¼šç”¨åˆ° spring-mock.jaræ¥è¿›è¡Œè¾…åŠ©æµ‹è¯•ï¼Œæ­£å¼åº”ç”¨ç³»ç»Ÿä¸­æ˜¯ç”¨ä¸å¾—è¿™äº›ç±»çš„.\nã€€é™¤äº†spring.jaræ–‡ä»¶ï¼ŒSpringè¿˜åŒ…æ‹¬æœ‰å…¶å®ƒ13ä¸ªç‹¬ç«‹çš„jaråŒ…ï¼Œå„è‡ªåŒ…å«ç€å¯¹åº”çš„Springç»„ä»¶ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦æ¥é€‰æ‹©ç»„åˆè‡ªå·±çš„jaråŒ…ï¼Œè€Œä¸å¿…å¼•å…¥æ•´ä¸ªspring.jarçš„æ‰€æœ‰ç±»æ–‡ä»¶.\n spring-core.jarï¼šè¿™ä¸ªjaræ–‡ä»¶åŒ…å«Springæ¡†æ¶åŸºæœ¬çš„æ ¸å¿ƒå·¥å…·ç±»ï¼ŒSpringå…¶å®ƒç»„ä»¶è¦éƒ½è¦ä½¿ç”¨åˆ°è¿™ä¸ªåŒ…é‡Œçš„ç±»ï¼Œæ˜¯å…¶å®ƒç»„ä»¶çš„åŸºæœ¬æ ¸å¿ƒï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥åœ¨è‡ªå·±çš„åº”ç”¨ç³»ç»Ÿä¸­ä½¿ç”¨è¿™äº›å·¥å…·ç±». spring-beans.jarï¼šè¿™ä¸ªjaræ–‡ä»¶æ˜¯æ‰€æœ‰åº”ç”¨éƒ½è¦ç”¨åˆ°çš„ï¼Œå®ƒåŒ…å«è®¿é—®é…ç½®æ–‡ä»¶ã€åˆ›å»ºå’Œç®¡ç†beanä»¥åŠè¿›è¡ŒInversion of Control / Dependency Injectionï¼ˆIoC/DIï¼‰æ“ä½œç›¸å…³çš„æ‰€æœ‰ç±». å¦‚æœåº”ç”¨åªéœ€åŸºæœ¬çš„IoC/DIæ”¯æŒï¼Œå¼•å…¥spring-core.jaråŠspring-beans.jaræ–‡ä»¶å°±å¯ä»¥äº†. spring-aop.jarï¼šè¿™ä¸ªjaræ–‡ä»¶åŒ…å«åœ¨åº”ç”¨ä¸­ä½¿ç”¨Springçš„AOPç‰¹æ€§æ—¶æ‰€éœ€çš„ç±». ä½¿ç”¨åŸºäºAOPçš„Springç‰¹æ€§ï¼Œå¦‚å£°æ˜å‹äº‹åŠ¡ç®¡ç†ï¼ˆDeclarative Transaction Managementï¼‰ï¼Œä¹Ÿè¦åœ¨åº”ç”¨é‡ŒåŒ…å«è¿™ä¸ªjaråŒ…. spring-context.jarï¼šè¿™ä¸ªjaræ–‡ä»¶ä¸ºSpringæ ¸å¿ƒæä¾›äº†å¤§é‡æ‰©å±•. å¯ä»¥æ‰¾åˆ°ä½¿ç”¨Spring ApplicationContextç‰¹æ€§æ—¶æ‰€éœ€çš„å…¨éƒ¨ç±»ï¼ŒJDNIæ‰€éœ€çš„å…¨éƒ¨ç±»ï¼ŒUIæ–¹é¢çš„ç”¨æ¥ä¸æ¨¡æ¿ï¼ˆTemplatingï¼‰å¼•æ“å¦‚Velocityã€FreeMarkerã€JasperReportsé›†æˆçš„ç±»ï¼Œä»¥åŠæ ¡éªŒValidationæ–¹é¢çš„ç›¸å…³ç±». spring-dao.jarï¼šè¿™ä¸ªjaræ–‡ä»¶åŒ…å«Spring DAOã€Spring Transactionè¿›è¡Œæ•°æ®è®¿é—®çš„æ‰€æœ‰ç±». ä¸ºäº†ä½¿ç”¨å£°æ˜å‹äº‹åŠ¡æ”¯æŒï¼Œè¿˜éœ€åœ¨è‡ªå·±çš„åº”ç”¨é‡ŒåŒ…å«spring-aop.jar. spring-hibernate.jarï¼šè¿™ä¸ªjaræ–‡ä»¶åŒ…å«Springå¯¹Hibernate 2åŠHibernate 3è¿›è¡Œå°è£…çš„æ‰€æœ‰ç±». spring-jdbc.jarï¼šè¿™ä¸ªjaræ–‡ä»¶åŒ…å«å¯¹Springå¯¹JDBCæ•°æ®è®¿é—®è¿›è¡Œå°è£…çš„æ‰€æœ‰ç±». spring-orm.jarï¼šè¿™ä¸ªjaræ–‡ä»¶åŒ…å«Springå¯¹DAOç‰¹æ€§é›†è¿›è¡Œäº†æ‰©å±•ï¼Œä½¿å…¶æ”¯æŒ iBATISã€JDOã€OJBã€TopLinkï¼Œå› ä¸ºHibernateå·²ç»ç‹¬ç«‹æˆåŒ…äº†ï¼Œç°åœ¨ä¸åŒ…å«åœ¨è¿™ä¸ªåŒ…é‡Œäº†. è¿™ä¸ªjaræ–‡ä»¶é‡Œå¤§éƒ¨åˆ†çš„ç±»éƒ½è¦ä¾èµ–spring-dao.jaré‡Œçš„ç±»ï¼Œç”¨è¿™ä¸ªåŒ…æ—¶ä½ éœ€è¦åŒæ—¶åŒ…å«spring-dao.jaråŒ…. spring-remoting.jarï¼šè¿™ä¸ªjaræ–‡ä»¶åŒ…å«æ”¯æŒEJBã€JMSã€è¿œç¨‹è°ƒç”¨Remotingï¼ˆRMIã€Hessianã€Burlapã€Http Invokerã€JAX-RPCï¼‰æ–¹é¢çš„ç±». spring-support.jarï¼šè¿™ä¸ªjaræ–‡ä»¶åŒ…å«æ”¯æŒç¼“å­˜Cacheï¼ˆehcacheï¼‰ã€JCAã€JMXã€é‚®ä»¶æœåŠ¡ï¼ˆJava Mailã€COS Mailï¼‰ã€ä»»åŠ¡è®¡åˆ’Schedulingï¼ˆTimerã€Quartzï¼‰æ–¹é¢çš„ç±». spring-web.jarï¼šè¿™ä¸ªjaræ–‡ä»¶åŒ…å«Webåº”ç”¨å¼€å‘æ—¶ï¼Œç”¨åˆ°Springæ¡†æ¶æ—¶æ‰€éœ€çš„æ ¸å¿ƒç±»ï¼ŒåŒ…æ‹¬è‡ªåŠ¨è½½å…¥WebApplicationContextç‰¹æ€§çš„ç±»ã€Strutsä¸JSFé›†æˆç±»ã€æ–‡ä»¶ä¸Šä¼ çš„æ”¯æŒç±»ã€Filterç±»å’Œå¤§é‡å·¥å…·è¾…åŠ©ç±». spring-webmvc.jarï¼šè¿™ä¸ªjaræ–‡ä»¶åŒ…å«Spring MVCæ¡†æ¶ç›¸å…³çš„æ‰€æœ‰ç±». åŒ…å«å›½é™…åŒ–ã€æ ‡ç­¾ã€Themeã€è§†å›¾å±•ç°çš„FreeMarkerã€JasperReportsã€Tilesã€Velocityã€XSLTç›¸å…³ç±». å½“ç„¶ï¼Œå¦‚æœä½ çš„åº”ç”¨ä½¿ç”¨äº†ç‹¬ç«‹çš„MVCæ¡†æ¶ï¼Œåˆ™æ— éœ€è¿™ä¸ªJARæ–‡ä»¶é‡Œçš„ä»»ä½•ç±». spring-mock.jarï¼šè¿™ä¸ªjaræ–‡ä»¶åŒ…å«Springä¸€æ•´å¥—mockç±»æ¥è¾…åŠ©åº”ç”¨çš„æµ‹è¯•. Springæµ‹è¯•å¥—ä»¶ä½¿ç”¨äº†å…¶ä¸­å¤§é‡mockç±»ï¼Œè¿™æ ·æµ‹è¯•å°±æ›´åŠ ç®€å•. æ¨¡æ‹ŸHttpServletRequestå’ŒHttpServletResponseç±»åœ¨Webåº”ç”¨å•å…ƒæµ‹è¯•æ˜¯å¾ˆæ–¹ä¾¿çš„.  å¦‚ä½•é€‰æ‹©è¿™äº›å‘å¸ƒåŒ…ï¼Œå†³å®šé€‰ç”¨å“ªäº›å‘å¸ƒåŒ…å…¶å®ç›¸å½“ç®€å•.\nã€€å¦‚æœä½ æ­£åœ¨æ„å»ºWebåº”ç”¨å¹¶å°†å…¨ç¨‹ä½¿ç”¨Springï¼Œé‚£ä¹ˆæœ€å¥½å°±ä½¿ç”¨å•ä¸ªå…¨éƒ¨çš„spring.jaræ–‡ä»¶ï¼› å¦‚æœä½ çš„åº”ç”¨ä»…ä»…ç”¨åˆ°ç®€å•çš„Inversion of Control / Dependency Injectionï¼ˆIoC/DIï¼‰å®¹å™¨ï¼Œé‚£ä¹ˆåªéœ€spring-core.jarä¸spring-beans.jarå³å¯ï¼›\nã€€å¦‚æœä½ å¯¹å‘å¸ƒçš„å¤§å°è¦æ±‚å¾ˆé«˜ï¼Œé‚£ä¹ˆå°±å¾—ç²¾æŒ‘ç»†é€‰äº†ï¼Œåªå–åŒ…å«è‡ªå·±æ‰€éœ€ç‰¹æ€§çš„jaræ–‡ä»¶äº†. é‡‡ç”¨ç‹¬ç«‹çš„å‘å¸ƒåŒ…ä½ å¯ä»¥é¿å…åŒ…å«è‡ªå·±çš„åº”ç”¨ä¸éœ€è¦çš„å…¨éƒ¨ç±». å½“ç„¶ä½ å¯ä»¥é‡‡ç”¨å…¶å®ƒçš„ä¸€äº›å·¥å…·æ¥è®¾æ³•ä»¤æ•´ä¸ªåº”ç”¨åŒ…å˜å°ï¼ŒèŠ‚çœç©ºé—´çš„é‡ç‚¹åœ¨äºå‡†ç¡®åœ°æ‰¾å‡ºè‡ªå·±æ‰€éœ€çš„Springä¾èµ–ç±»ï¼Œç„¶ååˆå¹¶æ‰€éœ€çš„ç±»ä¸åŒ…å°±å¯ä»¥äº†.\nEclispeæœ‰ä¸ªæ’ä»¶å«ClassPath Helperå¯ä»¥å¸®ä½ æ‰¾æ‰¾æ‰€ä¾èµ–çš„ç±».\n4ã€SpringåŒ…ä¾èµ–è¯´æ˜:  spring-core.jaréœ€commons-collections.jarï¼Œspring-core.jaræ˜¯ä»¥ä¸‹å…¶å®ƒå„ä¸ªçš„åŸºæœ¬. spring-beans.jaréœ€spring-core.jarï¼Œcglib-nodep-2.1_3.jar spring-aop.jaréœ€spring-core.jarï¼Œspring-beans.jarï¼Œcglib-nodep-2.1_3.jarï¼Œaopalliance.jar spring-context.jaréœ€spring-core.jarï¼Œspring-beans.jarï¼Œspring-aop.jarï¼Œcommons-collections.jarï¼Œaopalliance.jar spring-dao.jaréœ€spring-core.jarï¼Œspring-beans.jarï¼Œspring-aop.jarï¼Œspring-context.jar spring-jdbc.jaréœ€spring-core.jarï¼Œspring-beans.jarï¼Œspring-dao.jar spring-web.jaréœ€spring-core.jarï¼Œspring-beans.jarï¼Œspring-context.jar spring-webmvc.jaréœ€spring-core.jar/spring-beans.jar/spring-context.jar/spring-web.jar spring-hibernate.jaréœ€spring-core.jarï¼Œspring- beans.jarï¼Œspring-aop.jarï¼Œspring-dao.jarï¼Œspring-jdbc.jarï¼Œspring- orm.jarï¼Œspring-web.jarï¼Œspring-webmvc.jar spring-orm.jaréœ€spring-core.jarï¼Œspring-beans.jarï¼Œspring-aop.jarï¼Œspring-dao.jarï¼Œspring-jdbc.jarï¼Œspring-web.jarï¼Œspring-webmvc.jar spring-remoting.jaréœ€spring-core.jarï¼Œspring-beans.jarï¼Œspring- aop.jarï¼Œspring-dao.jarï¼Œspring-context.jarï¼Œspring-web.jarï¼Œspring- webmvc.jar spring-support.jaréœ€spring-core.jarï¼Œspring-beans.jarï¼Œspring-aop.jarï¼Œspring-dao.jarï¼Œspring-context.jarï¼Œspring-jdbc.jar spring-mock.jaréœ€spring-core.jarï¼Œspring-beans.jarï¼Œspring-dao.jarï¼Œspring-context.jarï¼Œspring-jdbc.jar  ä¸€ã€åªæ˜¯ä½¿ç”¨springæ¡†æ¶\n  dist\\spring.jar\n  lib\\jakarta-commons\\commons-logging.jar\n  å¦‚æœä½¿ç”¨åˆ°äº†åˆ‡é¢ç¼–ç¨‹(AOP)ï¼Œè¿˜éœ€è¦ä¸‹åˆ—jaræ–‡ä»¶\n  lib\\aspectj\\aspectjweaver.jsr å’Œ aspectjrt.jar\n  lib\\cglib\\cglib-nodep-2.1_3.jar\n    å¦‚æœä½¿ç”¨äº†JSR-250ä¸­çš„æ³¨è§£å¦‚@Resource/@PostConstruct/@PreDestroy,è¿˜éœ€ä¸‹åˆ—jaræ–‡ä»¶\n lib\\j2ee\\common-annotations.jar    äºŒã€åªæ˜¯ä½¿ç”¨springæ¡†æ¶è‹¥ä½¿ç”¨æ³¨è§£æ–¹å¼\nã€€åªè¦åŠ ä¸€äº›å‘½åç©ºé—´å’Œå¼€å¯è§£æå™¨,å¹¶ä¸”@Resourceéœ€è¦åŠ lib\\j2ee\\common-annotations.jar\n\u0026lt;context:annotation-config/\u0026gt;æ‰“å¼€å¤„ç†å™¨\nä¸‰ã€è¦è‡ªåŠ¨æ‰«æ\nã€€åªè¦å¼€å¯è§£æå™¨å’Œä¸€äº›å‘½åç©ºé—´ \u0026lt;context:component-scan base-package=\u0026quot;\u0026quot;/\u0026gt;\nå››ã€springæ¡†æ¶é‡‡ç”¨aopç¼–ç¨‹\néœ€è¦å¯¼å…¥ä¸€äº›å‘½åç©ºé—´ xmlns:aop\u0026hellip;\u0026hellip;. \u0026lt;aop:aspectj-autoproxy/\u0026gt;å¼€å¯è§£æå™¨ å¦‚æœä½¿ç”¨åˆ°äº†åˆ‡é¢ç¼–ç¨‹(AOP)ï¼Œè¿˜éœ€è¦ä¸‹åˆ—jaræ–‡ä»¶\n lib\\aspectj\\aspectjweaver.jsr å’Œ aspectjrt.jar lib\\cglib\\cglib-nodep-2.1_3.jar  äº”ã€spring+Jdbcå¼€å‘\nã€€éœ€è¦æ•°æ®æºæ–‡ä»¶ lib\\jakarta-commons\\commons-pool.jarã€lib\\jakarta-commons\\commons-dbcp.jar\n springæ–‡ä»¶ ï¼š dist\\spring.jarã€ lib\\jakarta-commons\\commons-logging.jar jdbcé©±åŠ¨æ–‡ä»¶ mysql**** sql*** ï¼š å¯¼å…¥txå‘½åç©ºé—´ \u0026lt;tx:annotation-driven transaction-manager=\u0026quot;\u0026quot;/\u0026gt; å¯¹äº‹åŠ¡æ³¨è§£çš„è§£æå™¨  å…­ã€spring2.5+hibernate3.3+struts1.3\n hibernateæ ¸å¿ƒåŒ…   hibernate3.jar lib\\required*.jar lib\\optional\\ehcache-1.2.3.jar (äºŒçº§ç¼“å­˜æ–‡ä»¶) hibernateæ³¨è§£åŒ… l+ ib\\test\\slf4j-log4j12.jar  springåŒ…   dist\\spring.jar lib\\jakarta-commons\\commons-logging.jar å’Œcommons-pool.jarã€commons-dbcp.jar(åä¸ºæ•°æ®æºæ–‡ä»¶) dist\\modules\\spring-webmvc-struts.jar (ä¸struts1çš„é›†æˆ) lib\\aspectj\\aspectjweaver.jsr å’Œ aspectjrt.jar (Aopæ–‡ä»¶) lib\\cglib\\cglib-nodep-2.1_3.jar (Aopæ–‡ä»¶) lib\\j2ee\\common-annotations.jar (æ³¨è§£æ–‡ä»¶) lib\\log4j\\log4j-1.2.15.jar  sturs1.3.8  ã€€å»ºè®®å°†jstl-1.0.2.jarå’Œstandard-1.0.2.jaræ–‡ä»¶æ›´æ¢ä¸º1.1ç‰ˆæœ¬ï¼Œæ­¤æ—¶JSTLæ–‡ä»¶ï¼è¿˜æœ‰springå·²å­˜åœ¨antlr-2.7.6.jaræ–‡ä»¶æ‰€ä»¥å°†strutsä¸­çš„antlr-2.7.6.jaræ–‡ä»¶åˆ é™¤ä»¥å…å†²çªï¼\nä¸ƒã€spring2.5+hibernate3.3+struts2æ•´åˆå¼€å‘\nã€€struts2æ–‡ä»¶libé‡Œé¢æ‰€æœ‰ä¸å¸¦-pluginç»“å°¾çš„jaræ–‡ä»¶ï¼Œä½†é™¤äº†struts2-spring-plugin-2.0.11.1.jar.\n5ã€å®ä¾‹åŒ–Springå®¹å™¨ 5.1ã€å®ä¾‹åŒ–Springå®¹å™¨çš„æ–¹å¼æœ‰ä¸¤ç§ï¼š æ–¹æ³•ä¸€ï¼š åœ¨ç±»è·¯å¾„ä¸‹å¯»æ‰¾é…ç½®æ–‡ä»¶æ¥å®ä¾‹åŒ–å®¹å™¨\nApplicationContext ctx = new ClassPathXmlApplicationContext(\u0026quot;beans.xml\u0026quot;); //1.åˆ›å»ºSpringçš„IOCå®¹å™¨å¯¹è±¡ApplicationContextä»£è¡¨IOCå®¹å™¨ // ClassPathXmlApplicationContext:ç±»è·¯å¾„ä¸‹çš„XMLæ ¼å¼çš„é…ç½®æ–‡ä»¶ ApplicationContext ctx = new ClassPathXmlApplicationContext(\u0026quot;applicationContext.xml\u0026quot;); //2.ä»IOCå®¹å™¨å¯¹è±¡ä¸­è·å–Beanå®ä¾‹ HelloWorld helloWorld2 = (HelloWorld) ctx.getBean(\u0026quot;helloworld\u0026quot;); //3.è°ƒç”¨helloæ–¹æ³• helloWorld2.hello();  æ–¹æ³•äºŒï¼š åœ¨æ–‡ä»¶å†…ç³»ç»Ÿè·¯å¾„ä¸‹å¯»æ‰¾é…ç½®æ–‡ä»¶æ¥å®ç°å®¹å™¨ï¼š\nApplicationContext ctx = new FileSystemXmlApplicationContext(\u0026quot;beans.xml\u0026quot;);  Springé…ç½®æ–‡ä»¶å¯ä»¥æŒ‡å®šå¤šä¸ªï¼Œå¯ä»¥é€šè¿‡Stringæ•°ç»„ä¼ å…¥. é…ç½®Springç¯å¢ƒ\n\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot;?\u0026gt; \u0026lt;beans xmlns=\u0026quot;http://www.springframework.org/schema/beans\u0026quot; xmlns:xsi=\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot; xmlns:context=\u0026quot;http://www.springframework.org/schema/context\u0026quot; xsi:schemaLocation=\u0026quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd\u0026quot;\u0026gt; \u0026lt;/beans\u0026gt;  æµ‹è¯•æ˜¯å¦æ­å»ºæˆåŠŸ:é¡¹ç›®å³é”®æ–°å»ºJunit Test Case. 6ã€å¦‚ä½•å°†ä¸šåŠ¡beanäº¤ç»™Springç®¡ç† ã€€åœ¨Springé…ç½®ä¸­æ·»åŠ \u0026lt;bean id=â€åç§°â€ name=â€åç§°â€ class=â€â€\u0026gt;\u0026lt;/bean\u0026gt;ï¼Œæ­¤æ—¶beanå°±å¯ä»¥ç”±Springå®¹å™¨å¸®åŠ©åˆ›å»ºå’Œç»´æŠ¤ï¼Œå½“æˆ‘ä»¬è¦ç”¨åˆ°beançš„æ—¶å€™åªéœ€è¦ä»Springå®¹å™¨ä¸­è·å–å³å¯ï¼Œè·å–çš„æ—¶å€™å¯ä»¥ç”¨ApplicationContext.getBean(id);ï¼ˆè¿”å›å€¼ä¸º Objectï¼‰ï¼Œå¯ä»¥é€šè¿‡beançš„æ¥å£å¯¹å…¶è¿›è¡Œå¼•ç”¨ï¼Œä¹‹åå³å¯è°ƒç”¨å…¶æ–¹æ³•.\næ³¨æ„ï¼šidä¸­ä¸èƒ½åŒ…å«ç‰¹æ®Šå­—ç¬¦ä¾‹å¦‚â€œ/â€ï¼Œè€Œnameä¸­å¯ä»¥åŒ…å«. å¦‚æœåŒ…å«ç‰¹æ®Šå­—ç¬¦åˆ™ç”¨name=â€â€ï¼›å…¶ä»–å¯ä»¥ç”¨id=â€â€.\nå®ä¾‹ï¼šé¦–å…ˆåˆ›å»ºä¸€ä¸ªä¸šåŠ¡bean\u0026ndash;PersonServiceBeanï¼Œå»ºè®®ä½¿ç”¨é¢å‘æ¥å£ç¼–ç¨‹ï¼ˆè¦å®ç°è½¯ä»¶ä¹‹é—´çš„è§£è€¦ï¼‰ï¼Œæ‰€ä»¥å¯ä»¥æŠ½å–æ¥å£ï¼Œç„¶åäº¤ç»™Springç®¡ç†. 7ã€ä¸‰ç§å®ä¾‹åŒ–beançš„æ–¹å¼ï¼š 7.1ã€å®ç”¨ç±»æ„é€ å™¨å®ä¾‹åŒ– \u0026lt;bean id=\u0026quot;personService\u0026quot; class=\u0026quot;com.haibao.service.impl.PersonServiceBean\u0026quot;/\u0026gt; \u0026lt;!-- é…ç½®bean class:beançš„å…¨ç±»åï¼Œé€šè¿‡åå°„çš„æ–¹å¼åœ¨IOCå®¹å™¨ä¸­åˆ›å»ºBeanï¼Œæ‰€ä»¥Beanä¸­å¿…é¡»æœ‰æ— å‚æ„é€ å™¨ id:è¡¨ç¤ºå®¹å™¨ä¸­çš„beanå”¯ä¸€ --\u0026gt;  7.2ã€ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•å®ä¾‹åŒ– \u0026lt;bean id=\u0026quot;personService2\u0026quot; class=\u0026quot;com.haibao.service.impl.PersonServiceFactory\u0026quot; factory-method=\u0026quot;createPersonService\u0026quot;/\u0026gt;  public class PersonServiceFactory { public static PersonServiceBean createPersonService() { return new PersonServiceBean(); } }  7.3ã€ä½¿ç”¨å®ä¾‹åŒ–å·¥å‚å®ä¾‹åŒ– \u0026lt;bean id=\u0026quot;personServiceFactory\u0026quot; class=\u0026quot;com.haibao.service.impl.PersonServiceFactory\u0026quot;/\u0026gt; \u0026lt;bean id=\u0026quot;personService3\u0026quot; factory-bean=\u0026quot;personServiceFactory\u0026quot; factory-method=\u0026quot;createPersonService2\u0026quot;/\u0026gt; public class PersonServiceFactory { public PersonServiceBean createPersonService() { return new PersonServiceBean(); } }  8ã€Beançš„ä½œç”¨åŸŸåŠbeançš„ç”Ÿå‘½å‘¨æœŸ ã€€.sigletonï¼ˆå•ä¾‹æ¨¡å¼ï¼ŒSpringå®¹å™¨å¯åŠ¨çš„æ—¶å€™beanå°±è¢«å®ä¾‹åŒ–ï¼‰ åœ¨æ¯ä¸ªSpring IoCå®¹å™¨ä¸­ä¸€ä¸ªbeanå®šä¹‰åªæœ‰ä¸€ä¸ªå¯¹è±¡å®ä¾‹. é»˜è®¤æƒ…å†µä¸‹ä¼šåœ¨å®¹å™¨å¯åŠ¨æ—¶åˆå§‹åŒ–beanï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šBeanèŠ‚ç‚¹çš„laz-init=â€trueâ€æ¥å»¶è¿Ÿåˆå§‹åŒ–beanï¼Œè¿™æ—¶å€™ï¼Œåªæœ‰ç¬¬ä¸€æ¬¡è·å–beanæ‰ä¼šåˆå§‹åŒ–bean. ä¾‹å¦‚ï¼š\u0026lt;bean id=â€XXXâ€ class=â€XXXâ€ lazy-init=â€œtrueâ€/\u0026gt; , ï¼ˆè®¾ç½®lazy-init=â€œtrueâ€åSpringå®¹å™¨å¯åŠ¨çš„æ—¶å€™beanä¸ä¼šè¢«å®ä¾‹åŒ–ï¼‰.å¦‚æœæƒ³æ‰€æœ‰çš„åº”ç”¨éƒ½åº”ç”¨å»¶è¿Ÿåˆå§‹åŒ–ï¼Œå¯ä»¥åœ¨æ ¹èŠ‚ç‚¹beansè®¾ç½®default-lazy-init=â€trueâ€;å³ï¼š\u0026lt;bean id=â€XXXâ€ class=â€XXXâ€ default-lazy-init=â€œtrueâ€/\u0026gt;,.prototype(è°ƒç”¨getBean()æ–¹æ³•çš„æ—¶å€™beanæ‰ä¼šè¢«å®ä¾‹åŒ–).æ¯æ¬¡ä»å®¹å™¨è·å–beanéƒ½æ˜¯æ–°å¯¹è±¡. \u0026lt;bean id=â€XXXâ€ class=â€XXXâ€ scope=â€ prototypeâ€/\u0026gt;.\nåˆå§‹åŒ–ï¼šåˆå§‹åŒ–æ–¹æ³•å¯ä»¥åœ¨beançš„é…ç½®ä¸­ç”¨init-method=\u0026quot;\u0026quot;æ–¹æ³•è°ƒç”¨åˆå§‹åŒ–å‡½æ•°.\né”€æ¯ï¼šé»˜è®¤æƒ…å†µä¸‹åªæœ‰Springå®¹å™¨åŒ—æ ¡å…³é—­æ‰ä¼šé”€æ¯. å¯ä»¥åœ¨beançš„é…ç½®ä¸­ç”¨destroy-method=\u0026quot;\u0026quot;æ–¹æ³•é”€æ¯.\n9ã€ä¾èµ–æ³¨å…¥å¯¹è±¡ï¼š ã€€æ‰€è°“ä¾èµ–æ³¨å…¥æ˜¯æŒ‡ï¼šåœ¨è¿è¡ŒæœŸï¼Œå¤–éƒ¨å®¹å™¨åŠ¨æ€çš„å°†ä»¥æ¥å¯¹è±¡æ³¨å…¥åˆ°ç»„ä»¶.\nåŸºæœ¬ç±»å‹å¯¹è±¡æ³¨å…¥ï¼š\n\u0026lt;bean id=\u0026quot;orderService\u0026quot; class=\u0026quot;orderServiceBean\u0026quot;\u0026gt; //æ„é€ å™¨æ³¨å…¥ \u0026lt;constructor-arg index=\u0026quot;0\u0026quot; type=\u0026quot;java.lang.String\u0026quot; value=\u0026quot;XXX\u0026quot;\u0026gt; //å±æ€§setteræ–¹æ³•æ³¨å…¥ \u0026lt;property name=\u0026quot;name\u0026quot; value=\u0026quot;value\u0026quot;/\u0026gt; \u0026lt;/bean\u0026gt;  æ–¹å¼ä¸€ï¼š\n\u0026lt;bean id=\u0026quot;orderDao\u0026quot; class=\u0026quot;PersonDaoBean\u0026quot;/\u0026gt; \u0026lt;bean id=\u0026quot;orderService\u0026quot; class=\u0026quot;PersonServiceBean\u0026quot;\u0026gt; \u0026lt;property name=\u0026quot;orderDao\u0026quot; ref=\u0026quot;orderDao\u0026quot;\u0026gt;\u0026lt;/property\u0026gt; \u0026lt;/bean\u0026gt; // refï¼šæŒ‡å‘å…¶ä»–bean  æ–¹å¼äºŒï¼š(ä½¿ç”¨å†…éƒ¨beanï¼Œä½†è¯¥beanä¸èƒ½è¢«å…¶ä»–beanä½¿ç”¨)\n\u0026lt;bean id=\u0026quot;orderService\u0026quot; class=\u0026quot;PersonServiceBean\u0026quot;\u0026gt; \u0026lt;property name=\u0026quot;orderDao\u0026quot; ref=\u0026quot;orderDao\u0026quot;\u0026gt; \u0026lt;bean class=\u0026quot; orderDao\u0026quot;/\u0026gt; \u0026lt;/property\u0026gt; \u0026lt;/bean\u0026gt;  å½“æˆ‘ä»¬æŠŠä¾èµ–å¯¹è±¡æ³¨å…¥äº¤ç»™å¤–éƒ¨å®¹å™¨è´Ÿè´£åˆ›å»ºï¼ŒnamePersonServiceBeanç±»å¯ä»¥æ”¹æˆï¼š\npublic class PersonServiceBean implements PersonService { private PersonDao personDao; public PersonDao getPerson(){ return personDao; } public void getPersonDao(PersonDao personDao){ this.personDao = personDao; } public void save(){ personDao.add(); } } public class PersonDaoBean implements PersonDao{ public void add(){ System.out.println(\u0026quot;add()æ–¹æ³•\u0026quot;); } }  beans.xmlé…ç½®ä¸­ï¼š\n\u0026lt;bean id=\u0026quot;personDaoname\u0026quot; class=\u0026quot;PersonDaoBean\u0026quot;/\u0026gt; \u0026lt;bean id=\u0026quot;personService\u0026quot; class=\u0026quot;PersonServiceBean\u0026quot;\u0026gt; \u0026lt;property name=\u0026quot;personDao\u0026quot; ref=\u0026quot;personDaoname \u0026quot;\u0026gt;\u0026lt;/property\u0026gt; \u0026lt;/bean\u0026gt;   å±æ€§setteræ–¹æ³•æ³¨å…¥  å¯¹åŸºæœ¬ç±»å‹è¿›è¡Œæ³¨å…¥ï¼š\n\u0026lt;property name=\u0026quot;name\u0026quot; value=\u0026quot;value\u0026quot;/\u0026gt;  é›†åˆç±»å‹çš„è£…é…\npublic calss orderServiceBean{ private Set\u0026lt;String\u0026gt; sets = new HashSet\u0026lt;Striing\u0026gt;(); private List\u0026lt;String\u0026gt; lists = new ArrayList\u0026lt;Striing\u0026gt;(); private Properties properties = new Properties (); private Map\u0026lt;String,String\u0026gt; maps = new HashMap\u0026lt;String,Striing\u0026gt;(); // ä¸€å®šè¦ç”Ÿæˆgetterã€setteræ–¹æ³• } \u0026lt;property name=\u0026quot;sets\u0026quot;\u0026gt; \u0026lt;set\u0026gt; \u0026lt;value\u0026gt;å€¼1\u0026lt;/value\u0026gt; \u0026lt;value\u0026gt;å€¼2\u0026lt;/value\u0026gt; \u0026lt;value\u0026gt;å€¼3\u0026lt;/value\u0026gt;. \u0026lt;/set\u0026gt; \u0026lt;property/\u0026gt; \u0026lt;property name=\u0026quot;lists\u0026quot;\u0026gt; \u0026lt;list\u0026gt; \u0026lt;value\u0026gt;å€¼1\u0026lt;/value\u0026gt; \u0026lt;value\u0026gt;å€¼2\u0026lt;/value\u0026gt; \u0026lt;value\u0026gt;å€¼3\u0026lt;/value\u0026gt; \u0026lt;/list\u0026gt; \u0026lt;property/\u0026gt; \u0026lt;property name=\u0026quot;properties\u0026quot;\u0026gt; \u0026lt;props\u0026gt; \u0026lt;prop key=\u0026quot;key1\u0026quot;\u0026gt;å€¼1\u0026lt;/prop\u0026gt; \u0026lt;prop key=\u0026quot;key2\u0026quot;\u0026gt;å€¼2\u0026lt;/prop\u0026gt; \u0026lt;prop key=\u0026quot;key3\u0026quot;\u0026gt;å€¼3\u0026lt;/prop\u0026gt;. \u0026lt;/props\u0026gt; \u0026lt;property/\u0026gt; \u0026lt;property name=\u0026quot;maps\u0026quot;\u0026gt; \u0026lt;map\u0026gt; \u0026lt;entry key=\u0026quot;key1\u0026quot; value=\u0026quot;1\u0026quot;/\u0026gt; \u0026lt;entry key=\u0026quot;key2\u0026quot; value=\u0026quot;2\u0026quot;/\u0026gt; \u0026lt;entry key=\u0026quot;key3\u0026quot; value=\u0026quot;3\u0026quot;/\u0026gt;. \u0026lt;/map\u0026gt; \u0026lt;property/\u0026gt;   æ„é€ å™¨å‚æ•°æ³¨å…¥  \u0026lt;constructor-arg index=\u0026quot;0\u0026quot; type=\u0026quot;java.lang.String\u0026quot; value=\u0026quot;XXX\u0026quot;/\u0026gt; \u0026lt;constructor-arg index=\u0026quot;1\u0026quot; type=\u0026quot;java.lang.String\u0026quot; value=\u0026quot;XXX\u0026quot;/\u0026gt;   ä½¿ç”¨Fieldæ³¨å…¥ï¼ˆç”¨äºæ³¨è§£æ–¹å¼ï¼‰ æ³¨å…¥ä»¥æ¥å¯¹è±¡å¯ä»¥é‡‡ç”¨æ‰‹å·¥è£…é…æˆ–è‡ªåŠ¨è£…é…ï¼Œåœ¨å®é™…åº”ç”¨ä¸­å»ºè®®ä½¿ç”¨æ‰‹å·¥è£…é…ï¼Œå› ä¸ºè‡ªåŠ¨è£…é…ä¼šäº§ç”ŸæœªçŸ¥æƒ…å†µï¼Œå¼€å‘äººå‘˜æ— æ³•é¢„è§æœ€ç»ˆç»“æœ.  9.1ã€ä¾èµ–æ³¨å…¥\u0026mdash;æ‰‹å·¥è£…é… æ‰‹å·¥è£…é…ä¾èµ–å¯¹è±¡ï¼Œåœ¨è¿™ç§æ–¹å¼ä¸­æœ‰ä¸¤ç§å˜æˆæ–¹å¼\n åœ¨xmlé…ç½®æ–‡ä»¶ä¸­é€šè¿‡beanèŠ‚ç‚¹ä¸‹é…ç½®. å¦‚ï¼š  \u0026lt;bean id=\u0026quot;orderDao\u0026quot; class=\u0026quot;PersonDaoBean\u0026quot;/\u0026gt; \u0026lt;bean id=\u0026quot;orderService\u0026quot; class=\u0026quot;PersonServiceBean\u0026quot;\u0026gt; \u0026lt;property name=\u0026quot;orderDao\u0026quot; ref=\u0026quot;orderDao\u0026quot;\u0026gt;\u0026lt;/property\u0026gt; \u0026lt;/bean\u0026gt;  åœ¨javaä»£ç ä¸­ä½¿ç”¨@Autowireæˆ–@Resourceæ³¨è§£æ–¹å¼è¿›è¡Œè£…é…. ä½†æˆ‘ä»¬éœ€è¦åœ¨xmlé…ç½®æ–‡ä»¶ä¸­é…ç½®ä»¥ä¸‹ä¿¡æ¯ï¼š  \u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot;?\u0026gt; \u0026lt;beans xmlns=\u0026quot;http://www.springframework.org/schema/beans\u0026quot;\txmlns:xsi=\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot; xmlns:context=http://www.springframework.org/schema/context xsi:schemaLocation=\u0026quot;http://www. springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd\u0026quot;\u0026gt; \u0026lt;context:annotation-config/\u0026gt; \u0026lt;/beans\u0026gt;  è¿™ä¸ªé…ç½®ä¹Ÿæ˜¯æ³¨å†Œäº†å¤šä¸ªå¯¹æ³¨é‡Šè¿›è¡Œè§£æå¤„ç†çš„å¤„ç†å™¨ï¼š\n AutwiredAnnotationBeanProcessor CommonAnnotationBeanPostProcessor PersistenceAnnotationBeanPostProcessor RequiredAnnotationBeanProcessor  æ³¨ï¼š@Resourceæ³¨è§£åœ¨Springå®‰è£…ç›®å½•ä¸‹çš„lib\\j2ee\\common-annotation.jar åœ¨javaä»£ç ä¸­ä½¿ç”¨@Autowireæˆ–@Resourceæ³¨è§£æ–¹å¼è¿›è¡Œè£…é…ï¼Œè¿™ä¸¤ä¸ªæ³¨è§£çš„åŒºåˆ«æ˜¯ï¼š@Autowireé»˜è®¤æŒ‰ç±»å‹è£…é…ï¼Œ@Resourceï¼Œé»˜è®¤æŒ‰åç§°è£…é…ï¼Œå½“æ‰¾ä¸åˆ°ä¸åç§°åŒ¹é…çš„beanæ‰ä¼šæŒ‰ç±»å‹è£…é….\n@Autowire private PersonDao personDao;//ç”¨äºå­—æ®µä¸Š @Autowire public void setOrderDao(PersonDao personDao){ //ç”¨äºå±æ€§çš„setteræ–¹æ³•ä¸Š this.orderDao = orderDaoï¼› }  @Autowireæ³¨è§£æ˜¯æŒ‰ç±»å‹è£…é…ä¾èµ–å¯¹è±¡ï¼Œé»˜è®¤æƒ…å†µä¸‹ä»–è¦æ±‚å¯¹è±¡å¿…é¡»å­˜åœ¨ï¼Œå¦‚æœå…è®¸ä¸ºnullå€¼ï¼Œå¯ä»¥è®¾ç½®å®ƒçš„requiredå±æ€§ä¸ºfalse. å¦‚æœæƒ³ä½¿ç”¨æŒ‰åç§°è£…é…ï¼Œå¯ä»¥ç»“åˆ@Qualifieræ³¨è§£ä¸€èµ·ä½¿ç”¨. å¦‚ä¸‹ï¼š\n@Autowire @Qualifier(â€œpersonDaoBeanâ€) private PersonDao personDaoï¼›  @Resourceæ³¨è§£å’Œ@Autowireä¸€æ ·ï¼Œä¹Ÿå¯ä»¥æ ‡æ³¨åœ¨å­—æ®µæˆ–å±æ€§çš„setteræ–¹æ³•ä¸Šï¼Œä½†ä»–é»˜è®¤æŒ‰åç§°è£…é…. åç§°å¯ä»¥é€šè¿‡@Resourceçš„nameå±æ€§æŒ‡å®šï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šnameå±æ€§ï¼Œå½“æ³¨è§£æ ‡æ³¨åœ¨å­—æ®µä¸Šï¼Œå³é»˜è®¤å–å­—æ®µçš„åç§°ä½œä¸ºbeanåç§°å¯»æ‰¾ä¾èµ–å¯¹è±¡ï¼Œå½“æ³¨è§£æ ‡æ³¨åœ¨å±æ€§çš„setteræ–¹æ³•ä¸Šï¼Œå³é»˜è®¤å–å±æ€§åä½œä¸ºbeanåç§°å¯»æ‰¾ä¾èµ–å¯¹è±¡.\n@Resource(name=â€personDaoBeanâ€) private PersonDao personDao;//ç”¨äºå­—æ®µä¸Š  æ³¨æ„ï¼šå¦‚æœæ²¡æœ‰æŒ‡å®šnameå±æ€§ï¼Œå¹¶ä¸”æŒ‰ç…§é»˜è®¤åç§°ä»ç„¶æ‰¾ä¸åˆ°ä¾èµ–å¯¹è±¡æ—¶ï¼Œ@Resourceæ³¨è§£ä¼šå›é€€åˆ°å®‰ç±»å‹è£…é…ï¼Œä½†ä¸€æ—¦æŒ‡å®šäº†nameå±æ€§ï¼Œå°±åªèƒ½æŒ‰åç§°è£…é…äº†.\n10ã€AOP\u0026ndash;ä»£ç†å¯¹è±¡ï¼ˆä¸»è¦ç”¨åœ¨æƒé™ï¼‰  ç¯ç»•é€šçŸ¥ å‰ç½®é€šçŸ¥ åç½®é€šçŸ¥ ä¾‹å¤–é€šçŸ¥ æœ€ç»ˆé€šçŸ¥  public Object invoke(Object proxy, Method method,Object[] args) throws Throwable { PersonServiceBean bean = (PersonServiceBean) this.targetObject; Object result = null;//ç¯ç»•é€šçŸ¥ if(bean.getUser () != null { // ..... advice ( )--\u0026gt;å‰ç½®é€šçŸ¥ try { result = method.invoke (targetObject, args); //afteradvice() --\u0026gt;åç½®é€šçŸ¥ } catch(RuntimeException e){ // exceptionadvice ()--\u0026gt;ä¾‹å¤–é€šçŸ¥ }finally{ // tinallyadvice () : --\u0026gt;æœ€ç»ˆé€šçŸ¥ } } return result; }  10.1ã€AOPä¸­çš„æ¦‚å¿µï¼šï¼ˆåŸºäºæ³¨è§£æ–¹å¼å£°æ˜åˆ‡é¢ï¼‰  Aspect(åˆ‡é¢)ï¼šæŒ‡æ¨ªåˆ‡æ€§å…³æ³¨ç‚¹çš„æŠ½è±¡å³ä¸ºåˆ‡é¢ï¼Œå®ƒä¸ç±»ç›¸ä¼¼ï¼Œåªæ˜¯ä¸¤è€…çš„å…³æ³¨ç‚¹ä¸ä¸€æ ·ï¼Œç±»æ˜¯å¯¹ç‰©ä½“ç‰¹å¾çš„æŠ½è±¡ï¼Œè€Œåˆ‡é¢æ˜¯æ¨ªåˆ‡æ€§å…³æ³¨ç‚¹çš„æŠ½è±¡. joinpoint(è¿æ¥ç‚¹)ï¼šæ‰€è°“è¿æ¥ç‚¹æ˜¯æŒ‡é‚£äº›è¢«æ‹¦æˆªåˆ°çš„ç‚¹. åœ¨springä¸­ï¼Œè¿™äº›ç‚¹æŒ‡çš„æ˜¯æ–¹æ³•ï¼Œå› ä¸ºspringåªæ”¯æŒæ–¹æ³•ç±»å‹çš„è¿æ¥ç‚¹ï¼Œå®é™…ä¸Šjoinpointè¿˜å¯ä»¥æ˜¯fieldæˆ–ç±»æ„é€ å™¨. Pointcut(åˆ‡å…¥ç‚¹)ï¼šæ‰€ä¸ºåˆ‡å…¥ç‚¹æ˜¯æˆ‘ä»¬è¦å¯¹é‚£äº›joinpointè¿›è¡Œæ‹¦æˆªçš„å®šä¹‰.  æ³¨è§£ï¼š\n@Pointcut (â€œexecution(* com.haibao.service.*.*(..))â€) private void anyMethod(){}//å£°æ˜ä¸€ä¸ªåˆ‡å…¥ç‚¹  è¯´æ˜\n\u0026lt;!-- é…ç½®äº‹åŠ¡æ‹¦æˆªå™¨æ‹¦æˆªå“ªäº›ç±»çš„å“ªäº›æ–¹æ³•,ä¸€èˆ¬è®¾ç½®æˆæ‹¦æˆªService --\u0026gt; \u0026lt;aop:config\u0026gt; \u0026lt;aop:pointcut expression=\u0026quot;execution(* com.xy.service.*.*(..))\u0026quot; id=\u0026quot;allDaoMethod\u0026quot; /\u0026gt; \u0026lt;aop:advisor advice-ref=\u0026quot;txAdvice\u0026quot; pointcut-ref=\u0026quot;allDaoMethod\u0026quot; /\u0026gt; \u0026lt;/aop:config\u0026gt;  è¡¨ç¤ºcom.xy.serviceåŒ…ä¸‹çš„æ‰€æœ‰æ–¹æ³•ä¸ºä¸ºäº‹åŠ¡ç®¡ç†.\nexecution(* com.aptech.jb.epet.dao.hibimpl.*.*(..)) è¿™æ˜¯com.aptech.jb.epet.dao.hibimplåŒ…ä¸‹æ‰€æœ‰çš„ç±»çš„æ‰€æœ‰æ–¹æ³•.\n ç¬¬ä¸€ä¸ª*ä»£è¡¨æ‰€æœ‰çš„è¿”å›å€¼ç±»å‹ ç¬¬äºŒä¸ª*ä»£è¡¨æ‰€æœ‰çš„ç±» ç¬¬ä¸‰ä¸ª*ä»£è¡¨ç±»æ‰€æœ‰æ–¹æ³• æœ€åä¸€ä¸ª..ä»£è¡¨æ‰€æœ‰çš„å‚æ•°.  ä¸€äº›å¸¸è§åˆ‡å…¥ç‚¹è¡¨è¾¾å¼çš„ä¾‹å­ï¼š\n ä»»æ„å…¬å…±æ–¹æ³•çš„æ‰§è¡Œï¼šexecution(public * *(..)) ä»»ä½•ä¸€ä¸ªä»¥â€œsetâ€å¼€å§‹çš„æ–¹æ³•çš„æ‰§è¡Œï¼šexecution(* set*(..)) AccountService æ¥å£çš„ä»»æ„æ–¹æ³•çš„æ‰§è¡Œï¼š execution(* com.xyz.service.AccountService.*(..)) å®šä¹‰åœ¨serviceåŒ…é‡Œçš„ä»»æ„æ–¹æ³•çš„æ‰§è¡Œï¼š execution(* com.xyz.service.*.*(..)) å®šä¹‰åœ¨serviceåŒ…æˆ–è€…å­åŒ…é‡Œçš„ä»»æ„ç±»çš„ä»»æ„æ–¹æ³•çš„æ‰§è¡Œï¼š execution(* com.xyz.service..*.*(..))  Advice(é€šçŸ¥)ï¼šæ‰€è°“é€šçŸ¥æ˜¯æŒ‡æ‹¦æˆªåˆ°joinpointä¹‹åæ‰€åšçš„äº‹æƒ…ï¼Œé€šçŸ¥åˆ†ä¸ºå‰ç½®é€šçŸ¥ï¼ˆ@Before(â€œanyMethod()â€)ï¼‰ã€   åç½®é€šçŸ¥ï¼ˆ@AfterReturning(â€œanyMethod()â€)ï¼‰ã€ æœ€ç»ˆé€šçŸ¥ï¼ˆ@After(â€œanyMethod()â€)ï¼‰ã€ ä¾‹å¤–é€šçŸ¥ï¼ˆ@AfterThrowing(â€œanyMethod()â€)ï¼‰ã€ ç¯ç»•é€šçŸ¥ï¼ˆ@Around(â€œanyMethod()â€)ï¼‰.  public Object doBasicProfiling(ProceedingJoinPoint p) throws Throwable{ Object result = p.proceed();//å¿…é¡»æ‰§è¡Œè¯¥æ–¹æ³• return result; }  Target(ç›®æ ‡å¯¹è±¡)ï¼šä»£ç†çš„ç›®æ ‡å¯¹è±¡.\nWeave(ç»‡å…¥)ï¼šæŒ‡å°†aspectsåº”ç”¨åˆ°targetå¯¹è±¡å¹¶å¯¼è‡´proxyå¯¹è±¡åˆ›å»ºçš„è¿‡ç¨‹ç§°ä¸ºç»‡å…¥.\nIntroduction(å¼•å…¥)ï¼šåœ¨ä¸ä¿®æ”¹ä»£ç çš„å‰æä¸‹ï¼ŒIntroductionå¯ä»¥åœ¨è¿è¡ŒæœŸé—´ä¸ºç±»åŠ¨æ€çš„æ·»åŠ ä¸€äº›æ–¹æ³•æˆ–Field.\n10.2ã€åŸºäºXMLé…ç½®æ–¹å¼å£°æ˜åˆ‡é¢ \u0026lt;aop:aspectj-autoproxy /\u0026gt; \u0026lt;bean id=\u0026quot;aspetbean\u0026quot; class=\u0026quot;...\u0026quot;\u0026gt;\u0026lt;/bean\u0026gt; \u0026lt;aop:config\u0026gt; \u0026lt;aop:aspect id=\u0026quot;asp\u0026quot; ref=\u0026quot;aspetbean\u0026quot;\u0026gt; \u0026lt;!-- å®šä¹‰åˆ‡å…¥ç‚¹ id=åç§° expression è¡¨ç¤ºæ‹¦æˆª... --\u0026gt; \u0026lt;aop:pointcut id=\u0026quot;mycut\u0026quot; expression= \u0026quot;execution(* com.xy.service.*.*(..))\u0026quot;/\u0026gt; \u0026lt;!-- å‰ç½®é€šçŸ¥ --\u0026gt; \u0026lt;aop:before pointcut-ref=\u0026quot;mycut\u0026quot; method=\u0026quot;\u0026quot;/\u0026gt; \u0026lt;!-- åç½®é€šçŸ¥ --\u0026gt; \u0026lt;aop:after-returning pointcut-ref= \u0026quot;mycut\u0026quot; method=\u0026quot;\u0026quot;/\u0026gt; \u0026lt;!-- ä¾‹å¤–é€šçŸ¥ --\u0026gt; \u0026lt;aop:after-throwing pointcut-ref=\u0026quot;mycut\u0026quot; method=\u0026quot;\u0026quot;/\u0026gt; \u0026lt;!-- æœ€ç»ˆé€šçŸ¥ --\u0026gt; \u0026lt;aop:after pointcut-ref=\u0026quot;mycut\u0026quot; method=\u0026quot;\u0026quot;/\u0026gt; \u0026lt;!-- ç¯ç»•é€šçŸ¥ --\u0026gt; \u0026lt;aop:around pointcut-ref=\u0026quot;mycut\u0026quot; method=\u0026quot;\u0026quot;/\u0026gt; \u0026lt;/aop:aspect\u0026gt; \u0026lt;/aop:config\u0026gt;  11ã€Spring+JDBCç»„åˆå¼€å‘ æ­¥éª¤ï¼š\n é…ç½®æ•°æ®æºï¼Œå¦‚ï¼š ä¾èµ–çš„jaræ–‡ä»¶ï¼š commons-dbcp.jarã€ commons-logging.jarã€ commons-pool.jar  \u0026lt;bean id=\u0026quot;dataSource\u0026quot; class=\u0026quot;org.apach.commons.dbcp.BasicDataSource\u0026quot; destroy-method=\u0026quot;close\u0026quot;\u0026gt; \u0026lt;property name=\u0026quot;driveClassName\u0026quot; value=\u0026quot;org.gjt.mm.mysql.Driver\u0026quot;/\u0026gt; \u0026lt;property name=\u0026quot;url\u0026quot; value=\u0026quot;jdbc:mysql://localhost:3306/dbname?useUnicode=true è½¬ä¹‰\u0026amp;â†\u0026amp;amp;characterEncoding=UTF-8\u0026quot;/\u0026gt; \u0026lt;property name=\u0026quot;username\u0026quot; value=\u0026quot;root\u0026quot;/\u0026gt; \u0026lt;property name=\u0026quot;password\u0026quot; value=\u0026quot;root\u0026quot;/\u0026gt; \u0026lt;!-- è¿æ¥æ± å¯åŠ¨æ—¶çš„åˆå§‹å€¼ --\u0026gt; \u0026lt;property name=\u0026quot;initialSize\u0026quot; value=\u0026quot;1\u0026quot;/\u0026gt; \u0026lt;!-- è¿æ¥æ± æœ€å¤§å€¼ --\u0026gt; \u0026lt;property name=\u0026quot;maxActive\u0026quot; value=\u0026quot;500\u0026quot;/\u0026gt; \u0026lt;!-- æœ€å¤§ç©ºé—²å€¼ï¼Œå½“ç»å†è¿‡ä¸€ä¸ªé«˜å³°æ—¶é—´åï¼Œè¿æ¥æ± å¯ä»¥æ…¢æ…¢å°†å·²ç»ç”¨ä¸åˆ°çš„è¿æ¥æ…¢æ…¢é‡Šæ”¾ä¸€éƒ¨åˆ†ï¼Œä¸€ç›´å‡å°‘åˆ°maxIdleä¸ºæ­¢ --\u0026gt; \u0026lt;property name=\u0026quot;maxIdle\u0026quot; value=\u0026quot;2\u0026quot;/\u0026gt; \u0026lt;!-- æœ€å°ç©ºé—²å€¼ï¼Œå½“ç©ºé—²çš„è¿æ¥æ•°å°‘äºé˜™å€¼æ—¶ï¼Œè¿æ¥æ± ä¼šé¢„ç”³è¯·å»ä¸€äº›è¿æ¥ï¼Œä»¥å…æ´ªå³°æ¥æ—¶ä¸åŠç”³è¯· --\u0026gt; \u0026lt;property name=\u0026quot;minIdle\u0026quot; value=\u0026quot;1\u0026quot;/\u0026gt; \u0026lt;/bean\u0026gt; æˆ–è€…ä½¿ç”¨å±æ€§æ–‡ä»¶ä¿å­˜å‚æ•°å€¼ \u0026lt;context:property-placeholder location=\u0026quot;classpath.properties\u0026quot;/\u0026gt; classpath:åœ¨ç±»è·¯å¾„ä¸‹ \u0026lt;bean id=\u0026quot;dataSource\u0026quot; class=\u0026quot;org.apach.commons.dbcp.BasicDataSource\u0026quot; destroy-method=\u0026quot;close\u0026quot;\u0026gt; \u0026lt;property name=\u0026quot;driveClassName\u0026quot; value=\u0026quot;${ driveClassName}\u0026quot;/\u0026gt; \u0026lt;property name=\u0026quot;url\u0026quot;value=\u0026quot;${ url }\u0026quot;/\u0026gt; \u0026lt;property name=\u0026quot;username\u0026quot; value=\u0026quot;${ username}\u0026quot;/\u0026gt; \u0026lt;property name=\u0026quot;password\u0026quot; value=\u0026quot;${ password }\u0026quot;/\u0026gt; \u0026lt;!-- è¿æ¥æ± å¯åŠ¨æ—¶çš„åˆå§‹å€¼ --\u0026gt; \u0026lt;property name=\u0026quot;initialSize\u0026quot; value=\u0026quot;${ initialSize }\u0026quot;/\u0026gt; \u0026lt;!-- è¿æ¥æ± æœ€å¤§å€¼ --\u0026gt; \u0026lt;property name=\u0026quot;maxActive\u0026quot; value=\u0026quot;${ maxActive }\u0026quot;/\u0026gt; \u0026lt;!-- æœ€å¤§ç©ºé—²å€¼ï¼Œå½“ç»å†è¿‡ä¸€ä¸ªé«˜å³°æ—¶é—´åï¼Œè¿æ¥æ± å¯ä»¥æ…¢æ…¢å°†å·²ç»ç”¨ä¸åˆ°çš„è¿æ¥æ…¢æ…¢é‡Šæ”¾ä¸€éƒ¨åˆ†ï¼Œä¸€ç›´å‡å°‘åˆ°maxIdleä¸ºæ­¢ --\u0026gt; \u0026lt;property name=\u0026quot;maxIdle\u0026quot; value=\u0026quot;${ maxIdle }\u0026quot;/\u0026gt; \u0026lt;!-- æœ€å°ç©ºé—²å€¼ï¼Œå½“ç©ºé—²çš„è¿æ¥æ•°å°‘äºé˜™å€¼æ—¶ï¼Œè¿æ¥æ± ä¼šé¢„ç”³è¯·å»ä¸€äº›è¿æ¥ï¼Œä»¥å…æ´ªå³°æ¥æ—¶ä¸åŠç”³è¯· --\u0026gt; \u0026lt;property name=\u0026quot;minIdle\u0026quot; value=\u0026quot;${ minIdle }\u0026quot;/\u0026gt; \u0026lt;/bean\u0026gt;  é…ç½®äº‹åŠ¡ï¼šé…ç½®äº‹åŠ¡æ—¶ï¼Œéœ€è¦åœ¨XMLé…ç½®æ–‡ä»¶ä¸­å¼•å…¥å£°æ˜äº‹åŠ¡çš„txå‘½åç©ºé—´ï¼Œäº‹åŠ¡çš„é…ç½®æ–¹å¼æœ‰ä¸¤ç§ï¼šæ³¨è§£æ–¹å¼å’ŒåŸºäºXMLé…ç½®æ–¹å¼.  11.1ã€é‡‡ç”¨æ³¨è§£æ–¹å¼é…ç½®äº‹åŠ¡ï¼šåœ¨XMLæ–‡ä»¶ä¸­é…ç½®äº‹åŠ¡ç®¡ç†å™¨ \u0026lt;bean id=\u0026quot;txManager\u0026quot; class=\u0026quot;org.springframework.jdbc.datasource.DataSourceTranszctionManager\u0026quot;\u0026gt; \u0026lt;property name=\u0026quot;dataSource\u0026quot; ref=\u0026quot;dataSource\u0026quot;/\u0026gt; \u0026lt;/bean\u0026gt; \u0026lt;!-- é‡‡ç”¨@Transactionalæ³¨è§£æ–¹å¼ä½¿ç”¨äº‹åŠ¡ --\u0026gt; \u0026lt;tx:annotation-driven transaction-manager=\u0026quot;txManager\u0026quot;\u0026gt;  txå‘½åç©ºé—´.\nxmlns:tx=\u0026ldquo;http://www.springframework.org/schema/tx\u0026quot; http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd\n12ã€é‡‡ç”¨åŸºäºXMLæ–¹å¼é…ç½®äº‹åŠ¡ \u0026lt;bean id=\u0026quot;txManager\u0026quot; class=\u0026quot;org.springframework.jdbc.datasource.DatasourceTransactionManager\u0026quot;\u0026gt; \u0026lt;property name=\u0026quot;dataSource\u0026quot; ref=\u0026quot;dataSource\u0026quot;/\u0026gt; \u0026lt;/bean\u0026gt; \u0026lt;aop:config\u0026gt; \u0026lt;aop:pointcut id=\u0026quot;transactionPointcut\u0026quot; expression=\u0026quot;execute()â€¦\u0026quot;/\u0026gt; \u0026lt;aop:advisor advice=\u0026quot;txAdvice\u0026quot; point-ref=\u0026quot;transactionPointcut\u0026quot;/\u0026gt; \u0026lt;/aop:config\u0026gt; \u0026lt;tx:advice id=\u0026quot;txAdvice\u0026quot; transaction-manager=\u0026quot;txManager\u0026quot;\u0026gt; \u0026lt;tx:attributes\u0026gt; \u0026lt;tx:method name=\u0026quot;get*\u0026quot; read-only=\u0026quot;true\u0026quot; proportion=\u0026quot;NOT_SUPPORTED\u0026quot;/\u0026gt; \u0026lt;tx:method name=\u0026quot;*\u0026quot;/\u0026gt; \u0026lt;/tx:attributes\u0026gt; \u0026lt;/tx:advice\u0026gt;  13ã€Springç®¡ç†äº‹åŠ¡æäº¤çš„è§„åˆ™ï¼š  é‡åˆ°unckeckedï¼ˆè¿è¡ŒæœŸä¾‹å¤–ï¼‰äº‹ç‰©ä¼šå‘ç”Ÿå›æ»šï¼Œå³ï¼šæ‰§è¡Œæ— æ•ˆ. é‡åˆ°checkedäº‹ç‰©ä¸ä¼šå‘ç”Ÿå›æ»š. è¦æ±‚å›æ»šï¼š@Transcation(rollbackFor=Exception.class) äº‹ç‰©ä¼ æ’­å±æ€§ï¼š@Transcation(propagation=Propagation. NOT_SUPPORTED) REQUIRED:ï¼ˆé»˜è®¤ï¼‰ä¸šåŠ¡æ–¹æ³•éœ€è¦åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­è¿è¡Œ. å¦‚æœæ–¹æ³•è¿è¡Œæ—¶ï¼Œå·²ç»å¤„åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œé‚£ä¹ˆåŠ å…¥åˆ°è¯¥äº‹åŠ¡ä¸­ï¼Œå¦åˆ™è‡ªå·±åˆ›å»ºä¸€ä¸ªæ–°äº‹åŠ¡. NOT_SUPPORTED:å£°æ˜æ–¹æ³•ä¸éœ€è¦äº‹åŠ¡. å¦‚æœæ–¹æ³•æ²¡æœ‰å…³è”ä¸€ä¸ªäº‹åŠ¡ï¼Œå®¹å™¨ä¸ä¼šä¸ºå®ƒå¼€å¯äº‹åŠ¡ï¼›å¦‚æœæ–¹æ³•åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­è¢«è°ƒç”¨ï¼Œè¯¥äº‹åŠ¡ä¼šæŒ‚èµ·ï¼Œåœ¨æ–¹æ³•è°ƒç”¨ç»“æŸåï¼ŒåŸå…ˆçš„äº‹åŠ¡ä¾¿ä¼šæ¢å¤æ‰§è¡Œ. REQUIRESNEW:å±æ€§è¡¨æ˜ä¸ç®¡æ˜¯å¦å­˜åœ¨äº‹åŠ¡ï¼Œä¸šåŠ¡æ–¹æ³•æ€»ä¼šä¸ºè‡ªå·±å‘èµ·ä¸€ä¸ªæ–°çš„äº‹åŠ¡. å¦‚æœæ–¹æ³•å·²ç»è¿è¡Œåœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œåˆ™åŸäº‹åŠ¡ä¼šè¢«æŒ‚èµ·ï¼Œæ–°äº‹åŠ¡ä¼šè¢«æ—¥åˆ›å»ºï¼Œç›´åˆ°æ–¹æ³•ç»“æŸï¼Œæ–°äº‹åŠ¡æ‰ç®—ç»“æŸï¼ŒåŸå…ˆçš„äº‹åŠ¡æ‰ä¼šæ¢å¤. MANDATORY:è¯¥å±æ€§æŒ‡å®šä¸šåŠ¡æ–¹æ³•åœ¨æŸä¸ªäº‹åŠ¡èŒƒå›´ï¼Œä¸šåŠ¡æ–¹æ³•ä¸èƒ½å‘èµ·è‡ªå·±çš„äº‹åŠ¡. å¦‚æœä¸šåŠ¡æ–¹æ³•åœ¨äº‹åŠ¡èŒƒå›´å¤–è¢«è°ƒç”¨ï¼Œåˆ™æ–¹æ³•åœ¨æ²¡æœ‰äº‹åŠ¡çš„ç¯å¢ƒä¸‹æ‰§è¡Œ. SUPPORKTSï¼šè¿™ä¸€äº‹åŠ¡å±æ€§è¡¨æ˜ï¼Œå¦‚æœä¸šåŠ¡æ–¹æ³•åœ¨æŸä¸ªäº‹åŠ¡èŒƒå›´å†…è¢«è°ƒç”¨ï¼Œåˆ™æ–¹æ³•æˆä¸ºè¯¥äº‹åŠ¡çš„ä¸€éƒ¨åˆ†. å¦‚æœä¸šåŠ¡æ–¹æ³•åœ¨æ²¡æœ‰äº‹åŠ¡çš„ç¯å¢ƒä¸‹è°ƒç”¨ï¼Œåˆ™æ–¹æ³•åœ¨æ²¡æœ‰äº‹åŠ¡çš„ç¯å¢ƒä¸‹æ‰§è¡Œ. Never:æŒ‡å®šä¸šåŠ¡æ–¹æ³•ç»å¯¹ä¸èƒ½åœ¨äº‹åŠ¡èŒƒå›´å†…æ‰§è¡Œ. è‹¥æœä¸šåŠ¡æ–¹æ³•åœ¨æŸä¸ªäº‹åŠ¡ä¸­æ‰§è¡Œï¼Œå®¹å™¨ä¼šæŠ›å‡ºä¾‹å¤–ï¼Œåªæœ‰ä¸šåŠ¡æ–¹æ³•æ²¡æœ‰å…³è”åˆ°ä»»ä½•äº‹åŠ¡ï¼Œæ‰èƒ½æ­£å¸¸æ‰§è¡Œ. NESTED:å¦‚æœä¸€ä¸ªæ´»åŠ¨çš„äº‹åŠ¡å­˜åœ¨ï¼Œåˆ™è¿è¡Œåœ¨ä¸€ä¸ªåµŒå¥—çš„äº‹åŠ¡ä¸­ï¼Œå¦‚æœæ²¡æœ‰æ´»åŠ¨äº‹åŠ¡ï¼Œåˆ™æŒ‰REQUIREDå±æ€§æ‰§è¡Œï¼Œå®ƒä½¿ç”¨äº†ä¸€ä¸ªäººå•ç‹¬çš„äº‹åŠ¡ï¼Œè¿™ä¸ªäº‹åŠ¡æ‹¥æœ‰å¤šä¸ªå¯ä»¥å›æ»šçš„ä¿å­˜ç‚¹. å†…éƒ¨äº‹åŠ¡çš„å›æ»šä¸ä¼šå¯¹å¤–éƒ¨äº‹åŠ¡é€ æˆå½±å“. ä»–åªå¯¹DataSourceTransactionManageräº‹åŠ¡ç®¡ç†å™¨èµ·æ•ˆ.  14ã€æ•°æ®åº“ç³»ç»Ÿæä¾›äº†å››ç§äº‹åŠ¡éš”ç¦»çº§ ã€€æ•°æ®åº“ç³»ç»Ÿæä¾›äº†å››çº§äº‹åŠ¡éš”ç¦»çº§åˆ«ä¾›ç”¨æˆ·é€‰æ‹©. ä¸åŒçš„éš”ç¦»çº§åˆ«é‡‡ç”¨ä¸åŒçš„æ‰€ç±»å‹å®ç°ï¼Œåœ¨å››çº§éš”ç¦»çº§åˆ«ä¸­ï¼ŒSerislixstionçš„éš”ç¦»çº§åˆ«æœ€é«˜ï¼ŒRead Uncommitedçš„éš”ç¦»çº§åˆ«æœ€ä½. å¤§å¤šæ•°æ®åº“é»˜è®¤çš„éš”ç¦»çº§åˆ«ä¸ºRead Commitedï¼Œå¦‚SQLServer 2000 \u0026hellip;\n Read Uncommitedï¼šè¯»æœªæäº¤æ•°æ®ï¼ˆä¼šå‡ºç°è„è¯»ï¼Œä¸å¯é‡å¤è¯»å’Œå¹»è¯»ï¼‰ Read Commitedï¼šè¯»å·²æäº¤æ•°æ®ï¼ˆä¼šå‡ºç°ä¸å¯é‡å¤è¯»å’Œå¹»è¯»ï¼‰ Repeatable Readï¼šå¯é‡å¤è¯»ï¼ˆä¼šå‡ºç°å¹»è¯»ï¼‰ Serializableï¼šä¸²è¡ŒåŒ– è„è¯»ï¼šä¸€ä¸ªäº‹åŠ¡è¯»å–åˆ°å¦ä¸€ä¸ªäº‹åŠ¡æœªæäº¤çš„æ›´æ–°æ•°æ®. å¯é‡å¤è¯»ï¼šåœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­å¤šæ¬¡è¯»å–æ•°æ®æ—¶ï¼Œèƒ½å¤Ÿä¿è¯æ‰€è¯»æ•°æ®ä¸€æ ·ï¼Œä¹Ÿå°±æ˜¯ï¼Œåç»­è¯»å–ä¸èƒ½è¯»åˆ°å¦å¤–ä¸€ä¸ªäº‹åŠ¡å·²æäº¤çš„æ›´æ–°æ•°æ®. ä¸å¯é‡å¤è¯»ï¼šåœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­å¤šæ¬¡è¯»å–åŒä¸€æ•°æ®è¿”å›çš„ç»“æœæœ‰æ‰€ä¸åŒï¼Œä¹Ÿå°±æ˜¯ï¼Œåç»­è¯»å–èƒ½è¯»åˆ°å¦å¤–ä¸€ä¸ªäº‹åŠ¡å·²æäº¤çš„æ›´æ–°æ•°æ®. å¹»è¯»ï¼šä¸€ä¸ªäº‹åŠ¡è¯»å–åˆ°å¦ä¸€äº‹åŠ¡å·²æäº¤çš„insertæ•°æ®.  ","date":1611964800,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1611964800,"objectID":"9226e139b2d30f2cbf1e37cc4f3ba49e","permalink":"https://CoMath21.github.io/post/1-spring2.5/","publishdate":"2021-01-30T00:00:00Z","relpermalink":"/post/1-spring2.5/","section":"post","summary":"å…·ä½“ä»‹ç»Spring2.5çš„ç›¸å…³å†…å®¹.","tags":["ç¼–ç¨‹è¯­è¨€","Java","Spring"],"title":"Spring2.5å­¦ä¹ ç¬”è®°","type":"post"},{"authors":["Xinæ€å¥½å…ˆç”Ÿ","CoMath"],"categories":["å­¦ä¹ ç¬”è®°","ç¼–ç¨‹è¯­è¨€"],"content":"Hibernate æ˜¯ä»€ä¹ˆï¼Ÿ  hibernateæ˜¯ä¸€ä¸ªè½»é‡çº§JavaEEåº”ç”¨çš„æŒä¹…å±‚æ¡†æ¶ï¼ˆframeworkï¼‰ hibernateæ˜¯ä¸€ä¸ªORMï¼ˆobject relation mappingå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰æ¡†æ¶  o object -\u0026gt; ä¸šåŠ¡å±‚(åªå¯¹å¯¹è±¡æ“ä½œ) r relation-\u0026gt; å…³ç³»æ•°æ®åº“ï¼Œå…³ç³»å‹æ•°æ®åº“ä¸­äºŒç»´è¡¨ m mapping å¯¹è±¡å…³ç³»æ˜ å°„æ–‡ä»¶  javaç±»\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;-\u0026gt;è¡¨ javaå¯¹è±¡\u0026mdash;\u0026mdash;\u0026mdash;\u0026ndash;\u0026gt;è¡¨ä¸­è®°å½• javaå¯¹è±¡å±æ€§\u0026mdash;\u0026mdash;-\u0026gt;è¡¨ä¸­å­—æ®µ     hibernate å¤„äºæˆ‘ä»¬é¡¹ç›®çš„æŒä¹…å±‚ä½ç½®(æ­£å› ä¸ºå¦‚æ­¤ï¼Œæ‰€ä»¥æœ‰äººåˆæŠŠhibernateç§°ä¸º æŒä¹…å±‚æ¡†æ¶) hibernate å®é™…ä¸Šå°±æ˜¯å¯¹jdbcè¿›è¡Œäº†è½»é‡çº§çš„å°è£…. hibernate çš„åŸºç¡€è¿˜æ˜¯æˆ‘ä»¬javaåå°„æœºåˆ¶  æ‰‹åŠ¨é…ç½®hibernateæ–¹å¼å®Œæˆcrudæ“ä½œ ã€€é¦–å…ˆåˆ›å»ºé¡¹ç›®ï¼Œå†å¼•å…¥jaråŒ…. hibernateå¼€å‘çš„ä¸‰ç§æ–¹å¼ï¼š\n ç”±domain object â€“\u0026gt; mapping -\u0026gt; db (å®˜æ–¹æ¨è). ç”±DBå¼€å§‹ï¼Œç”¨å·¥å…·ç”Ÿæˆmappingå’Œdomain object (ä½¿ç”¨è¾ƒå¤š). ç”±æ˜ å°„å¼€å§‹.  Employee.hbml.xmlé…ç½®æ–‡ä»¶ \u0026lt;!DOCTYPE hibernate-mapping PUBLIC \u0026quot;-//Hibernate/Hibernate Mapping DTD 3.0//EN\u0026quot; \u0026quot;http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\u0026quot;\u0026gt; \u0026lt;hibernate-mapping package=\u0026quot;com.hsp.domain\u0026quot;\u0026gt; \u0026lt;class name=\u0026quot;Employee\u0026quot; table=\u0026quot;employee\u0026quot;\u0026gt; \u0026lt;!-- idå…ƒç´ ç”¨äºæŒ‡å®šä¸»é”®å±æ€§ --\u0026gt; \u0026lt;id name=\u0026quot;id\u0026quot; column=\u0026quot;id\u0026quot; type=\u0026quot;java.lang.Integer\u0026quot;\u0026gt; \u0026lt;!-- è¯¥å…ƒç´ ç”¨äºæŒ‡å®šä¸»é”®å€¼ç”Ÿæˆç­–ç•¥hilo native increment sequence uuid --\u0026gt; \u0026lt;generator class=\u0026quot;sequence\u0026quot;\u0026gt; \u0026lt;param name=\u0026quot;sequence\u0026quot;\u0026gt;emp_seq\u0026lt;/param\u0026gt; \u0026lt;/generator\u0026gt; \u0026lt;/id\u0026gt; \u0026lt;!-- å¯¹å…¶å®ƒå±æ€§è¿˜æœ‰é…ç½® --\u0026gt; \u0026lt;property name=\u0026quot;name\u0026quot; type=\u0026quot;java.lang.String\u0026quot;\u0026gt; \u0026lt;column name=\u0026quot;name\u0026quot; not-null=\u0026quot;false\u0026quot; /\u0026gt; \u0026lt;/property\u0026gt; \u0026lt;property name=\u0026quot;email\u0026quot; type=\u0026quot;java.lang.String\u0026quot; \u0026gt; \u0026lt;column name=\u0026quot;email\u0026quot; not-null=\u0026quot;false\u0026quot;/\u0026gt; \u0026lt;/property\u0026gt; \u0026lt;property name=\u0026quot;hiredate\u0026quot; type=\u0026quot;java.util.Date\u0026quot;\u0026gt; \u0026lt;column name=\u0026quot;hiredate\u0026quot; not-null=\u0026quot;false\u0026quot; /\u0026gt; \u0026lt;/property\u0026gt; \u0026lt;/class\u0026gt;\t\u0026lt;/hibernate-mapping\u0026gt;  hibernate.cfg.xmlé…ç½®æ–‡ä»¶ \u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;utf-8\u0026quot;?\u0026gt; \u0026lt;!DOCTYPE hibernate-configuration PUBLIC \u0026quot;-//Hibernate/Hibernate Configuration DTD 3.0//EN\u0026quot; \u0026quot;http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\u0026quot;\u0026gt; \u0026lt;hibernate-configuration\u0026gt; \u0026lt;session-factory\u0026gt; \u0026lt;!-- hibernate è®¾è®¡è€…ï¼Œç»™æˆ‘ä»¬æä¾›äº†ä¸€å†™å¸¸ç”¨çš„é…ç½® --\u0026gt; \u0026lt;!-- é…ç½®ä½¿ç”¨çš„driver --\u0026gt; \u0026lt;property name=\u0026quot;connection.driver_class\u0026quot;\u0026gt;oracle.jdbc.driver.OracleDriver\u0026lt;/property\u0026gt; \u0026lt;!-- é…ç½®ä½¿ç”¨çš„è´¦æˆ·å¯†ç  --\u0026gt; \u0026lt;property name=\u0026quot;connection.username\u0026quot;\u0026gt;scott\u0026lt;/property\u0026gt; \u0026lt;property name=\u0026quot;connection.password\u0026quot;\u0026gt;tiger\u0026lt;/property\u0026gt; \u0026lt;property name=\u0026quot;connection.url\u0026quot;\u0026gt;jdbc:oracle:thin:@127.0.0.1:1521:orclhsp\u0026lt;/property\u0026gt; \u0026lt;!-- é…ç½®dialectæ–¹è¨€,æ˜ç¡®å‘Šè¯‰hibernateè¿æ¥æ˜¯å“ªç§æ•°æ®åº“ --\u0026gt; \u0026lt;property name=\u0026quot;dialect\u0026quot;\u0026gt;org.hibernate.dialect.OracleDialect\u0026lt;/property\u0026gt; \u0026lt;!-- æ˜¾ç¤ºå‡ºå¯¹äºsqlè¯­å¥ --\u0026gt; \u0026lt;property name=\u0026quot;show_sql\u0026quot;\u0026gt;true\u0026lt;/property\u0026gt; \u0026lt;!-- æŒ‡å®šç®¡ç†çš„å¯¹è±¡æ˜ å°„æ–‡ä»¶ --\u0026gt; \u0026lt;mapping resource=\u0026quot;com/hsp/domain/Employee.hbm.xml\u0026quot;/\u0026gt; \u0026lt;/session-factory\u0026gt; \u0026lt;/hibernate-configuration\u0026gt;  è¯´æ˜ï¼š\n connection.driver_class:åœ¨etcä¸‹å¯ä»¥æ‰¾åˆ°ï¼› hibernate.cfg.xmlæ–‡ä»¶å¯ä»¥ä¸å†™ï¼Œä½†è¦åœ¨springä¸­é…ç½®.  æµ‹è¯•æ–‡ä»¶TestMain.java package com.hsp.view; import com.hsp.util.*; import java.util.Date; import org.hibernate.Session; import org.hibernate.SessionFactory; import org.hibernate.Transaction; import org.hibernate.cfg.*; import com.hsp.domain.Employee; public class TestMain { public static void main(String[] args) { //æŸ¥è¯¢[load]-\u0026gt;hqlè¯­å¥(hibernate query language) } public static void delEmp() { //åˆ é™¤ //è·å–ä¸€ä¸ªsession Session session=MySessionFactory.getSessionFactory().openSession(); Transaction ts=session.beginTransaction(); //åˆ é™¤1.å…ˆè·å–è¯¥é›‡å‘˜ï¼Œç„¶ååˆ é™¤ Employee emp=(Employee) session.load(Employee.class, 3); session.delete(emp); ts.commit(); session.close(); } public static void updateEmp() { // TODO Auto-generated method stub //ä¿®æ”¹ç”¨æˆ· //è·å–ä¸€ä¸ªä¼šè¯ Session session=MySessionFactory.getSessionFactory().openSession(); Transaction ts=session.beginTransaction(); //ä¿®æ”¹ç”¨æˆ·1. è·å–è¦ä¿®æ”¹çš„ç”¨æˆ·ï¼Œ2.ä¿®æ”¹ //loadæ˜¯é€šè¿‡ä¸»é”®å±æ€§ï¼Œè·å–è¯¥å¯¹è±¡å®ä¾‹.\u0026lt;---\u0026gt;è¡¨çš„è®°å½•å¯¹åº” Employee emp=(Employee) session.load(Employee.class, 3); emp.setName(\u0026quot;éŸ©é¡ºå¹³8\u0026quot;);//update... emp.setEmail(\u0026quot;abc@sohu.com\u0026quot;); ts.commit(); session.close(); } public static void addEmployee() { //æˆ‘ä»¬ä½¿ç”¨hibernateå®Œæˆcrudæ“ä½œ[è¿™é‡Œæˆ‘ä»¬åªè§å¯¹è±¡ï¼Œä¸è§è¡¨] //ç°åœ¨æˆ‘ä»¬ä¸æ˜¯ç”¨service ,ç›´æ¥æµ‹è¯•. //1. åˆ›å»ºConfiguration,è¯¥å¯¹è±¡ç”¨äºè¯»å–hibernate.cfg.xml,å¹¶å®Œæˆåˆå§‹åŒ– Configuration configuration=new Configuration().configure(); //2.åˆ›å»ºSessoinFactory[è¿™æ˜¯ä¸€ä¸ªä¼šè¯å·¥å‚ï¼Œæ˜¯ä¸€ä¸ªé‡é‡çº§çš„å¯¹è±¡] SessionFactory sessionFactory=configuration.buildSessionFactory(); //3.åˆ›å»ºSessoin ç›¸å½“äºjdbc Connection[ servelt HttpSession ,ä¹Ÿä¸æ˜¯ jsp session] Session session=sessionFactory.openSession(); //4.å¯¹hiberateè€Œè¨€ï¼Œè¦æ±‚åœ¨è¿›è¡Œ å¢åŠ ï¼Œåˆ é™¤ï¼Œä¿®æ”¹çš„æ—¶å€™ä½¿ç”¨äº‹åŠ¡æäº¤ï¼Œ Transaction transaction = session.beginTransaction(); //æ·»åŠ ä¸€ä¸ªé›‡å‘˜ Employee employee=new Employee(); employee.setName(\u0026quot;shunping\u0026quot;); employee.setEmail(\u0026quot;shunping@sohu.com\u0026quot;); employee.setHiredate(new Date()); //insert ............. //ä¿å­˜ session.save(employee);//save employeeå°±æ˜¯æŒä¹…åŒ–è¯¥å¯¹è±¡ (æŠŠå¯¹è±¡ä¿å­˜åˆ°äº†æ•°æ®åº“ä¸­ç§°ä¸ºä¸€æ¡è®°å½•) //==\u0026gt;insert into ....[è¢«hiberanteå°è£…] //æäº¤ transaction.commit(); session.close(); } }  ã€€\u0026lt;Hibernate-mapping\u0026gt;æ ‡ç­¾çš„å±æ€§å¦‚ä¸‹ï¼š\n packageï¼šæŒ‡å®šä¸€ä¸ªåŒ…å‰ç¼€ï¼Œå¦‚æœåœ¨æ˜ å°„æ–‡æ¡£ä¸­(å°±æ˜¯åœ¨classæ ‡ç­¾çš„é‚£ä¹ˆå±æ€§é‡Œæ²¡æœ‰æŒ‡å®šå…¨ç±»å)æ²¡æœ‰æŒ‡å®šå…¨é™å®šçš„ç±»åï¼Œå°±ä½¿ç”¨è¿™ä¸ªä½œä¸ºåŒ…å. schemaï¼šæ•°æ®åº“schemaçš„åç§°. catalogï¼šæ•°æ®åº“catalogçš„åç§°. default-cascadeï¼šé»˜è®¤çš„çº§è”é£æ ¼,é»˜è®¤ä¸ºnone. default-accessï¼šHibernateç”¨æ¥è®¿é—®å±æ€§çš„ç­–ç•¥. default-lazyï¼šæŒ‡å®šäº†æ­¤å±æ€§ï¼Œæœªæ˜ç¡®æ³¨æ˜lazyå±æ€§çš„Javaå±æ€§å’Œé›†åˆç±»ï¼ŒHibernateä¼šé‡‡å–çš„é»˜è®¤ä½¿ç”¨è¿™ä¸ªå±æ€§åŠ è½½é£æ ¼,é»˜è®¤ä¸ºtrue. auto-importï¼šæŒ‡å®šæˆ‘ä»¬æ˜¯å¦å¯ä»¥åœ¨æŸ¥è¯¢è¯­è¨€ä¸­ä½¿ç”¨éå…¨é™å®šçš„ç±»å,é»˜è®¤ä¸ºtrue,å¦‚æœé¡¹ç›®ä¸­æœ‰ä¸¤ä¸ªåŒåçš„æŒä¹…åŒ–ç±»,åˆ™æœ€å¥½åœ¨è¿™ä¸¤ä¸ªç±»çš„å¯¹åº”çš„æ˜ å°„æ–‡ä»¶ä¸­é…ç½®ä¸ºfalse.  ã€€Hibernateçš„å­æ ‡ç­¾classæ ‡ç­¾ï¼š\n class å…ƒç´ ç”¨äºæŒ‡å®šç±»å’Œè¡¨çš„æ˜ å°„ . name:æŒ‡å®šè¯¥æŒä¹…åŒ–ç±»æ˜ å°„çš„æŒä¹…åŒ–ç±»çš„ç±»å.  example:\u0026lt;class name=\u0026quot;com.jeremy.hibernate.example.News\u0026quot; table=\u0026quot;NEWS\u0026quot;\u0026gt;.   table:æŒ‡å®šè¯¥æŒä¹…åŒ–ç±»æ˜ å°„çš„è¡¨å, Hibernate é»˜è®¤ä»¥æŒä¹…åŒ–ç±»çš„ç±»åä½œä¸ºè¡¨å .  example:\u0026lt;class name=\u0026quot;com.jeremy.hibernate.example.News\u0026quot; table=\u0026quot;NEWS\u0026quot;\u0026gt;.   dynamic-insert: è‹¥è®¾ç½®ä¸º true, è¡¨ç¤ºå½“ï¼ˆè°ƒç”¨Sessionçš„save()æ–¹æ³•æ—¶ï¼‰ä¿å­˜ä¸€ä¸ªå¯¹è±¡æ—¶, ä¼šåŠ¨æ€ç”Ÿæˆ insert è¯­å¥, insert è¯­å¥ä¸­ä»…åŒ…å«æ‰€æœ‰å–å€¼ä¸ä¸º null çš„å­—æ®µ. é»˜è®¤å€¼ä¸º false. Example:è¿™ä¸ªè·Ÿdynamic-updateä¸€ä¸ªæ„æ€. dynamic-update: è‹¥è®¾ç½®ä¸º true, è¡¨ç¤ºå½“(è°ƒç”¨å¯¹è±¡çš„set()æ–¹æ³•)æ›´æ–°ä¸€ä¸ªå¯¹è±¡æ—¶, ä¼šåŠ¨æ€ç”Ÿæˆ update è¯­å¥, update è¯­å¥ä¸­ä»…åŒ…å«æ‰€æœ‰å–å€¼éœ€è¦æ›´æ–°çš„å­—æ®µ. é»˜è®¤å€¼ä¸º false.  ã€€Hibernateæ˜ å°„æ–‡ä»¶ä¸»è¦å†…å®¹:\n æ˜ å°„å†…å®¹çš„å®šä¹‰: Hibernateæ˜ å°„æ–‡ä»¶ç”±\u0026lt;hibernate-mapping package=\u0026quot;JavaBeanæ‰€åœ¨åŒ…çš„å…¨è·¯å¾„\u0026quot;\u0026gt;èŠ‚ç‚¹å®šä¹‰æ˜ å°„å†…å®¹å¹¶æŒ‡å®šæ‰€å¯¹åº”çš„JavaBeançš„ä½ç½®(ä¹Ÿå¯ä»¥ä¸åœ¨è¯¥èŠ‚ç‚¹ä¸­ç”¨packageå±æ€§æŒ‡å®šå¯¹åº”çš„JavaBeanä½ç½®,è€Œåœ¨è¯¥èŠ‚ç‚¹ä¸‹çš„classèŠ‚ç‚¹ä¸­çš„nameå±æ€§ä¸­æŒ‡å®š). æ•°æ®åº“å’ŒJavaBeançš„å…³è”: Hibernateæ˜ å°„æ–‡ä»¶ä¸­ç”¨\u0026lt;hibernate-mapping\u0026gt;èŠ‚ç‚¹ä¸‹çš„ \u0026lt;class name=\u0026quot;JavaBeanåç§°\u0026quot; table=\u0026quot;å¯¹åº”æ•°æ®åº“ä¸­çš„è¡¨å\u0026quot;\u0026gt;èŠ‚ç‚¹æŒ‡å®šæ•°æ®åº“è¡¨å’ŒJavaBeançš„å…³è”. ( è¯¥èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ä¸­ç”¨packageå±æ€§æŒ‡å®šäº†JavaBeançš„åŒ…åæ—¶ç”¨)/å…¨è·¯å¾„(è¯¥èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ä¸­æ²¡ç”¨packageå±æ€§æŒ‡å®šJavaBeançš„åŒ…åæ—¶ç”¨). ä¸»é”®æ˜ å°„: åœ¨\u0026lt;class \u0026gt;èŠ‚ç‚¹ä¸‹ç”¨\u0026lt;id name=\u0026quot;æ•°æ®åº“ä¸­ä¸»é”®åœ¨JavaBeanä¸­çš„å±æ€§åç§°\u0026quot; column=\u0026quot;æ•°æ®åº“ä¸­ä¸»é”®å\u0026quot; type=\u0026quot;string\u0026quot;\u0026gt;èŠ‚ç‚¹æ˜ å°„å¯¹åº”çš„ä¸»é”®,è¯¥èŠ‚ç‚¹å¿…é¡»æœ‰ä¸”åªæœ‰ä¸€ä¸ª(å› ä¸ºä¸»é”®åªæœ‰ä¸€ä¸ª),åŒæ—¶å¿…é¡»æ”¾åœ¨\u0026lt;property ...\u0026gt;èŠ‚ç‚¹å‰. æ™®é€šå­—æ®µæ˜ å°„: åœ¨\u0026lt;class ...\u0026gt;èŠ‚ç‚¹ä¸‹ç”¨\u0026lt;property name=\u0026quot;æ•°æ®åº“ä¸­å­—æ®µåœ¨JavaBeanä¸­çš„å±æ€§åç§°\u0026quot; column=\u0026quot;æ•°æ®åº“ä¸­çš„å­—æ®µå\u0026quot; type=\u0026quot;string\u0026quot;/\u0026gt;èŠ‚ç‚¹æ˜ å°„æ™®é€šå­—æ®µ,è¯¥èŠ‚ç‚¹å¯æœ‰å¤šä¸ª(ä¸€ä¸ªå­—æ®µç”¨ä¸€ä¸ªè¯¥èŠ‚ç‚¹æ¥æ˜ å°„).  ã€€Heibernateçš„ä¸»é”®æ˜ å°„æ–¹å¼ï¼š\nã€€åœ¨\u0026lt;id ...\u0026gt;èŠ‚ç‚¹ä¸‹ç”¨\u0026lt;generator class=\u0026quot;æ˜ å°„æ–¹å¼\u0026quot;/\u0026gt;èŠ‚ç‚¹æŒ‡å®šHibernateå‘æ•°æ®åº“æ’å…¥æ•°æ®æ—¶ä¸»é”®çš„ç”Ÿæˆæ–¹å¼.\n assignedï¼šåº”ç”¨ç¨‹åºè‡ªèº«å¯¹idèµ‹å€¼. å½“è®¾ç½®\u0026lt;generator class=\u0026quot;assigned\u0026quot;/\u0026gt;æ—¶ï¼Œåº”ç”¨ç¨‹åºè‡ªèº«éœ€è¦è´Ÿè´£ä¸»é”®idçš„èµ‹å€¼ï¼Œç”±å¤–éƒ¨ç¨‹åºè´Ÿè´£ç”Ÿæˆ(åœ¨session.save()ä¹‹å‰ä¸ºå¯¹è±¡çš„ä¸»é”®è®¾ç½®å€¼),æ— éœ€Hibernateå‚ä¸ï¼Œä¸€èˆ¬åº”ç”¨åœ¨ä¸»é”®ä¸ºè‡ªç„¶ä¸»é”®æ—¶. ä¾‹å¦‚XHä¸ºä¸»é”®æ—¶ï¼Œå½“æ·»åŠ ä¸€ä¸ªå­¦ç”Ÿä¿¡æ¯æ—¶ï¼Œå°±éœ€è¦ç¨‹åºå‘˜è‡ªå·±è®¾ç½®å­¦å·çš„å€¼ï¼Œè¿™æ—¶å°±éœ€è¦åº”ç”¨è¯¥idç”Ÿæˆå™¨. nativeï¼šç”±æ•°æ®åº“å¯¹idèµ‹å€¼. å½“è®¾ç½®\u0026lt;generator class=\u0026quot;native\u0026quot;/\u0026gt;æ—¶ï¼Œæ•°æ®åº“è´Ÿè´£ä¸»é”®idçš„èµ‹å€¼ï¼Œæœ€å¸¸è§çš„æ˜¯intå‹çš„è‡ªå¢å‹ä¸»é”®. ä¾‹å¦‚ï¼Œåœ¨SQLServerä¸­å»ºç«‹è¡¨çš„idå­—æ®µä¸ºidentityï¼Œé…ç½®äº†è¯¥ç”Ÿæˆå™¨ï¼Œç¨‹åºå‘˜å°±ä¸ç”¨ä¸ºè¯¥ä¸»é”®è®¾ç½®å€¼ï¼Œå®ƒä¼šè‡ªåŠ¨è®¾ç½®. identityï¼šé‡‡ç”¨æ•°æ®åº“æä¾›çš„ä¸»é”®ç”Ÿæˆæœºåˆ¶ï¼Œä¸ºlong/short/intå‹åˆ—ç”Ÿæˆå”¯ä¸€æ ‡è¯†å¦‚SQL Serverã€MySQLä¸­çš„è‡ªå¢ä¸»é”®ç”Ÿæˆæœºåˆ¶. hiloï¼šé€šè¿‡hi/loç®—æ³•å®ç°çš„ä¸»é”®ç”Ÿæˆæœºåˆ¶ï¼Œéœ€è¦é¢å¤–çš„æ•°æ®åº“è¡¨ä¿å­˜ä¸»é”®ç”Ÿæˆå†å²çŠ¶æ€. seqhiloï¼šä¸hi/loç±»ä¼¼ï¼Œé€šè¿‡hi/loç®—æ³•å®ç°çš„ä¸»é”®ç”Ÿæˆæœºåˆ¶ï¼Œåªæ˜¯ä¸»é”®å†å²çŠ¶æ€ä¿å­˜åœ¨sequenceä¸­ï¼Œé€‚ç”¨äºæ”¯æŒsequenceçš„æ•°æ®åº“ï¼Œå¦‚Oracle. incrementï¼šä¸»é”®æŒ‰æ•°å€¼é¡ºåºé€’å¢. æ­¤æ–¹å¼çš„å®ç°æœºåˆ¶ä¸ºåœ¨å½“å‰åº”ç”¨å®ä¾‹ä¸­ç»´æŒä¸€ä¸ªå˜é‡ï¼Œä»¥ä¿å­˜å½“å‰çš„æœ€å¤§å€¼ï¼Œä¹‹åæ¯æ¬¡éœ€è¦ç”Ÿæˆä¸»é”®çš„æ—¶å€™å°†æ­¤å€¼åŠ 1ä½œä¸ºä¸»é”®. è¿™ç§æ–¹å¼å¯èƒ½äº§ç”Ÿçš„é—®é¢˜æ˜¯ï¼šå¦‚æœå½“å‰æœ‰å¤šä¸ªå®ä¾‹è®¿é—®åŒä¸€ä¸ªæ•°æ®åº“ï¼Œç”±äºå„ä¸ªå®ä¾‹å„è‡ªç»´æŠ¤ä¸»é”®çŠ¶æ€ï¼Œä¸åŒå®ä¾‹å¯èƒ½ç”ŸæˆåŒæ ·çš„ä¸»é”®ï¼Œä»è€Œé€ æˆä¸»é”®é‡å¤å¼‚å¸¸. å› æ­¤ï¼Œå¦‚æœåŒä¸€ä¸ªæ•°æ®åº“æœ‰å¤šä¸ªå®ä¾‹è®¿é—®ï¼Œè¿™ç§æ–¹å¼åº”è¯¥é¿å…ä½¿ç”¨. sequenceï¼šé‡‡ç”¨æ•°æ®åº“æä¾›çš„sequenceæœºåˆ¶ç”Ÿæˆä¸»é”®ï¼Œç”¨äºç”¨åºåˆ—æ–¹å¼äº§ç”Ÿä¸»é”®çš„æ•°æ®åº“(å¦‚:Oracleã€DB2ç­‰çš„Sequence),ç”¨äºä¸ºlong/short/intå‹åˆ—ç”Ÿæˆå”¯ä¸€æ ‡è¯†,å¦‚:\u0026lt;generator class=\u0026quot;sequence\u0026quot;\u0026gt;\u0026lt;param name=\u0026quot;sequence\u0026quot;\u0026gt;åºåˆ—å\u0026lt;/param\u0026gt;\u0026lt;/generator\u0026gt;å¦‚Oracle sequence. uuid.hexï¼šç”±HibernateåŸºäº128ä½å”¯ä¸€å€¼äº§ç”Ÿç®—æ³•ï¼Œæ ¹æ®å½“å‰è®¾å¤‡IPã€æ—¶é—´ã€JVMå¯åŠ¨æ—¶é—´ã€å†…éƒ¨è‡ªå¢é‡ç­‰4ä¸ªå‚æ•°ç”Ÿæˆåå…­è¿›åˆ¶æ•°å€¼ï¼ˆç¼–ç åé•¿åº¦ä¸º32ä½çš„å­—ç¬¦ä¸²è¡¨ç¤ºï¼‰ä½œä¸ºä¸»é”®. å³ä½¿æ˜¯åœ¨å¤šå®ä¾‹å¹¶å‘è¿è¡Œçš„æƒ…å†µä¸‹ï¼Œè¿™ç§ç®—æ³•åœ¨æœ€å¤§ç¨‹åº¦ä¸Šä¿è¯äº†äº§ç”Ÿidçš„å”¯ä¸€æ€§. å½“ç„¶ï¼Œé‡å¤çš„æ¦‚ç‡åœ¨ç†è®ºä¸Šä¾ç„¶å­˜åœ¨ï¼Œåªæ˜¯æ¦‚ç‡æ¯”è¾ƒå°. ä¸€èˆ¬è€Œè¨€ï¼Œåˆ©ç”¨uuid.hexæ–¹å¼ç”Ÿæˆä¸»é”®å°†æä¾›æœ€å¥½çš„æ•°æ®æ’å…¥æ€§èƒ½å’Œæ•°æ®å¹³å°é€‚åº”æ€§. uuid.stringï¼šä¸uuid.hexç±»ä¼¼ï¼Œåªæ˜¯å¯¹ç”Ÿæˆçš„ä¸»é”®è¿›è¡Œç¼–ç ï¼ˆé•¿åº¦ä¸º16ä½ï¼‰. åœ¨æŸäº›æ•°æ®åº“ä¸­å¯èƒ½å‡ºç°é—®é¢˜. foreignï¼šä½¿ç”¨å¤–éƒ¨è¡¨çš„å­—æ®µä½œä¸ºä¸»é”®. è¯¥ä¸»é”®ä¸€èˆ¬åº”ç”¨åœ¨è¡¨ä¸è¡¨ä¹‹é—´çš„å…³ç³»ä¸Šï¼Œä¼šåœ¨åé¢çš„è¡¨å¯¹åº”å…³ç³»ä¸Šè¿›ä¸€æ­¥è®²è§£. selectï¼šHibernate 3æ–°å¼•å…¥çš„ä¸»é”®ç”Ÿæˆæœºåˆ¶ï¼Œä¸»è¦é’ˆå¯¹é—ç•™ç³»ç»Ÿçš„æ”¹é€ å·¥ç¨‹. ç”±äºå¸¸ç”¨çš„æ•°æ®åº“ï¼Œå¦‚SQLServerã€MySQLç­‰ï¼Œéƒ½æä¾›äº†æ˜“ç”¨çš„ä¸»é”®ç”Ÿæˆæœºåˆ¶ï¼ˆå¦‚auto-increaseå­—æ®µï¼‰ï¼Œå¯ä»¥åœ¨æ•°æ®åº“æä¾›çš„ä¸»é”®ç”Ÿæˆæœºåˆ¶ä¸Šï¼Œé‡‡ç”¨nativeç”Ÿæˆå™¨æ¥é…ç½®ä¸»é”®ç”Ÿæˆæ–¹å¼.  Hibernateçš„æ ¸å¿ƒç±»å’Œæ¥å£ 1ã€Configurationç±» å®ƒçš„ä½œç”¨æ˜¯ï¼š\n è´Ÿè´£ç®¡ç†hibernateçš„é…ç½®ä¿¡æ¯ï¼› è¯»å–hibernate.cfg.xmlæ–‡ä»¶ï¼› åŠ è½½hibernate.cfg.xmlé…ç½®æ–‡ä»¶ä¸­é…ç½®çš„é©±åŠ¨æ–‡ä»¶ï¼Œurlï¼Œç”¨æˆ·åï¼Œå¯†ç ï¼Œè¿æ¥æ± ï¼› ç®¡ç† *.hbm.xmlå¯¹è±¡å…³ç³»æ–‡ä»¶.  2ã€hibernate.cfg.xmlæ–‡ä»¶  è¯¥æ–‡ä»¶ä¸»è¦ç”¨äºåˆ¶å®šå„ä¸ªå‚æ•°ï¼Œå€¼hibernateæ ¸å¿ƒæ–‡ä»¶ï¼› é»˜è®¤æ”¾åœ¨srcç›®å½•ä¸‹ï¼Œä¹Ÿå¯ä»¥åœ¨åˆ«çš„ç›®å½•ä¸‹ï¼› æŒ‡å®šè¿æ¥æ•°æ®åº“çš„é©±åŠ¨ã€ç”¨æˆ·åã€urlã€å¯†ç ã€è¿æ¥æ± ï¼› åˆ¶å®šå¯¹è±¡å…³ç³»æ˜ å°„æ–‡ä»¶ä½ç½®ï¼› ä¹Ÿå¯ä»¥ä½¿ç”¨hibernate,propertiesæ–‡ä»¶æ¥æ›¿ä»£è¯¥æ–‡ä»¶.  3ã€SessionFactory æ¥å£  å¯ä»¥ç¼“å­˜SQLè¯­å¥æˆ–è€…æ•°æ®ï¼ˆç§°ä¸ºï¼‰. åœ¨åº”ç”¨ç¨‹åºåŒ–çš„æ—¶å€™åˆ›å»ºï¼Œæ˜¯ä¸€ä¸ªé‡é‡çº§çš„ç±»ï¼Œä¸€èˆ¬ç”¨å•ä¾‹æ¨¡å¼ä¿è¯ä¸€ä¸ªåº”ç”¨åªéœ€è¦ä¸€ä¸ªSessionFactoryå®ä¾‹. å¦‚æœæŸä¸ªåº”ç”¨è®¿é—®å¤šä¸ªæ•°æ®åº“ï¼Œåˆ™è¦åˆ›å»ºå¤šä¸ªå›è¯å·¥å‚å®ä¾‹ï¼Œä¸€èˆ¬ä¸€ä¸ªæ•°æ®åº“ä¸€ä¸ªä¼šè¯å·¥å‚å®ä¾‹. é€šè¿‡SessionFactoryæ¥å£å¯ä»¥è·å¾—Sessionå®ä¾‹.  Configuration cf = new Configuration().configure(); SessionFactory sf = cf.buildSessionFactory(); Session s = sf.getCurrentSession(); //æˆ–è€…ï¼šSession s = sf.openSession();  3.1 openSession()å’ŒgetCurrentSession()åŒºåˆ«  é‡‡ç”¨getCurrentSession()åˆ›å»ºçš„sessionä¼šç»‘å®šåˆ°å½“å‰çº¿ç¨‹ä¸­ï¼Œè€Œé‡‡ç”¨openSession()åˆ›å»ºçš„Sessionåˆ™ä¸ä¼šï¼› é‡‡ç”¨getCurrentSession()åˆ›å»ºçš„sessionåœ¨commitæˆ–rollbackæ—¶ä¼šè‡ªåŠ¨å…³é—­ï¼Œè€Œé‡‡ç”¨openSession()åˆ›å»ºçš„sessionå¿…é¡»æ‰‹åŠ¨å…³é—­ï¼ˆå»ºè®®ä¸ç®¡æ˜¯ç”¨å“ªä¸ªï¼Œæœ€å¥½éƒ½è¦æ‰‹åŠ¨å…³é—­ï¼‰ï¼› ä½¿ç”¨getCurrentSession()éœ€è¦åœ¨hibernate.cfg.xmlæ–‡ä»¶ä¸­åŠ å…¥å¦‚ä¸‹é…ç½®ï¼š  * å¦‚æœä½¿ç”¨çš„æ˜¯æœ¬åœ°äº‹åŠ¡ï¼ˆjdbcäº‹åŠ¡ï¼šé’ˆå¯¹ä¸€ä¸ªæ•°æ®åº“çš„äº‹åŠ¡ï¼‰* \u0026lt;property name=\u0026quot;hibernate.current_session_context_class\u0026quot;\u0026gt;thread\u0026lt;/property\u0026gt; * å¦‚æœä½¿ç”¨çš„æ˜¯å…¨å±€äº‹åŠ¡ï¼ˆjtaäº‹åŠ¡ï¼šå·æ•°æ®åº“çš„äº‹åŠ¡ï¼‰* \u0026lt;property name=\u0026quot;hibernate.current_session_context_class\u0026quot;\u0026gt;jta\u0026lt;/property\u0026gt;  å¦‚ä½•é€‰æ‹©openSession()å’ŒgetCurrentSession()\nåŸåˆ™ï¼š\n å¦‚æœéœ€è¦åœ¨åŒä¸€çº¿ç¨‹ä¸­ï¼Œä¿è¯ä½¿ç”¨åŒä¸€ä¸ªSessionï¼Œåˆ™ä½¿ç”¨getCurrentSession(). å¦‚æœåœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œéœ€è¦ä½¿ç”¨ä¸åŒçš„Sessionï¼Œåˆ™ä½¿ç”¨openSession().  3.2\tget vs load ã€€å¯ä»¥ä½¿ç”¨session.get(Student.class,i)/session.load(â€¦)è·å–å€¼\n å¦‚æœæŸ¥è¯¢ä¸åˆ°æ•°æ®ï¼Œgetä¼šè¿”å› null,ä½†æ˜¯ä¸ä¼šæŠ¥é”™, loadå¦‚æœæŸ¥è¯¢ä¸åˆ°æ•°æ®ï¼Œåˆ™æŠ¥é”™ObjectNotFoundException ä½¿ç”¨get å»æŸ¥è¯¢æ•°æ®ï¼Œ(å…ˆåˆ°ä¸€çº§/äºŒçº§)ä¼šç«‹å³å‘dbå‘å‡ºæŸ¥è¯¢è¯·æ±‚(select \u0026hellip;), å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ loadæŸ¥è¯¢æ•°æ®ï¼Œ(å…ˆåˆ°ä¸€çº§ã€äºŒçº§))å³ä½¿æŸ¥è¯¢åˆ°å¯¹è±¡ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªä»£ç†å¯¹è±¡,å¦‚æœåé¢æ²¡æœ‰ä½¿ç”¨æŸ¥è¯¢ç»“æœï¼Œå®ƒä¸ä¼šçœŸçš„å‘æ•°æ®åº“å‘select ,å½“ç¨‹åºå‘˜ä½¿ç”¨æŸ¥è¯¢ç»“æœçš„æ—¶å€™æ‰çœŸçš„å‘å‡ºselect ,è¿™ä¸ªç°è±¡æˆ‘ä»¬ç§°ä¸ºâ€œæ‡’åŠ è½½â€(lazy) é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å–æ¶ˆâ€œæ‡’åŠ è½½â€ï¼›  \u0026lt;class name=\u0026quot;Employee\u0026quot; lazy=\u0026quot;false\u0026quot; table=\u0026quot;employee\u0026quot;\u0026gt;  å¦‚ä½•é€‰æ‹©ä½¿ç”¨å“ªä¸ª: å¦‚æœä½ ç¡®å®šDBä¸­æœ‰è¿™ä¸ªå¯¹è±¡å°±ç”¨load(),ä¸ç¡®å®šå°±ç”¨get()ï¼ˆè¿™æ ·æ•ˆç‡é«˜ï¼‰.  4ã€Transactionï¼ˆäº‹åŠ¡ï¼‰æ¥å£ ã€€äº‹åŠ¡ç®€å•åœ°è¯´å°±æ˜¯ä¸€ç»„å¯¹æ•°æ®åº“çš„æ“ä½œé›†åˆï¼Œä»–ä»¬è¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ï¼Œè¿™ä¸ªå¯ä»¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œäº‹åŠ¡å…·æœ‰åŸå­æ€§.\n Transactionæ˜¯åº•å±‚çš„äº‹ç‰©å®ç°ä¸­æŠ½å–å‡ºæ¥çš„æ¥å£ï¼› å¯èƒ½æ˜¯ä¸€ä¸ªjdbcæˆ–è€…jtaçš„äº‹åŠ¡ï¼Œè¿™æ ·æœ‰åˆ©äºhibernateåœ¨ä¸åŒæ‰§è¡Œç¯å¢ƒçš„ç§»æ¤ï¼› Hibernateè¦æ±‚æ˜¾ç¤ºçš„è°ƒç”¨äº‹åŠ¡ï¼ˆå¦‚æœä»…ä»…æ˜¯æŸ¥è¯¢å¯ä»¥ä¸è°ƒç”¨ï¼‰.  //å¢åŠ åˆ é™¤ä¿®æ”¹å¦‚æœå‘ç”Ÿå¼‚å¸¸è¦tx.rollback()å›æ»š Session sess = factory.openSession(); Transaction tx; try { tx = sess.beginTransaction(); //do some work ... tx.commit(); } catch (Exception e) { if (tx!=null) tx.rollback(); throw e; } finally { sess.close(); }  5ã€Query æ¥å£ ã€€Queryæ¥å£ç±»å‹çš„å¯¹è±¡å¯ä»¥å¯¹æ•°æ®åº“æ“ä½œï¼Œä»–å¯ä»¥ä½¿ç”¨Hqlï¼ŒQbcï¼ŒQbeå’ŒåŸç”ŸSQLï¼ˆnative Sqlï¼‰å¯¹æ•°æ®åº“æ“ä½œï¼Œå®˜æ–¹æ¨èä½¿ç”¨Hqlè¯­å¥.\n//è·å–queryå¼•ç”¨[è¿™é‡ŒEmployeeä¸æ˜¯è¡¨åï¼Œè€Œæ˜¯domainç±»å]ï¼Œwhereåé¢çš„æ¡ä»¶æœ€å¥½ä½¿ç”¨ç±»ä¸‹çš„å±æ€§å Query query = session.createQuery(\u0026quot;from Employee where id=10\u0026quot;); //é€šè¿‡listæ–¹æ³•è·å–ç»“æœï¼Œè¿™ä¸ªlistä¼šè‡ªåŠ¨å°è£…æˆå¯¹åº”çš„domainå¯¹è±¡ List\u0026lt;Employee\u0026gt; list = query.list(); for(Employee e:list) ...  6ã€Criteriaæ¥å£ ã€€ä»€ä¹ˆæ˜¯QBCï¼š QBCï¼ˆQuery By Criteriaï¼‰æŒ‰æ¡ä»¶æŸ¥è¯¢ï¼Œé€šè¿‡Criteriaæ„é€ æŸ¥è¯¢æ¡ä»¶ï¼Œå³é€šè¿‡è°ƒç”¨Criteriaçš„apiå®ç°å„ç§æŸ¥è¯¢.\nã€€é€šè¿‡Criteriaå¯¹è±¡æ‹¼è£… æŸ¥è¯¢æ¡ä»¶ï¼Œè°ƒç”¨Criteriaçš„addæ–¹æ³•æ‹¼æ¥æŸ¥è¯¢æ¡ä»¶ï¼Œæœ€ç»ˆhibernateé€šè¿‡criteriaå¯¹è±¡è‡ªåŠ¨ç”Ÿæˆsqlè¯­å¥.\nï¼ˆäº†è§£ï¼‰çº¯é¢å‘å¯¹è±¡çš„æ£€ç´¢æ–¹å¼\nSession session=HibernateUtil.getCurrentSession(); Transaction ts=null;\ttry {\tts=session.beginTransaction();\tCriteria cri = session.createCriteria(Employee.class). setMaxResults(2).addOrder(Order.desc(\u0026quot;id\u0026quot;) );//æŒ‰ç…§å‡åº List\u0026lt;Employee\u0026gt; list=cri.list(); for(Employee e: list){ System.out.println(e.getAaaid()); }\tts.commit();\t} catch (Exception e) {\tif(ts!=null){ ts.rollback(); } throw new RuntimeException(e.getMessage()); }finally{ //å…³é—­session if(session!=null\u0026amp;\u0026amp;session.isOpen()){ session.close(); } }  MySQLè®°å½•æ€»æ•°æŸ¥è¯¢  åˆ†é¡µæŸ¥è¯¢  æŠ•å½±æŸ¥è¯¢æ–¹æ³•  è®°å½•æ€»æ•°æŸ¥è¯¢   DetachedCriteria  DetachedCriteriaæ˜¯ä»€ä¹ˆï¼Ÿç¦»çº¿çš„Criteria. DetachedCriteriaå’ŒCriteriaåŒºåˆ«ï¼š  Criteriaåˆ›å»ºæ–¹æ³•ï¼šsession.createCriteria DetachedCriteriaåˆ›å»ºæ–¹æ³•ï¼šä¸éœ€è¦sessionï¼   DetachedCriteriaå’ŒCriteriaç›¸åŒç‚¹ï¼šå®ç°æŸ¥è¯¢æ¡ä»¶æ‹¼è£….  ã€€å»ºè®®ä½¿ç”¨DetachedCriteriaï¼Œå› ä¸ºDetachedCriteriaåˆ›å»ºä¸éœ€è¦sessionï¼Œåœ¨ä»»ä½•ä»£ç ä¸­é€šè¿‡DetachedCriteria æ‹¼æ¥æŸ¥è¯¢æ¡ä»¶. è¿™é‡Œçš„HibernateUtilä¸ºæ‰“å¼€SessionFactory.\nservice ã€€æ¥æ”¶servletä¼ å…¥æŸ¥è¯¢æ¡ä»¶ï¼Œå°†æŸ¥è¯¢æ¡ä»¶æ‹¼è£…æˆDetachedCritriea. @Override public Long findCustomerCount(CstCustomer cstCustomer) { //åˆ›å»ºDetachedCriteria DetachedCriteria detachedCriteria = DetachedCriteria.forClass(CstCustomer.class); //æ ¹æ®cstCustomerä¸­æ•°æ®åŠ¨æ€æ‹¼æ¥æŸ¥è¯¢æ¡ä»¶ if(cstCustomer!=null){ //æ‹¼æ¥å®¢æˆ·åç§°æŸ¥è¯¢æ¡ä»¶ï¼Œä½¿ç”¨like if(cstCustomer.getCustName()!=null \u0026amp;\u0026amp; !cstCustomer.getCustName().equals(\u0026quot;\u0026quot;)){ detachedCriteria.add(Restrictions.like(\u0026quot;custName\u0026quot;, \u0026quot;%\u0026quot;+cstCustomer.getCustName()+\u0026quot;%\u0026quot;)); } //æ‹¼æ¥è”ç³»äººæŸ¥è¯¢æ¡ä»¶ if(cstCustomer.getCustLinkman()!=null \u0026amp;\u0026amp; !cstCustomer.getCustLinkman().equals(\u0026quot;\u0026quot;)){ detachedCriteria.add(Restrictions.eq(\u0026quot;custLinkman\u0026quot;,cstCustomer.getCustLinkman())); } } CstCustomerDao cstCustomerDao = new CstCustomerDaoImpl(); return cstCustomerDao.findCustomerCount(detachedCriteria); } @Override public List\u0026lt;CstCustomer\u0026gt; findCustomerList(CstCustomer cstCustomer, int firstResult, int maxResults) { CstCustomerDao cstCustomerDao = new CstCustomerDaoImpl(); //åˆ›å»ºDetachedCriteria DetachedCriteria detachedCriteria = DetachedCriteria.forClass(CstCustomer.class); //æ‹¼æ¥æŸ¥è¯¢æ¡ä»¶ //æ ¹æ®cstCustomerä¸­æ•°æ®åŠ¨æ€æ‹¼æ¥æŸ¥è¯¢æ¡ä»¶ if(cstCustomer!=null){ //æ‹¼æ¥å®¢æˆ·åç§°æŸ¥è¯¢æ¡ä»¶ï¼Œä½¿ç”¨like if(cstCustomer.getCustName()!=null \u0026amp;\u0026amp; !cstCustomer.getCustName().equals(\u0026quot;\u0026quot;)){ detachedCriteria.add(Restrictions.like(\u0026quot;custName\u0026quot;, \u0026quot;%\u0026quot;+cstCustomer.getCustName()+\u0026quot;%\u0026quot;)); } //æ‹¼æ¥è”ç³»äººæŸ¥è¯¢æ¡ä»¶ if(cstCustomer.getCustLinkman()!=null \u0026amp;\u0026amp; !cstCustomer.getCustLinkman().equals(\u0026quot;\u0026quot;)){ detachedCriteria.add(Restrictions.eq(\u0026quot;custLinkman\u0026quot;,cstCustomer.getCustLinkman())); } } return cstCustomerDao.findCustomerList(detachedCriteria, firstResult, maxResults); }  log4jå­¦ä¹  ç›®æ ‡ï¼šå­¦ä¼šä½¿ç”¨log4jè‡ªå®šä¹‰è¾“å‡ºæ—¥å¿—ä¿¡æ¯.\nhibernateé»˜è®¤ä½¿ç”¨slf4jæ¡†æ¶.\n slf4jï¼šæä¾›äº†ä¸€å¥—æ—¥å¿—è®°å½•æ¥å£è§„èŒƒ. log4jï¼šæ—¥å¿—æ¥å£çš„å®ç°ç±».  ã€€å¦‚æœ ä½¿ç”¨log4jéœ€è¦ä»¥classpathä¸‹æ·»åŠ log4j.propertiesæ–‡ä»¶.\nLog4jåŒ…æ‹¬ä¸‰ä¸ªä¸»è¦éƒ¨ä»¶ï¼Œåˆ†åˆ«æ˜¯ï¼š\n è®°å½•å™¨ï¼ˆLoggersï¼‰ï¼šé…ç½®æ—¥å¿—åœ¨å“ªè®°å½•. è¾“å‡ºæºï¼ˆAppendersï¼‰ï¼šé…ç½®æ—¥å¿—è¾“å‡ºåˆ°å“ªé‡Œ.  å¸ƒå±€ï¼ˆLayoutsï¼‰ï¼ŒæŒ‡å®šæ—¥å¿—è¾“å‡ºæ ¼å¼ è®°å½•å™¨ï¼š  log4j.rootLogger=debug,A log4j.appender.A=org.apache.log4j.ConsoleAppender log4j.appender.A.layout=org.apache.log4j.PatternLayout  æ—¥å¿—çº§åˆ«\n  æ—¥å¿—çº§åˆ«ç”±ä½åˆ°é«˜ä¸ºï¼šALL \u0026lt; TRACE \u0026lt; DEBUG \u0026lt; INFO \u0026lt; WARN \u0026lt; ERROR \u0026lt; FATAL \u0026lt; OFF.\n  æ—¥å¿—çº§åˆ«è¶Šä½è¾“å‡ºæ—¥å¿—è¶Šå¤šï¼Œå› ä¸ºå°†ç³»ç»Ÿè°ƒè¯•ä¿¡æ¯è®¾ç½®çº§åˆ«ä½ï¼Œç³»ç»Ÿçš„é”™è¯¯ä¿¡æ¯çº§åˆ«è¦é«˜ï¼Œè®¾ç½®æˆerror.\n  æ ¹æ®log4j.propertiesä¸­çº§åˆ«è®¾ç½®ï¼Œå°†çº§åˆ«é«˜çš„æ—¥å¿—è¾“å‡º.\nåœ¨å¼€å‘é˜¶æ®µè®¾ç½®ä¸ºdebugï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒè®¾ç½®infoæˆ–error.\nç”¨MyEclipseè¿›è¡Œhibernateå¿«é€Ÿå¼€å‘ ã€€æ‰‹åŠ¨é…ç½®:\ndb(table )-\u0026gt; æ‰‹å†™domainå¯¹è±¡-\u0026gt;å¯¹è±¡å…³ç³»æ˜ å°„æ–‡ä»¶.\nç°åœ¨æˆ‘ä»¬å¸Œæœ›ç”¨å·¥å…·å®ŒæˆDomainå¯¹è±¡å’Œå…³ç³»æ˜ å°„æ–‡ä»¶çš„å·¥ä½œ. é”™è¯¯ä¿¡æ¯\njava.lang.AbstractMethodError: com.microsoft.jdbc.base.BaseDatabaseMetaData.supportsGetGeneratedKeys()Z\nè§£å†³ï¼šmicrosoftæä¾›çš„æ•°æ®åº“é©±åŠ¨å­˜åœ¨bug. éœ€è¦æ¢ä¸€ç§é©±åŠ¨è¿æ¥ï¼Œä½¿ç”¨jtdsï¼ˆä¸‹è½½åœ°å€ï¼‰ä¸‹è½½jtds1.2ç‰ˆï¼Œè§£å‹å¾—åˆ°jtds-1.2.jarï¼Œå¼•ç”¨åˆ°eclipseä¸­é¡¹ç›®ç›®å½•ä¸‹ï¼ˆå»é™¤åŸé©±åŠ¨å¼•ç”¨ï¼‰ï¼Œæ›´æ”¹hibernateé…ç½®æ–‡ä»¶.\nåŸé©±åŠ¨è¿æ¥é…ç½®ï¼š\n\u0026lt;property name=\u0026quot;connection.driver_class\u0026quot;\u0026gt;com.microsoft.jdbc.sqlserver.SQLServerDriver\u0026lt;/property\u0026gt; \u0026lt;property name=\u0026quot;connection.url\u0026quot;\u0026gt;jdbc:microsoft:sqlserver://127.0.0.1:1433;DatabaseName=hibernate\u0026lt;/property\u0026gt;  æ›´æ”¹jtdsè¿æ¥ï¼š\n\u0026lt;property name=\u0026quot;connection.driver_class\u0026quot;\u0026gt;net.sourceforge.jtds.jdbc.Driver\u0026lt;/property\u0026gt; \u0026lt;property name=\u0026quot;connection.url\u0026quot;\u0026gt;jdbc:jtds:sqlserver://127.0.0.1:1433;DatabaseName=hibernate\u0026lt;/property\u0026gt;  é—®é¢˜å¾—åˆ°è§£å†³.\nè¡¥å……ï¼šjavaä»£ç è°ƒåŸé©±åŠ¨è¿æ¥æ•°æ®åº“æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œæ­é…hibernateä¼šæœ‰æ­¤é—®é¢˜.\n# HibernateUtilå·¥å…·ç±»ï¼š package com.haibao.util; import javax.persistence.Entity; import org.hibernate.Session; import org.hibernate.SessionFactory; import org.hibernate.cfg.Configuration; @Entity final public class HibernateUtil { private static SessionFactory sessionFactory = null; private static ThreadLocal\u0026lt;Session\u0026gt; threadLocal = new ThreadLocal\u0026lt;Session\u0026gt;(); private HibernateUtil(){}; static{ sessionFactory = new Configuration().configure().buildSessionFactory(); } public static Session openSession(){ return sessionFactory.openSession(); } public static Session getCurrentSession(){ Session session = threadLocal.get(); if(session==null){ session = sessionFactory.openSession(); threadLocal.set(session); } return session; } } # å®ç°ç±»ï¼š package com.haibao.view; import javax.persistence.Entity; import org.hibernate.Session; import org.hibernate.Transaction; import com.haibao.bean.Person; import com.haibao.util.HibernateUtil; @Entity public class Main { public static void main(String[] args) { Session session = null; Transaction ts = null; try { session = HibernateUtil.getCurrentSession(); ts = session.beginTransaction(); Person p = new Person(); p.setName(\u0026quot;asd\u0026quot;); p.setSex(\u0026quot;ç”·\u0026quot;); session.persist(p); ts.commit(); } catch (Exception e) { if(ts!=null){ ts.rollback(); } throw new RuntimeException(e.getMessage()); }finally{ if(session!=null \u0026amp;\u0026amp; session.isOpen()){ session.close(); } } } }  HQLè¯­å¥ï¼ˆHibernate Query Languageï¼‰ ã€€é¢å‘å¯¹è±¡çš„æŸ¥è¯¢è¯­å¥ï¼Œä¸SQLä¸åŒï¼ŒHQlä¸­çš„å¯¹è±¡æ˜¯åŒºåˆ†å¤§å°å†™çš„ï¼ˆé™¤äº†JAVAç±»å’Œå±æ€§å…¶ä»–éƒ¨åˆ†ä¸åŒºåˆ†å¤§å°å†™ï¼‰ï¼›åœ¨HQLä¸­æŸ¥çš„æ˜¯å¯¹è±¡è€Œä¸æ˜¯è¡¨ï¼Œå¹¶ä¸”æ”¯æŒå¤šæ€ï¼›HQLä¸»è¦é€šè¿‡Queryæ¥æ“ä½œï¼ŒQueryçš„åˆ›å»ºæ–¹å¼ï¼š\nQuery query = session.createQuery(hql);  ã€€ç°åœ¨ä½¿ç”¨hibernateå·¥å…·ï¼Œè‡ªåŠ¨ç”Ÿæˆ domain å¯¹è±¡ å’Œæ˜ å°„æ–‡ä»¶,å¦‚æœæˆ‘ä»¬çš„è¡¨æœ‰ä¸»å¤–é”®çš„å…³ç³»ï¼Œåˆ™åº”å½“å…ˆæ˜ å°„ä¸»è¡¨ï¼Œå†æ˜ å°„ä»è¡¨.\nuniqueResultæ–¹æ³• ã€€å¦‚æœæˆ‘ä»¬æ£€ç´¢ä¸€ä¸ªå¯¹è±¡ï¼Œæ˜ç¡®çŸ¥é“æœ€å¤šåªæœ‰ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™å»ºè®®ä½¿ç”¨è¯¥æ–¹æ³•ï¼Œç®€å•é«˜æ•ˆ. å…·ä½“ç”¨æ³•å¦‚ä¸‹:\nStudent s=(Student) session.createQuery(\u0026quot;from Student where sid='20050003'\u0026quot;).uniqueResult(); System.out.println(s.getSname());  distinctçš„ç”¨æ³• è¿‡æ»¤é‡å¤çš„è®°å½•\n//æ¯”å¦‚ï¼Œæ˜¾ç¤ºæ‰€æœ‰å­¦ç”Ÿçš„æ€§åˆ«å’Œå¹´é¾„. List list=session.createQuery(\u0026quot;select distinct sage,ssex from Student\u0026quot;).list(); for(int i=0;i\u0026lt;list.size();i++){ Object [] objs=(Object[]) list.get(i); System.out.println(objs[0].toString()+\u0026quot; \u0026quot;+objs[1].toString()); }  between and.. List list=session.createQuery(\u0026quot;select distinct sage,ssex,sname from Student where sage between 20 and 22\u0026quot;).list(); for(int i=0;i\u0026lt;list.size();i++){ Object [] objs=(Object[]) list.get(i); System.out.println(objs[0].toString()+\u0026quot; \u0026quot;+objs[1].toString()+objs[2].toString()); }  in/not in //æŸ¥è¯¢è®¡ç®—æœºç³»å’Œå¤–è¯­ç³»çš„å­¦ç”Ÿä¿¡æ¯ List\u0026lt;Student\u0026gt; list=session.createQuery(\u0026quot;from Student where sdept in ('è®¡ç®—æœºç³»','å¤–è¯­ç³»')\u0026quot;).list(); //å–å‡º1. for å¢å¼º for(Student s:list){ System.out.println(s.getSname()+\u0026quot; \u0026quot;+s.getSaddress()+\u0026quot; \u0026quot;+s.getSdept()); }  group byä½¿ç”¨ //æ˜¾ç¤ºå„ä¸ªç³»çš„å­¦ç”Ÿçš„å¹³å‡å¹´é¾„ List\u0026lt;Object[]\u0026gt; list=session.createQuery(\u0026quot;select avg(sage),sdept from Student group by sdept\u0026quot;).list(); //å–å‡º1. for å¢å¼º for(Object[] obj:list){ System.out.println(obj[0].toString()+\u0026quot; \u0026quot;+obj[1].toString()); }  havingçš„ä½¿ç”¨ //1.å¯¹åˆ†ç»„æŸ¥è¯¢åçš„ç»“æœï¼Œè¿›è¡Œç­›é€‰:æ¯”å¦‚è¯·æ˜¾ç¤ºäººæ•°å¤§äº3çš„ç³»åç§° //a. æŸ¥è¯¢å„ä¸ªç³»åˆ†åˆ«æœ‰å¤šå°‘å­¦ç”Ÿ. List\u0026lt;Object[]\u0026gt; list=session.createQuery(\u0026quot;select count(*) as c1,sdept from Student group by sdept having count(*)\u0026gt;3\u0026quot;).list(); //å–å‡º1. for å¢å¼º for(Object[] obj:list){ System.out.println(obj[0].toString()+\u0026quot; \u0026quot;+obj[1].toString()); } //2æŸ¥è¯¢å¥³ç”Ÿå°‘äº200äººçš„ç³» //a.æŸ¥è¯¢å„ä¸ªç³»çš„å¥³ç”Ÿæœ‰å¤šä¸ªä¸ª List\u0026lt;Object[]\u0026gt; list=session. createQuery(\u0026quot;select count(*) as c1,sdept from Student where ssex='F' group by sdept\u0026quot;).list(); //å–å‡º1. for å¢å¼º for(Object[] obj:list){ System.out.println(obj[0].toString()+\u0026quot; \u0026quot;+obj[1].toString()); } //1.æŸ¥è¯¢è®¡ç®—æœºç³»å…±å¤šå°‘äºº?-\u0026gt;å¦‚æœæˆ‘ä»¬è¿”å›çš„æ˜¯ä¸€åˆ—æ•°æ® //è¿™æ—¶æˆ‘ä»¬çš„å–æ³•æ˜¯ç›´æ¥å–å‡ºlist-\u0026gt;object è€Œä¸æ˜¯ list-\u0026gt;Object[] List\u0026lt;Object[]\u0026gt; list=session.createQuery(\u0026quot;select sage from Student where sdept='è®¡ç®—æœºç³»'\u0026quot;).list(); //å–å‡º1. for å¢å¼º for(Object obj:list){ System.out.println(obj.toString()); } //3.æŸ¥è¯¢é€‰ä¿®11å·è¯¾ç¨‹çš„æœ€é«˜åˆ†å’Œæœ€ä½åˆ†. List\u0026lt;Object[]\u0026gt; list=session. createQuery(\u0026quot;select 11,max(grade),min(grade) from Studcourse where course.cid=11\u0026quot;).list(); //å–å‡º1. for å¢å¼º for(Object[] obj:list){ System.out.println(obj[0].toString()+\u0026quot; max=\u0026quot;+obj[1].toString()+\u0026quot; min=\u0026quot;+obj[2].toString()); } //4.è®¡ç®—å„ä¸ªç§‘ç›®ä¸åŠæ ¼çš„å­¦ç”Ÿæ•°é‡. List\u0026lt;Object[]\u0026gt; list=session. createQuery(\u0026quot;select count(*),student.sdept from StudCourse where grade\u0026lt;60 group by student.sdept\u0026quot;).list(); //å–å‡º1. for å¢å¼º for(Object[] obj:list){ System.out.println(obj[0].toString()+\u0026quot; \u0026quot;+obj[1].toString()); }  åˆ†é¡µæ˜¾ç¤ºå¯¹è±¡ï¼š ã€€æ ¹æ®ç”¨æˆ·è¾“å…¥çš„pageNowå’ŒpageSizeç°å®å¯¹è±¡\nQuery query = session.createQuery(hql); query.setFirdtRequest(ä»ç¬¬å‡ æ¡å–//ä»0å¼€å§‹è®¡ç®—); query.setMaxRequest(å–å‡ºå‡ æ¡); List list = query.list(); //listå°±æ˜¯ç»“æœ query = session.createQuery(å¾—åˆ°count(*)çš„æŸ¥è¯¢è¯­å¥); int pageRow = (Integer)query.list().get(0).intValue();  å‚æ•°ç»‘å®š ã€€å¯ä»¥ç”¨setParameter()æ–¹æ³•æ¥ç¡®å®šå˜é‡çš„å€¼ï¼š\nQuery query = session.createQuery(\u0026quot;from Student where sdept = :dept and sage\u0026gt;:age\u0026quot;); query.setParameter(å‚æ•°åï¼Œå€¼);  ä½¿ç”¨ç»‘å®šå‚æ•°çš„å¥½å¤„ï¼š\n å¯è¯»æ€§å¥½ æ€§èƒ½æé«˜ é˜²æ­¢SQLæ³¨å…¥ï¼ˆwhere 1=1ï¼‰  æç¤ºï¼šä¹Ÿå¯ä»¥ä½¿ç”¨setInteger().setString()â€¦æ¥æŒ‡å®šå€¼.\nå¦å¤–ï¼šhqlè¯­å¥ä¹Ÿå¯ä»¥ç”¨â€œ?â€æ¥æŒ‡å®šå¸¦ç»‘å®šçš„å‚æ•°.\nQuery query = session.createQuery(â€œfrom Student where sdept = ? and sage\u0026gt;?â€); query.setParameter(0ï¼Œå€¼); query.setParameter(1ï¼Œå€¼);  åœ¨æ˜ å°„æ–‡ä»¶ä¸­å¾—åˆ°hqlè¯­å¥ ã€€å¯ä»¥ä»æŸäº›æ˜ å°„æ–‡ä»¶ä¸­å¾—åˆ°hqlè¯­å¥ï¼Œæ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼Œè¿™æ ·å¯ä»¥æ›´åŠ çµæ´»ï¼Œåœ¨æŸç§æƒ…å†µä¸‹ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨. æ¯”å¦‚ï¼šåœ¨Student.hbm.xmlä¸­.\n\u0026lt;query name=â€myquerytestâ€\u0026gt; \u0026lt;![CDATA[select sname,ssex from Student where sage\u0026gt;22]]\u0026gt; \u0026lt;/query\u0026gt; å¦‚ä½•ä½¿ç”¨ï¼š List list = session.getNameQuery(â€œmyQuerytestâ€).lise(); System.out.println(list.size()); Iterator iterator = list.iterator(); while(iterator.hasNext()){ Object obj[] = (Object[])iterator.next(); System.out.println(â€œN=â€+obj[0]); }  ä½¿ç”¨å­æŸ¥è¯¢ hibernateä¸­çš„å¯¹è±¡å­˜åœ¨ä¸‰ç§å…³ç³»  one-to-oneï¼šèº«ä»½è¯â†â†’äºº one-to-manyã€many-to-oneã€‘éƒ¨é—¨â†â†’å‘˜å·¥ many-to-manyï¼šè€å¸ˆâ†â†’å­¦ç”Ÿï¼ˆå°½é‡åŒ–ç®€ï¼‰ å®é™…å¼€å‘ä¸­ï¼Œå¦‚æœå‡ºç°äº†many-to-manyå…³ç³»ï¼Œç”¨å°†å…¶è£…æ¢æˆä¸¤ä¸ªone-to-manyæˆ–è€…many-to-oneï¼Œè¿™æ ·ç¨‹åºå¥½æ§åˆ¶ï¼ŒåŒæ—¶ä¸ä¼šå†—ä½™.  criterialä½¿ç”¨:\n//æŸ¥è¯¢å¹´é¾„å¤§äº10å²çš„å­¦ç”Ÿ criteria Session s=HibernateUtil.getCurrentSession(); Transaction tx=s.beginTransaction(); Criteria cri=s.createCriteria(Student.class); //æ·»åŠ æ£€ç´¢æ¡ä»¶ cri.add(Restrictions.gt(\u0026quot;sage\u0026quot;, new Long(10))); List\u0026lt;Student\u0026gt; list=cri.list(); for(Student s1: list){ System.out.println(s1.getSname()); } tx.commit();  hibernateå¼€å‘çš„ä¸‰ç§æ–¹å¼ä¸­çš„ ã€€ç¼–å†™domain object + æ˜ å°„æ–‡ä»¶ \u0026mdash;\u0026mdash;\u0026gt; åˆ›å»ºå‡ºå¯¹åº”çš„æ•°æ®åº“,è¿™é‡Œæˆ‘ä»¬è¯´æ˜å¦‚æœè¦è‡ªåŠ¨çš„åˆ›å»ºå‡ºå¯¹åº”çš„æ•°æ®åº“ï¼Œéœ€è¦åšé…ç½®(hibernate.cfg.xml).\n\u0026lt;property name=\u0026quot;hbm2ddl.auto\u0026quot;\u0026gt;create\u0026lt;/property\u0026gt;  è¿™é‡Œæœ‰å››ä¸ªé…ç½®å€¼: create , update , create-drop, validate\n create:å½“æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºåŠ è½½hibernate.cfg.xml[new Configuration().config();]å°±ä¼šæ ¹æ®æ˜ å°„æ–‡ä»¶ï¼Œåˆ›å»ºå‡ºæ•°æ®åº“, æ¯æ¬¡éƒ½ä¼šé‡æ–°åˆ›å»ºï¼Œ åŸæ¥è¡¨ä¸­çš„æ•°æ®å°±æ²¡æœ‰!!! update: å¦‚æœæ•°æ®åº“ä¸­æ²¡æœ‰è¯¥è¡¨ï¼Œåˆ™åˆ›å»ºï¼Œå¦‚æœæœ‰è¡¨ï¼Œåˆ™çœ‹æœ‰æ²¡æœ‰å˜åŒ–ï¼Œå¦‚æœæœ‰å˜åŒ–ï¼Œåˆ™æ›´æ–°. create-drop: åœ¨æ˜¾ç¤ºå…³é—­ sessionFactoryæ—¶ï¼Œå°†dropæ‰æ•°æ®åº“çš„schema validate: ç›¸å½“äºæ¯æ¬¡æ’å…¥æ•°æ®ä¹‹å‰éƒ½ä¼šéªŒè¯æ•°æ®åº“ä¸­çš„è¡¨ç»“æ„å’Œhbmæ–‡ä»¶çš„ç»“æ„æ˜¯å¦ä¸€è‡´  ã€€åœ¨å¼€å‘æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬é…ç½®å“ªä¸ªéƒ½å¯ä»¥æµ‹è¯•ï¼Œä½†æ˜¯å¦‚æœé¡¹ç›®å‘å¸ƒåï¼Œæœ€å¥½è‡ªå·±é…ç½®ä¸€æ¬¡ï¼Œè®©å¯¹åº”çš„æ•°æ®åº“ç”Ÿæˆï¼Œå®Œåå–æ¶ˆé…ç½®.\ndomainå¯¹è±¡çš„ç»†èŠ‚:\n éœ€è¦ä¸€ä¸ªæ— å‚çš„æ„é€ å‡½æ•°(ç”¨äºhibernateåå°„è¯¥å¯¹è±¡) åº”å½“æœ‰ä¸€ä¸ªæ— ä¸šåŠ¡é€»è¾‘çš„ä¸»é”®å±æ€§. ç»™æ¯ä¸ªå±æ€§æä¾› get/setæ–¹æ³•. åœ¨domianå¯¹è±¡ä¸­çš„å±æ€§ï¼Œåªæœ‰é…ç½®åˆ°äº†å¯¹è±¡æ˜ å°„æ–‡ä»¶xxx.hbm.xmlåï¼Œæ‰ä¼šè¢«hiberanteç®¡ç†. å±æ€§ä¸€èˆ¬æ˜¯privateèŒƒå›´  å¯¹è±¡å…³ç³»æ˜ å°„æ–‡ä»¶çš„è¯´æ˜ï¼š\nã€€å¯¹è±¡å…³ç³»æ–‡ä»¶ä¸­ï¼Œæœ‰äº›å±æ€§æ˜¯å¯ä»¥ä¸é…ï¼Œhibernateä¼šé‡‡ç”¨é»˜è®¤æœºåˆ¶ï¼Œæ¯”å¦‚\u0026lt;class table=\u0026quot;?\u0026quot; \u0026gt; table å€¼ä¸é…ï¼Œåˆ™ä»¥ç±»çš„å°å†™åšè¡¨åï¼›\u0026lt;property type=\u0026quot;?\u0026quot;\u0026gt; typeä¸é…ç½®ï¼Œåˆ™hibernateä¼šæ ¹æ®ç±»çš„å±æ€§ç±»å‹ï¼Œé€‰æ‹©ä¸€ä¸ªé€‚å½“çš„ç±»å‹.\nHibernateçš„ä¸‰ç§çŠ¶æ€ï¼š\n ç¬æ—¶æ€ï¼šå¯¹è±¡åˆšåˆšè¢«åˆ›å»ºï¼Œæ²¡æœ‰å¤„äºsessionçš„ç®¡ç†ä¸‹ï¼ŒåŒæ—¶åœ¨æ•°æ®åº“æ²¡æœ‰è®°å½•ï¼› æŒä¹…æ€ï¼šæ—¢å¤„äºsessionçš„ç®¡ç†ä¸‹ï¼ŒåŒæ—¶åˆè¢«ä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼ˆåœ¨æ•°æ®åº“ä¸­æœ‰è®°å½•ï¼‰ï¼› è„±ç®¡/æ¸¸ç¦»æ€ï¼šæ²¡æœ‰åœ¨sessionç®¡ç†ä¸‹ï¼Œä½†åœ¨æ•°æ®åº“ä¸­æœ‰è®°å½•. å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡å¤„äºæ€æ ·çš„çŠ¶æ€ï¼Ÿ  ä¸»è¦çš„ä¾æ®æ˜¯:\n çœ‹è¯¥å¯¹è±¡æ˜¯å¦å¤„äºsessionç®¡ç†ï¼› çœ‹åœ¨æ•°æ®åº“ä¸­æœ‰æ²¡æœ‰å¯¹åº”çš„è®°å½•.    ç¬æ—¶æ€: æ²¡æœ‰sessionç®¡ç†,åŒæ—¶æ•°æ®åº“æ²¡æœ‰å¯¹åº”è®°å½•;newäº†ä¸€ä¸ªå¯¹è±¡ï¼Œæ­¤æ—¶å¯¹è±¡å°±æ˜¯ç¬æ—¶æ€;ç¬æ—¶æ€å¯¹è±¡å’Œæ•°æ®åº“è®°å½•æ²¡æœ‰å¯¹å…³ç³»ï¼Œå’Œsessionæ²¡æœ‰å…³ç³».\n  æŒä¹…æ€: æœ‰sessionç®¡ç†ï¼ŒåŒæ—¶åœ¨æ•°æ®åº“ä¸­æœ‰è®°å½•; ç¬æ—¶æ€å¯¹è±¡æ‰§è¡Œsaveå˜åŒ–æŒä¹…å±‚;æŒä¹…æ€å¯¹è±¡å’Œæ•°æ®åº“è®°å½•å­˜åœ¨å¯¹åº”å…³ç³»ï¼Œå’Œsessionæœ‰å…³ç³».ä¿®æ”¹å¯¹è±¡çš„å±æ€§ï¼Œç›´æ¥å°†æ•°æ®ä¿è¯åˆ°æ•°æ®åº“.\n  ç®¡æ€/æ¸¸ç¦»æ€ï¼š æ²¡æœ‰sessionç®¡ç†ï¼Œä½†æ˜¯åœ¨æ•°æ®åº“ä¸­æœ‰è®°å½•.å½“sessionå…³é—­åï¼ŒæŒä¹…æ€å¯¹è±¡å˜ä¸ºæ‰˜ç®¡æ€;\tæ‰˜ç®¡æ€å¯¹è±¡å’Œsessionæ²¡æœ‰å…³ç³»ï¼Œå¯èƒ½å’Œæ•°æ®åº“å­˜åœ¨å¯¹è±¡ä¹Ÿå¯èƒ½ä¸å¯¹åº”.\n  æ‰˜ç®¡æ€å’Œç¬æ—¶æ€åŒºåˆ«\n æ‰˜ç®¡æ€å¯¹è±¡:\tå’Œsessionæ²¡æœ‰å…³è”ï¼Œå¯èƒ½å’Œæ•°æ®åº“å­˜åœ¨å¯¹åº”å…³ç³»ï¼Œæ‰˜ç®¡æ€å¯¹è±¡ä¸­å­˜åœ¨ä¸»é”®çš„å€¼. æŒä¹…æ€å¯¹è±¡:\tå’Œsessionæœ‰çŠ¶æ€ ç¬æ—¶æ€å¯¹è±¡:\tå’Œsessionæ²¡æœ‰å…³è”ï¼Œå’Œæ•°æ®åº“è®°å½•æ²¡æœ‰å¯¹è±¡å…³ç³»ï¼Œæ²¡æœ‰ä¸»é”®.  å°†ç¬æ—¶æ€å¯¹è±¡è®¾ç½®ä¸€ä¸ªä¸»é”®å€¼ï¼Œå®ƒå°±å˜ä¸ºäº†æ‰˜ç®¡æ€å¯¹è±¡ï¼ï¼ï¼\nsaveOrUpdateæ–¹æ³•æµ‹è¯•ï¼š  å¯¹ç¬æ—¶æ€å¯¹è±¡æ‰§è¡Œinsertæ“ä½œ å¯¹æŒä¹…æ€å¯¹è±¡æ‰§è¡Œupdateæ“ä½œ å¯¹æ‰˜ç®¡æ€å¯¹è±¡æ‰§è¡Œupdateæ“ä½œ  æ‡’åŠ è½½: ã€€ç®€è¿°: å½“æˆ‘ä»¬æŸ¥è¯¢ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹,è¿”å›çš„åªæ˜¯è¯¥å¯¹è±¡çš„æ™®é€šå±æ€§ï¼ˆç›´æ¥å±æ€§ï¼Œä¸éœ€è¦é€šè¿‡å¤–é”®ç­‰æŸ¥è¯¢å¾—åˆ°ï¼‰,å½“ç”¨æˆ·å»ä½¿ç”¨å¯¹è±¡å±æ€§æ—¶ï¼Œæ‰ä¼šå‘æ•°æ®åº“å‘å‡ºå†ä¸€æ¬¡çš„æŸ¥è¯¢.è¿™ç§ç°è±¡æˆ‘ä»¬ç§°ä¸º lazyç°è±¡. è§£å†³æ–¹æ³•å¯ä»¥è¿™æ ·:\n æ˜¾ç¤ºåˆå§‹åŒ–ä»£ç†å¯¹è±¡ï¼š Hibernate.initized(student.getDepart())ï¼›ä¸ç›´æ¥å±æ€§ç›¸è¿çš„å¯¹è±¡. ä¿®æ”¹å¯¹è±¡å…³ç³»æ–‡ä»¶ lazy æ”¹å†™ lazy=falseï¼ˆè¯´æ˜ï¼šä¸è¦å†one-to-manyçš„oneä¸­è®¾ç½®falseï¼Œåœ¨manyä¸­è®¾ç½®å¯ä»¥æé«˜æ•ˆç‡ï¼‰ ä»¥ä¸Šä¸¤ç§æ–¹æ³• ä¸èƒ½ç›´æ¥è§£å†³æ‡’åŠ è½½é—®é¢˜. é€šè¿‡è¿‡æ»¤å™¨(webé¡¹ç›®) openSessionInView æ·»åŠ ä¸€ä¸ªè¿‡æ»¤å™¨  æ‡’åŠ è½½è¯¦è§£ï¼š ã€€æ‡’åŠ è½½ï¼ˆLoad On Demandï¼‰æ˜¯ä¸€ç§ç‹¬ç‰¹è€Œåˆå¼ºå¤§çš„æ•°æ®è·å–æ–¹æ³•ï¼Œæ˜¯æŒ‡ç¨‹åºæ¨è¿Ÿè®¿é—®æ•°æ®åº“ï¼Œè¿™æ ·å¯ä»¥ä¿è¯æœ‰æ—¶å€™ä¸å¿…è¦çš„è®¿é—®æ•°æ®åº“ï¼Œå› ä¸ºä¸€æ¬¡è®¿é—®æ•°æ®åº“æ˜¯æ¯”è¾ƒè€—æ—¶çš„. æ‡’åŠ è½½çš„å‡ ç§æƒ…å†µï¼š é¦–å…ˆæ˜ç¡®ä¸€ç‚¹ï¼šDomain Objectæ˜¯éfinallyçš„ï¼Œæ‰èƒ½å®ç°æ‡’åŠ è½½. è§£å†³æ–¹æ³•ï¼šï¼ˆå› ä¸ºè¦é‡å†™é›†åˆSetâ€¦ï¼‰\n æ˜ç¡®åˆå§‹åŒ– åœ¨sessionè¿˜æ²¡æœ‰å…³é—­æ—¶ï¼Œè®¿é—®ä¸€æ¬¡xxx.getXxx()ï¼Œå¼ºåˆ¶è®¿é—®æ•°æ®åº“. æˆ–è€…Hibernate.initialize(xxx)ï¼› openSessionView è¿™ä¸ªå¾€å¾€éœ€è¦è¿‡æ»¤å™¨é…åˆä½¿ç”¨(webç¨‹åº)ï¼› åœ¨sshä¸­ï¼Œå¯ä»¥å®ç°åœ¨serviceå±‚ï¼Œæ ‡å‡†æ–¹å¼è§£å†³æ‡’åŠ è½½ï¼› åœ¨æ˜ å°„æ–‡ä»¶ä¸­é…ç½®ï¼Œlazy=false.  Hibernateçš„å…³ç³»æ˜ å°„ï¼š mang-to-oneï¼š \u0026lt;!-- å¯¹äºprivate Department departå°±ä¸èƒ½ç”¨property many-to-one çš„name=â€œå˜é‡åâ€ column name=â€œå°†æ¥ç”Ÿæˆè¡¨çš„åâ€ --\u0026gt; \u0026lt;many-to-one name=\u0026quot;depart\u0026quot;\u0026gt; \u0026lt;column name=\u0026quot;depart_id\u0026quot;\u0026gt;\u0026lt;/column\u0026gt; \u0026lt;/many-to-one\u0026gt;  one-to-many éœ€æ±‚ï¼šæŸ¥è¯¢æ‰€æœ‰ä¸€å·éƒ¨é—¨çš„å­¦ç”Ÿ.\nå¸¸è§„æ€ç»´ï¼šString hql = â€œfrom Student where dept.id=1â€;\nè¿˜å¯ä»¥é‡‡ç”¨ä¸€å¯¹å¤šï¼š\n ç°åœ¨Departmentä¸­æ·»åŠ ä¸€ä¸ªSeté›†åˆï¼Œå¹¶ç”Ÿæˆget/setæ–¹æ³•ï¼› private Set stu;//ä¸€ä¸ªéƒ¨é—¨å¯ä»¥å¯¹åº”å¤šä¸ªå­¦ç”Ÿ åœ¨Department.hbm.xmlæ–‡ä»¶ä¸­æ·»åŠ   \u0026lt;set name=â€œé›†åˆå¯¹è±¡å±æ€§åâ€\u0026gt; \u0026lt;key column=â€œå¤–é”®åâ€\u0026gt; \u0026lt;one-to-many class=â€œé›†åˆå­˜æ”¾çš„ç±»åâ€\u0026gt; \u0026lt;/set\u0026gt; \u0026lt;!-- é…ç½®onne-to-manyå…³ç³» --\u0026gt; \u0026lt;set name=â€œstusâ€ cascade=â€œè”çº§â€\u0026gt; \u0026lt;key column=â€œdepart_idâ€\u0026gt; \u0026lt;one-to-many class=â€œStudentâ€\u0026gt;  one-to-one ä¸€å¯¹ä¸€æœ‰ä¸¤ç§æ–¹å¼ï¼š\n åŸºäºä¸»é”®çš„ä¸€å¯¹ä¸€:   ä¸»é”®å…³è”æ˜ å°„ï¼šå…¶ä¸­ä¸€ä¸ªè¡¨çš„ä¸»é”®ä¾èµ–äºå¦ä¸€å¼ è¡¨çš„ä¸»é”®è€Œå»ºç«‹èµ·çš„ä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œè¿™ä¸¤å¼ äº’ç›¸å…³è”çš„è¡¨çš„ä¸»é”®ä¸€è‡´. å¿…é¡»ä¸ºone-to-oneå…ƒç´ å¢åŠ constrained=\u0026ldquo;true\u0026quot;å±æ€§ï¼Œè¡¨æ˜è¯¥ç±»çš„ä¸»é”®ç”±å…³è”ç±»ç”Ÿæˆ.  ã€è¦ç‚¹ã€‘Person - IdCard\n\u0026lt;id name=â€idâ€\u0026gt; \u0026lt;generator class=â€foreignâ€\u0026gt; \u0026lt;param name=â€propertyâ€\u0026gt;idCard\u0026lt;/param\u0026gt; \u0026lt;/generator\u0026gt; \u0026lt;/id\u0026gt; \u0026lt;one-to-one name=â€idCardâ€ constrained=â€trueâ€/\u0026gt;  åŸºäºå¤–é”®çš„ä¸€å¯¹ä¸€ å’ŒN-1ç›¸åŒï¼Œå¤šæ·»åŠ ä¸€ä¸ªunique=\u0026ldquo;true\u0026rdquo; å±æ€§ï¼Œç”¨ä»¥è¡¨ç¤ºNçš„ä¸€ç«¯å¿…é¡»å”¯ä¸€ï¼ŒåŠ äº†å”¯ä¸€çº¦æŸï¼Œå³æˆäº†1-1  ã€ä¸¾ä¾‹ã€‘\n\u0026lt;one-to-one name=â€idCardâ€ property-ref=â€œpersonâ€/\u0026gt; \u0026lt;many-to-one name=â€personâ€ unique=â€trueâ€ /\u0026gt; # property-refï¼šç”¨äºæŒ‡å®šå…³è”ç±»çš„ä¸€ä¸ªå±æ€§ï¼Œè¿™ä¸ªå±æ€§å°†ä¼šå’Œæœ¬å¤–é”®ç›¸å¯¹åº”  many-to-many ã€€å­¦ç”Ÿâ†â†’è¯¾ç¨‹ é¡¾å®¢â†â†’å•†å“ student:one-to-mangy class Student{ private Integer id; private String name; private Set\u0026lt;StuCourse\u0026gt; stuCourses; }  ä»stucourseçš„è§’åº¦çœ‹æ˜¯ many-to-one class StuCourse{ private Integer id; private Student student; private Course course; private Integer grade; }  courset:one-to-mangy class Course{ private Integer id; private String name; private Set\u0026lt;StuCourse\u0026gt; stuCourses; }  cascadeï¼ˆEmployee-Departmentã€bbsé¡¹ç›®ç­‰ï¼‰ æ‰€è°“çº§è”æ“ä½œå°±æ˜¯è¯´ï¼Œå½“è¿›è¡ŒæŸä¸ªæ“ä½œï¼ˆæ·»åŠ /åˆ é™¤/ä¿®æ”¹â€¦ï¼‰ï¼Œå°±æœ‰hibernateè‡ªåŠ¨å®Œæˆ. ä¾‹å¦‚ï¼šDepartmentâ†â†’Employeeå½“æŸä¸ªéƒ¨é—¨è¢«åˆ é™¤åï¼Œå‘˜å·¥ä¹Ÿä¸ä¼šå­˜åœ¨. å¸¸ç”¨çš„cascadeï¼šnoneã€allã€save-updateã€deleteã€lockã€refreshã€evictã€replicã€persistã€mergeã€delete-orphan(one-to-many). ä¸€èˆ¬å¯¹many-to-manyï¼Œmany-to-oneä¸è®¾ç½®è”çº§ï¼Œåœ¨one-to-manyå’Œone-to-oneä¸­è®¾ç½®è”çº§.\nåœ¨JSPé¡µé¢ä¸­è·å–é¡¹ç›®åç§°ï¼š \u0026lt;%=this.getServletContext().getContextPath()%\u0026gt; //javaç‰‡æ®µ ${ pageContext.request.contextPath } //é€šè¿‡æ ‡ç­¾  ç¼“å­˜ ã€€ç¼“å­˜çš„ä½œç”¨ä¸»è¦ç”¨æ¥æé«˜æ€§èƒ½ï¼Œå¯ä»¥ç®€å•çš„ç†è§£æˆä¸€ä¸ªMapï¼›ä½¿ç¼“å­˜æ¶‰åŠåˆ°ä¸‰ä¸ªæ“ä½œï¼šæŠŠæ•°æ®æ”¾å…¥ç¼“å­˜ã€ä»ç¼“å­˜è·å–æ•°æ®ã€åˆ é™¤ç¼“å­˜ä¸­çš„æ— æ•ˆæ•°æ®.\nä¸€çº§ç¼“å­˜ï¼ˆSessionçº§å…±äº«ï¼‰ ä¸€çº§ç¼“å­˜æ˜¯ sessionå¯¹è±¡ä¸­ä¸€å—å†…å­˜. åœ¨åŒä¸€ä¸ªsessionä¸­ï¼ŒæŸ¥è¯¢ä¸€ä¸ªå¯¹è±¡æ˜¯ä¸ä¼šå‘å‡ºsqlè¯­å¥. sessionå…³é—­ä¸€çº§ç¼“å­˜ä¸å­˜åœ¨äº†ï¼Œå†æŸ¥è¯¢å¯¹è±¡ï¼Œä¼šå‘å‡ºsql.\nsaveï¼Œupdateï¼ŒsaveOrUpdateï¼Œloadï¼Œgetï¼Œlistï¼Œiteratorï¼Œlockè¿™äº›æ–¹æ³•éƒ½ä¼šå°†å¯¹è±¡æ”¾åœ¨ä¸€çº§ç¼“å­˜ä¸­ï¼Œä¸€çº§ç¼“å­˜ä¸èƒ½æ§åˆ¶ç¼“å­˜çš„æ•°é‡ï¼Œæ‰€ä»¥è¦æ³¨æ„å°†å¤§æ‰¹é‡æ“ä½œæ•°æ®æ—¶å¯èƒ½é€ æˆå†…å­˜æº¢å‡ºï¼›å¯ä»¥ç”¨evict(æ¸…æ¥šä¸€ä¸ªå¯¹è±¡)ï¼Œclear(æ¸…é™¤æ‰€æœ‰å¯¹è±¡)æ–¹æ³•æ¸…é™¤ç¼“å­˜çš„å†…å®¹. ç”¨HashMapæ¥æ¨¡æ‹Ÿä¸€ä¸ªSessionç¼“å­˜ï¼ŒåŠ æ·±å¯¹ç¼“å­˜çš„æ·±å…¥.\npackage com.hsp.view; import java.util.ArrayList; import java.util.HashMap; import java.util.List; import java.util.Map; public class MyCache { //ä½¿ç”¨mapæ¥æ¨¡æ‹Ÿç¼“å­˜ static Map\u0026lt;Integer,Student\u0026gt; maps=new HashMap\u0026lt;Integer,Student\u0026gt;(); public static void main(String[] args) { // TODO Auto-generated method stub getStudent(1); getStudent(1); getStudent(1); getStudent(1); getStudent(3); getStudent(3); } public static Student getStudent(Integer id){ //s.get() //å…ˆåˆ°ç¼“å­˜å» if(maps.containsKey(id)){ //åœ¨ç¼“å­˜æœ‰ System.out.println(\u0026quot;ä»ç¼“å­˜å–å‡º\u0026quot;); return maps.get(id); }else{ System.out.println(\u0026quot;ä»æ•°æ®åº“ä¸­å–\u0026quot;); //åˆ°æ•°æ®åº“å– Student stu=MyDB.getStudentFromDB(id); //æ”¾å…¥ç¼“å­˜ maps.put(id, stu); return stu; } } } //æˆ‘çš„æ•°æ®åº“ class MyDB{\tstatic List\u0026lt;Student\u0026gt; lists=new ArrayList\u0026lt;Student\u0026gt;(); //åˆå§‹åŒ–æ•°æ®åº“,å‡è®¾æœ‰ä¸‰ä¸ªå­¦ç”Ÿ static{ Student s1=new Student(); s1.setId(1); s1.setName(\u0026quot;aaa\u0026quot;); Student s2=new Student(); s2.setId(2); s2.setName(\u0026quot;bbb\u0026quot;); Student s3=new Student(); s3.setId(3); s3.setName(\u0026quot;ccc\u0026quot;); lists.add(s1); lists.add(s2); lists.add(s3); } public static Student getStudentFromDB(Integer id){ for(Student s: lists){ if(s.getId().equals(id)){ return s; } } return null;// åœ¨æ•°æ®åº“ä¸­æ²¡æœ‰. } } class Student{ private Integer id; private String name; public Integer getId() { return id; } public void setId(Integer id) { this.id = id; } public String getName() { return name; } public void setName(String name) { this.name = name; } }  äºŒçº§ç¼“å­˜ï¼ˆSessionFactoryçº§å…±äº«ï¼‰ ä¸ºä»€ä¹ˆéœ€è¦äºŒçº§ç¼“å­˜?\nã€€å› ä¸ºä¸€çº§ç¼“å­˜æœ‰é™(ç”Ÿå‘½å‘¨æœŸçŸ­),æ‰€ä»¥æˆ‘ä»¬éœ€è¦äºŒçº§ç¼“å­˜(SessionFactoryç¼“å­˜)æ¥å¼¥è¡¥è¿™ä¸ªé—®é¢˜\n éœ€è¦é…ç½® äºŒçº§ç¼“å­˜æ˜¯äº¤ç»™ç¬¬ä¸‰æ–¹å»å¤„ç†,å¸¸è§çš„Hashtable , OSCache , EHCache äºŒçº§ç¼“å­˜çš„åŸç†ï¼› äºŒçº§ç¼“å­˜çš„å¯¹è±¡å¯èƒ½æ”¾åœ¨å†…å­˜ï¼Œä¹Ÿå¯èƒ½æ”¾åœ¨ç£ç›˜.  ä½¿ç”¨OsCacheæ¥æ¼”ç¤ºäºŒçº§ç¼“å­˜çš„ä½¿ç”¨.\n é…ç½®äºŒçº§ç¼“å­˜  å¯¹é…ç½®è¯´æ˜:\n\u0026lt;property name=\u0026quot;hbm2ddl.auto\u0026quot;\u0026gt;update\u0026lt;/property\u0026gt; \u0026lt;!-- å¯åŠ¨äºŒçº§ç¼“å­˜ --\u0026gt; \u0026lt;property name=\u0026quot;cache.use_second_level_cache\u0026quot;\u0026gt;true\u0026lt;/property\u0026gt; \u0026lt;!-- æŒ‡å®šä½¿ç”¨å“ªç§äºŒçº§ç¼“å­˜ --\u0026gt; \u0026lt;property name=\u0026quot;cache.provider_class\u0026quot;\u0026gt;org.hibernate.cache.OSCacheProvider\u0026lt;/property\u0026gt; \u0026lt;mapping resource=\u0026quot;com/hsp/domain/Department.hbm.xml\u0026quot; /\u0026gt; \u0026lt;mapping resource=\u0026quot;com/hsp/domain/Student.hbm.xml\u0026quot; /\u0026gt; \u0026lt;!-- æŒ‡å®šå“ªä¸ªdomainå¯ç”¨äºŒçº§ç¼“å­˜ ç‰¹åˆ«è¯´æ˜äºŒçº§ç¼“å­˜ç­–ç•¥: 1. read-only 2. read-write 3. nonstrict-read-write 4. transcational --\u0026gt; \u0026lt;class-cache class=\u0026quot;com.hsp.domain.Student\u0026quot; usage=\u0026quot;read-write\u0026quot;/\u0026gt;  å¯ä»¥æŠŠoscache.propertiesæ–‡ä»¶æ”¾åœ¨ srcç›®å½•ä¸‹ï¼Œè¿™æ ·ä½ å¯ä»¥æŒ‡å®šæ”¾å…¥äºŒçº§ç¼“å­˜çš„å¯¹è±¡capacity å¤§å°. é»˜è®¤1000. ä½¿ç”¨  // TODO Auto-generated method stub //é€šè¿‡è·å–ä¸€ä¸ªsesion,è®©hibernateæ¡†æ¶è¿è¡Œ(config-\u0026gt;åŠ è½½hibernate.cfg.xml) Session s=null; Transaction tx=null;\ttry { //æˆ‘ä»¬ä½¿ç”¨åŸºç¡€æ¨¡æ¿æ¥è®²è§£. s=HibernateUtil.openSession(); tx=s.beginTransaction();\t//æŸ¥è¯¢45å·å­¦ç”Ÿ\tStudent stu1=(Student) s.get(Student.class, 45);//45-\u0026gt;ä¸€çº§ç¼“å­˜\tSystem.out.println(stu1.getName()); tx.commit();\t} catch (Exception e) { e.printStackTrace(); if(tx!=null){ tx.rollback(); } }finally{\tif(s!=null \u0026amp;\u0026amp; s.isOpen()){ s.close(); } }\tSystem.out.println(\u0026quot;*********************************\u0026quot;); try { //æˆ‘ä»¬ä½¿ç”¨åŸºç¡€æ¨¡æ¿æ¥è®²è§£. s=HibernateUtil.openSession(); tx=s.beginTransaction();\t//æŸ¥è¯¢45å·å­¦ç”Ÿ\tStudent stu1=(Student) s.get(Student.class, 45);\tSystem.out.println(stu1.getName());\tStudent stu3=(Student) s.get(Student.class, 46);\tSystem.out.println(stu3.getName()); tx.commit();\t} catch (Exception e) { e.printStackTrace(); if(tx!=null){ tx.rollback(); } }finally{ if(s!=null \u0026amp;\u0026amp; s.isOpen()){ s.close(); } } //å®Œæˆä¸€ä¸ªç»Ÿè®¡ï¼Œç»Ÿè®¡çš„ä¿¡æ¯åœ¨Sessfactory //SessionFactoryå¯¹è±¡. Statistics statistics= HibernateUtil.getSessionFactory().getStatistics(); System.out.println(statistics); System.out.println(\u0026quot;æ”¾å…¥\u0026quot;+statistics.getSecondLevelCachePutCount()); System.out.println(\u0026quot;å‘½ä¸­\u0026quot;+statistics.getSecondLevelCacheHitCount()); System.out.println(\u0026quot;é”™è¿‡\u0026quot;+statistics.getSecondLevelCacheMissCount());  åœ¨é…ç½®äº†äºŒçº§ç¼“å­˜åï¼Œè¯·å¤§å®¶è¦æ³¨æ„å¯ä»¥é€šè¿‡ Statistics,æŸ¥çœ‹ä½ çš„é…ç½®å‘½ä¸­ç‡é«˜ä¸é«˜.  äº‹åŠ¡ç®¡ç†  åœ¨hibernateè®¾ç½®éš”ç¦»çº§åˆ« åœ¨hibernate.cfg.xmlä¸­è®¾ç½®éš”ç¦»çº§åˆ«ï¼š  \u0026lt;!-- äº‹åŠ¡éš”ç¦»çº§åˆ« --\u0026gt; \u0026lt;property name=\u0026quot;hibernate.connection.isolation\u0026quot;\u0026gt;4\u0026lt;/property\u0026gt;  äº‹åŠ¡æ§åˆ¶åœ¨å“ªé‡Œè¿›è¡Œï¼Ÿ  service(){ session.beginTransaction;//å¼€å¯äº‹åŠ¡ try{ è°ƒç”¨daoæ–¹æ³•1 è°ƒç”¨daoæ–¹æ³•2 ..... session.getTransaction().commit();//æäº¤äº‹åŠ¡ }catch(Exception ex){ session.getTransaction().rollback();//å›æ»šäº‹åŠ¡ } }  sessionå¦‚ä½•ç®¡ç† ã€€åœ¨serviceæ¥å£ä¸­ï¼Œæ¯ä¸ªdaoè¯·æ±‚ä¸­ä½¿ç”¨åŒä¸€ä¸ªsessionå³ä½¿ç”¨åŒä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼Œä¿è¯å¤šä¸ªdaoè°ƒç”¨åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­. åœ¨serviceæ‰§è¡Œå¼€å§‹å¤„å¼€å¯ä¸€ä¸ªæ–°sessionï¼Œå°†sessionå’Œå½“å‰çº¿ç¨‹ç»‘å®šï¼Œåœ¨æ¯ä¸ªdaoè°ƒç”¨ä¸­è·å–å½“å‰çº¿ç¨‹ç»‘å®šçš„sessionï¼Œå®ç°æ¯ä¸ªdaoè·å–åˆ°çš„sessionæ˜¯åŒä¸€ä¸ªsession. ä¸»é”®å¢é•¿ç­–ç•¥  increment: è‡ªå¢ï¼Œæ¯æ¬¡å¢é•¿1, é€‚ç”¨äºæ‰€æœ‰æ•°æ®åº“. ä½†æ˜¯ä¸è¦ä½¿ç”¨åœ¨å¤šè¿›ç¨‹,ä¸»é”®ç±»å‹æ˜¯æ•°å€¼å‹ select max(id) from Student identity : è‡ªå¢ï¼Œæ¯æ¬¡å¢é•¿1, é€‚ç”¨äºæ”¯æŒidentityçš„æ•°æ®(mysql,sql server), ä¸»é”®ç±»å‹æ˜¯æ•°å€¼ sequence native:ä¼šæ ¹æ®æ•°æ®ç±»å‹æ¥é€‰æ‹©ï¼Œä½¿ç”¨identity,sequence ,hilo select hibernate_sequence.nextval from dual.ä¸»é”®ç±»å‹æ˜¯æ•°å€¼long , short ,int  \u0026lt;id name=\u0026quot;id\u0026quot; type=\u0026quot;java.lang.Integer\u0026quot;\u0026gt; \u0026lt;generator class=\u0026quot;native\u0026quot;/\u0026gt; \u0026lt;/id\u0026gt;  hilo:hiloæ ‡è¯†ç¬¦ç”Ÿæˆå™¨ç”±HibernateæŒ‰ç…§ä¸€ç§high/lowç®—æ³•ç”Ÿæˆæ ‡è¯†ç¬¦.  ç”¨æ³•:\n\u0026lt;id name=â€idâ€ type=â€java.lang.Integerâ€ column=â€IDâ€\u0026gt; \u0026lt;generator class=â€hiloâ€\u0026gt; \u0026lt;param name=â€tableâ€\u0026gt;my_hi_value\u0026lt;/param\u0026gt; \u0026lt;param name=â€columnâ€\u0026gt;next_value\u0026lt;/param\u0026gt; \u0026lt;/generator\u0026gt; \u0026lt;/id\u0026gt;  uuid: ä¼šæ ¹æ®uuidç®—æ³•ï¼Œç”Ÿæˆ128-bitçš„å­—ä¸² ä¸»é”®å±æ€§ç±»å‹ä¸èƒ½æ˜¯æ•°å€¼å‹ï¼Œè€Œæ˜¯å­—ä¸²å‹ assigned: ç”¨æˆ·è‡ªå·±è®¾ç½®ä¸»é”®å€¼ï¼Œæ‰€ä»¥ä¸»é”®å±æ€§ç±»å‹å¯ä»¥æ˜¯æ•°å€¼ï¼Œå­—ä¸² æ˜ å°„å¤åˆä¸»é”® foreign: åœ¨one-to-oneçš„å…³ç³»ä¸­ï¼Œæœ‰å¦ä¸€å¼ è¡¨çš„ä¸»é”®(Person) æ¥å†³å®š è‡ªå·±ä¸»é”®/å¤–é”®( IdCard)  ç»™å‡ºä¸€ä¸ªç®€å•åŸåˆ™:\n é’ˆå¯¹oracle [ä¸»é”®æ˜¯int/long/short å»ºè®®ä½¿ç”¨ sequence] ä¸»é”®æ˜¯String ä½¿ç”¨uuidæˆ–è€…assinged é’ˆå¯¹ mysql [ä¸»é”®æ˜¯ int/long/short å»ºè®®ä½¿ç”¨increment/assigend ,å¦‚æœæ˜¯å­—ä¸² UUId/assigned] é’ˆå¯¹ sql server [ä¸»é”®æ˜¯ int/long/short å»ºè®®ä½¿ç”¨identity/native/assinged ,å¦‚æœä¸»é”®æ˜¯å­—ä¸²ï¼Œä½¿ç”¨uuid/assigned ] one-to-one åˆæ˜¯åŸºäºä¸»é”®çš„åˆ™ä½¿ç”¨foreign  Hibernateä¸é€‚åˆçš„åœºæ™¯ ã€€ä¸é€‚åˆOLAPï¼ˆOn-Line-Analytical Processingè”æœºåˆ†æå¤„ç†ï¼‰ï¼Œå·²æŸ¥è¯¢åˆ†ææ•°æ®ä¸ºä¸»æµçš„ç³»ç»Ÿï¼Œé€‚åˆOLTPï¼ˆOn-line transaction Processingè”æœºäº‹åŠ¡å¤„ç†ï¼‰\n    OLTP OLAP     ç”¨æˆ· æ“ä½œäººå‘˜ï¼Œåº•å±‚ç®¡ç†äººå‘˜ å†³ç­–äººå‘˜ï¼Œé«˜çº§ç®¡ç†äººå‘˜   åŠŸèƒ½ æ—¥å¸¸æ“ä½œç®¡ç† åˆ†æå†³ç­–   DBè®¾è®¡ é¢å‘åº”ç”¨ é¢å‘ä¸»é¢˜   æ•°æ® å½“å‰çš„ï¼Œæœ€æ–°çš„ï¼Œç»†èŠ‚çš„ï¼ŒäºŒç»´çš„åˆ†ç«‹çš„ å†å²çš„ã€èšé›†çš„ã€å¤šç»´çš„é›†æˆçš„ï¼Œç»Ÿä¸€çš„   å­˜å– è¯»/å†™æ•°åæ¡è®°å½• è¯»/å†™ä¸Šç™¾ä¸‡ æ¡è®°å½•   å·¥ä½œå•ä½ ç®€å•äº‹åŠ¡ å¤æ‚æŸ¥è¯¢   ç”¨æˆ· ä¸Šåƒä¸ª ä¸Šç™¾ä¸ª   DBå¤§å° 100M-GB 100GB-TB    ","date":1611878400,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1611878400,"objectID":"fe1a2ed54399c32bb0a8893cc5ff6170","permalink":"https://CoMath21.github.io/post/1-hibernate/","publishdate":"2021-01-29T00:00:00Z","relpermalink":"/post/1-hibernate/","section":"post","summary":"å…·ä½“ä»‹ç»Hibernateçš„ç›¸å…³å†…å®¹.","tags":["ç¼–ç¨‹è¯­è¨€","Java","Hibernate"],"title":"Hibernateå­¦ä¹ ç¬”è®°","type":"post"},{"authors":["Xinæ€å¥½å…ˆç”Ÿ","CoMath"],"categories":["å­¦ä¹ ç¬”è®°","ç¼–ç¨‹è¯­è¨€"],"content":"1ã€ä»€ä¹ˆæ˜¯Struts2: ã€€Struts2æ˜¯ä¸€ä¸ªåŸºäºMVCè®¾è®¡æ¨¡å¼çš„Webåº”ç”¨æ¡†æ¶ï¼Œå®ƒæœ¬è´¨ä¸Šç›¸å½“äºä¸€ä¸ªservletï¼Œåœ¨MVCè®¾è®¡æ¨¡å¼ä¸­ï¼ŒStruts2ä½œä¸ºæ§åˆ¶å™¨(Controller)æ¥å»ºç«‹æ¨¡å‹ä¸è§†å›¾çš„æ•°æ®äº¤äº’. Struts2æ˜¯WebWork2åŸºç¡€å‘å±•è€Œæ¥çš„.\n2ã€Struts2ä¼˜ç‚¹ï¼š  Struts2çš„åº”ç”¨å¯ä»¥ä¸ä¾èµ–äºServlet APIï¼ˆrequest,responseï¼‰å’Œstruts APIï¼›è¿™ç§è®¾è®¡å±äºæ— ä¾µå…¥å¼è®¾è®¡. Struts2æä¾›äº†æ‹¦æˆªå™¨,åˆ©ç”¨æ‹¦æˆªå™¨å¯ä»¥è¿›è¡ŒAOPç¼–ç¨‹,å®ç°å¦‚æƒé™æ‹¦æˆªç­‰åŠŸèƒ½. Struts2æä¾›ç±»å‹è½¬æ¢å™¨,å¯ä»¥æŠŠç‰¹æ®Šç±»å‹å‚æ•°è½¬æ¢ç¨‹åºè¦çš„ç±»å‹. Struts2æä¾›æ”¯æŒå¤šç§è¡¨ç°å±‚æŠ€æœ¯,å¦‚JSP,freeMarker,Velocityç­‰. Struts2çš„è¾“å…¥æ ¡éªŒå¯ä»¥å¯¹æŒ‡å®šçš„æ–¹æ³•è¿›è¡Œæ ¡éªŒ. Struts2æä¾›äº†å…¨å±€èŒƒå›´ã€åŒ…èŒƒå›´ã€å’ŒActionèŒƒå›´çš„å›½é™…æ¢èµ„æºæ–‡ä»¶ç®¡ç†å®ç°.  3ã€æ­å»ºStruts2å¼€å‘ç¯å¢ƒ 3.1ã€å¼€å‘Struts2åº”ç”¨ä¾èµ–çš„jaræ–‡ä»¶ å¼€å‘Struts2åº”ç”¨éœ€è¦ä¾èµ–çš„jaræ–‡ä»¶åœ¨è§£å‹ç›®å½•çš„libæ–‡ä»¶å¤¹ä¸‹,ä¸åŒçš„åº”ç”¨éœ€è¦çš„JARåŒ…æ˜¯ä¸åŒçš„. å¼€å‘Struts2ç¨‹åºæœ€å°‘éœ€è¦çš„JAR.\n struts2-core-2.x.x.jar ï¼šStruts2æ¡†æ¶çš„æ ¸å¿ƒç±»åº“. xwork-2.x.x jar ï¼šXWorkç±»åº“,Struts2åœ¨å…¶ä¸Šæ„å»º. ognl-2.6.x.jar ï¼šå¯¹è±¡å›¾å¯¼èˆªè¯­è¨€(Object Graph Navigation Language),struts2æ¡†æ¶é€šè¿‡å…¶è¯»å†™å¯¹è±¡çš„å±æ€§. freemarker-2.3.x.jar ï¼šStruts 2çš„UIæ ‡ç­¾çš„æ¨¡æ¿ä½¿ç”¨FreeMarkerç¼–å†™. commons-logging-1.1.x jar ï¼šASFå‡ºå“çš„æ—¥å¿—åŒ…,Struts2æ¡†æ¶ä½¿ç”¨è¿™ä¸ªæ—¥å¿—åŒ…æ¥æ”¯æŒLog4Jå’ŒJDK1.4+çš„æ—¥å¿—è®°å½•. commons-fileupload-12 .1.jar ï¼šæ–‡ä»¶ä¸Šä¼ ç»„ä»¶,2 .1.6ç‰ˆæœ¬åå¿…é¡»åŠ å…¥æ­¤æ–‡ä»¶.   3.2ã€æ­å»ºStruts2å¼€å‘ç¯å¢ƒ  æ‰¾åˆ°Struts2éœ€è¦çš„å‡ ä¸ªjaråŒ…ï¼› ç¼–å†™é…ç½®struts2çš„é…ç½®æ–‡ä»¶ï¼šsrcä¸‹åˆ›å»ºstruts.xmlæ–‡ä»¶ï¼› åœ¨web.xmlä¸­åŠ å…¥struts2 MVCæ¡†æ¶å¯åŠ¨é…ç½®  \u0026lt;filter\u0026gt; \u0026lt;filter-name\u0026gt;struts2\u0026lt;/filter-name\u0026gt; \u0026lt;filter-class\u0026gt;org.apache.struts2.dispatcher.ng.filter. StrutsPrepareAndExecuteFilter\u0026lt;/filter-class\u0026gt; \u0026lt;/filter\u0026gt; \u0026lt;filter-mapping\u0026gt; \u0026lt;filter-name\u0026gt;struts2\u0026lt;/filter-name\u0026gt; \u0026lt;url-pattern\u0026gt;/*\u0026lt;/url-pattern\u0026gt; \u0026lt;/filter-mapping\u0026gt;  4ã€Struts.xmlé…ç½®ä¸­çš„åŒ…ä»‹ç»  é…ç½®åŒ…æ—¶å¿…é¡»æŒ‡å®šnameå±æ€§ï¼š è¯¥å±æ€§åå­—å¯ä»¥ä»»æ„,ä½†æ˜¯å¿…é¡»å”¯ä¸€,ä¸»è¦ä½œç”¨åœ¨äºï¼šå¦‚æœå…¶ä»–åŒ…è¦ç»§æ‰¿è¯¥åŒ…å°±å¿…é¡»é€šè¿‡è¯¥å±æ€§(nameå±æ€§)è¿›è¡Œå¼•ç”¨. åŒ…çš„namespaceå±æ€§ï¼š ç”¨äºå®šä¹‰è¯¥åŒ…çš„å‘½åç©ºé—´,å‘½åç©ºé—´ä½œä¸ºè®¿é—®è¯¥åŒ…ä¸‹Actionè·¯å¾„çš„ä¸€éƒ¨åˆ†. å¦‚æœä¸é…ç½®,é»˜è®¤ä¸ºâ€â€(ç©ºå­—ç¬¦ä¸²). ç»§æ‰¿æ–¹æ³•extendsï¼š é€šå¸¸æ¯ä¸ªåŒ…éƒ½åº”è¯¥ç»§æ‰¿struts-defaultåŒ…,å› ä¸ºStruts2å¾ˆå¤šæ ¸å¿ƒçš„åŠŸèƒ½éƒ½æ˜¯æ‹¦æˆªå™¨æ¥å®ç°çš„. struts-defaultå®šä¹‰äº†è¿™äº›æ‹¦æˆªå™¨å’ŒResultç±»å‹ï¼›struts-defaultåŒ…æ˜¯åœ¨struts2-core-2.jaræ–‡ä»¶ä¸­çš„struts-default.xmlä¸­å®šä¹‰çš„,struts-default.xmlä¹Ÿæ˜¯Struts2é»˜è®¤é…ç½®æ–‡ä»¶. Struts2æ¯æ¬¡éƒ½ä¼šè‡ªåŠ¨åŠ è½½struts-default.xmlæ–‡ä»¶.\n  4.1ã€Actioné…ç½®ä¸­çš„å„ç§é»˜è®¤å€¼  å¦‚æœæ²¡æœ‰ä¸ºactionæŒ‡å®šclass,é»˜è®¤æ˜¯ActionSupport. å¦‚æœæ²¡æœ‰ä¸ºactionæŒ‡å®šmethod,é»˜è®¤æ‰§è¡Œactionä¸­çš„execute()æ–¹æ³•. å¦‚æœæ²¡æœ‰æŒ‡å®šactionçš„nameå±æ€§,é»˜è®¤å€¼ä¸ºsuccess.  Actionä¸­çš„resultçš„å„ç§è½¬å‘ç±»å‹ ã€€Struts2å¸¸ç”¨çš„ç»“æœç±»å‹æœ‰ï¼šdispathcher(é»˜è®¤å€¼)ã€redirect(é‡å®šå‘)ã€redirectActionã€plainText åœ¨resultä¸­å¯ä»¥ä½¿ç”¨${å±æ€§å}è¡¨è¾¾å¼è®¿é—®actionä¸­çš„å±æ€§,è¡¨è¾¾å¼é‡Œçš„å±æ€§åå¯¹åº”actionä¸­çš„å±æ€§.\n dispathcher(é»˜è®¤å€¼)ï¼šå†…éƒ¨è¯·æ±‚è½¬å‘ redirect(é‡å®šå‘)ï¼š  // æ ¼å¼ï¼š \u0026lt;result type=\u0026quot;redirect\u0026quot;\u0026gt;/hello.jsp\u0026lt;/result\u0026gt; // å¦‚æœé‡å®šå‘éœ€è¦å¸¦å‚æ•°,åˆ™ç”¨ï¼š \u0026lt;result type=\u0026quot;redirect\u0026quot;\u0026gt;/hello.jsp?id=${id}\u0026lt;/result\u0026gt;  æ­¤æ—¶,éœ€è¦åœ¨å¯¹åº”çš„Actionä¸‹æœ‰å¯¹åº”çš„å˜é‡,å¹¶ä¸”æä¾›getå±æ€§. æ³¨æ„ï¼šé‡å®šå‘ä¸èƒ½è®¿é—®WEB-INFä¸‹çš„æ–‡ä»¶.\n redirectAction(åœ¨å…¶ä»–*Actionä¸‹)ï¼š  // æ ¼å¼ï¼š \u0026lt;action name=\u0026quot; redirectActionName\u0026quot;\u0026gt; \u0026lt;result type=\u0026quot; redirectAction\u0026quot;\u0026gt;é‡å®šå‘çš„name\u0026lt;/result\u0026gt; \u0026lt;/action\u0026gt; // å¦‚æœä¸ä¸åœ¨åŒä¸€ä¸ªåŒ…ä¸‹éœ€é…ç½®é¡¹ \u0026lt;result type=\u0026quot; redirectAction\u0026quot;\u0026gt; \u0026lt;param name=\u0026quot; actionName\u0026quot;\u0026gt;xxx\u0026lt;/param\u0026gt; \u0026lt;param name=\u0026quot; namespace\u0026quot;\u0026gt;/â€¦/â€¦\u0026lt;/param\u0026gt; \u0026lt;/result\u0026gt;  è¡¥å…….\nä¸­æ–‡å­—ç¬¦ç¼–ç ã€è§£ç \n ç¼–ç (java.net.URLEncoder)ï¼šURLEncoder.encode(\u0026quot;å­—ç¬¦ä¸²\u0026quot;,\u0026quot;UTF-8\u0026quot;); è§£ç (java.net.URLDecoder)ï¼šURLDecoder.encode(new String (request.getParameter(\u0026quot;å±æ€§å\u0026quot;).getBytes(\u0026quot;ISO8859-1\u0026quot;),\u0026quot;UTF-8\u0026quot;),\u0026quot;UTF-8\u0026quot;); JSPæ–‡ä»¶ä¸­å¯ä»¥ç”¨$(param.å±æ€§å)è®¿é—®Actionä¸­çš„å±æ€§(ä¼šä¹±ç )  ã€€plaintext(æ˜¾ç¤ºåŸå§‹æ–‡ä»¶å†…å®¹çš„é‡å®šå‘)ï¼šä¾‹å¦‚æŸåŠŸèƒ½éœ€è¦æŸ¥çœ‹æºä»£ç \n\u0026lt;action name=\u0026quot; plainText\u0026quot;\u0026gt; \u0026lt;result type=\u0026quot; plainText\u0026quot;\u0026gt;\u0026lt;/result\u0026gt; \u0026lt;/action\u0026gt;  æ³¨æ„ï¼šå½“è¯¥JSPæ–‡ä»¶å­˜åœ¨ä¸­æ–‡çš„æ—¶å€™,ä¼šä¹±ç ï¼  éœ€è¦åŠ å…¥ï¼š\n\u0026lt;param name=\u0026quot; location\u0026quot;\u0026gt;/xxx.jsp\u0026lt;/param\u0026gt;\u0026lt;!â€”å®šå‘çš„è·¯å¾„--\u0026gt; \u0026lt;param name=\u0026quot; charSet\u0026quot;\u0026gt;UTF-8\u0026lt;/param\u0026gt;\u0026lt;!--æŒ‡å®šè¯»å–æ–‡ä»¶çš„ç¼–ç --\u0026gt;  é™„ï¼šStruts2çš„å…¨è§†å›¾ å•ä¸ªåŒ…ä¸‹ï¼š\n\u0026lt;package name=\u0026quot; xxx\u0026quot; namespace=\u0026quot; /â€¦/â€¦\u0026quot; extends=\u0026quot; struts-default\u0026quot;\u0026gt; \u0026lt;global-results\u0026gt;\t\u0026lt;result type=\u0026quot; messâ€¦\u0026quot;\u0026gt;/â€¦/â€¦\u0026lt;/result\u0026gt; \u0026lt;/global-results\u0026gt; \u0026lt;/package\u0026gt;  å…¨å±€ï¼š(åœ¨ä¸€ä¸ªåŒ…ä¸­å†™,ç„¶åå…¶ä»–åŒ…ç»§æ‰¿è¯¥åŒ…)\n4.2ã€ä¸ºActionå±æ€§æ³¨å…¥å€¼ \u0026lt;package name=\u0026quot; xxx\u0026quot; namespace=\u0026quot; /â€¦/â€¦\u0026quot; extends=\u0026quot; struts-default\u0026quot;\u0026gt; \u0026lt;action name=\u0026quot; list\u0026quot; class=\u0026quot;com.haibao.HelloWorldAction\u0026quot; method=\u0026quot;execute\u0026quot;\u0026gt; \u0026lt;param name=\u0026quot;path \u0026quot;\u0026gt;/image\u0026lt;/param\u0026gt; \u0026lt;result name=\u0026quot;success \u0026quot;\u0026gt;/xxx.jsp \u0026lt;/result\u0026gt; \u0026lt;/action\u0026gt; \u0026lt;/package\u0026gt;  é™„ï¼šåœ¨HelloWorldActionä¸‹å¿…é¡»å­˜åœ¨â€œpathâ€å±æ€§çš„getæ–¹æ³• ,è®¿é—®xxx.jspå¾—åˆ°çš„æ˜¯â€œ/imageâ€\n5ã€æŒ‡å®šstruts2å¤„ç†çš„è¯·æ±‚åç¼€ 5.1ã€é»˜è®¤åç¼€åŠä¿®æ”¹ é»˜è®¤åç¼€ï¼š.action é»˜è®¤åç¼€å¯ä»¥é€šè¿‡å¸¸é‡\u0026quot;struts.action.extension\u0026quot;è¿›è¡Œä¿®æ”¹\n\u0026lt;constant name=\u0026quot; struts.action.extension\u0026quot; value=\u0026quot;do\u0026quot;/\u0026gt;  å¦‚æœç”¨æˆ·æŒ‡å®šå¤šä¸ªè¯·æ±‚åç¼€,åˆ™å¤šä¸ªåç¼€ä¹‹é—´ä»¥è‹±æ–‡é€—å·( , )éš”å¼€\n\u0026lt;constant name=\u0026quot; struts.action.extension\u0026quot; value=\u0026quot;do,action\u0026quot;/\u0026gt;  5.2ã€å¸¸ç”¨çš„å¸¸é‡ \u0026lt;!--æŒ‡å®šé»˜è®¤ç¼–ç é›†,ä½œç”¨äºHTTPServletRequestçš„setCharacterEncodingæ–¹æ³•å’Œfreemarkerã€velocityçš„è¾“å‡º--\u0026gt; \u0026lt;constant name=\u0026quot; struts.i18n.encoding\u0026quot; value=\u0026quot;UTF-8\u0026quot;/\u0026gt; \u0026lt;!-- è¯¥å±æ€§æŒ‡å®šéœ€è¦çš„struts2å¤„ç†çš„åç¼€è¯·æ±‚å¦‚æœç”¨æˆ·æŒ‡å®šå¤šä¸ªè¯·æ±‚åç¼€,åˆ™å¤šä¸ªåç¼€ä¹‹é—´ä»¥è‹±æ–‡é€—å·(,)éš”å¼€--\u0026gt; \u0026lt;constant name=\u0026quot; struts.action.extension\u0026quot; value=\u0026quot;do,action\u0026quot;/\u0026gt; \u0026lt;!-- è®¾ç½®æµè§ˆå™¨æ˜¯å¦ç¼“å­˜é™æ€å†…å®¹. é»˜è®¤å€¼ä¸ºtrue(ç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨)--\u0026gt; \u0026lt;constant name=\u0026quot;struts.serve.static.browserCache\u0026quot; value=\u0026quot;false\u0026quot;/\u0026gt; \u0026lt;!-- å½“strutsçš„é…ç½®æ–‡ä»¶ä¿®æ”¹å,ç³»ç»Ÿæ˜¯å¦è‡ªåŠ¨é‡æ–°åŠ è½½è¯¥æ–‡ä»¶,é»˜è®¤false(ç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨) --\u0026gt; \u0026lt;constant name=\u0026quot; struts.configuration.xml.reload\u0026quot; value=\u0026quot;true\u0026quot;/\u0026gt; \u0026lt;!-- å¼€å‘æ¨¡å¼ä¸‹ä½¿ç”¨,è¿™æ ·å¯ä»¥æ‰“å°å‡ºæ›´è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ --\u0026gt; \u0026lt;constant name=\u0026quot; struts.devMode\u0026quot; value=\u0026quot;true\u0026quot;/\u0026gt;â€ƒ\u0026lt;!-- é»˜è®¤çš„è§†å›¾ä¸»é¢˜ --\u0026gt; \u0026lt;constant name=\u0026quot; struts.ui.theme\u0026quot; value=\u0026quot;smple\u0026quot;/\u0026gt;â€ƒ\u0026lt;!-- ä¸Springé›†æˆæ—¶,æŒ‡å®šæœ‰Springè´Ÿè´£actionå¯¹è±¡çš„åˆ›å»º --\u0026gt; \u0026lt;constant name=\u0026quot; struts.objectFactory\u0026quot; value=\u0026quot;spring\u0026quot;/\u0026gt; \u0026lt;!-- è¯¥å±æ€§è®¾ç½®Struts2æ˜¯å¦æ”¯æŒåŠ¨æ€æ–¹æ³•è°ƒç”¨,é»˜è®¤ä¸ºtrue --\u0026gt; \u0026lt;constant name=\u0026quot; struts.enable.DynamicMethodlnvocation\u0026quot; value=\u0026quot;true\u0026quot;/\u0026gt; \u0026lt;!-- ä¸Šä¼ æ–‡ä»¶çš„å¤§å°é™åˆ¶ --\u0026gt; \u0026lt;constant name=\u0026quot; struts.multipart.maxSize\u0026quot; value=\u0026quot;10701096\u0026quot;/\u0026gt;  5.3ã€å¸¸é‡çš„å®šä¹‰ å¸¸é‡å¯ä»¥åœ¨struts.xmlæˆ–struts.propretiesä¸­é…ç½®,å»ºè®®åœ¨struts.xmlä¸­é…ç½® åœ¨struts.xmlæ–‡ä»¶ä¸­é…ç½®å¸¸é‡ï¼š\n\u0026lt;struts\u0026gt; \u0026lt;constant name=\u0026quot;struts.action.extension\u0026quot; value=\u0026quot;do\u0026quot;\u0026gt; \u0026lt;/struts\u0026gt;  åœ¨struts.propretiesä¸­é…ç½®å¸¸é‡ï¼š\nstruts.action.extension=do  å¸¸é‡å¯ä»¥åœ¨ä¸‹é¢å¤šä¸ªé…ç½®æ–‡ä»¶ä¸­å®šä¹‰,åŠ è½½å¸¸é‡çš„æœç´¢é¡ºåºä¸ºï¼š\n struts-default.xml struts-plugin.xml struts.xml struts.propreties web.xml  å¤šä¸ªæ–‡ä»¶ä¸­é…ç½®äº†åŒä¸€ä¸ªå¸¸é‡,åˆ™åä¸€ä¸ªæ–‡ä»¶ä¸­é…ç½®çš„å¸¸é‡å€¼ä¼šè¦†ç›–å‰é¢æ–‡ä»¶ä¸­é…ç½®çš„å¸¸é‡å€¼.\n6ã€Struts2çš„å¤„ç†æµç¨‹ StrutsPrepareAndExecuteFilteræ˜¯Strutsçš„æ ¸å¿ƒæ§åˆ¶å™¨,ä»–è´Ÿè´£æ‹¦æˆªç”±/*æŒ‡å®šçš„æ‰€æœ‰ç”¨æˆ·è¯·æ±‚,å½“ç”¨æˆ·è¯·æ±‚åˆ°è¾¾æ—¶,ç»™Filterä¼šè¿‡æ»¤ç”¨æˆ·çš„è¯·æ±‚. é»˜è®¤æƒ…å†µä¸‹,å¦‚æœç”¨æˆ·è¯·æ±‚è·¯å¾„ä¸å¸¦åç¼€æˆ–è€…ä»¥.actionç»“å°¾,è¿™æ—¶è¯·æ±‚è¢«è½¬å…¥Struts2æ¡†æ¶å¤„ç†,å¦åˆ™Struts2æ¡†æ¶å°†ç•¥è¿‡è¯¥è¯·æ±‚çš„å¤„ç†. å½“è¯·æ±‚è½¬å…¥Struts2æ¡†æ¶å¤„ç†æ—¶ä¼šç»è¿‡ä¸€ç³»åˆ—çš„æ‹¦æˆªå™¨,ç„¶ååˆ°Action. ä¸Struts1ä¸åŒ,Struts2å¯¹ç”¨æˆ·çš„æ¯ä¸€æ¬¡è¯·æ±‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ªAction,æ‰€ä»¥Struts2ä¸­çš„Actionæ˜¯çº¿ç¨‹å®‰å…¨çš„.\nä¸ºåº”ç”¨æŒ‡å®šå¤šä¸ªStrutsé…ç½®æ–‡ä»¶\nã€€åœ¨å¤§éƒ¨åˆ†åº”ç”¨é‡Œ,éšç€åº”ç”¨è§„æ¨¡çš„å¢åŠ ,ç³»ç»Ÿä¸­Actionçš„æ•°é‡ä¹Ÿä¼šå¤§å¤§å¢åŠ ,å¯¼è‡´struts.xmlé…ç½®æ–‡ä»¶å˜å¾—è‡ƒè‚¿,ä¸ºäº†é¿å…struts.xmlæ–‡ä»¶è¿‡äºåºå¤§,æé«˜struts.xmlæ–‡ä»¶çš„å¯è¯»æ€§,å¯ä»¥å°†ä¸€ä¸ªstruts.xmlé…ç½®æ–‡ä»¶åˆ†è§£æˆå¤šä¸ªé…ç½®æ–‡ä»¶,ç„¶ååœ¨struts.xmlæ–‡ä»¶ä¸­åŒ…å«å…¶ä»–é…ç½®æ–‡ä»¶(é€šè¿‡å…ƒç´ æŒ‡å®šå¤šä¸ªé…ç½®æ–‡ä»¶)\n\u0026lt;struts\u0026gt; \u0026lt;include file=\u0026quot;struts-user.xml\u0026quot;/\u0026gt; \u0026lt;include file=\u0026quot;struts-order.xml\u0026quot;/\u0026gt; \u0026lt;/struts\u0026gt;  7ã€åŠ¨æ€æ–¹æ³•è°ƒç”¨ï¼š  åŠ¨æ€æ–¹æ³•è°ƒç”¨DMIï¼ˆåŠ¨æ€æŒ‡å®šï¼‰,å¯ä»¥åœ¨urlåœ°å€ä¸­åŠ¨æ€æŒ‡å®šactionæ‰§è¡Œå“ªä¸ªæ–¹æ³•,å¯ä»¥é€šè¿‡action+!+æ–¹æ³•å. (æ³¨ï¼šåªè¦Actionå¯¹è±¡ä¸­æœ‰è¿™ä¸ªæ–¹æ³•,å¹¶ä¸”è¿”å›ç±»å‹ä¸ºStringå°±å¯ä»¥è°ƒç”¨,è¿™æ ·struts.xmlæ–‡ä»¶é…ç½®æ–‡ä»¶å°±å¯ä»¥ä¸éœ€è¦é…ç½®methodå±æ€§)ï¼š è®¾ç½®Struts2æ˜¯å¦æ”¯æŒåŠ¨æ€æ–¹æ³•è°ƒç”¨,å¦‚æœæ²¡æœ‰è¿™ä¸€è¡Œè¦åŠ ä¸Šå»,è¦ä¸ç„¶ä¼šæŠ¥é”™è¯¯,å¦‚æœä½ åŠ ä¸Šè¿™ä¸€è¡Œ,ä½†æ˜¯ä½ æŠŠvalueå€¼æ”¹æˆfalse,ä¹Ÿä¼šæŠ¥é”™ï¼   8ã€ä½¿ç”¨é€šé…ç¬¦å®šä¹‰action ã€€å…¶ä¸­*åŒ¹é…æ‰€æœ‰,åœ¨method=\u0026quot;{æ•°å­—}\u0026ldquo;ä¸­ç”¨{æ•°å­—}è¡¨ç¤ºåŒ¹é…ç¬¬å‡ ä¸ª*,å…¶ä¸­è·³è½¬é¡µé¢çš„å‘½åä¹Ÿæ˜¯æ ¹æ®ç¬¬ä¸€ä¸ª*çš„å€¼è¿›è¡Œçš„. 9ã€è¯·æ±‚å‚æ•°çš„æ¥æ”¶ ã€€åœ¨Actionä¸­å¿…é¡»å­˜åœ¨è¯¥å±æ€§å¹¶ä¸”å­˜åœ¨è¯¥å±æ€§çš„setæ–¹æ³•,è¿™æ ·åœ¨urlä¸­èµ‹å€¼æ‰èƒ½æ¥æ”¶åˆ°getæ–¹æ³•ç›´æ¥åœ¨urlåé¢åŠ å…¥â€œ?å±æ€§å=å±æ€§å€¼\u0026amp;å±æ€§å=å±æ€§å€¼â€\n9.1ã€åŸºæœ¬ç±»å‹ 9.2ã€å¤åˆç±»å‹ ï¼ˆä¸ºäº†å‡å°‘å¤æ‚åº¦,å°½é‡ç”¨å¤åˆç±»å‹ï¼‰ åŸç†ï¼šStruts2é¦–å…ˆé€šè¿‡åå°„æŠ€æœ¯è°ƒç”¨Personçš„é»˜è®¤æ„é€ å™¨åˆ›å»ºproductå¯¹è±¡,ç„¶åå†é€šè¿‡åå°„æŠ€æœ¯è°ƒç”¨productä¸­ä¸è¯·æ±‚å‚æ•°åŒåçš„å±æ€§çš„setteræ–¹æ³•æ¥è·å–è¯·æ±‚å‚æ•°çš„å€¼.\n10ã€å…³äºStruts2.1.6æ¥æ”¶ä¸­æ–‡è¯·æ±‚å‚æ•°ä¹±ç é—®é¢˜ ã€€Struts2.1.6ç‰ˆæœ¬ä¸­å­˜åœ¨ä¸€ä¸ªBug,å³æ¥æ”¶åˆ°çš„ä¸­æ–‡è¯·æ±‚å‚æ•°ä¸ºä¹±ç ï¼ˆä»¥postæ–¹æ³•æäº¤ï¼‰,åŸå› æ˜¯struts2.1.6åœ¨è·å–å¹¶ä½¿ç”¨äº†è¯·æ±‚å‚æ•°åæ‰è°ƒç”¨HttpServletRequestçš„setCharacterEncoding()æ–¹æ³•è¿›è¡Œç¼–ç è®¾ç½®,å¯¼è‡´åº”ç”¨ä½¿ç”¨çš„å°±æ˜¯ä¹±ç è¯·æ±‚å‚æ•°.\nè§£å†³æ–¹æ³•ï¼šæ–°å»ºä¸€ä¸ªFilter,æŠŠè¿™ä¸ªFilteræ”¾ç½®åœ¨Struts2çš„Filterä¹‹å‰,ç„¶ååœ¨doFilter()æ–¹æ³•é‡Œæ·»åŠ ä¸€ä¸‹ä»£ç ï¼š\npublic void doFilter(â€¦){ HttpServletRequest req = (HttpServletRequest)request; req.setCharacterEncoding(\u0026quot;UTF-8\u0026quot;); filterchain.doFilter(request,response); }  11ã€è‡ªå®šä¹‰ç±»å‹è½¬æ¢å™¨ 11.1ã€å±€éƒ¨ç±»å‹è½¬æ¢å™¨ï¼š  é¦–å…ˆéœ€è¦å®šä¹‰ç±»å¹¶ç»§æ‰¿DefaultTypeConverterç±»; åœ¨Actionç±»æ‰€åœ¨çš„åŒ…ä¸‹æ”¾ç½®ActionClassName-conversion.propertiesæ–‡ä»¶ï¼›å…¶ä¸­ActionClassNameæ˜¯Actionçš„ç±»å,åé¢çš„-conversion.propertiesæ˜¯å›ºå®šå†™æ³•; åœ¨.propertiesæ–‡ä»¶ä¸­å†…å®¹ä¸ºï¼šå±æ€§åç§°=ç±»å‹è½¬æ¢å™¨çš„å…¨ç±»å. ä»¥å‡ºç”Ÿå¹´æœˆä¸ºä¾‹ï¼š   11.2ã€å…¨å±€ç±»å‹è½¬æ¢å™¨ï¼š åœ¨src(æ ¹ç›®å½•)ä¸‹æ”¾ç½®xwork-conversion.properties. æ–‡ä»¶ä¸­çš„å†…å®¹ä¸ºï¼š å¸¦è½¬æ¢çš„ç±»å‹=ç±»å‹è½¬æ¢å™¨çš„å…¨ç±»å ä¾‹å¦‚ï¼šjava.util.Date=com.haibao.â€¦ 11.3ã€è®¿é—®æˆ–æ·»åŠ å±æ€§ ä»…ä»…æ˜¯ä¸ºäº†è®¿é—®æ·»åŠ ï¼š\npublic String scope() throws Exception{//æ–¹æ³• ActionContext ctx = ActionContext.getContext(); ctx.getApplication().put(\u0026quot;app\u0026quot;,\u0026quot;åº”ç”¨èŒƒå›´\u0026quot;);//å¾€ServletContexté‡Œæ”¾å…¥app ctx.getSession().put(\u0026quot;ses\u0026quot;,\u0026quot;sessionèŒƒå›´\u0026quot;)ï¼›//å¾€ServletContexté‡Œæ”¾å…¥ses ctx.put(\u0026quot;req\u0026quot;,\u0026quot;requestèŒƒå›´\u0026quot;)ï¼›//å¾€ServletContexté‡Œæ”¾å…¥req return \u0026quot;scope\u0026quot;;// }  JSPä¸­ï¼š\n\u0026lt;body\u0026gt; ${applicationScope.app}\u0026lt;br\u0026gt; ${sessionScope.ses}\u0026lt;br\u0026gt; ${requestScope.ses}\u0026lt;br\u0026gt; \u0026lt;body\u0026gt;  è¦æ˜¯æƒ³å¾—åˆ°å¯¹è±¡ï¼š\n// æ–¹æ³•ä¸€ï¼šé€šè¿‡ServletActionContextç±»ç›´æ¥å®ç° public String rsa() throws Exception{//æ–¹æ³• HttpServletRequest request = ServletActionContext.getRequest(); ServletContext servletContext = ServletActionContext.getServletContest(); request.setAttribute(\u0026quot;req\u0026quot;,\u0026quot;åº”ç”¨èŒƒå›´\u0026quot;); request.getSession().setAttribute(\u0026quot;ses\u0026quot;,\u0026quot;sessionèŒƒå›´\u0026quot;)ï¼› servletContext.setAttribute(\u0026quot;app\u0026quot;,\u0026quot;åº”ç”¨èŒƒå›´\u0026quot;); return \u0026quot;scope\u0026quot;;// } // æ–¹æ³•äºŒï¼šé€šè¿‡æŒ‡å®šæ¥å£,æœ‰Strutsæ¡†æ¶è¿è¡Œæ—¶æ³¨å…¥ public class HelloWorldAction implements ServletRequestAware, ServletResponseAware,ServletContextAware{ private HttpServletRequest requesr; private ServletContextResponse Context; private HttpServletResponse response; public void setServletRequest(HttoServletRequest req){ this.request = req; } public void setServletResponse(){ } public void setServletContext(){ }  12ã€æ–‡ä»¶ä¸Šä¼  12.1ã€å•æ–‡ä»¶ä¸Šä¼  æ­¥éª¤\n ç¬¬ä¸€æ­¥ï¼šåœ¨WEB-INF/libä¸‹åŠ å…¥commons-fileupload-1.2.1.jarï¼ˆ2.1ç‰ˆæœ¬ä¹‹åå¿…é¡»æ·»åŠ ï¼‰ã€commons-io.jarï¼ˆéœ€è¦ç”¨åˆ°é‡Œé¢çš„å·¥å…·ç±»ï¼‰ ç¬¬äºŒæ­¥ï¼šæŠŠformè¡¨çš„enctypeè®¾ç½®ä¸ºï¼šâ€œmultipart/form-dataâ€  \u0026lt;form action=\u0026quot;${pageContext.request.contextPath}/uploadAction_execute.action\u0026quot; enctype=\u0026quot;multipart/form-data\u0026quot; method=\u0026quot;post\u0026quot;\u0026gt; æ–‡ä»¶ï¼š\u0026lt;input type=\u0026quot;file\u0026quot; name=\u0026quot;image\u0026quot;\u0026gt; \u0026lt;input type=\u0026quot;submit\u0026quot; value=\u0026quot;ä¸Šä¼ \u0026quot;\u0026gt; \u0026lt;/form\u0026gt;  ç¬¬ä¸‰æ­¥ï¼šåœ¨Actionç±»ä¸­æ·»åŠ ä»¥ä¸‹å±æ€§  public class UploadAction { private File image;// æ–‡ä»¶åç§° // å¦‚æœæƒ³å¾—åˆ°ä¸Šä¼ æ–‡ä»¶çš„åç§°,åˆ™å®šä¹‰æ–‡ä»¶å. æ ¼å¼ï¼šæ–‡ä»¶åç§°+FileName private String imageFileName;// å¾—åˆ°ä¸Šä¼ æ–‡ä»¶åç§° // å¦‚æœæƒ³å¾—åˆ°æ–‡ä»¶çš„ç±»å‹,åˆ™å®šä¹‰æ–‡ä»¶å. æ ¼å¼ï¼šæ–‡ä»¶åç§°+ContextType private String imageContextType; public String getImageFileName() { return imageFileName; } public void setImageFileName(String imageFileName) { this.imageFileName = imageFileName; } // æä¾›ä¸å­—æ®µåç§°ç›¸ç¬¦çš„getã€setå±æ€§,ä»¥ä¾¿å¾—åˆ°ä¸Šä¼ çš„æ–‡ä»¶ public File getImage() { return image; } public void setImage(File image) { this.image = image; } public String execute() throws Exception { // åœ¨è¯¥æ–¹æ³•ä¸‹è¿›è¡Œä¿å­˜ String realPath = ServletActionContext.getServletContext().getRealPath( \u0026quot;/images\u0026quot;);// å¾—åˆ°æ ¹ç›®å½• System.out.println(\u0026quot;*****\u0026quot; + realPath + \u0026quot;****\u0026quot;); if (image != null) { File savefile = new File(new File(realPath), imageFileName);// ä¿å­˜åˆ°... if (!savefile.getParentFile().exists()) savefile.getParentFile().mkdirs(); FileUtils.copyFile(image, savefile);// è°ƒç”¨commons-io.jarä¸‹çš„å·¥å…·ç±»Copyæ–‡ä»¶åˆ°æŒ‡å®šä½ç½® ActionContext.getContext().put(\u0026quot;message\u0026quot;, \u0026quot;ä¸Šä¼ æˆåŠŸ\u0026quot;);// è¿”å›ä¿¡æ¯ } return \u0026quot;success\u0026quot;; } }  12.2ã€å¤šæ–‡ä»¶ä¸Šä¼  ã€€åªéœ€è¦å°†å•æ–‡ä»¶ä¸Šä¼ çš„ç¬¬ä¸‰æ­¥ï¼šåœ¨Actionç±»ä¸­æ·»åŠ ä»¥ä¸‹å±æ€§ä¸­æŠŠå•ä¸ªæ–‡ä»¶å˜æˆæ•°ç»„.\npublic class moreUploadAction { private File[] image;// æ–‡ä»¶åç§° // å¦‚æœæƒ³å¾—åˆ°ä¸Šä¼ æ–‡ä»¶çš„åç§°,åˆ™å®šä¹‰æ–‡ä»¶å. æ ¼å¼ï¼šæ–‡ä»¶åç§°+FileName private String[] imageFileName;// å¾—åˆ°ä¸Šä¼ æ–‡ä»¶åç§° // å¦‚æœæƒ³å¾—åˆ°æ–‡ä»¶çš„ç±»å‹,åˆ™å®šä¹‰æ–‡ä»¶å. æ ¼å¼ï¼šæ–‡ä»¶åç§°+ContextType private String[] imageContextType; public File[] getImage() { return image; } public void setImage(File[] image) { this.image = image; } public String[] getImageFileName() { return imageFileName; } public void setImageFileName(String[] imageFileName) { this.imageFileName = imageFileName; } public String[] getImageContextType() { return imageContextType; } public void setImageContextType(String[] imageContextType) { this.imageContextType = imageContextType; } public String execute() throws Exception { // åœ¨è¯¥æ–¹æ³•ä¸‹è¿›è¡Œä¿å­˜ String realPath = ServletActionContext.getServletContext().getRealPath( \u0026quot;/images\u0026quot;);// å¾—åˆ°æ ¹ç›®å½• System.out.println(\u0026quot;*****\u0026quot; + realPath + \u0026quot;****\u0026quot;); if (image != null) { File savedir = new File(realPath); if (!savedir.exists()) savedir.mkdirs(); for (int i = 0; i \u0026lt; image.length; i++) { File savefile = new File(savedir, imageFileName[i]);// ä¿å­˜åˆ°... FileUtils.copyFile(image[i], savefile);// è°ƒç”¨commons-io.jarä¸‹çš„å·¥å…·ç±»Copyæ–‡ä»¶åˆ°æŒ‡å®šä½ç½® } ActionContext.getContext().put(\u0026quot;message\u0026quot;, \u0026quot;ä¸Šä¼ æˆåŠŸ\u0026quot;);// è¿”å›ä¿¡æ¯ } return \u0026quot;success\u0026quot;; } }  13ã€è‡ªå®šä¹‰æ‹¦æˆªå™¨ éœ€æ±‚ï¼šå¯¹äºç™»é™†çš„ç”¨æˆ·å¯ä»¥è®¿é—®Actionä¸­çš„æ‰€æœ‰æ–¹æ³•,è€Œæ²¡æœ‰ç™»å½•çš„ç”¨æˆ·åˆ™ä¸å¯ä»¥è®¿é—®ä»»ä½•æ–¹æ³•.\næ–¹æ³•ï¼šæ·»åŠ è‡ªå®šä¹‰æ‹¦æˆªå™¨. å®ç°com.opensymphony.xwork2.interceptor.interceptoræ¥å£\n@Override public String intercept(ActionInvocation arg0) throws Exception { // å½“æ‹¦æˆªåˆ°Actionæ—¶æ‰§è¡Œè¯¥æ–¹æ³• // å¾—åˆ°sessionä¸­å­˜åœ¨çš„å¯¹è±¡ Object user = ActionContext.getContext() .getSession().get(\u0026quot;user\u0026quot;); // å¦‚æœå¸Œæœ›è¢«æ‹¦æˆªçš„çš„æ–¹æ³•æ‰§è¡Œ,è°ƒç”¨arg0.invoke(); if (user != null) return arg0.invoke();//å¦‚æœUserä¸ä¸ºnull,ä»£è¡¨åˆæ³•ç”¨æˆ·,å…è®¸è®¿é—®æ–¹æ³• // è¿”å›çš„æ˜¯Actionä¸­å¯¹åº”æ–¹æ³•çš„è¿”å›å€¼String ActionContext.getContext().put(\u0026quot;message\u0026quot;, \u0026quot;è¯·å…ˆç™»å½•\u0026quot;); return \u0026quot;success\u0026quot;; }  åœ¨struts.xmlä¸­å®šä¹‰æ‹¦æˆªå™¨\n\u0026lt;!-- å®šä¹‰æ‹¦æˆªå™¨ --\u0026gt; \u0026lt;interceptors\u0026gt; \u0026lt;!-- è‡ªå®šä¹‰æ‹¦æˆªå™¨ --\u0026gt; \u0026lt;interceptor name=\u0026quot;permission\u0026quot; class=\u0026quot;com.haibao.interceptor.PermissionInterceptor\u0026quot; /\u0026gt; \u0026lt;!-- å®šä¹‰æ‹¦æˆªå™¨æ ˆ ç›®çš„ï¼šä½¿å¾—Struts2è‡ªå¸¦çš„æ‹¦æˆªå™¨æœ‰æ•ˆ --\u0026gt; \u0026lt;interceptor-stack name=\u0026quot;permissionStack\u0026quot;\u0026gt; \u0026lt;interceptor-ref name=\u0026quot;defaultStack\u0026quot;/\u0026gt; \u0026lt;interceptor-ref name=\u0026quot;permission\u0026quot;/\u0026gt; \u0026lt;/interceptor-stack\u0026gt; \u0026lt;/interceptors\u0026gt; \u0026lt;action name=\u0026quot;loginAction_*\u0026quot; class=\u0026quot;com.haibao.action.LoginAction\u0026quot;\tmethod=\u0026quot;{1}\u0026quot;\u0026gt; \u0026lt;result name=\u0026quot;success\u0026quot;\u0026gt;/WEB-INF/page/LoginPage.jsp\u0026lt;/result\u0026gt; \u0026lt;interceptor-ref name=\u0026quot;permissionStack\u0026quot;/\u0026gt; \u0026lt;/action\u0026gt;  æ³¨æ„ï¼š å¦‚æœç›´æ¥åœ¨actionä¸­å®šä¹‰ä½¿ç”¨æ‹¦æˆªå™¨,åˆ™ä¸ä¼šåœ¨ä½¿ç”¨Strutsè‡ªå¸¦æ‹¦æˆªå™¨ï¼è¿™æ ·Struts2çš„ä¼˜åŠ¿å°±æ²¡æœ‰äº†ï¼Œæ‰€ä»¥å¼•å…¥æ‹¦æˆªå™¨æ ˆçš„æ¦‚å¿µï¼Œåœ¨æ‹¦æˆªå™¨æ ˆä¸­è¦æŠŠStrutsçš„æ‹¦æˆªå™¨å†™åœ¨å‰é¢ï¼Œä»¥ä¿è¯webé¡¹ç›®ä¼šé¦–å…ˆæ‰§è¡ŒStrutså†å¸¦çš„æ‹¦æˆªå™¨. å¦‚æœæƒ³æ‰€æœ‰çš„ç¨‹åºéƒ½æ˜¯ç”¨è‡ªå®šä¹‰çš„æ‹¦æˆªå™¨ï¼Œå¯ä»¥ä½¿ç”¨ï¼š\n\u0026lt;default-interceptor-ref name=\u0026quot;permissionStack\u0026quot;/\u0026gt;  æ•ˆæœæ¼”ç¤ºï¼š\nç›´æ¥è®¿é—®ä¼šè¢«æ‹¦æˆªï¼š ç™»å½•åè®¿é—® 14ã€è¾“å…¥æ ¡éªŒ ã€€Struts2ä¸­å¯ä»¥å®ç°å¯¹actionçš„æ‰€æœ‰æ–¹æ³•è¿›è¡Œæ ¡éªŒæˆ–è€…å¯¹actionçš„æŒ‡å®šæ–¹æ³•è¿›é¡¹æ ¡éªŒï¼Œå®ç°æ–¹æ³•æœ‰ä¸¤ç§ï¼š\n é‡‡ç”¨æ‰‹å·¥ç¼–å†™ä»£ç å®ç°   å¯¹æ‰€æœ‰æ–¹æ³•è¿›è¡Œæ ¡éªŒ é‡å†™validate()æ–¹æ³•å®ç°ï¼Œvalidate()æ–¹æ³•ä¼šæ ¡éªŒactionä¸­æ‰€æœ‰çš„ä¸executeæ–¹æ³•ç­¾åç›¸åŒçš„æ–¹æ³•. å½“æŸä¸ªæ•°æ®æ ¡éªŒå¤±è´¥æ—¶ï¼Œè°ƒç”¨addFieldError()æ–¹æ³•å¾€ç³»ç»Ÿçš„fieldErrorsæ·»åŠ æ ¡éªŒå¤±è´¥ä¿¡æ¯ï¼Œï¼ˆä¸ºäº†ä½¿ç”¨addFieldError()æ–¹æ³•ï¼Œactionå¯ä»¥ç»§æ‰¿ActionSupportï¼‰ï¼Œå¦‚æœç³»ç»Ÿçš„fieldErroråŒ…å«å¤±è´¥ä¿¡æ¯ï¼Œstruts2ä¼šå°†è¯·æ±‚è½¬å‘åˆ°åä¸ºinputçš„result. åœ¨inputè§†å›¾ä¸­å¯ä»¥é€šè¿‡\u0026lt;s:fielderror/\u0026gt;æ˜¾ç¤ºå¤±è´¥ä¿¡æ¯. éœ€è¦å¼•å…¥æ ‡ç­¾  \u0026lt;%@ taglab url=\u0026quot;/struts-tags\u0026quot; prefix=\u0026quot;s\u0026quot;%\u0026gt;  public void validate(){ if(this.mobile==null||\u0026quot;\u0026quot;.equals(this.mobile.trim())){ this.addFieldError(\u0026quot;username\u0026quot;,\u0026quot;ç”¨æˆ·åä¸èƒ½ä¸ºç©º\u0026quot;); } if(this.mobile==null||\u0026quot;\u0026quot;.equals(this.mobile.trim())){ this.addFieldError(\u0026quot;mobile\u0026quot;,\u0026quot;æ‰‹æœºå·ä¸èƒ½ä¸ºç©º\u0026quot;); }else{ if(!Pattern.compile(\u0026quot;^1[358]\\\\d{9}\u0026quot;).matcher(this.mobile.trim()).matches()){ this.addFieldError(\u0026quot;mobile\u0026quot;,\u0026quot;æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®\u0026quot;); } }\t}   å¯¹æŒ‡å®šæ–¹æ³•è¿›è¡Œæ ¡éªŒ  ã€€é‡å†™validateXxx()æ–¹æ³•å®ç°ï¼Œvalidate()æ–¹æ³•ä¼šæ ¡éªŒactionä¸­æ‰€æœ‰çš„ä¸executeæ–¹æ³•ç­¾åç›¸åŒçš„æ–¹æ³•. å½“æŸä¸ªæ•°æ®æ ¡éªŒå¤±è´¥æ—¶ï¼Œè°ƒç”¨addFieldError()æ–¹æ³•å¾€ç³»ç»Ÿçš„fieldErrorsæ·»åŠ æ ¡éªŒå¤±è´¥ä¿¡æ¯ï¼Œï¼ˆä¸ºäº†ä½¿ç”¨addFieldError()æ–¹æ³•ï¼Œactionå¯ä»¥ç»§æ‰¿ActionSupportï¼‰ï¼Œå¦‚æœç³»ç»Ÿçš„fieldErroråŒ…å«å¤±è´¥ä¿¡æ¯ï¼Œstruts2ä¼šå°†è¯·æ±‚è½¬å‘åˆ°åä¸ºinputçš„result. åœ¨inputè§†å›¾ä¸­å¯ä»¥é€šè¿‡\u0026lt;s:fielderror/\u0026gt;æ˜¾ç¤ºå¤±è´¥ä¿¡æ¯. éœ€è¦å¼•å…¥æ ‡ç­¾\n\u0026lt;%@ taglab url=\u0026quot;/struts-tags\u0026quot; prefix=\u0026quot;s\u0026quot;%\u0026gt;  public void validateUpdata(){ if(this.mobile==null||\u0026quot;\u0026quot;.equals(this.mobile.trim())){ this.addFieldError(\u0026quot;username\u0026quot;,\u0026quot;ç”¨æˆ·åä¸èƒ½ä¸ºç©º\u0026quot;); } if(this.mobile==null||\u0026quot;\u0026quot;.equals(this.mobile.trim())){ this.addFieldError(\u0026quot;mobile\u0026quot;,\u0026quot;æ‰‹æœºå·ä¸èƒ½ä¸ºç©º\u0026quot;); }else{ if(!Patten.compile(\u0026quot;^1[358]\\\\d{9}\u0026quot;).matcher(this.mobile.trim()).matches()){ this.addFieldError(\u0026quot;mobile\u0026quot;,\u0026quot;æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®\u0026quot;); } } }   è¾“å…¥æ ¡éªŒçš„æµç¨‹  ç±»å‹è½¬æ¢å™¨é˜Ÿè¯·æ±‚å‚æ•°æ‰§è¡Œç±»å‹è½¬æ¢ï¼Œå¹¶æŠŠè½¬æ¢åçš„èµ‹å€¼ç»™actionä¸­çš„å±æ€§. å¦‚æœåœ¨æ‰§è¡Œç±»å‹è½¬æ¢çš„è¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸ï¼Œç³»ç»Ÿä¼šå°†å¼‚å¸¸ä¿¡æ¯ä¿å­˜åˆ°ActionContextï¼ŒconversionErroræ‹¦æˆªå™¨å°†å¼‚å¸¸ä¿¡æ¯å°è£…åˆ°fieldErrorsé‡Œ. ä¸ç®¡ç±»å‹è½¬æ¢æ˜¯å¦å‡ºç°å¼‚å¸¸ï¼Œéƒ½ä¼šè¿›å…¥ç¬¬3æ­¥. ç³»ç»Ÿé€šè¿‡åå°„æŠ€æœ¯å…ˆè°ƒç”¨actionä¸­çš„validateXxx()æ–¹æ³•ï¼ŒXxxä¸ºæ–¹æ³•å. åœ¨è°ƒç”¨actionä¸­çš„validate()æ–¹æ³•. ç»è¿‡ä¸Šé¢4æ­¥ï¼Œå¦‚æœç³»ç»Ÿä¸­çš„fieldErrorså­˜åœ¨é”™è¯¯ä¿¡æ¯ï¼ˆå³å­˜æ”¾é”™è¯¯ä¿¡æ¯çš„é›†åˆçš„size\u0026gt;0ï¼‰ï¼Œç³»ç»Ÿè‡ªåŠ¨å°†è¯·æ±‚è½¬å‘è‡³åç§°ä¸ºinputè§†å›¾. å¦‚æœç³»ç»Ÿä¸­çš„fieldErrorsæ²¡æœ‰ä»»ä½•é”™è¯¯ä¿¡æ¯ï¼Œç³»ç»Ÿå°†æ‰§è¡Œactionä¸­çš„å¤„ç†æ–¹æ³•.    åŸºäºXMLé…ç½®æ–¹å¼å®ç°  ã€€a) å¯¹æ‰€æœ‰æ–¹æ³•è¿›è¡Œæ ¡éªŒ\nã€€åœ¨Actionç›¸åŒåŒ…ä¸‹åˆ›å»ºActionClassName-validation.xmlæ–‡ä»¶. Struts2 çš„éªŒè¯è§„åˆ™å¤§æ¦‚æœ‰ä»¥ä¸‹æ•°ç§ï¼š\n required:å¿…å¡«æ ¡éªŒå™¨ï¼Œè¦æ±‚fieldçš„å€¼ä¸èƒ½ä¸ºnull requiredstring:å¿…å¡«å­—ç¬¦ä¸²æ ¡éªŒå™¨ï¼Œè¦æ±‚fieldçš„å€¼ä¸èƒ½ä¸ºnull,å¹¶ä¸”é•¿åº¦å¤§äº0ï¼Œé»˜ è®¤æƒ…å†µä¸‹ä¼šå¯¹å­—ç¬¦ä¸²å»æ‰å‰åç©ºæ ¼ int:æ•´æ•°æ ¡éªŒå™¨ï¼Œè¦æ±‚fieldçš„å€¼å¿…é¡»åœ¨æ•´æ•°èŒƒå›´å†…ï¼ŒminæŒ‡å®šæœ€å°å€¼ï¼ŒmaxæŒ‡å®šæœ€å¤§å€¼ double:åŒç²¾åº¦æµ®ç‚¹æ•°æ ¡éªŒå™¨ date:æ—¥æœŸæ ¡éªŒå™¨ expression:è¡¨è¾¾å¼æ ¡éªŒå™¨ fieldexpression:å­—æ®µè¡¨è¾¾å¼æ ¡éªŒå™¨ email:ç”µå­é‚®ä»¶æ ¡éªŒå™¨ï¼Œè¦æ±‚å¦‚æœfieldçš„å€¼éç©ºï¼Œåˆ™å¿…é¡»æ˜¯åˆæ³•çš„é‚®ä»¶åœ°å€ url:ç½‘å€æ ¡éªŒå™¨ï¼Œè¦æ±‚å¦‚æœfieldçš„å€¼éç©ºï¼Œåˆ™å¿…é¡»æ˜¯åˆæ³•çš„urlåœ°å€ visitor:Visitoræ ¡éªŒå™¨ï¼Œç”¨äºæ ¡éªŒactionçš„å¤åˆå±æ€§ï¼Œå®ƒæŒ‡å®šä¸€ä¸ªæ ¡éªŒæ–‡ä»¶ç”¨äºæ ¡éªŒå¤åˆå±æ€§ä¸­çš„å±æ€§ conversion:è½¬æ¢æ ¡éªŒå™¨ stringlength:å­—ç¬¦ä¸²é•¿åº¦æ ¡éªŒå™¨ regex:æ­£åˆ™è¡¨è¾¾å¼æ ¡éªŒå™¨  å¸¸ç”¨çš„éªŒè¯è§„åˆ™ï¼š  å¿…å¡«æ£€éªŒ  \u0026lt;validators\u0026gt; \u0026lt;field name=\u0026quot;username\u0026quot;\u0026gt; \u0026lt;field-validator type=\u0026quot;required\u0026quot;\u0026gt; \u0026lt;message\u0026gt;æŒ‡å®šæ£€éªŒå¤±è´¥çš„æç¤ºä¿¡æ¯\u0026lt;/message\u0026gt; \u0026lt;/field-validator\u0026gt; \u0026lt;/field\u0026gt; \u0026lt;/validators\u0026gt;  å¿…å¡«å­—ç¬¦ä¸²æ£€éªŒ  \u0026lt;validators\u0026gt; \u0026lt;field name=\u0026quot;username\u0026quot;\u0026gt; \u0026lt;field-validator type=\u0026quot;requiredstring\u0026quot;\u0026gt; \u0026lt;param name=\u0026quot;trim\u0026quot;\u0026gt;true\u0026lt;/param\u0026gt; \u0026lt;message\u0026gt;æŒ‡å®šæ£€éªŒå¤±è´¥çš„æç¤ºä¿¡æ¯\u0026lt;/message\u0026gt; \u0026lt;/field-validator\u0026gt; \u0026lt;/field\u0026gt; \u0026lt;/validators\u0026gt;  æ•´æ•°æ£€éªŒå™¨/æµ®ç‚¹æ£€éªŒ  \u0026lt;validators\u0026gt; \u0026lt;field name=\u0026quot;age\u0026quot;\u0026gt; \u0026lt;field-validator type=\u0026quot;int\u0026quot;\u0026gt; \u0026lt;param name=\u0026quot;min\u0026quot;\u0026gt;1\u0026lt;/param\u0026gt; \u0026lt;param name=\u0026quot;max\u0026quot;\u0026gt;150\u0026lt;/param\u0026gt; \u0026lt;message\u0026gt;å¹´çºªå¿…é¡»åœ¨1åˆ°150ä¹‹é—´\u0026lt;/message\u0026gt; \u0026lt;/field-validator\u0026gt; \u0026lt;/field\u0026gt; \u0026lt;/validators\u0026gt;  æ—¥æœŸæ£€éªŒ  \u0026lt;validators\u0026gt; \u0026lt;field name=\u0026quot;birth\u0026quot;\u0026gt; \u0026lt;field-validator type=\u0026quot;date\u0026quot;\u0026gt; \u0026lt;param name=\u0026quot;min\u0026quot;\u0026gt;1900-01-01\u0026lt;/param\u0026gt; \u0026lt;param name=\u0026quot;max\u0026quot;\u0026gt;2050-02-21\u0026lt;/param\u0026gt; \u0026lt;message key=\u0026quot;birth.range\u0026quot;/\u0026gt; \u0026lt;/field-validator\u0026gt; \u0026lt;/field\u0026gt; \u0026lt;/validators\u0026gt;  å­—æ®µè¡¨è¾¾å¼æ£€éªŒå™¨(è¦æ±‚æŒ‡å®šå­—æ®µæ»¡è¶³ä¸€ä¸ªé€»è¾‘è¡¨è¾¾å¼)  \u0026lt;validators\u0026gt; \u0026lt;field name=\u0026quot;re_pass\u0026quot;\u0026gt; \u0026lt;field-validator type=\u0026quot;fieldexpression\u0026quot;\u0026gt; \u0026lt;!--æŒ‡å®šé€»è¾‘è¡¨è¾¾å¼ --\u0026gt; \u0026lt;param name=\u0026quot;expression\u0026quot;\u0026gt; (pass eq re_pass)\u0026lt;/param\u0026gt; \u0026lt;message\u0026gt;å¯†ç å¿…é¡»å’Œç¡®è®¤å¯†ç ç›¸ç­‰\u0026lt;/message\u0026gt; \u0026lt;/field-validator\u0026gt; \u0026lt;/field\u0026gt; \u0026lt;/validators\u0026gt;  é‚®ä»¶åœ°å€æ ¡éªŒ  \u0026lt;validators\u0026gt; \u0026lt;field name=\u0026quot;email\u0026quot;\u0026gt; \u0026lt;field-validator type=\u0026quot;email\u0026quot;\u0026gt; \u0026lt;message\u0026gt;ä½ çš„ç”µå­é‚®ä»¶åœ°å€å¿…é¡»æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ç”µé‚®åœ°å€\u0026lt;/message\u0026gt; \u0026lt;/field-validator\u0026gt; \u0026lt;/field\u0026gt; \u0026lt;/validators\u0026gt;  ç½‘å€æ£€éªŒ  \u0026lt;validators\u0026gt; \u0026lt;field name=\u0026quot;url\u0026quot;\u0026gt; \u0026lt;field-validator type=\u0026quot;url\u0026quot;\u0026gt; \u0026lt;message\u0026gt;ä½ çš„ä¸»é¡µåœ°å€å¿…é¡»æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ç½‘å€\u0026lt;/message\u0026gt; \u0026lt;/field-validator\u0026gt; \u0026lt;/field\u0026gt; \u0026lt;/validators\u0026gt;  å­—ç¬¦ä¸²é•¿åº¦æ£€éªŒ  \u0026lt;validators\u0026gt; \u0026lt;field name=\u0026quot;user\u0026quot;\u0026gt; \u0026lt;field-validator type=\u0026quot;stringlength\u0026quot;\u0026gt; \u0026lt;param name=\u0026quot;minlength\u0026quot;\u0026gt;4\u0026lt;/param\u0026gt; \u0026lt;param name=\u0026quot;maxlength\u0026quot;\u0026gt;20\u0026lt;/param\u0026gt; \u0026lt;message\u0026gt;ä½ çš„ç”¨æˆ·åé•¿åº¦å¿…é¡»åœ¨4åˆ°20ä¹‹é—´\u0026lt;/message\u0026gt; \u0026lt;/field-validator\u0026gt; \u0026lt;/field\u0026gt; \u0026lt;/validators\u0026gt;  æ­£åˆ™è¡¨è¾¾å¼æ£€éªŒ  \u0026lt;validators\u0026gt; \u0026lt;field name=\u0026quot;user\u0026quot;\u0026gt; \u0026lt;field-validator type=\u0026quot;regex\u0026quot;\u0026gt; \u0026lt;param name=\u0026quot;regex\u0026quot;\u0026gt;\u0026lt;![CDATA[(\\w{4,25})]]\u0026gt;\u0026lt;/param\u0026gt; \u0026lt;message\u0026gt;æ‚¨è¾“å…¥çš„ç”¨æˆ·ååªèƒ½æ˜¯å­—æ¯å’Œæ•°ç»„ï¼Œä¸”é•¿åº¦å¿…é¡»åœ¨4åˆ°25ä¹‹é—´\u0026lt;/message\u0026gt; \u0026lt;/field-validator\u0026gt; \u0026lt;/field\u0026gt; \u0026lt;/validators  ã€€b) å¯¹æŒ‡å®šæ–¹æ³•è¿›è¡Œæ ¡éªŒ\nã€€å–åæ›´æ”¹ä¸ºActionClassName-ActionName-validation.xml\næ³¨æ„\n å½“actionåŒæ—¶æä¾›äº†ä¸¤ä¸ªæ ¡éªŒæ–¹æ³•ï¼Œåˆ™æŒ‰ç…§â€œæ‰€æœ‰æ–¹æ³•â€ï¼Œâ€œæŒ‡å®šæ–¹æ³•â€çš„é¡ºåºæ±‡æ€»åæ‰§è¡Œï¼›å¦‚æœåé¢çš„æ–‡ä»¶åŒ…å«å‰é¢æ–‡ä»¶çš„æ–¹æ³•å‘ç”Ÿå†²çªï¼Œåˆ™åªæ˜¯ç”¨åé¢æ–‡ä»¶ä¸­çš„æ ¡éªŒè§„åˆ™. å½“actionç»§æ‰¿äº†å¦å¤–ä¸€ä¸ªactionï¼Œçˆ¶ç±»actionçš„æ ¡éªŒæ–‡ä»¶ä¼šå…ˆè¢«æœç´¢åˆ°.  15ã€å›½é™…åŒ– å‡†å¤‡èµ„æºæ–‡ä»¶ï¼Œèµ„æºæ–‡ä»¶çš„å‘½åæ ¼å¼å¦‚ä¸‹ï¼š\nbaseName_language_country.propeties baseName_language.propeties baseName.propeties  å…¶ä¸­baseNameæ˜¯èµ„æºæ–‡ä»¶çš„åŸºæœ¬åï¼Œå¯ä»¥è‡ªå®šä¹‰ï¼Œä½†languageå’Œcountryå¿…é¡»æ˜¯javaæ”¯æŒçš„è¯­è¨€å’Œå›½å®¶.\n ä¸­å›½ï¼šbaseName_zh_CN.properties ç¾å›½ï¼šbaseName_en_US.properties  å¦‚æœæ²¡æœ‰ä½¿ç”¨å¼€å‘å·¥å…·ï¼Œå¯¹äºä¸­æ–‡çš„å±æ€§æ–‡ä»¶ï¼Œåº”è¯¥ä½¿ç”¨JDKæä¾›çš„native2asciiå‘½ä»¤æŠŠæ–‡ä»¶è½¬æ¢ä¸ºUnicodeç¼–ç çš„æ–‡ä»¶. å‘½ä»¤ä½¿ç”¨å¦‚ä¸‹ï¼š native2ascii æºæ–‡ä»¶.properties ç›®æ ‡æ–‡ä»¶.properties\n15.1ã€é…ç½®å…¨å±€èµ„æºä¸è¾“å‡ºå›½é™…åŒ–ä¿¡æ¯ å½“å‡†å¤‡å¥½èµ„æºæ–‡ä»¶ä¹‹åï¼Œå¯ä»¥åœ¨struts.xmlä¸­é€šè¿‡struts.custom.i18n.resourceså¸¸é‡æŠŠèµ„æºæ–‡ä»¶å®šä¹‰ä¸ºå…¨å±€å˜é‡ï¼š\n\u0026lt;constant name=\u0026quot;struts.custom.i18n.resources\u0026quot; value=\u0026quot;baseName\u0026quot;/ \u0026gt;  å…¶ä¸­baseNameä¸ºèµ„æºçš„åŸºæœ¬å. ä¹‹åå°±å¯ä»¥åœ¨é¡µé¢æˆ–è€…actionä¸­è®¿é—®å›½é™…åŒ–ä¿¡æ¯ï¼š\n åœ¨JSPé¡µé¢ä¸­ä½¿ç”¨\u0026lt;s:text name=\u0026quot;\u0026quot;/\u0026gt;æ ‡ç­¾è¾“å‡ºå›½é™…åŒ–ä¿¡æ¯ï¼›\u0026lt;s:text name=\u0026quot;user\u0026quot;/\u0026gt;,nameä¸ºèµ„æºæ–‡ä»¶ä¸­çš„Key. åœ¨Actionç±»ä¸­ï¼Œå¯ä»¥ç»§æ‰¿ActionSupportï¼Œä½¿ç”¨getText()æ–¹æ³•å¾—åˆ°å›½é™…åŒ–ä¿¡æ¯ï¼Œè¯¥æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ç”¨äºæŒ‡å®šèµ„æºæ–‡ä»¶ä¸­çš„Key. åœ¨è¡¨å•æ ‡ç­¾ä¸­ï¼Œé€šè¿‡Keyå±æ€§æŒ‡å®šèµ„æºæ–‡ä»¶ä¸­çš„Keyï¼Œå¦‚ï¼š  \u0026lt;s:textfield name=\u0026quot;realname\u0026quot; key=\u0026quot;use\u0026quot;/\u0026gt;  è¾“å‡ºå¸¦å ä½ç¬¦çš„å›½é™…åŒ–ä¿¡æ¯ èµ„æºæ–‡ä»¶ä¸­çš„å†…å®¹å¦‚ä¸‹ï¼š welcome={0},ä½ å¥½{1}\n15.2ã€JSPé¡µé¢ä¸­è¾“å‡ºå ä½ç¬¦çš„å›½é™…åŒ–ä¿¡æ¯ \u0026lt;s:text name=\u0026quot;welcome\u0026quot;\u0026gt; \u0026lt;s:param\u0026gt;ç†Šå¤§\u0026lt;/s:param\u0026gt; \u0026lt;s:param\u0026gt;å­¦ä¹ \u0026lt;/s:param\u0026gt; \u0026lt;s:text/\u0026gt;  ã€€åœ¨Actionç±»ä¸­è·å–å¸¦å ä½ç¬¦çš„å›½é™…åŒ–ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨getText(String Keyï¼ŒString[] args)æˆ–è€…getText(String Keyï¼ŒList args)æ–¹æ³•\n15.3ã€åŒ…èŒƒå›´èµ„æºæ–‡ä»¶ ã€€åœ¨ä¸€ä¸ªå¤§å‹åº”ç”¨ä¸­ï¼Œæ•´ä¸ªåº”ç”¨æœ‰å¤§é‡çš„å†…å®¹éœ€è¦å®ç°å›½é™…åŒ–ï¼Œå¦‚æœæŠŠå›½é™…åŒ–çš„å†…å®¹æ”¾ç½®åœ¨å…¨å±€èµ„æºå±æ€§æ–‡ä»¶ä¸­ï¼Œæ˜¾ç„¶ä¼šå¯¼è‡´èµ„æºæ–‡ä»¶å˜çš„åºå¤§ã€è‡ƒè‚¿ã€ä¸ä¾¿äºç»´æŠ¤ï¼Œæ”¯ä¸ªæ—¶å€™å¯ä»¥é’ˆå¯¹ä¸åŒæœ«ç­ï¼Œä½¿ç”¨åŒ…èŒƒå›´æ¥ç»„ç»‡å›½é™…åŒ–æ–‡ä»¶.\næ–¹æ³•ï¼šåœ¨javaçš„åŒ…ä¸‹æ”¾ç½®package_language_country.propertiesèµ„æºæ–‡ä»¶ï¼Œpackageä¸ºå›ºå®šå†™æ³•ï¼Œå¤„äºè¯¥åŒ…åŠå­åŒ…ä¸‹çš„actionéƒ½å¯ä»¥è®¿é—®è¯¥èµ„æºï¼Œå½“æŸ¥åˆ°æŒ‡å®šKeyçš„æ¶ˆæ¯æ—¶ï¼Œç³»ç»Ÿä¼šå…ˆä»packageèµ„æºæ–‡ä»¶æŸ¥æ‰¾ï¼Œå½“ä¸å­˜åœ¨å¯¹åº”çš„Keyæ—¶ï¼Œæ‰ä¼šä»å¸¸é‡struts.custom.i18n.resourcesæŒ‡å®šçš„èµ„æºæ–‡ä»¶ä¸­å¯»æ‰¾.\n15.4ã€ActionèŒƒå›´èµ„æºæ–‡ä»¶ ã€€åœ¨Actionç±»æ‰€åœ¨çš„è·¯å¾„ï¼Œæ”¾ç½®ActionClassName_languaage_country.propertiesèµ„æºæ–‡ä»¶ï¼ŒActionClassNameä¸ºactionç±»çš„ç®€å•åç§°ï¼›å½“æŒ‡å®škeyçš„æ¶ˆæ¯æ—¶ï¼Œç³»ç»Ÿä¼šå…ˆä»ActionClassName_languaage_country.propertiesèµ„æºæ–‡ä»¶ä¸­æŸ¥æ‰¾.\n15.5ã€JSPä¸­ç›´æ¥è®¿é—®æŸä¸ªèµ„æºæ–‡ä»¶ struts2æä¾›äº†\u0026lt;s:i18n\u0026gt;æ ‡ç­¾ï¼Œä½¿ç”¨\u0026lt;s:i18n\u0026gt;æ ‡ç­¾å¯ä»¥åœ¨ç±»è·¯å¾„ä¸‹ç›´æ¥ä»æŸä¸ªèµ„æºæ–‡ä»¶ä¸­è·å–å›½é™…åŒ–æ•°æ®ï¼Œæ— éœ€ä»»ä½•é…ç½®ï¼š\n\u0026lt;s:i18n name=\u0026quot;realname\u0026quot;\u0026gt; \u0026lt;s:text name=\u0026quot;realname\u0026quot;/\u0026gt; \u0026lt;s:i18n\u0026gt;  realnameä¸ºè¦è®¿é—®çš„èµ„æºæ–‡ä»¶çš„åŸºæœ¬å\nå¦‚æœè¦è®¿é—®çš„èµ„æºæ–‡ä»¶åœ¨ç±»è·¯å¾„çš„æŸä¸ªåŒ…ä¸‹ï¼Œå¯ä»¥è®¿é—®ï¼š\n\u0026lt;s:i18n name=\u0026quot;com/haibao/action/package\u0026quot;\u0026gt; \u0026lt;s:text name=\u0026quot;realname\u0026quot;\u0026gt; \u0026lt;s:param\u0026gt;ç†Šå¤§\u0026lt;/s:param\u0026gt; \u0026lt;/s:text/\u0026gt; \u0026lt;s:i18n\u0026gt;  ä¸Šé¢è®¿é—®com.haibao.actionåŒ…ä¸‹åŸºæœ¬åä¸ºpackageçš„èµ„æºæ–‡ä»¶.\n16ã€OGNLè¡¨è¾¾å¼è¯­è¨€ ã€€OGNLæ˜¯Object Graphic Navigation Languageï¼ˆå¯¹è±¡å›¾å¯¼èˆªè¯­è¨€ï¼‰çš„ç¼©å†™ï¼Œæ˜¯ä¸€ä¸ªå¼€æºçš„é¡¹ç›®. Struts2æ¡†æ¶é‡‡ç”¨OGNLä½œä¸ºé»˜è®¤çš„è¡¨è¾¾å¼è¯­è¨€.\nç›¸å¯¹äºELè¡¨è¾¾å¼ï¼ŒOGNLæä¾›äº†ï¼š\n æ”¯æŒå¯¹è±¡æ–¹æ³•è°ƒç”¨ï¼šå¦‚xxx.sayHello()ï¼› æ”¯æŒç±»é™æ€æ–¹æ³•è°ƒç”¨å’Œå€¼è®¿é—®ï¼Œè¡¨è¾¾å¼çš„æ ¼å¼ä¸º@[ç±»å…¨åï¼ˆåŒ…æ‹¬è·¯å¾„ï¼‰]@[æ–¹æ³•å|å€¼å] ä¾‹å¦‚ï¼š@java.lang.String@format('foo %s'ï¼Œbar) æˆ–è€… @com.haibao.Constant@APP_NAME æ“ä½œé›†åˆå¯¹è±¡.  ã€€Ognlæœ‰ä¸€ä¸ªä¸Šä¸‹æ–‡ï¼ˆContextï¼‰æ¦‚å¿µï¼Œå®ƒå®ç°äº†äº†java.utils.Mapæ¥å£ï¼ŒStruts2ä¸­è¯´æ˜ï¼š\n ä¸Šä¸‹æ–‡ï¼ˆContextï¼‰çš„å®ç°ä¸ºActionContext. å½“Struts2æ¥å—ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œä¼šè¿…é€Ÿåˆ›å»ºActionContextï¼ŒValueStackï¼Œaction. ç„¶åæŠŠactionå­˜è¿›ValueStackï¼Œæ‰€ä»¥actionçš„å®ä¾‹å˜é‡å¯ä»¥è¢«OGNLè®¿é—®. è®¿é—®ä¸Šä¸‹æ–‡ï¼ˆContextï¼‰ä¸­çš„å¯¹è±¡éœ€è¦ä½¿ç”¨#ç¬¦å·æ ‡æ³¨å‘½åç©ºé—´. å¦‚#applicationã€#session. å¦‚ï¼š#application['userName']==#application.userName//è·å¾—applicationä¸­userNameå€¼.  ï¼ˆ#sessionå¯¹è±¡ã€#requestå¯¹è±¡ã€#parameteå¯¹è±¡ã€attrå¯¹è±¡â€”æŒ‰ç…§pageâ€”requestâ€”sessionâ€”applicationé¡ºåºè®¿é—®å…¶å±æ€§ï¼‰. OGNLè®¾å®šäº†ä¸€ä¸ªè·Ÿå¯¹è±¡ï¼ˆrootï¼‰å¯¹è±¡ï¼Œåœ¨Struts2ä¸­æ ¹å¯¹è±¡å°±æ˜¯ValueStackï¼ˆå€¼æ ˆï¼‰. å¦‚æœè®¿é—®æ ¹å¯¹è±¡ä¸­çš„å±æ€§ï¼Œåˆ™å¯ä»¥çœç•¥#å‘½åç©ºé—´ï¼Œç›´æ¥è®¿é—®è¯¥å¯¹è±¡çš„å±æ€§å³å¯. å¦‚ï¼š${foo}//è·å¾—æ ˆå€¼ä¸­æŸä¸ªå¯¹è±¡çš„fooå±æ€§.  æ³¨æ„ï¼šStruts2ä¸­ï¼ŒOGNLè¡¨è¾¾å¼éœ€è¦é…åˆStrutsæ ‡ç­¾ä½¿ç”¨. å¦‚ï¼š\u0026lt;s:property value=\u0026quot;name\u0026quot;\u0026gt;ï¼›ä½¿ç”¨ELè¡¨è¾¾å¼èƒ½å¤Ÿè®¿é—®valueStackä¸­å¯¹è±¡çš„å±æ€§ï¼ŒåŸå› æ˜¯ï¼šStruts2å¯¹HTTPServletRequestä½œäº†è¿›ä¸€æ­¥çš„å°è£….\n17ã€é‡‡ç”¨OGNLè¡¨è¾¾å¼åˆ›å»ºList/Mapé›†åˆå¯¹è±¡ 17.1ã€è¯•ç”¨å¦‚ä¸‹ç›´æ¥ç”Ÿæˆä¸€ä¸ªListå¯¹è±¡ï¼š \u0026lt;s:set name=\u0026quot;list\u0026quot; value=\u0026quot;{'zhangsan','lisi','wangwu'}\u0026quot;/\u0026gt; \u0026lt;s:iterator value=\u0026quot;#list\u0026quot;\u0026gt;\u0026lt;!-- è¿­ä»£å™¨ --\u0026gt; \u0026lt;s:property/\u0026gt;\u0026lt;br\u0026gt; \u0026lt;/s:iterator\u0026gt;  Setæ ‡ç­¾ç”¨äºå°†æŸä¸ªå€¼æ”¾å…¥æŒ‡å®šèŒƒå›´\n scopeï¼šæŒ‡å®šå˜é‡è¢«æ”¾ç½®çš„èŒƒå›´ï¼Œè¯¥å±æ€§å¯ä»¥æ¥å—applicationã€sessionã€requestã€pageæˆ–action. å¦‚æœæ²¡æœ‰è®¾ç½®è¯¥å±æ€§ï¼Œåˆ™é»˜è®¤æ”¾ç½®åœ¨OGNL Contextä¸­. valueï¼šèµ‹ç»™å˜é‡çš„å€¼ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®è¯¥å±æ€§ï¼Œåˆ™å°†ValueStackæ ˆé¡¶çš„å€¼èµ‹å€¼ç»™å˜é‡.  ç”Ÿæˆä¸€ä¸ªMapå¯¹è±¡ï¼š(Key\u0026ndash;Value)\n\u0026lt;s:set name=\u0026quot;foobar\u0026quot; value=\u0026quot;#{'k1': 'value1','k2':'value2'}\u0026quot;/\u0026gt; \u0026lt;s:iterator value=\u0026quot;# foobar \u0026quot;\u0026gt;\u0026lt;!-- è¿­ä»£å™¨ --\u0026gt; \u0026lt;s:property value=\u0026quot;key\u0026quot;/\u0026gt;=\u0026lt;s:property value=\u0026quot;value\u0026quot;/\u0026gt;\u0026lt;br\u0026gt; \u0026lt;/s:iterator\u0026gt;  java è¿­ä»£æ–¹æ³•ï¼š\nfor(Map.Entry\u0026lt;String,Integer\u0026gt;entry:maps.entrySet){ System.out.println(entry.getKey()+\u0026quot;=\u0026quot;+entry.getValue()); }  18ã€é‡‡ç”¨OGNLè¡¨è¾¾å¼åˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜åœ¨äºé›†åˆä¸­ ä½¿ç”¨inå’Œnot in inè¡¨è¾¾å¼\n\u0026lt;s:if test=\u0026quot;foor\u0026quot; in {'foo', 'bar'}\u0026gt; åœ¨ \u0026lt;/s:if\u0026gt; \u0026lt;s:else\u0026gt; ä¸åœ¨ \u0026lt;/s:else\u0026gt; not in è¡¨è¾¾å¼ \u0026lt;s:if test=\u0026quot;foor\u0026quot; not in {'foo','bar'}\u0026gt; ä¸åœ¨ \u0026lt;/s:if\u0026gt; \u0026lt;s:else\u0026gt; åœ¨ \u0026lt;/s:else\u0026gt;  é™„åŠ ï¼š é™¤äº†inå’Œnot inä¹‹å¤–OGNLè¿˜å…è®¸ä½¿ç”¨æŸä¸ªè§„åˆ™è·å¾—é›†åˆå¯¹è±¡çš„å­é›†\n ?:è·å¾—æ‰€æœ‰ç¬¦åˆé€»è¾‘çš„å…ƒç´ . ^:è·å¾—ç¬¦åˆé€»è¾‘çš„ç¬¬ä¸€ä¸ªå…ƒç´ . $:è·å¾—ç¬¦åˆé€»è¾‘çš„æœ€åä¸€ä¸ªå…ƒç´ .  ä¾‹å¦‚ï¼š\n\u0026lt;s:iterator value=\u0026quot;books.{?#this.price}35}\u0026quot;\t/\u0026gt;  19ã€å¸¸ç”¨æ ‡ç­¾ 19.1ã€propertæ ‡ç­¾ï¼š ç”¨äºè¾“å‡ºæŒ‡å®šå€¼ï¼š\n\u0026lt;s:set name=\u0026quot;name\u0026quot; value=\u0026quot;kk\u0026quot;/\u0026gt; \u0026lt;s:property value=\u0026quot;#name\u0026quot;/\u0026gt;   default:å¯é€‰å±æ€§ï¼Œå¦‚æœéœ€è¦è¾“å‡ºæŒ‡å®šçš„å±æ€§å€¼ä¸ºnullï¼Œåˆ™æ˜¾ç¤ºè¯¥å±æ€§æŒ‡å®šçš„å€¼. valueï¼šå¯é€‰å±æ€§ï¼ŒæŒ‡å®šéœ€è¦è¾“å‡ºçš„å±æ€§å€¼ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šè¯¥å±æ€§ï¼Œåˆ™é»˜è®¤è¾“å‡ºValueStackæ ˆé¡¶çš„å€¼. escapeï¼šå¯é€‰å±æ€§ï¼ŒæŒ‡å®šæ˜¯å¦æ ¼å¼åŒ–HTMLä»£ç . idï¼šå¯é€‰å±æ€§ï¼ŒæŒ‡å®šè¿˜å…ƒç´ çš„æ ‡è¯†.  19.2ã€iteratoræ ‡ç­¾ iteratoræ ‡ç­¾ç”¨äºå¯¹é›†åˆè¿›è¡Œè¿­ä»£ï¼Œæ²»ç†çš„é›†åˆåŒ…å«Listã€Setå’Œæ•°ç»„\n\u0026lt;s:set name=\u0026quot;list\u0026quot; value=\u0026quot;{'foo','bar'}\u0026quot;/\u0026gt; \u0026lt;s:iterator value=\u0026quot;#list\u0026quot; status=\u0026quot;st\u0026quot;\u0026gt; \u0026lt;s:color=\u0026lt;s:if test=\u0026quot;#st.odd\u0026quot;\u0026gt;red\u0026lt;/s:if\u0026gt;\u0026lt;s:else\u0026gt;blue\u0026lt;/s:else\u0026gt;\u0026gt; \u0026lt;s:property/\u0026gt;\u0026lt;/font\u0026gt;\u0026lt;br\u0026gt; \u0026lt;/s:iterator\u0026gt;   value:å¯é€‰å±æ€§ï¼ŒæŒ‡å®šè¢«è¿­ä»£çš„é›†åˆï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®è¯¥å±æ€§ï¼Œåˆ™ä½¿ç”¨ValueStackæ ˆé¡¶çš„é›†åˆ id:å¯é€‰å±æ€§ï¼ŒæŒ‡å®šå³åˆç†å…ƒç´ çš„id. ï¼ˆè¿‡æ—¶ï¼‰ statusï¼šè¯¥å±æ€§æŒ‡å®šè¿­ä»£æ—¶çš„IteratorStatuså®ä¾‹. è¯¥å®ä¾‹åŒ…å«ä»¥ä¸‹å‡ ä¸ªæ–¹æ³•ï¼š  int getCount()ï¼Œè¿”å›å½“å‰è¿­ä»£äº†å‡ ä¸ªå…ƒç´  int getIndex()ï¼Œè¿”å›å½“å‰è¿­ä»£å…ƒç´ çš„ç´¢å¼• boolean isEven()ï¼Œè¿”å›å½“å‰è¢«è¿­ä»£å…ƒç´ çš„ç´¢å¼•æ˜¯å¦ä¸ºå¶æ•° boolean isOdd()ï¼Œè¿”å›å½“å‰è¢«è¿­ä»£å…ƒç´ çš„ç´¢å¼•æ˜¯å¦ä¸ºå¥‡æ•° boolean isFirst()ï¼Œè¿”å›å½“å‰è¢«è¿­ä»£å…ƒç´ çš„ç´¢å¼•æ˜¯å¦æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´  boolean isLast()ï¼Œè¿”å›å½“å‰è¢«è¿­ä»£å…ƒç´ çš„ç´¢å¼•æ˜¯å¦æœ€åä¸€ä¸ªå…ƒç´     19.3ã€urlæ ‡ç­¾ \u0026lt;s:url value=\u0026quot;hellowoeld_add\u0026quot; namespace=\u0026quot;/test\u0026quot;\u0026gt;\u0026lt;s:param name=\u0026quot;person\u0026quot; value=\u0026quot;23\u0026quot;/\u0026gt;\u0026lt;/s:url\u0026gt;  ç”Ÿæˆç±»ä¼¼å¦‚ä¸‹è·¯å¾„ï¼š /struts/test/helloworld_add.adtion?persom=23 çº¢è‰²éƒ¨åˆ†ä¸ºå†…å®¹è·¯å¾„\nå½“æ ‡ç­¾çš„å±æ€§ä½œä¸ºå­—ç¬¦ä¸²ç±»å‹å¤„ç†æ—¶ï¼Œâ€œ%â€ç¬¦å·çš„ç”¨é€”è¯•è®¡ç®—OGNLè¡¨è¾¾å¼çš„å€¼\n\u0026lt;s:set value=\u0026quot;myurl\u0026quot; value='\u0026quot;http://www.sohu.com\u0026quot;'/\u0026gt; \u0026lt;s:url value=\u0026quot;myurl\u0026quot;/\u0026gt;\u0026lt;/br\u0026gt; \u0026lt;s:url value=\u0026quot;%{#myurl}\u0026quot;/\u0026gt;  è¾“å‡ºç»“æœï¼š\n# myurl http://www.sohu.com  19.4ã€è¡¨å•æ ‡ç­¾ï¼šcheckboxlistå¤é€‰æ¡† å¦‚æœé›†åˆä¸ºlist\n\u0026lt;s:checkboxlist name=\u0026quot;list\u0026quot; list=\u0026quot;{'Java','.Net','Ror','PHP'}\u0026quot; value=\u0026quot;{'Java','.Net'}\u0026quot;/\u0026gt;  ç”Ÿæˆå¦‚ä¸‹htmlä»£ç ï¼š\n\u0026lt;input type=\u0026quot;checkbox\u0026quot; name=\u0026quot;list\u0026quot; value=\u0026quot;Java\u0026quot; checked=\u0026quot;checked\u0026quot;/\u0026gt;\u0026lt;lable\u0026gt;Java\u0026lt;/lable\u0026gt; \u0026lt;input type=\u0026quot;checkbox\u0026quot; name=\u0026quot;list\u0026quot; value=\u0026quot;.Net\u0026quot; checked=\u0026quot;checked\u0026quot;/\u0026gt;\u0026lt;lable\u0026gt;.Net\u0026lt;/lable\u0026gt; \u0026lt;input type=\u0026quot;checkbox\u0026quot; name=\u0026quot;list\u0026quot; value=\u0026quot; Ror\u0026quot;/\u0026gt;\u0026lt;lable\u0026gt;Ror\u0026lt;/lable\u0026gt; \u0026lt;input type=\u0026quot;checkbox\u0026quot; name=\u0026quot;list\u0026quot; value=\u0026quot; PHP\u0026quot;/\u0026gt;\u0026lt;lable\u0026gt;PHP\u0026lt;/lable\u0026gt;  å¦‚æœé›†åˆä¸ºMap\n\u0026lt;s:checkboxlist name=\u0026quot;map\u0026quot; list=\u0026quot;#{1:'Java',2:'.Net',3:'Ror',4:'PHP'}\u0026quot; listKey=\u0026quot;key\u0026quot; listValue=\u0026quot;value\u0026quot; value=\u0026quot;{1,2,3}\u0026quot;/\u0026gt;  ç”Ÿæˆå¦‚ä¸‹htmlä»£ç ï¼š\n\u0026lt;input type=\u0026quot;checkbox\u0026quot; name=\u0026quot;map\u0026quot; value=\u0026quot;1\u0026quot; checked=\u0026quot;checked\u0026quot;/\u0026gt;\u0026lt;lable\u0026gt;Java\u0026lt;/lable\u0026gt; \u0026lt;input type=\u0026quot;checkbox\u0026quot; name=\u0026quot;map\u0026quot; value=\u0026quot;2\u0026quot; checked=\u0026quot;checked\u0026quot;/\u0026gt;\u0026lt;lable\u0026gt;.Net\u0026lt;/lable\u0026gt; \u0026lt;input type=\u0026quot;checkbox\u0026quot; name=\u0026quot;map\u0026quot; value=\u0026quot;3\u0026quot; checked=\u0026quot;checked\u0026quot;/\u0026gt;\u0026lt;lable\u0026gt;Ror\u0026lt;/lable\u0026gt; \u0026lt;input type=\u0026quot;checkbox\u0026quot; name=\u0026quot;map\u0026quot; value=\u0026quot;4\u0026quot;/\u0026gt;\u0026lt;lable\u0026gt;PHP\u0026lt;/lable\u0026gt;  å¦‚æœé›†åˆé‡Œå­˜æ”¾çš„æ˜¯javabean\n\u0026lt;% Person p1 = new Person(1,\u0026quot;ç¬¬ä¸€ä¸ª\u0026quot;); Person p1 = new Person(2,\u0026quot;ç¬¬ä¸€ä¸ª\u0026quot;); List\u0026lt;Person\u0026gt; list = new ArrayList\u0026lt;Person\u0026gt;(); list.add(p1); list.add(p2); request.setAttribute(\u0026quot;person\u0026quot;, list); %\u0026gt; \u0026lt;s:checkboxlist list=\u0026quot;#request.persons\u0026quot; listKey=\u0026quot;personid\u0026quot; listValue=\u0026quot;name\u0026quot;\u0026gt;\u0026lt;/s:checkboxlist\u0026gt;  personidå’Œnameä¸ºPersonçš„å±æ€§ ç”Ÿæˆå¦‚ä¸‹ä»£ç ï¼š\n\u0026lt;input type=\u0026quot;checkbox\u0026quot; name=\u0026quot;beans\u0026quot; value=\u0026quot;1\u0026quot;/\u0026gt;\u0026lt;lable\u0026gt;ç¬¬ä¸€ä¸ª\u0026lt;/lable\u0026gt; \u0026lt;input type=\u0026quot;checkbox\u0026quot; name=\u0026quot;beans\u0026quot; value=\u0026quot;2\u0026quot;/\u0026gt;\u0026lt;lable\u0026gt;ç¬¬äºŒä¸ª\u0026lt;/lable\u0026gt;  19.5ã€è¡¨å•æ ‡ç­¾ï¼šradioå•é€‰æ¡† å¦‚æœé›†åˆä¸ºlist\n\u0026lt;s:radio name=\u0026quot;list\u0026quot; list=\u0026quot;{'Java','.Net','Ror','PHP'}\u0026quot; value=\u0026quot;'Java'\u0026quot;/\u0026gt;  ç”Ÿæˆå¦‚ä¸‹htmlä»£ç ï¼š\n\u0026lt;input type=\u0026quot;radio\u0026quot; name=\u0026quot;list\u0026quot; value=\u0026quot;Java\u0026quot; checked=\u0026quot;checked\u0026quot;/\u0026gt;\u0026lt;lable\u0026gt;Java\u0026lt;/lable\u0026gt; \u0026lt;input type=\u0026quot;radio\u0026quot; name=\u0026quot;list\u0026quot; value=\u0026quot;.Net\u0026quot;/\u0026gt; \u0026lt;input type=\u0026quot;radio\u0026quot; name=\u0026quot;list\u0026quot; value=\u0026quot;Ror\u0026quot;/\u0026gt; \u0026lt;input type=\u0026quot;radio\u0026quot; name=\u0026quot;list\u0026quot; value=\u0026quot;PHP\u0026quot;/\u0026gt;  å¦‚æœé›†åˆä¸ºMap\n\u0026lt;s:radio name=\u0026quot;map\u0026quot; list=\u0026quot;#{1:'Java',2:'.Net'3:,'Ror',4:'PHP'}\u0026quot; listKey=\u0026quot;key\u0026quot; listValue=\u0026quot;value\u0026quot; value=\u0026quot;1\u0026quot;/\u0026gt;  ç”Ÿæˆå¦‚ä¸‹htmlä»£ç ï¼š\n\u0026lt;input type=\u0026quot;radio\u0026quot; name=\u0026quot;map\u0026quot; value=\u0026quot;1\u0026quot; checked=\u0026quot;checked\u0026quot;/\u0026gt;\u0026lt;lable\u0026gt;Java\u0026lt;/lable\u0026gt; \u0026lt;input type=\u0026quot;radio\u0026quot; name=\u0026quot;map\u0026quot; value=\u0026quot;2\u0026quot;/\u0026gt;\u0026lt;lable\u0026gt;.Net\u0026lt;/lable\u0026gt; \u0026lt;input type=\u0026quot;radio\u0026quot; name=\u0026quot;map\u0026quot; value=\u0026quot;3\u0026quot;/\u0026gt;\u0026lt;lable\u0026gt;Ror\u0026lt;/lable\u0026gt; \u0026lt;input type=\u0026quot;radio\u0026quot; name=\u0026quot;map\u0026quot; value=\u0026quot;4\u0026quot;/\u0026gt;\u0026lt;lable\u0026gt;PHP\u0026lt;/lable\u0026gt;  å¦‚æœé›†åˆé‡Œå­˜æ”¾çš„æ˜¯javabean\n\u0026lt;% Person p1 = new Person(1,\u0026quot;ç¬¬ä¸€ä¸ª\u0026quot;); Person p1 = new Person(2,\u0026quot;ç¬¬ä¸€ä¸ª\u0026quot;); List\u0026lt;Person\u0026gt; list = new ArrayList\u0026lt;Person\u0026gt;(); list.add(p1); list.add(p2); request.setAttribute(\u0026quot;person\u0026quot;, list); %\u0026gt; \u0026lt;s:radio name=\u0026quot;beans\u0026quot; list=\u0026quot;#request.persons\u0026quot; listKey=\u0026quot;personid\u0026quot; listValue=\u0026quot;name\u0026quot;/\u0026gt;  personidå’Œnameä¸ºPersonçš„å±æ€§ ç”Ÿæˆå¦‚ä¸‹ä»£ç ï¼š\n\u0026lt;input type=\u0026quot;radio\u0026quot; name=\u0026quot;beans\u0026quot; value=\u0026quot;1\u0026quot;/\u0026gt;\u0026lt;lable\u0026gt;ç¬¬ä¸€ä¸ª\u0026lt;/lable\u0026gt; \u0026lt;input type=\u0026quot;radio\u0026quot; name=\u0026quot;beans\u0026quot; value=\u0026quot;2\u0026quot;/\u0026gt;\u0026lt;lable\u0026gt;ç¬¬äºŒä¸ª\u0026lt;/lable\u0026gt;  19.6ã€è¡¨å•æ ‡ç­¾selectä¸‹æ‹‰é€‰æ‹©æ¡† \u0026lt;s:select name=\u0026quot;list\u0026quot; list=\u0026quot;{'Java','.Net'}\u0026quot; value=\u0026quot;'Java'\u0026quot;/\u0026gt;  ç”Ÿæˆå¦‚ä¸‹htmlä»£ç ï¼š\n\u0026lt;s:select name=\u0026quot;list\u0026quot; id=\u0026quot;list\u0026quot;\u0026gt; \u0026lt;option value=\u0026quot;Java\u0026quot; selected=\u0026quot;selected\u0026quot;\u0026gt;Java\u0026lt;option/\u0026gt; \u0026lt;option value=\u0026quot;.Net\u0026quot;\u0026gt;.Net \u0026lt;option/\u0026gt; \u0026lt;/select\u0026gt; \u0026lt;s:select name=\u0026quot;map\u0026quot; list=\u0026quot;#{1:'Java',2:'.Net'3:,'Ror',4:'PHP'}\u0026quot; listKey=\u0026quot;key\u0026quot; listValue=\u0026quot;value\u0026quot; value=\u0026quot;1\u0026quot;/\u0026gt;  ç”Ÿæˆå¦‚ä¸‹htmlä»£ç ï¼š\n\u0026lt;s:select name=\u0026quot;list\u0026quot; id=\u0026quot;list\u0026quot;\u0026gt; \u0026lt;option value=\u0026quot;1\u0026quot; selected=\u0026quot;selected\u0026quot;\u0026gt;Java\u0026lt;option/\u0026gt; \u0026lt;option value=\u0026quot;2\u0026quot;\u0026gt;.Net\u0026lt;option/\u0026gt; \u0026lt;/select\u0026gt;  20ã€\u0026lt;s:token/\u0026gt;æ ‡ç­¾æ”¾ç½®é‡å¤æäº¤ \u0026lt;s:token/\u0026gt;æ ‡ç­¾æ”¾ç½®é‡å¤æäº¤ç”¨æ³•å¦‚ä¸‹ï¼š ç¬¬ä¸€æ­¥ï¼šåœ¨è¡¨å•ä¸­åŠ å…¥\u0026lt;s:token/\u0026gt;\n\u0026lt;s:form action=\u0026quot;Action_execute()\u0026quot; method=\u0026quot;post\u0026quot; \u0026gt; å§“å\u0026lt;s:textfield name=\u0026quot;name\u0026quot;/\u0026gt;\u0026lt;s:token/\u0026gt; \u0026lt;input type=\u0026quot;submit\u0026quot; value=\u0026quot;å‘é€\u0026quot;/\u0026gt; \u0026lt;/s:form\u0026gt;  ç¬¬äºŒæ­¥ï¼š\n\u0026lt;action name=\u0026quot;Action_*\u0026quot; class=\u0026quot;com.haibao.action.XMLvalidate\u0026quot; method=\u0026quot;{1}\u0026quot;\u0026gt; \u0026lt;interceptor-ref name=\u0026quot;defaultStack\u0026quot;/\u0026gt; \u0026lt;interceptor-ref name=\u0026quot;token\u0026quot;/\u0026gt; \u0026lt;result name=\u0026quot;ivalid.token\u0026quot;\u0026gt;/message.jsp\u0026lt;/result\u0026gt; \u0026lt;result name=\u0026quot;success\u0026quot;\u0026gt;/WEB-INF/page/message.jsp\u0026lt;/result\u0026gt; \u0026lt;/action\u0026gt;  ä»¥ä¸Šé…ç½®åŠ å…¥äº†â€œtokenâ€æ‹¦æˆªå™¨å’Œâ€œivalid.tokenâ€ç»“æœï¼Œå› ä¸ºâ€œtokenâ€æ‹¦æˆªå™¨åœ¨ä¼šè¯çš„tokenä¸è¯·æ±‚çš„tokenä¸ä¸€è‡´æ—¶ï¼Œå°†ä¼šç›´æ¥è¿”å›â€œivalid.tokenâ€ç»“æœ.\n","date":1611878400,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1611878400,"objectID":"97fdddcd9bf62e2f6e54ff9f344cbe06","permalink":"https://CoMath21.github.io/post/1-struts2/","publishdate":"2021-01-29T00:00:00Z","relpermalink":"/post/1-struts2/","section":"post","summary":"å…·ä½“ä»‹ç»Strust2çš„ç›¸å…³å†…å®¹.","tags":["ç¼–ç¨‹è¯­è¨€","Java","Struts2"],"title":"Struts2å­¦ä¹ ç¬”è®°","type":"post"},{"authors":["Xinæ€å¥½å…ˆç”Ÿ","CoMath"],"categories":["å­¦ä¹ ç¬”è®°","ç¼–ç¨‹è¯­è¨€"],"content":"ã€€å¯¹äºè¿™ä¸€ç»„ç”µå½±æ•°æ®ï¼Œå¦‚æœæˆ‘ä»¬æƒ³runtimeçš„åˆ†å¸ƒæƒ…å†µ.\n# coding=utf-8 import pandas as pd from matplotlib import pyplot as plt file_path = \u0026quot;./IMDB-Movie-Data.csv\u0026quot; df = pd.read_csv(file_path) # print(temp_list.tolist()) # nums = set([i for j in temp_list for i in j]) # print(len(nums)) time_list = df[\u0026quot;Runtime (Minutes)\u0026quot;].values max_time = time_list.max() min_time = time_list.min() dis = (max_time - min_time)//5 plt.figure(figsize=(20,8),dpi=80) plt.hist(time_list,dis) plt.xticks(range(min_time,max_time,5)) plt.show()  å¯¹äºè¿™ä¸€ç»„ç”µå½±æ•°æ®ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›ç»Ÿè®¡ç”µå½±åˆ†ç±»(genre)çš„æƒ…å†µï¼Œåº”è¯¥å¦‚ä½•å¤„ç†æ•°æ®ï¼Ÿ\næ€è·¯ï¼šé‡æ–°æ„é€ ä¸€ä¸ªå…¨ä¸º0çš„æ•°ç»„ï¼Œåˆ—åä¸ºåˆ†ç±»ï¼Œå¦‚æœæŸä¸€æ¡æ•°æ®ä¸­åˆ†ç±»å‡ºç°è¿‡ï¼Œå°±è®©0å˜ä¸º1.\n# coding=utf-8 import pandas as pd from matplotlib import pyplot as plt import numpy as np file_path = \u0026quot;./IMDB-Movie-Data.csv\u0026quot; # è¯»å–CSVæ–‡ä»¶ df = pd.read_csv(file_path) print(df[\u0026quot;Genre\u0026quot;].head(3)) # ç»Ÿè®¡åˆ†ç±»çš„åˆ—è¡¨ temp_list = df[\u0026quot;Genre\u0026quot;].str.split(\u0026quot;,\u0026quot;).tolist() #[[],[],[]] genre_list = list(set([i for j in temp_list for i in j])) # ç­‰ä»·äº genre_list = [] # for i in temp_genre_list: # genre_list.extend(i) # genre_list = list(set(genre_list)) # æ„é€ å…¨ä¸º0çš„æ•°ç»„ zeros_df = pd.DataFrame(np.zeros((df.shape[0],len(genre_list))),columns=genre_list) # ç»™æ¯ä¸ªç”µå½±å‡ºç°åˆ†ç±»çš„ä½ç½®èµ‹å€¼1 for i in range(df.shape[0]): #zeros_df.loc[0,[\u0026quot;Sci-fi\u0026quot;,\u0026quot;Mucical\u0026quot;]] = 1 zeros_df.loc[i,temp_list[i]] = 1 # ç»Ÿè®¡æ¯ä¸ªåˆ†ç±»çš„ç”µå½±çš„æ•°é‡å’Œ genre_count = zeros_df.sum(axis=0) # æ’åº genre_count = genre_count.sort_values() _x = genre_count.index _y = genre_count.values #ç”»å›¾ plt.figure(figsize=(20,8),dpi=80) plt.bar(range(len(_x)),_y,width=0.4,color=\u0026quot;orange\u0026quot;) plt.xticks(range(len(_x)),_x) plt.show()  æ•°æ®åˆå¹¶ä¹‹join ã€€join:é»˜è®¤æƒ…å†µä¸‹ä»–æ˜¯æŠŠè¡Œç´¢å¼•ç›¸åŒçš„æ•°æ®åˆå¹¶åˆ°ä¸€èµ·. æ•°æ®åˆå¹¶ä¹‹merge ã€€merge:æŒ‰ç…§æŒ‡å®šçš„åˆ—æŠŠæ•°æ®æŒ‰ç…§ä¸€å®šçš„æ–¹å¼åˆå¹¶åˆ°ä¸€èµ·\nmerge(left, right, how='inner', on=None, left_on=None, right_on=None, left_index=False, right_index=False, sort=False, suffixes=('_x', '_y'), copy=True, indicator=False, validate=None) import pandas as pd df1=pd.DataFrame({'key':['a','b','a','b','b'],'value1':range(5)}) df2=pd.DataFrame({'key':['a','c','c','c','c'],'value2':range(5)}) display(df1,df2,pd.merge(df1,df2))   é»˜è®¤çš„åˆå¹¶æ–¹å¼innerï¼Œäº¤é›†; merge outerï¼Œå¹¶é›†ï¼ŒNaNè¡¥å…¨; merge leftï¼Œå·¦è¾¹ä¸ºå‡†ï¼ŒNaNè¡¥å…¨; merge rightï¼Œå³è¾¹ä¸ºå‡†ï¼ŒNaNè¡¥å…¨.  åˆ†ç»„å’Œèšåˆ ã€€åœ¨pandasä¸­ç±»ä¼¼çš„åˆ†ç»„çš„æ“ä½œæœ‰å¾ˆç®€å•çš„æ–¹å¼æ¥å®Œæˆ\ngrouped = df.groupby(by=\u0026quot;columns_name\u0026quot;)  groupedæ˜¯ä¸€ä¸ªDataFrameGroupByå¯¹è±¡ï¼Œæ˜¯å¯è¿­ä»£çš„;groupedä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªå…ƒç»„ï¼Œå…ƒç»„é‡Œé¢æ˜¯ï¼ˆç´¢å¼•(åˆ†ç»„çš„å€¼)ï¼Œåˆ†ç»„ä¹‹åçš„DataFrameï¼‰.\né‚£ä¹ˆï¼Œåˆ†ç»„ä¹‹åçš„æ¯ä¸ªDataFrameçš„é•¿åº¦ï¼Ÿ é•¿åº¦æ˜¯ä¸€ä¸ªæ€è·¯ï¼Œä½†æ›´å¤šçš„æ–¹æ³•(èšåˆæ–¹æ³•)æ¥è§£å†³è¿™ä¸ªé—®é¢˜. DataFrameGroupByå¯¹è±¡æœ‰å¾ˆå¤šç»è¿‡ä¼˜åŒ–çš„æ–¹æ³•. å¦‚æœéœ€è¦å¯¹å›½å®¶å’Œçœä»½è¿›è¡Œåˆ†ç»„ç»Ÿè®¡\ngrouped = df.groupby(by=[df[\u0026quot;Country\u0026quot;],df[\u0026quot;State/Province\u0026quot;]])  å¾ˆå¤šæ—¶å€™æˆ‘ä»¬åªå¸Œæœ›å¯¹è·å–åˆ†ç»„ä¹‹åçš„æŸä¸€éƒ¨åˆ†æ•°æ®ï¼Œæˆ–è€…è¯´æˆ‘ä»¬åªå¸Œæœ›å¯¹æŸå‡ åˆ—æ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ è·å–åˆ†ç»„ä¹‹åçš„æŸä¸€éƒ¨åˆ†æ•°æ®ï¼š\ndf.groupby(by=[\u0026quot;Country\u0026quot;,\u0026quot;State/Province\u0026quot;])[\u0026quot;Country\u0026quot;].count()  å¯¹æŸå‡ åˆ—æ•°æ®è¿›è¡Œåˆ†ç»„ï¼š\ndf[\u0026quot;Country\u0026quot;].groupby(by=[df[\u0026quot;Country\u0026quot;],df[\u0026quot;State/Province\u0026quot;]]).count()  è§‚å¯Ÿç»“æœï¼Œç”±äºåªé€‰æ‹©äº†ä¸€åˆ—æ•°æ®ï¼Œæ‰€ä»¥ç»“æœæ˜¯ä¸€ä¸ªSeriesç±»å‹.\nå¦‚æœæˆ‘æƒ³è¿”å›ä¸€ä¸ªDataFrameç±»å‹å‘¢ï¼Ÿ\nt1 = df[[\u0026quot;Country\u0026quot;]].groupby(by=[df[\u0026quot;Country\u0026quot;],df[\u0026quot;State/Province\u0026quot;]]).count() t2 = df.groupby(by=[\u0026quot;Country\u0026quot;,\u0026quot;State/Province\u0026quot;])[[\u0026quot;Country\u0026quot;]].count()  ä»¥ä¸Šçš„ä¸¤æ¡å‘½ä»¤ç»“æœä¸€æ ·ï¼Œå’Œä¹‹å‰çš„ç»“æœçš„åŒºåˆ«åœ¨äºå½“å‰è¿”å›çš„æ˜¯ä¸€ä¸ªDataFrameç±»å‹.\nç´¢å¼•å’Œå¤åˆç´¢å¼• ç®€å•çš„ç´¢å¼•æ“ä½œï¼š  è·å–indexï¼šdf.index æŒ‡å®šindex ï¼šdf.index = ['x','y'] é‡æ–°è®¾ç½®index : df.reindex(list(\u0026quot;abcedf\u0026quot;)) æŒ‡å®šæŸä¸€åˆ—ä½œä¸ºindex ï¼šdf.set_index(\u0026quot;Country\u0026quot;,drop=False) è¿”å›indexçš„å”¯ä¸€å€¼ï¼šdf.set_index(\u0026quot;Country\u0026quot;).index.unique()  ã€€å‡è®¾aä¸ºä¸€ä¸ªDataFrame,é‚£ä¹ˆå½“a.set_index([\u0026quot;c\u0026quot;,\u0026quot;d\u0026quot;])å³è®¾ç½®ä¸¤ä¸ªç´¢å¼•çš„æ—¶å€™æ˜¯ä»€ä¹ˆæ ·å­çš„ç»“æœå‘¢ï¼Ÿ\na = pd.DataFrame({'a': range(7),'b': range(7, 0, -1),'c': ['one','one','one','two','two','two', 'two'],'d': list(\u0026quot;hjklmno\u0026quot;)})  Serieså¤åˆç´¢å¼• DataFrameå¤åˆç´¢å¼• ä¾‹.ç°åœ¨æœ‰2015åˆ°2017å¹´25ä¸‡æ¡911çš„ç´§æ€¥ç”µè¯çš„æ•°æ®ï¼Œè¯·ç»Ÿè®¡å‡ºå‡ºè¿™äº›æ•°æ®ä¸­ä¸åŒç±»å‹çš„ç´§æ€¥æƒ…å†µçš„æ¬¡æ•°.\nimport pandas as pd import numpy as np from matplotlib import pyplot as plt df = pd.read_csv(\u0026quot;./911.csv\u0026quot;) # print(df.info()) temp_list = df[\u0026quot;title\u0026quot;].str.split(\u0026quot;:\u0026quot;).tolist() cate_list = [i[0] for i in temp_list] cate_set_list = list(set(cate_list)) df[\u0026quot;type\u0026quot;] = pd.DataFrame(np.array(cate_list).reshape((df.shape[0],1))) # print(df.head()) cate_zeros = pd.DataFrame(np.zeros((df.shape[0],len(cate_set_list))),columns=cate_set_list) for cate in cate_set_list: cate_zeros[cate][df[\u0026quot;type\u0026quot;].str.contains(cate)] = 1 zeros_sum = cate_zeros.sum(axis=0) sum_values = zeros_sum.values plt.figure(figsize=(8, 6),dpi=80) plt.bar(cate_set_list,sum_values,color=\u0026quot;orange\u0026quot;,width=0.4) plt.show()  ç»Ÿè®¡å‡ºä¸åŒæœˆä»½ä¸åŒç±»å‹ç´§æ€¥ç”µè¯çš„æ¬¡æ•°çš„å˜åŒ–æƒ…å†µï¼Œåº”è¯¥æ€ä¹ˆåšå¯ä»¥æŒ‰ç…§ä¸Šé¢çš„æ–¹æ³•å°†æ—¶é—´æˆ³æŒ‰ç…§å³è¾¹â€œ-â€è¿›è¡Œåˆ‡å‰²ï¼Œç„¶åå°†å‰é¢çš„å­—ç¬¦ä¸²å®šä¹‰ä¸ºåŸæ•°ç»„çš„æœ€åä¸€åˆ—ï¼Œåœ¨è¿›è¡Œå…¶ä»–æ“ä½œ. ä¹Ÿå¯ä»¥ä½¿ç”¨pandasçš„æ—¶é—´åºåˆ—.\npandasä¸­çš„æ—¶é—´åºåˆ— ã€€ä¸ç®¡åœ¨ä»€ä¹ˆè¡Œä¸šï¼Œæ—¶é—´åºåˆ—éƒ½æ˜¯ä¸€ç§éå¸¸é‡è¦çš„æ•°æ®å½¢å¼ï¼Œå¾ˆå¤šç»Ÿè®¡æ•°æ®ä»¥åŠæ•°æ®çš„è§„å¾‹ä¹Ÿéƒ½å’Œæ—¶é—´åºåˆ—æœ‰ç€éå¸¸é‡è¦çš„è”ç³»,è€Œä¸”åœ¨pandasä¸­å¤„ç†æ—¶é—´åºåˆ—æ˜¯éå¸¸ç®€å•çš„ç”Ÿæˆä¸€æ®µæ—¶é—´èŒƒå›´.\npd.date_range(start=None, end=None, periods=None, freq='D')  startå’Œendä»¥åŠfreqé…åˆèƒ½å¤Ÿç”Ÿæˆstartå’ŒendèŒƒå›´å†…ä»¥é¢‘ç‡freqçš„ä¸€ç»„æ—¶é—´ç´¢å¼•. startå’Œperiodsä»¥åŠfreqé…åˆèƒ½å¤Ÿç”Ÿæˆä»startå¼€å§‹çš„é¢‘ç‡ä¸ºfreqçš„periodsä¸ªæ—¶é—´ç´¢å¼•. åœ¨DataFrameä¸­ä½¿ç”¨æ—¶é—´åºåˆ— index=pd.date_range(\u0026quot;20170101\u0026quot;,periods=10) df = pd.DataFrame(np.random.rand(10),index=index)  å›åˆ°æœ€å¼€å§‹çš„911æ•°æ®çš„æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨pandasæä¾›çš„æ–¹æ³•æŠŠæ—¶é—´å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ—¶é—´åºåˆ—.\ndf[\u0026quot;timeStamp\u0026quot;] = pd.to_datetime(df[\u0026quot;timeStamp\u0026quot;],format=\u0026quot;\u0026quot;)  formatå‚æ•°å¤§éƒ¨åˆ†æƒ…å†µä¸‹å¯ä»¥ä¸ç”¨å†™ï¼Œä½†æ˜¯å¯¹äºpandasæ— æ³•æ ¼å¼åŒ–çš„æ—¶é—´å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥å‚æ•°ï¼Œæ¯”å¦‚åŒ…å«ä¸­æ–‡.\npandasé‡é‡‡æ · ã€€é‡é‡‡æ ·ï¼šæŒ‡çš„æ˜¯å°†æ—¶é—´åºåˆ—ä»ä¸€ä¸ªé¢‘ç‡è½¬åŒ–ä¸ºå¦ä¸€ä¸ªé¢‘ç‡è¿›è¡Œå¤„ç†çš„è¿‡ç¨‹ï¼Œå°†é«˜é¢‘ç‡æ•°æ®è½¬åŒ–ä¸ºä½é¢‘ç‡æ•°æ®ä¸ºé™é‡‡æ ·ï¼Œä½é¢‘ç‡è½¬åŒ–ä¸ºé«˜é¢‘ç‡ä¸ºå‡é‡‡æ ·.pandasæä¾›äº†ä¸€ä¸ªresampleçš„æ–¹æ³•æ¥å¸®åŠ©æˆ‘ä»¬å®ç°é¢‘ç‡è½¬åŒ–. PeriodIndex ã€€ä¹‹å‰æ‰€å­¦ä¹ çš„DatetimeIndexå¯ä»¥ç†è§£ä¸ºæ—¶é—´æˆ³ï¼Œé‚£ä¹ˆç°åœ¨æˆ‘ä»¬è¦å­¦ä¹ çš„PeriodIndexå¯ä»¥ç†è§£ä¸ºæ—¶é—´æ®µï¼\nperiods = pd.PeriodIndex(year=data[\u0026quot;year\u0026quot;],month=data[\u0026quot;month\u0026quot;],day=data[\u0026quot;day\u0026quot;],hour=data[\u0026quot;hour\u0026quot;],freq=\u0026quot;H\u0026quot;)  é‚£ä¹ˆå¦‚æœç»™è¿™ä¸ªæ—¶é—´æ®µé™é‡‡æ ·å‘¢ï¼Ÿ\ndata = df.set_index(periods).resample(\u0026quot;10D\u0026quot;).mean()  ","date":1611792000,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1611792000,"objectID":"25241c6db9aa838d1b87741feaee85e3","permalink":"https://CoMath21.github.io/post/0-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%904/","publishdate":"2021-01-28T00:00:00Z","relpermalink":"/post/0-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%904/","section":"post","summary":"Pythonæ•°æ®åˆ†æä¹‹å¸¸ç”¨ç»Ÿè®¡æ–¹æ³•.","tags":["ç¼–ç¨‹è¯­è¨€","Python","æ•°æ®åˆ†æ"],"title":"Pythonæ•°æ®åˆ†æï¼ˆå››ï¼‰","type":"post"},{"authors":["Xinæ€å¥½å…ˆç”Ÿ","CoMath"],"categories":["å­¦ä¹ ç¬”è®°","ç¼–ç¨‹è¯­è¨€"],"content":"ã€€Numpyèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å¤„ç†æ•°å€¼ï¼Œpandasé™¤äº†å¤„ç†æ•°å€¼ä¹‹å¤–(åŸºäºnumpy)ï¼Œè¿˜èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å¤„ç†å…¶ä»–ç±»å‹çš„æ•°æ®.\npandasçš„å¸¸ç”¨æ•°æ®ç±»å‹ Series ä¸€ç»´ï¼Œå¸¦æ ‡ç­¾æ•°ç»„ t = pd.Series(np.arange(10),index=list(string.ascoo_uppercase[:10]))  Seriesåˆ‡ç‰‡å’Œç´¢å¼• Seriesçš„ç´¢å¼•å’Œå€¼ å¯¹äºä¸€ä¸ªé™Œç”Ÿçš„seriesç±»å‹ï¼Œå¯ä»¥é€šè¿‡t.indexè·å–å…¶ç´¢å¼•å€¼ pandasè¯»å–å¤–éƒ¨æ•°æ®ï¼š  ç›´æ¥ä½¿ç”¨pd. read_csv()å³å¯. å¦‚æœå¾…æ•°æ®çš„æ•°æ®æ²¡æœ‰åˆ—åï¼Œåˆ™éœ€è¦è¡¥å……ï¼Œå³åœ¨è¯»å–æ–‡ä»¶æ—¶ç»™å®šå‚æ•°namesçš„å€¼.  pd.read_csv(â€œâ€™â€™,names=column_names)   column_namesï¼šæŒ‡å®šç±»åˆ«åå­—,[\u0026lsquo;Sample code number\u0026rsquo;,\u0026lsquo;Clump Thickness\u0026rsquo;, \u0026lsquo;Uniformity of Cell Size\u0026rsquo;,\u0026lsquo;Uniformity of Cell Shape\u0026rsquo;,\u0026lsquo;Marginal Adhesion\u0026rsquo;, \u0026lsquo;Single Epithelial Cell Size\u0026rsquo;,\u0026lsquo;Bare Nuclei\u0026rsquo;,\u0026lsquo;Bland Chromatin\u0026rsquo;,\u0026lsquo;Normal Nucleoli\u0026rsquo;,\u0026lsquo;Mitoses\u0026rsquo;,\u0026lsquo;Class\u0026rsquo;] return:æ•°æ®. replace(to_replace=â€™â€™,value=)ï¼šè¿”å›æ•°æ®. dropna():è¿”å›æ•°æ®. æ³¨ï¼šè¯»å–æ–‡ä»¶åªè¦æ˜¯.CSVæ–‡ä»¶å°±å¯ä»¥ä½¿ç”¨load_csv()æ–¹æ³•ï¼Œå³ä½¿æ–‡ä»¶åœ°å€æ˜¯ç½‘ç«™.  DataFrame äºŒç»´ï¼ŒSerieså®¹å™¨ DataFrameå¯¹è±¡æ—¢æœ‰è¡Œç´¢å¼•ï¼Œåˆæœ‰åˆ—ç´¢å¼• è¡Œç´¢å¼•ï¼Œè¡¨æ˜ä¸åŒè¡Œï¼Œæ¨ªå‘ç´¢å¼•ï¼Œå«indexï¼Œ0è½´ï¼Œaxis=0ï¼› åˆ—ç´¢å¼•ï¼Œè¡¨åä¸åŒåˆ—ï¼Œçºµå‘ç´¢å¼•ï¼Œå«columnsï¼Œ1è½´ï¼Œaxis=1ï¼ å’Œä¸€ä¸ªndarrayä¸€æ ·ï¼Œé€šè¿‡ndimï¼Œshapeï¼Œdtypeäº†è§£è¿™ä¸ªndarrayçš„åŸºæœ¬ä¿¡æ¯ï¼ è·å¾—ä½¿ç”¨æ¬¡æ•°æœ€é«˜çš„å‰å‡ ä¸ªåå­—æ˜¯ä»€ä¹ˆï¼Ÿ\nimport pandas as pd df = pd.read_csv(\u0026quot;./dogNames.csv\u0026quot;) # print(df.head()) # print(df.info()) # dataFrame ä¸­æ’åºçš„æ–¹æ³• df = df.sort_values(\u0026quot;Count_AnimalName\u0026quot;,ascending=False) print(df.head())  def sort_values(self, by, axis=0, ascending=True, inplace=False, kind='quicksort', na_position='last') # ascendingï¼šå‡åºï¼šTrue\t# é™åºï¼šFalse  é—®é¢˜ï¼šæ•°æ®æœ‰10åˆ—ï¼Œæˆ‘æƒ³æŒ‰ç…§å…¶ä¸­çš„ç¬¬1ï¼Œç¬¬3ï¼Œç¬¬8åˆ—æ’åºï¼Ÿ\n# pandaså–è¡Œæˆ–è€…åˆ—çš„æ³¨æ„ç‚¹ # - æ–¹æ‹¬å·å†™æ•°ç»„,è¡¨ç¤ºå–è¡Œ,å¯¹è¡Œè¿›è¡Œæ“ä½œ # - å†™å­—ç¬¦ä¸²,è¡¨ç¤ºçš„å»åˆ—ç´¢å¼•,å¯¹åˆ—è¿›è¡Œæ“ä½œ print(df[:20]) print(df[\u0026quot;Row_Labels\u0026quot;]) print(type(df[\u0026quot;Row_Labels\u0026quot;]))  è¿˜æœ‰æ›´å¤šçš„ç»è¿‡pandasä¼˜åŒ–è¿‡çš„é€‰æ‹©æ–¹å¼ï¼š\n df.loc é€šè¿‡æ ‡ç­¾ç´¢å¼•è¡Œæ•°æ®ï¼ˆè¡Œåˆ—çš„åå­—ï¼‰  df.loc[â€œaâ€,â€wâ€] # aè¡Œwåˆ— df.loc[â€œaâ€,:] # aè¡Œ df.loc[:,â€wâ€] # wåˆ— df.loc[[â€œaâ€,â€câ€],:] # aï¼Œcè¡Œ df.loc[:,[â€œwâ€,â€zâ€]] # wï¼Œzåˆ— df.loc[[â€œaâ€,â€câ€ ,[â€œwâ€,â€zâ€]] # a,cè¡Œï¼Œw,zåˆ— df.loc[[â€œaâ€:â€câ€ ,[â€œwâ€,â€zâ€]] # aåˆ°cè¡Œï¼Œw,zåˆ—  df.iloc é€šè¿‡ä½ç½®è·å–è¡Œæ•°æ®ï¼ˆè¡Œåˆ—å·-1ï¼‰  df.iloc[1,:] # ç¬¬äºŒè¡Œ df.iloc[:,2] # ç¬¬ä¸‰åˆ— df.iloc[:,[2,1]] # ç¬¬ä¸‰åˆ—ç¬¬äºŒåˆ— df.iloc[[0,2], [2,1]]\t# ç¬¬1,3è¡Œ, ç¬¬3,2åˆ—  èµ‹å€¼æ›´æ”¹æ•°æ®çš„è¿‡ç¨‹ï¼š å¸ƒå°”ç´¢å¼• ã€€æ‰¾åˆ°æ‰€æœ‰çš„ä½¿ç”¨æ¬¡æ•°è¶…è¿‡800çš„ç‹—çš„åå­—. æ‰¾åˆ°æ‰€æœ‰çš„ä½¿ç”¨æ¬¡æ•°è¶…è¿‡700å¹¶ä¸”åå­—çš„å­—ç¬¦ä¸²çš„é•¿åº¦å¤§äº4çš„ç‹—çš„åå­— å­—ç¬¦ä¸²æ–¹æ³• Pandasç¼ºå¤±æ•°æ®çš„å¤„ç† æ•°æ®ç¼ºå¤±é€šå¸¸æœ‰ä¸¤ç§æƒ…å†µï¼š ã€€ä¸€ç§å°±æ˜¯ç©ºï¼ŒNoneç­‰ï¼Œåœ¨pandasæ˜¯NaN(å’Œnp.nanä¸€æ ·);å¦ä¸€ç§æ˜¯æˆ‘ä»¬è®©å…¶ä¸º0ï¼Œè“è‰²æ¡†ä¸­å¯¹äºNaNçš„æ•°æ®ï¼Œåœ¨numpyä¸­æˆ‘ä»¬æ˜¯å¦‚ä½•å¤„ç†çš„ï¼Ÿ\nã€€åœ¨pandasä¸­æˆ‘ä»¬å¤„ç†èµ·æ¥éå¸¸å®¹æ˜“.\nåˆ¤æ–­æ•°æ®æ˜¯å¦ä¸ºNaNï¼špd.isnull(df),pd.notnull(df)\n å¤„ç†æ–¹å¼1ï¼šåˆ é™¤NaNæ‰€åœ¨çš„è¡Œåˆ—dropna (axis=0, how=\u0026lsquo;any\u0026rsquo;, inplace=False)# æ˜¯å¦åŸåœ°ä¿®æ”¹ å¤„ç†æ–¹å¼2ï¼šå¡«å……æ•°æ®ï¼Œt.fillna(t.mean()),t.fiallna(t.median()),t.fillna(0) å¤„ç†ä¸º0çš„æ•°æ®ï¼št[t==0]=np.nan  å½“ç„¶å¹¶ä¸æ˜¯æ¯æ¬¡ä¸º0çš„æ•°æ®éƒ½éœ€è¦å¤„ç†è®¡ç®—å¹³å‡å€¼ç­‰æƒ…å†µï¼Œnanæ˜¯ä¸å‚ä¸è®¡ç®—çš„ï¼Œä½†0ä¼š.\næ•°æ®å˜å½¢ï¼š  å¤„ç†é‡å¤æ•°æ®  åˆ¤æ–­æ•°æ®æ˜¯å¦é‡å¤ï¼Œduplicated() å»é™¤é‡å¤æ•°æ®ï¼Œdrop_dumplicates()ï¼Œå¯æŒ‡å®šåˆ—åŠå¦‚ä½•ä¿ç•™æ•°æ®   ä½¿ç”¨å‡½æ•°æˆ–mapè½¬åŒ–æ•°æ®ï¼Œé€šå¸¸æ ¹æ®å­—å…¸è¿›è¡Œæ•°æ®è½¬åŒ–  data = pd.DataFrame({'food': ['bacon', 'pulled pork', 'bacon', 'Pastrami', 'corned beef', 'Bacon', 'pastrami', 'honey ham', 'nova lox'], 'ounces': [4, 3, 12, 6, 7.5, 8, 3, 5, 6]})  # æ·»åŠ ä¸€åˆ—ï¼Œç”¨äºæŒ‡å®šé£Ÿç‰©çš„æ¥æº meat_to_animal = { 'bacon': 'pig', 'pulled pork': 'pig', 'pastrami': 'cow', 'corned beef': 'cow', 'honey ham': 'pig', 'nova lox': 'salmon' } # ä½¿ç”¨map() lowercased = data['food'].str.lower() data['animal'] = lowercased.map(meat_to_animal)   æ›¿æ¢å€¼ï¼Œreplace() ç¦»æ•£åŒ–å’Œåˆ†äº«æ“ä½œï¼Œpd.cut()ï¼Œè¿”å›Categoricalå¯¹è±¡  å“‘å˜é‡æ“ä½œï¼Œpd.get_dummies() å‘é‡åŒ–å­—ç¬¦ä¸²æ“ä½œ  å­—ç¬¦ä¸²åˆ—è¶Šè‹ä¸­æ˜¯å¦åŒ…å«å­å­—ç¬¦ä¸²ï¼Œser_obj.str.contains() å­—ç¬¦ä¸²åˆ—åˆ‡ç‰‡æ“ä½œï¼Œser_obj.str[a:b]    ","date":1611705600,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1611705600,"objectID":"160ed39b47e3b45a7d11a8d243db6c3c","permalink":"https://CoMath21.github.io/post/0-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%903/","publishdate":"2021-01-27T00:00:00Z","relpermalink":"/post/0-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%903/","section":"post","summary":"Pythonæ•°æ®åˆ†æä¹‹Pandas.","tags":["ç¼–ç¨‹è¯­è¨€","Python","æ•°æ®åˆ†æ","Pandas"],"title":"Pythonæ•°æ®åˆ†æï¼ˆä¸‰ï¼‰","type":"post"},{"authors":["Xinæ€å¥½å…ˆç”Ÿ","CoMath"],"categories":["å­¦ä¹ ç¬”è®°","ç¼–ç¨‹è¯­è¨€"],"content":"Numpy ã€€Numpyæ˜¯ä¸€ä¸ªåœ¨Pythonä¸­åšç§‘å­¦è®¡ç®—çš„åŸºç¡€åº“ï¼Œé‡åœ¨æ•°å€¼è®¡ç®—ï¼Œä¹Ÿæ˜¯å¤§éƒ¨åˆ†PYTHONç§‘å­¦è®¡ç®—åº“çš„åŸºç¡€åº“ï¼Œå¤šç”¨äºåœ¨å¤§å‹ã€å¤šç»´æ•°ç»„ä¸Šæ‰§è¡Œæ•°å€¼è¿ç®—.\nNumpyç®€å•åˆ›å»ºæ•°ç»„ import numpy as np # åˆ›å»ºç®€å•çš„åˆ—è¡¨ a = [1, 2, 3, 4]\tæ­¤å¤„è¾“å‡ºaçš„è¯æ˜¯[1,2,3,4] # å°†åˆ—è¡¨è½¬æ¢ä¸ºæ•°ç»„ b = np.array(a)\tæ­¤å¤„bè¾“å‡ºçš„è¯æ˜¯[1 2 3 4] np.array(a) = np.array(range(1,4)) = np.arange(1,4) np,arrange([start, ] stop[, step,], ftype=None) # å»å°æ•° np.round(x,ä¿ç•™ä½æ•°)  NumpyæŸ¥çœ‹æ•°ç»„å±æ€§ æ•°ç»„å…ƒç´ ä¸ªæ•°ï¼šb.size\næ•°ç»„å½¢çŠ¶ï¼šb.shape\nä¸€ç»´ï¼šåˆ—æ•°(8,)ï¼›äºŒç»´ï¼šè¡Œåˆ—(2, 4)ï¼›ä¸‰ç»´ï¼šå—è¡Œåˆ—(2, 2, 4)\né‡å¡‘reshapeï¼šæ•°ç»„ä¸€ä¸ªæ–°çš„å½¢çŠ¶è€Œä¸æ”¹å˜å…¶æ•°æ®.\n# å…·æœ‰è¿”å›å€¼çš„ï¼Œä¸ä¼šæ”¹å˜åŸæ•°ç»„ numpy.reshape(a, newshape, order='C')\torder : {â€˜Câ€™, â€˜Fâ€™, â€˜Aâ€™} # C:æ¨ªç€è¯»æ¨ªç€å†™; E:ç«–ç€çš„ç«–ç€å†™; A:ç«–ç€åº¦æ¨ªç€å†™  ä¾‹.\na = np.array([[1,2,3], [4,5,6]]) print(a) [[1 2 3] [4 5 6]] print(np.reshape(a, (3,2))) [[1 2] [3 4] [5 6]]  æ•°ç»„ç»´åº¦ï¼šb.ndim\næ•°ç»„å…ƒç´ ç±»å‹ï¼šb.dtype\nå¿«é€Ÿåˆ›å»ºNç»´æ•°ç»„çš„apiå‡½æ•°\n#åˆ›å»º10è¡Œ10åˆ—çš„æ•°å€¼ä¸ºæµ®ç‚¹1çš„çŸ©é˜µ array_one = np.ones([10, 10]) #åˆ›å»º10è¡Œ10åˆ—çš„æ•°å€¼ä¸ºæµ®ç‚¹0çš„çŸ©é˜µ array_zero = np.zeros([10, 10]) #é™åˆ°ä¸€ç»´ï¼š b.flatten(order='C') # æŠŠaé™åˆ°ä¸€ç»´ï¼Œé»˜è®¤æ˜¯æŒ‰æ¨ªçš„æ–¹å‘é™order:{â€˜Câ€™, â€˜Fâ€™,â€˜Aâ€™,â€˜Kâ€™} b.flatten('F') # æŒ‰ç«–çš„æ–¹å‘é™  è½´(axis) ã€€åœ¨numpyä¸­å¯ä»¥ç†è§£ä¸ºæ–¹å‘,ä½¿ç”¨0,1,2\u0026hellip;æ•°å­—è¡¨ç¤º,å¯¹äºä¸€ä¸ªä¸€ç»´æ•°ç»„,åªæœ‰ä¸€ä¸ª0è½´,å¯¹äº2ç»´æ•°ç»„(shape(2,2)),æœ‰0è½´å’Œ1è½´,å¯¹äºä¸‰ç»´æ•°ç»„(shape(2,2, 3)),æœ‰0,1,2è½´. Numpyè¯»å–æ•°æ® ï¼ˆä»¥åç»“åˆæ¡†æ¶ä¹‹ç±»çš„è¯»å–æ–‡ä»¶å¤§å¤šæ•°æ˜¯ä»CSVæ–‡ä»¶ä¸­è¯»å–ï¼‰\nã€€CSVï¼ˆComma-Separated Value,é€—å·åˆ†éš”å€¼æ–‡ä»¶ï¼‰ï¼šç”±äºcsvä¾¿äºå±•ç¤º,è¯»å–å’Œå†™å…¥,æ‰€ä»¥å¾ˆå¤šåœ°æ–¹ä¹Ÿæ˜¯ç”¨csvçš„æ ¼å¼å­˜å‚¨å’Œä¼ è¾“ä¸­å°å‹çš„æ•°æ®,ä¸ºäº†æ–¹ä¾¿æ•™å­¦,æˆ‘ä»¬ä¼šç»å¸¸æ“ä½œcsvæ ¼å¼çš„æ–‡ä»¶,ä½†æ˜¯æ“ä½œæ•°æ®åº“ä¸­çš„æ•°æ®ä¹Ÿæ˜¯å¾ˆå®¹æ˜“çš„å®ç°çš„.\næ–¹æ³•\nnp.loadtxt(fname,dtype=np.float,delimiter=None,skiprows=0,usecols=None,unpack=False)  æ³¨æ„ å…¶ä¸­æ·»åŠ çš„delimiterå’Œdtypeä»¥åŠunpackæ•ˆæœ.\n delimiterï¼šæŒ‡å®šè¾¹ç•Œç¬¦å·æ˜¯ä»€ä¹ˆï¼Œä¸æŒ‡å®šä¼šå¯¼è‡´æ¯è¡Œæ•°æ®ä¸ºä¸€ä¸ªæ•´ä½“æ³•äººå­—ç¬¦ä¸²è€ŒæŠ¥é”™ dtypeï¼šé»˜è®¤æƒ…å†µä¸‹å¯¹äºè¾ƒå¤§çš„æ•°æ®å°†å˜ä¸ºç§‘å­¦è®¡æ•°æ³•çš„æ–¹å¼ upackï¼šé»˜è®¤å€¼æ˜¯False(0)ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæœ‰å¤šå°‘æ¡æ•°æ®å°±ä¼šæœ‰å¤šå°‘è¡Œï¼›ä¸ºTrue(1)çš„æƒ…å†µä¸‹ï¼Œæ¯ä¸€åˆ—çš„æ•°æ®ä¼šç»„æˆä¸€è¡Œï¼Œè¢æœ¯æ•°æ®æœ‰å¤šå°‘åˆ—ï¼ŒåŠ è½½å‡ºæ¥å°±ä¼šæœ‰å¤šå°‘è¡Œï¼Œç›¸å½“äºè½¬ç½®çš„æ•ˆæœ. å…¶ä»–è½¬ç½®æ–¹æ³•ï¼št.transpose()\tt.T\tt.swapaxes(1,0) # 1è½´å’Œ1è½´äº’æ¢.  Numpyç´¢å¼•å’Œåˆ‡ç‰‡ # å–è¡Œï¼š T[è¡Œ] # å–è¿ç»­çš„å¤šè¡Œï¼š T [2:] # å–ä¸è¿ç»­çš„å¤šè¡Œï¼š T [ [2,8,10] ] = T [[2,10,3],:] å–ç¬¬2è¡Œï¼šT [1,:] å–ç¬¬ä¸‰è¡Œä»¥åæ‰€æœ‰è¡Œï¼šT [2:,:] #å–åˆ—ï¼š T [:,0] #å–è¿ç»­çš„å¤šåˆ—ï¼š T [:, 2 :] #å–ä¸è¿ç»­çš„å¤šåˆ—ï¼š T [:,[ 0,2]] #å»è¡Œå’Œåˆ—ï¼Œå–ç¬¬3è¡Œï¼Œç¬¬å››åˆ—çš„å€¼ï¼š a = T [ 2, 3] print(type(a))\t# int #å–å¤šè¡Œå’Œå¤šåˆ—ï¼Œå–ç¬¬3è¡Œåˆ°ç¬¬äº”è¡Œï¼Œç¬¬2åˆ—åˆ°ç¬¬4åˆ—çš„ç»“æœ #å»çš„æ˜¯è¡Œå’Œåˆ—äº¤å‰ç‚¹çš„ä½ç½® b = T [2:5,1:4] #å–å¤šä¸ªä¸ç›¸é‚»çš„ç‚¹--é€‰å‡ºæ¥çš„ç»“æœæ˜¯ï¼ˆ0ï¼Œ0ï¼‰ ï¼ˆ2ï¼Œ1ï¼‰ ï¼ˆ2ï¼Œ3ï¼‰ c = T [[0,2,2],[0,1,3]]  Numpyä¸­å¸ƒå°”ç´¢å¼• # numpyä¸­ä¸‰å…ƒè¿ç®—ç¬¦ np.where(condition, if True, if False)  Numpyä¸­çš„clip(è£å‰ª) numpy.clip(a, a_min, a_max, out=None)  [a_min, a_max] é‡Œé¢çš„æ•°è¢«ä¿ç•™ä¸‹æ¥,å¤–é¢çš„è¢«æˆªå–ä¸ºa_minæˆ–è€…a_max .\noutï¼šå¯ä»¥æŠŠç»“æœæ”¾ç½®åœ¨æ­¤æ•°ç»„ä¸­.\nä¾‹å¦‚ï¼ŒæŒ‡å®šé—´éš”ä¸º[0ï¼Œ1]ï¼Œåˆ™å°äº0çš„å€¼èµ‹å€¼ä¸º0ï¼Œå¹¶ä¸”å¤§äº1çš„å€¼èµ‹å€¼ä¸º1.\nè¡¥å……ï¼šintç±»å‹çš„æƒ…å†µä¸‹æ— æ³•èµ‹å€¼ä¸ºnanï¼Œæ‰€ä»¥éœ€è¦å°†ç±»å‹æ”¹ä¸ºfloat.\nt.astype(float) t[x,y]=np.nan  æ•°ç»„çš„æ‹¼æ¥ï¼š np.vstack((t1,t2))\t# ç«–ç›´æ‹¼æ¥ np.hstack((t1,t2))\t# æ°´å¹³æ‹¼æ¥  æ•°ç»„çš„è¡Œåˆ—äº¤æ¢ Numpyæ›´å¤šå¥½ç”¨çš„æ–¹æ³•  è·å–æœ€å¤§å€¼æœ€å°å€¼çš„ä½ç½® np.argmax(t,axis=0) np.argmin(t,axis=1) åˆ›å»ºä¸€ä¸ªå…¨0çš„æ•°ç»„: np.zeros((3,4)) åˆ›å»ºä¸€ä¸ªå…¨1çš„æ•°ç»„:np.ones((3,4)) åˆ›å»ºä¸€ä¸ªå¯¹è§’çº¿ä¸º1çš„æ­£æ–¹å½¢æ•°ç»„(æ–¹é˜µ)ï¼šnp.eye(3)  Numpyç”Ÿæˆéšæœºæ•° Numpyä¸­çš„æ³¨æ„ç‚¹copyå’Œview  a=b å®Œå…¨ä¸å¤åˆ¶ï¼Œaå’Œbç›¸äº’å½±å“ a = b[:],è§†å›¾çš„æ“ä½œï¼Œä¸€ç§åˆ‡ç‰‡ï¼Œä¼šåˆ›å»ºæ–°çš„å¯¹è±¡aï¼Œä½†æ˜¯açš„æ•°æ®å®Œå…¨ç”±bä¿ç®¡ï¼Œä»–ä»¬ä¸¤ä¸ªçš„æ•°æ®å˜åŒ–æ˜¯ä¸€è‡´çš„ï¼Œ a = b.copy(),å¤åˆ¶ï¼Œaå’Œbäº’ä¸å½±å“  Numpyä¸­çš„nanå’Œinfï¼ˆéƒ½æ˜¯floatç±»å‹ï¼‰ nan(NAN,Nan):not a numberè¡¨ç¤ºä¸æ˜¯ä¸€ä¸ªæ•°å­—.\nä»€ä¹ˆæ—¶å€™numpyä¸­ä¼šå‡ºç°nan\nå½“æˆ‘ä»¬è¯»å–æœ¬åœ°çš„æ–‡ä»¶ä¸ºfloatçš„æ—¶å€™ï¼Œå¦‚æœæœ‰ç¼ºå¤±ï¼Œå°±ä¼šå‡ºç°nanï¼ ã€€å½“åšäº†ä¸€ä¸ªä¸åˆé€‚çš„è®¡ç®—çš„æ—¶å€™(æ¯”å¦‚æ— ç©·å¤§(inf)å‡å»æ— ç©·å¤§)ï¼\ninf(-inf,inf):infinity,infè¡¨ç¤ºæ­£æ— ç©·ï¼Œ-infè¡¨ç¤ºè´Ÿæ— ç©·\nä»€ä¹ˆæ—¶å€™å›å‡ºç°infåŒ…æ‹¬ï¼ˆ-infï¼Œ+infï¼‰\næ¯”å¦‚ä¸€ä¸ªæ•°å­—é™¤ä»¥0ï¼Œï¼ˆpythonä¸­ç›´æ¥ä¼šæŠ¥é”™ï¼Œnumpyä¸­æ˜¯ä¸€ä¸ªinfæˆ–è€…-infï¼‰ Numpyä¸­çš„nançš„æ³¨æ„ç‚¹ t.sum(axis=None) #æ±‚å’Œ t.mean(a,axis=None) # å‡å€¼ å—ç¦»ç¾¤ç‚¹çš„å½±å“è¾ƒå¤§ np.median(t,axis=None) # ä¸­å€¼ï¼š t.max(axis=None) # æœ€å¤§å€¼ï¼š t.min(axis=None) # æœ€å°å€¼ï¼š np.ptp(t,axis=None) # æå€¼ å³æœ€å¤§å€¼å’Œæœ€å°å€¼åªå·® t.std(axis=None) # æ ‡å‡†å·®  ndarryç¼ºå¤±å€¼å¡«å……å‡å€¼ tä¸­å­˜åœ¨nanå€¼ï¼Œå¦‚ä½•æ“ä½œæŠŠå…¶ä¸­çš„nanå¡«å……ä¸ºæ¯ä¸€åˆ—çš„å‡å€¼\nt = array([[ 0., 1., 2., 3., 4., 5.], [ 6., 7., nan, 9., 10., 11.], [ 12., 13., 14., nan, 16., 17.], [ 18., 19., 20., 21., 22., 23.]]) def fill_ndarray(t1): #éå†æ¯ä¸€åˆ— for i in range(t1.shape[1]): temp_col = t1[:,i] #å½“å‰çš„ä¸€åˆ— nan_num = np.count_nonzero(temp_col!=temp_col) if nan_num != 0: #ä¸ä¸º0ï¼Œè¯´æ˜å½“å‰è¿™ä¸€åˆ—ä¸­æœ‰nan temp_not_nan_col = temp_col[temp_col==temp_col] #å½“å‰ä¸€åˆ—ä¸ä¸ºnançš„array # é€‰ä¸­å½“å‰ä¸ºnançš„ä½ç½®ï¼ŒæŠŠå€¼èµ‹å€¼ä¸ºä¸ä¸ºnançš„å‡å€¼ temp_col[np.isnan(temp_col)] = temp_not_nan_col.mean() return t1 if __name__ == '__main__': t1 = np.arange(12).reshape((4, 3)).astype(\u0026quot;float\u0026quot;) t1[1, 1:] = np.nan print(t1) t1 = fill_ndarray(t1) print(t1)  è¾“å‡ºç»“æœ\n[[ 0. 1. 2.]\t[[ 0. 1. 2.] [ 3. nan nan]\t[ 3. 6. 7.] [ 6. 7. 8.]\t[ 6. 7. 8.] [ 9. 10. 11.]]\t[ 9. 10. 11.]]  ","date":1611532800,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1611532800,"objectID":"366acf95216fb391a3aaa0d6d31f7922","permalink":"https://CoMath21.github.io/post/0-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%902/","publishdate":"2021-01-25T00:00:00Z","relpermalink":"/post/0-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%902/","section":"post","summary":"Pythonæ•°æ®åˆ†æä¹‹Numpy.","tags":["ç¼–ç¨‹è¯­è¨€","Python","æ•°æ®åˆ†æ","Numpy"],"title":"Pythonæ•°æ®åˆ†æï¼ˆäºŒï¼‰","type":"post"},{"authors":["Xinæ€å¥½å…ˆç”Ÿ","CoMath"],"categories":["å­¦ä¹ ç¬”è®°","ç¼–ç¨‹è¯­è¨€"],"content":"å‡†å¤‡å·¥ä½œ ç¯å¢ƒå®‰è£…ï¼ˆä¸æ˜¯å¿…è¦ï¼Œåªæ˜¯ä¸ºäº†èƒ½å¤Ÿæ›´å¥½çš„æ“ä½œåŠç»´æŠ¤ï¼‰ CONDAï¼š condaç±»ä¼¼äºnpmæˆ–mavençš„åŒ…ç®¡ç†å·¥å…·ï¼Œåªæ˜¯condaæ˜¯é’ˆå¯¹äºpythonçš„. å¯ä»¥å®‰è£…mincondaæˆ–anacondaè¿›è¡Œå®‰è£…ï¼›Condaæ˜¯ä¸€ä¸ªåŒ…ç®¡ç†å™¨ï¼›Anacondaæ˜¯ä¸€ä¸ªå‘è¡ŒåŒ….è™½ç„¶Condaä¸Anacondaä¸€èµ·åŒ…è£…ï¼Œä½†ä¸¤è€…æ˜¯å…·æœ‰ä¸åŒç›®æ ‡çš„ä¸åŒå®ä½“. CONDAå®‰è£…ï¼ˆä»¥Win64ä¸ºä¾‹ï¼‰: å¯ä»¥åˆ°å®˜ç½‘ï¼›ä¹Ÿå¯ä»¥åˆ°å›½å†…æ¸…åé•œåƒæºè¿›è¡Œä¸‹è½½é•œåƒæ–‡ä»¶ï¼š å®‰è£… ï¼š æ‰“å¼€å®‰è£…åŒ…ï¼Œä¸€è·¯next å³å¯. æ³¨æ„ï¼Œå‹¾é€‰ æ·»åŠ ç¯å¢ƒå˜é‡ å’Œ é»˜è®¤python3.6 ä½œä¸ºAnacondaçš„è¯­è¨€. å®‰è£…æˆåŠŸåæ‰“å¼€cmdå‘½ä»¤è¾“å…¥\u0026quot;python\u0026quot;æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯. æŸ¥çœ‹å½“å‰æœ‰å“ªäº›å¯ä»¥ä½¿ç”¨çš„pythonç‰ˆæœ¬ï¼šconda search \u0026ndash;full -name python å®‰è£…pythonç‰ˆæœ¬ï¼ˆå®‰è£…çš„3.6çš„ç‰ˆæœ¬ï¼‰ï¼šconda create \u0026ndash;name tensorflow python=3.6\nJupyter notebook jupyter notebook:ä¸€æ¬¾ç¼–ç¨‹/æ–‡æ¡£/ç¬”è®°/å±•ç¤ºè½¯ä»¶. å¯åŠ¨å‘½ä»¤:jupyter notebook ï¼ˆå·²ç»å®‰è£…Anaconda/åœ¨condaç¯å¢ƒä¸‹ï¼‰ Jupyter notebookå¥½å¤„  æå…¶é€‚åˆæ•°æ®åˆ†æ æ”¯æŒå¤šè¯­è¨€ åˆ†äº«ä¾¿æ·ï¼šæ”¯æŒä»¥ç½‘é¡µçš„å½¢å¼åˆ†äº«ï¼ŒGitHub ä¸­å¤©ç„¶æ”¯æŒ Notebook å±•ç¤ºï¼Œä¹Ÿå¯ä»¥é€šè¿‡ nbviewer åˆ†äº«ä½ çš„æ–‡æ¡£. å½“ç„¶ä¹Ÿæ”¯æŒå¯¼å‡ºæˆ HTMLã€PDFã€Markdownç­‰å¤šç§æ ¼å¼çš„æ–‡æ¡£. è¿œç¨‹è¿è¡Œï¼šåœ¨ä»»ä½•åœ°ç‚¹éƒ½å¯ä»¥é€šè¿‡ç½‘ç»œé“¾æ¥è¿œç¨‹æœåŠ¡å™¨æ¥å®ç°è¿ç®—. äº¤äº’å¼å±•ç°ï¼šä¸ä»…å¯ä»¥è¾“å‡ºå›¾ç‰‡ã€è§†é¢‘ã€æ•°å­¦å…¬å¼ï¼Œç”šè‡³å¯ä»¥å‘ˆç°ä¸€äº›äº’åŠ¨çš„å¯è§†åŒ–å†…å®¹ï¼Œæ¯”å¦‚å¯ä»¥ç¼©æ”¾çš„åœ°å›¾æˆ–è€…æ˜¯å¯ä»¥æ—‹è½¬çš„ä¸‰ç»´æ¨¡å‹. è¿™å°±éœ€è¦äº¤äº’å¼æ’ä»¶ï¼ˆInteractive widgetsï¼‰æ¥æ”¯æŒ.  åŸºç¡€çŸ¥è¯† matplotlib æœ€æµè¡Œçš„Pythonåº•å±‚ç»˜å›¾åº“ï¼Œä¸»è¦åšæ•°æ®å¯è§†åŒ–å›¾è¡¨,åå­—å–æäºMATLABï¼Œæ¨¡ä»¿MATLABæ„å»ºï¼›èƒ½å°†æ•°æ®è¿›è¡Œå¯è§†åŒ–,æ›´ç›´è§‚çš„å‘ˆç°ã€ä½¿æ•°æ®æ›´åŠ å®¢è§‚ã€æ›´å…·è¯´æœåŠ› matplotlibä½¿ç”¨æµç¨‹ï¼š\n æ˜ç¡®é—®é¢˜ é€‰æ‹©å›¾å½¢çš„å‘ˆç°æ–¹å¼ å‡†å¤‡æ•°æ® ç»˜å›¾å’Œå›¾å½¢å®Œå–„  ä¾‹. å‡è®¾ä¸€å¤©ä¸­æ¯éš”ä¸¤ä¸ªå°æ—¶(range(2,26,2))çš„æ°”æ¸©(â„ƒ)åˆ†åˆ«æ˜¯[15, 13, 14.5, 17, 20, 25, 26, 26, 27, 22, 18, 15].\nè®¾ç½®å›¾ç‰‡å¤§å° fig = plt.figure(figsize=(10,6),dpi=80)  figureå›¾å½¢å›¾æ ‡çš„æ„æ€ï¼Œåœ¨è¿™é‡ŒæŒ‡çš„æ˜¯ç”»çš„å›¾ï¼›é€šè¿‡å®ä¾‹åŒ–ä¸€ä¸ªfigureå¹¶ä¼ é€’å‚æ•°ï¼Œèƒ½å¤Ÿåœ¨åå°è‡ªåŠ¨ä½¿ç”¨è¯¥figureå®ä¾‹ï¼›åœ¨å›¾åƒæ¨¡ç³Šçš„æ—¶å€™å¯ä»¥ä¼ å…¥dpiå‚æ•°ï¼ˆæ¯è‹±å¯¸ä¸Šåƒç´ ç‚¹çš„ä¸ªæ•°ï¼‰\nä¿å­˜åˆ°æœ¬åœ° ã€€ä¿å­˜éœ€è¦åœ¨ç»˜åˆ¶å›¾å½¢ä¹‹åä¿å­˜\nplt.show(\u0026quot;è·¯å¾„/åå­—.png\u0026quot;)  ä¹Ÿå¯ä»¥ä¿å­˜ä¸ºSVGè¿™ç§çŸ¢é‡å›¾çš„æ ¼å¼\næè¿°ä¿¡æ¯,æ¯”å¦‚xè½´å’Œyè½´è¡¨ç¤ºä»€ä¹ˆ,è¿™ä¸ªå›¾è¡¨ç¤ºä»€ä¹ˆ  plt.xlabel(\u0026quot;Xè½´\u0026quot;) plt.ylabel(\u0026quot;Yè½´\u0026quot;) plt.title(\u0026quot;Title\u0026quot;) # å­˜åœ¨ä¸­æ–‡ä¹±ç é—®é¢˜  è°ƒæ•´xæˆ–è€…yçš„åˆ»åº¦çš„é—´è·  è®¾ç½®xè½´çš„åˆ»åº¦ï¼ˆä¸€ä¸ªå‚æ•°ï¼‰  plt.xticks(x)  æƒ³è¦å¯†é›†ç‚¹å¯ä»¥è®¾ç½®ï¼š\n_xticks = [i/2 for I in range(4,49)] plt.xticks(_xticks) # æ˜¾å¾—è¿‡äºå¯†é›† plt.xticks(_xticks[::3]) # æ¯éš”3å–ä¸€ä¸ªï¼›åªæœ‰åˆ—è¡¨çš„æ—¶å€™æ‰èƒ½ä½¿ç”¨[ ]å–æ­¥é•¿   è®¾ç½®xè½´çš„åˆ»åº¦ï¼ˆä¸¤ä¸ªå‚æ•°ï¼‰  plt.xticks(x,_xticks_labels) _x = x # intç±»å‹ _xtick_labels = [\u0026quot;hello,{}\u0026quot;.format(i) for i in _x] plt.xticks(_x,_xtick_labels)  formatå‡½æ•°: æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„å‡½æ•° str.format()ï¼Œå®ƒå¢å¼ºäº†å­—ç¬¦ä¸²æ ¼å¼åŒ–çš„åŠŸèƒ½. åŸºæœ¬è¯­æ³•æ˜¯é€šè¿‡ {} å’Œ : ï¼Œæ¥ä»£æ›¿ä»¥å‰çš„%.\nformat å‡½æ•°å¯ä»¥æ¥å—ä¸é™ä¸ªå‚æ•°ï¼Œä½ç½®å¯ä»¥ä¸æŒ‰é¡ºåº.\n\u0026quot;{} {}\u0026quot;.format(\u0026quot;hello\u0026quot;, \u0026quot;world\u0026quot;) # ä¸è®¾ç½®æŒ‡å®šä½ç½®ï¼ŒæŒ‰é»˜è®¤é¡ºåº 'hello world'  format å‡½æ•°å¯ä»¥æ¥å—ä¸é™ä¸ªå‚æ•°,ä½ç½®ä¹Ÿå¯ä»¥è®¾ç½®å‚æ•°ï¼š\nprint(\u0026quot;ç½‘ç«™åï¼š{name}, åœ°å€ {url}\u0026quot;.format(name=\u0026quot;ç™¾åº¦\u0026quot;, url=\u0026quot;www.Baidu.com\u0026quot;))  æ”¹è¿›ï¼š\n_x = list(x) # intç±»å‹ _xtick_labels = [\u0026quot;hello,{}\u0026quot;.format(i) for i in _x]\t# å–æ­¥é•¿ä¸€æ ·ï¼Œæ•°å­—å’Œå­—ç¬¦ä¸²ä¸€ä¸€å¯¹åº”ï¼Œæ•°æ®é•¿åº¦ä¸€æ · plt.xticks(_x[::8],_xtick_labels[::8])  ä½¿ç”¨rotationå‚æ•°æ—‹è½¬\nplt.xticks(_x[::8],_xtick_labels[::8],rotation=45)  ä¸­æ–‡æƒ…å†µå¤„ç†ï¼š ã€€matplotlibé»˜è®¤ä¸æ”¯æŒä¸­æ–‡å­—ç¬¦ï¼Œå› ä¸ºé»˜è®¤çš„è‹±æ–‡å­—ä½“æ— æ³•æ˜¾ç¤ºæ±‰å­—\nå¦‚ä½•ä¿®æ”¹matplotlibçš„é»˜è®¤å­—ä½“?\né€šè¿‡matplotlib.rcå¯ä»¥ä¿®æ”¹,å…·ä½“æ–¹æ³•å‚è§æºç (windows/linux) import matplotlib font = {'family': \u0026quot;simhei\u0026quot;,'size': '10'} # é»‘ä½“ matplotlib.rc(\u0026quot;font\u0026quot;,**font)  é€šè¿‡matplotlib ä¸‹çš„font_managerå¯ä»¥è§£å†³(windows/linux/mac)\n# è®¾ç½®ä¸­æ–‡å­—ä½“ï¼ˆæŒ‡å®šçš„å­—ä½“æ–‡ä»¶è·¯å¾„ï¼Œç„¶ååœ¨æ˜¾ç¤ºä¸­æ–‡çš„åœ°æ–¹æ·»åŠ fontpropertiesï¼‰ my_font = font_manager.FontProperties(fname=\u0026quot;/System/Library/Fonts/PingFang.ttc\u0026quot;) plt.xticks(x[::5],_x_ticks[::5],rotation=90,fontproperties=my_font)  çº¿æ¡çš„æ ·å¼(æ¯”å¦‚é¢œè‰²,é€æ˜åº¦ç­‰) plt.grid()\t# ç»˜åˆ¶ç½‘æ ¼ plt.grid(alpha=0.6)\t# ç»˜åˆ¶ç½‘æ ¼ï¼Œå¹¶è°ƒæ•´é€æ˜åº¦  ç»˜åˆ¶é£æ ¼åŠæè¿° ã€€æè¿°ä¸åŒæ›²çº¿å«ä¹‰ï¼šåœ¨plot()ä¸­æ·»åŠ å‚æ•°label=\u0026quot;Name\u0026quot; å†æ·»åŠ è¯­å¥ï¼š\nplt.legend(loc=0)/plt.legend(prop=my_font) # locä½ç½®ï¼š0=best/upper left  å¸¸ç”¨ç»Ÿè®¡å›¾ ã€€ç»Ÿè®¡å›¾æ˜¯æ•°æ®åˆ†æå’Œæ•°å­¦å»ºæ¨¡æœ€ç›´æ¥ã€æœ€æœ‰æ•ˆçš„å¯è§†åŒ–å½¢å¼.è¿™é‡Œåªæ˜¯ç®€å•è¯´æ˜åœ¨Pythonä¸­ä¸åŒçš„ç»˜å›¾å‘½ä»¤.\n æŠ˜çº¿å›¾:ä»¥æŠ˜çº¿çš„ä¸Šå‡æˆ–ä¸‹é™æ¥è¡¨ç¤ºç»Ÿè®¡æ•°é‡çš„å¢å‡å˜åŒ–çš„ç»Ÿè®¡å›¾.  ç‰¹ç‚¹:èƒ½å¤Ÿæ˜¾ç¤ºæ•°æ®çš„å˜åŒ–è¶‹åŠ¿ï¼Œåæ˜ äº‹ç‰©çš„å˜åŒ–æƒ…å†µ(å˜åŒ–).   ç›´æ–¹å›¾:ç”±ä¸€ç³»åˆ—é«˜åº¦ä¸ç­‰çš„çºµå‘æ¡çº¹æˆ–çº¿æ®µè¡¨ç¤ºæ•°æ®åˆ†å¸ƒçš„æƒ…å†µ. ä¸€èˆ¬ç”¨æ¨ªè½´è¡¨ç¤ºæ•°æ®èŒƒå›´ï¼Œçºµè½´è¡¨ç¤ºåˆ†å¸ƒæƒ…å†µ.  ç‰¹ç‚¹:ç»˜åˆ¶è¿ç»­æ€§çš„æ•°æ®,å±•ç¤ºä¸€ç»„æˆ–è€…å¤šç»„æ•°æ®çš„åˆ†å¸ƒçŠ¶å†µ(ç»Ÿè®¡).   æ¡å½¢å›¾:æ’åˆ—åœ¨å·¥ä½œè¡¨çš„åˆ—æˆ–è¡Œä¸­çš„æ•°æ®å¯ä»¥ç»˜åˆ¶åˆ°æ¡å½¢å›¾ä¸­.  ç‰¹ç‚¹:ç»˜åˆ¶è¿ç¦»æ•£çš„æ•°æ®,èƒ½å¤Ÿä¸€çœ¼çœ‹å‡ºå„ä¸ªæ•°æ®çš„å¤§å°,æ¯”è¾ƒæ•°æ®ä¹‹é—´çš„å·®åˆ«(ç»Ÿè®¡).   æ•£ç‚¹å›¾:ç”¨ä¸¤ç»„æ•°æ®æ„æˆå¤šä¸ªåæ ‡ç‚¹ï¼Œè€ƒå¯Ÿåæ ‡ç‚¹çš„åˆ†å¸ƒ,åˆ¤æ–­ä¸¤å˜é‡ä¹‹é—´æ˜¯å¦å­˜åœ¨æŸç§å…³è”æˆ–æ€»ç»“åæ ‡ç‚¹çš„åˆ†å¸ƒæ¨¡å¼.  ç‰¹ç‚¹:åˆ¤æ–­å˜é‡ä¹‹é—´æ˜¯å¦å­˜åœ¨æ•°é‡å…³è”è¶‹åŠ¿,å±•ç¤ºç¦»ç¾¤ç‚¹(åˆ†å¸ƒè§„å¾‹).    ç»˜åˆ¶æŠ˜çº¿å›¾ï¼šplt.plot(x,y) import numpy as np linear_data = np.arange(1, 9) quadratic_data = linear_data ** 2 plt.figure() plt.plot(linear_data, '-o', quadratic_data, '-o') # æ³¨æ„ï¼Œè¿™é‡ŒåªæŒ‡å®šäº†yè½´æ•°æ®ï¼Œxè½´çš„æ•°æ®æ˜¯matplotlibè‡ªåŠ¨ç”Ÿæˆçš„ # æ·»åŠ åæ ‡è½´æ ‡ç­¾åŠå›¾ä¾‹ plt.xlabel('x data') plt.ylabel('y data') plt.title('Line Chart Title') plt.legend(['legend1', 'legend2', 'legend3']) # å¡«å……ä¸¤ä¸ªlineé—´çš„åŒºåŸŸplt.gca().fill_between(x,y1,y2,color,é€æ˜åº¦) plt.gca().fill_between(range(len(linear_data)), linear_data, quadratic_data, facecolor='green', alpha=0.25)  æ³¨æ„ï¼š\n# å¯¹äºå­¦æœ¯åˆ¶å›¾ï¼Œå¯åœ¨æ ‡é¢˜ä¸­åŒ…å«latexè¯­æ³• ax = plt.gca() ax.set_title('Quadratic ($x^2$) vs. Linear ($x$)')  ç»˜åˆ¶æ•£ç‚¹å›¾ï¼šplt.scatter(x,y) å‡è®¾é€šè¿‡çˆ¬è™«ä½ è·å–åˆ°äº†åŒ—äº¬2016å¹´3,10æœˆä»½æ¯å¤©ç™½å¤©çš„æœ€é«˜æ°”æ¸©(åˆ†åˆ«ä½äºåˆ—è¡¨a,b),é‚£ä¹ˆæ­¤æ—¶å¦‚ä½•å¯»æ‰¾å‡ºæ°”æ¸©å’Œéšæ—¶é—´(å¤©)å˜åŒ–çš„æŸç§è§„å¾‹?\nfrom matplotlib import pyplot as plt import matplotlib # è®¾ç½®å­—ä½“æ ·å¼ font = {'family': \u0026quot;simhei\u0026quot;, 'size':'10'} matplotlib.rc(\u0026quot;font\u0026quot;,**font) # æ•°æ® y_3 = [11,17,16,11,12,11,12,6,6,7,8,9,12,15,14,17,18,21,16,17,20,14,15,15,15,19,21,22,22,22,23] y_10 = [26,26,28,19,21,17,16,19,18,20,20,19,22,23,17,20,21,20,22,15,11,15,5,13,17,10,11,13,12,13,6] # 3æœˆï¼Œ10æœˆèŒƒå›´ x_3 = range(1,32) x_10 = range(50,81) # åˆå¹¶æ¨ªåæ ‡ plt.figure(figsize=(14,8),dpi=80) # ç»˜åˆ¶æ•£ç‚¹å›¾ plt.scatter(x_3,y_3,label=\u0026quot;3æœˆä»½\u0026quot;) plt.scatter(x_10,y_10,label=\u0026quot;10æœˆä»½\u0026quot;) # è®¾ç½®xè½´ _x = list(x_3) + list(x_10) _xticks_labels = [\u0026quot;3æœˆ{}æ—¥\u0026quot;.format(i) for i in x_3] _xticks_labels += [\u0026quot;10æœˆ{}æ—¥\u0026quot;.format(i) for i in x_10] plt.xticks(_x[::3],_xticks_labels[::3],rotation=45) plt.legend(loc=\u0026quot;upper left\u0026quot;) # æ˜¾ç¤ºè®¾ç½® plt.xlabel(\u0026quot;æœˆä»½\u0026quot;) plt.ylabel(\u0026quot;æ¸©åº¦\u0026quot;) plt.title(\u0026quot;æ ‡é¢˜\u0026quot;) # å±•ç¤º plt.show()  ç»˜åˆ¶æ¡å½¢å›¾/æŸ±çŠ¶å›¾ï¼š plt.bar(x, y, width=0.2, color='orange') plt.bar(x, y, height=0.2, color='orange')  ä¾‹.\nfrom matplotlib import pyplot as plt import matplotlib # è®¾ç½®å­—ä½“æ ·å¼ font = {'family': \u0026quot;simhei\u0026quot;, 'size':'10'} matplotlib.rc(\u0026quot;font\u0026quot;,**font) a = [\u0026quot;æˆ˜ç‹¼2\u0026quot;,\u0026quot;é€Ÿåº¦ä¸æ¿€æƒ…8\u0026quot;,\u0026quot;åŠŸå¤«ç‘œä¼½\u0026quot;,\u0026quot;è¥¿æ¸¸ä¼å¦–ç¯‡\u0026quot;,\u0026quot;å˜å½¢é‡‘åˆš5ï¼šæœ€åçš„éª‘å£«\u0026quot;,\u0026quot;æ‘”è·¤å§ï¼çˆ¸çˆ¸\u0026quot;,\u0026quot;åŠ å‹’æ¯”æµ·ç›—5ï¼šæ­»æ— å¯¹è¯\u0026quot;,\u0026quot;é‡‘åˆšï¼šéª·é«…å²›\u0026quot;,\u0026quot;æé™ç‰¹å·¥ï¼šç»ˆæå›å½’\u0026quot;,\u0026quot;ç”ŸåŒ–å±æœº6ï¼šç»ˆç« \u0026quot;,\u0026quot;ä¹˜é£ç ´æµª\u0026quot;,\u0026quot;ç¥å·å¥¶çˆ¸3\u0026quot;,\u0026quot;æ™ºå–å¨è™å±±\u0026quot;,\u0026quot;å¤§é—¹å¤©ç«º\u0026quot;,\u0026quot;é‡‘åˆšç‹¼3ï¼šæ®Šæ­»ä¸€æˆ˜\u0026quot;,\u0026quot;èœ˜è››ä¾ ï¼šè‹±é›„å½’æ¥\u0026quot;,\u0026quot;æ‚Ÿç©ºä¼ \u0026quot;,\u0026quot;é“¶æ²³æŠ¤å«é˜Ÿ2\u0026quot;,\u0026quot;æƒ…åœ£\u0026quot;,\u0026quot;æ–°æœ¨ä¹ƒä¼Š\u0026quot;] b = [56.01,26.94,17.53,16.49,15.45,12.96,11.8,11.61,11.28,11.12,10.49,10.3,8.75,7.55,7.32,6.99,6.88,6.86,6.58,6.23] plt.figure(figsize=(12,8),dpi=80) x = range(len(a)) plt.bar(x, b, width=0.2, color='orange') plt.xticks(x, a, rotation=45) plt.show()  å‘ç°å­—æ•°é•¿çš„åå­—é”™ä½,æ¨ªå‘çš„æ¡å½¢å›¾,å°†\nplt.bar(x, y, width=0.2, color='orange')  æ”¹æˆ\nplt.bar(x, y, height=0.2, color='orange')  å†é€‚å½“è°ƒæ•´å…¶ä»–å‚æ•°. ä¾‹.å‡è®¾ä½ çŸ¥é“äº†åˆ—è¡¨aä¸­ç”µå½±åˆ†åˆ«åœ¨2017-09-14(b_14), 2017-09-15(b_15), 2017-09-16(b_16)ä¸‰å¤©çš„ç¥¨æˆ¿,ä¸ºäº†å±•ç¤ºåˆ—è¡¨ä¸­ç”µå½±æœ¬èº«çš„ç¥¨æˆ¿ä»¥åŠåŒå…¶ä»–ç”µå½±çš„æ•°æ®å¯¹æ¯”æƒ…å†µ,åº”è¯¥å¦‚ä½•æ›´åŠ ç›´è§‚çš„å‘ˆç°è¯¥æ•°æ®?\nfrom matplotlib import pyplot as plt import matplotlib # è®¾ç½®å­—ä½“æ ·å¼ font = {'family': \u0026quot;simhei\u0026quot;, 'size':'10'} matplotlib.rc(\u0026quot;font\u0026quot;,**font) a = [\u0026quot;çŒ©çƒå´›èµ·3ï¼šç»ˆæä¹‹æˆ˜\u0026quot;,\u0026quot;æ•¦åˆ»å°”å…‹\u0026quot;,\u0026quot;èœ˜è››ä¾ ï¼šè‹±é›„å½’æ¥\u0026quot;,\u0026quot;æˆ˜ç‹¼2\u0026quot;] b_16 = [15746,312,4497,319] b_15 = [12357,156,2045,168] b_14 = [2358,399,2358,362] bar_width = 0.2 plt.figure(figsize=(10,8),dpi=80) x_14 = list(range(len(a))) x_15 = [i+bar_width for i in x_14] x_16 = [i+bar_width for i in x_15] plt.bar(x_14, b_14, width=bar_width,label=\u0026quot;2017-09-14\u0026quot;) plt.bar(x_15, b_15, width=bar_width,label=\u0026quot;2017-09-15\u0026quot;) plt.bar(x_16, b_16, width=bar_width,label=\u0026quot;2017-09-16\u0026quot;) plt.xticks(x_15, a) plt.legend() plt.show()  å †å æŸ±çŠ¶å›¾\n# stack bar chart plt.figure() x_vals = list(range(len(linear_data))) plt.bar(x_vals, linear_data, width=0.3) plt.bar(x_vals, quadratic_data, width=0.3, bottom=linear_data)  ç»˜åˆ¶ç›´æ–¹å›¾ é¢‘æ•°åˆ†å¸ƒç›´æ–¹å›¾ ã€€å‡è®¾ä½ è·å–äº†250éƒ¨ç”µå½±çš„æ—¶é•¿(åˆ—è¡¨aä¸­),å¸Œæœ›ç»Ÿè®¡å‡ºè¿™äº›ç”µå½±æ—¶é•¿çš„åˆ†å¸ƒçŠ¶æ€(æ¯”å¦‚æ—¶é•¿ä¸º100åˆ†é’Ÿåˆ°120åˆ†é’Ÿç”µå½±çš„æ•°é‡,å‡ºç°çš„é¢‘ç‡)ç­‰ä¿¡æ¯,ä½ åº”è¯¥å¦‚ä½•å‘ˆç°è¿™äº›æ•°æ®?\nfrom matplotlib import pyplot as plt import matplotlib # è®¾ç½®å­—ä½“æ ·å¼ font = {'family': \u0026quot;simhei\u0026quot;, 'size':'10'} matplotlib.rc(\u0026quot;font\u0026quot;,**font) a=[131, 98, 125, 131, 124, 139, 131, 117, 128, 108, 135, 138, 131, 102, 107, 114, 119, 128, 121, ...] # è®¡ç®—ç»„è· dis = 3 num_bins = (max(a)-min(a))//dis plt.figure(figsize=(12,8),dpi=80) plt.hist(a, num_bins) plt.xticks(range(min(a),max(a)+dis,dis)) plt.grid() plt.show()  é¢‘ç‡åˆ†å¸ƒç›´æ–¹å›¾ plt.hist(a, num_bins,normed=1/True)  ä¾‹. åœ¨ç¾å›½2004å¹´äººå£æ™®æŸ¥å‘ç°æœ‰124 millionçš„äººåœ¨ç¦»å®¶ç›¸å¯¹è¾ƒè¿œçš„åœ°æ–¹å·¥ä½œ. æ ¹æ®ä»–ä»¬ä»å®¶åˆ°ä¸Šç­åœ°ç‚¹æ‰€éœ€è¦çš„æ—¶é—´,é€šè¿‡æŠ½æ ·ç»Ÿè®¡(æœ€åä¸€åˆ—)å‡ºäº†ä¸‹è¡¨çš„æ•°æ®,è¿™äº›æ•°æ®èƒ½å¤Ÿç»˜åˆ¶æˆç›´æ–¹å›¾ä¹ˆ? æ•°æ®è¢«ç»Ÿè®¡åï¼Œç»„è·ä¸åŒï¼ˆä¸èƒ½ä½¿ç”¨histï¼‰\nè§£å†³åŠæ³•ï¼šä½¿ç”¨barï¼ˆæ¡å½¢å›¾ï¼‰åœ¨è¿›è¡Œè°ƒæ•´.\nfrom matplotlib import pyplot as plt import matplotlib # è®¾ç½®å­—ä½“æ ·å¼ font = {'family': \u0026quot;simhei\u0026quot;, 'size':'10'} matplotlib.rc(\u0026quot;font\u0026quot;,**font) interval = [0,5,10,15,20,25,30,35,40,45,60,90] width = [5,5,5,5,5,5,5,5,5,15,30,60] quantity = [836,2737,3723,3926,3596,1438,3273,642,824,613,215,47] plt.figure(figsize=(14,8),dpi=80) # é»˜è®¤å®½åº¦æ˜¯0.8ï¼Œä¸ºäº†æ˜¯æ¡å½¢å›¾è¿èµ·æ¥ï¼Œä»¤width=1 plt.bar(range(12), quantity, width=1) # è®¾ç½®Xè½´çš„åˆ»åº¦â€”â€”ä¸ºäº†è®©èµ·ç‚¹ä»é›¶å¼€å§‹ï¼Œæ‰€ä»¥i-1 _x = [i-0.5 for i in range(13)] _xticks_labels = interval+[150] plt.xticks(_x, _xticks_labels) plt.grid(linestyle='--') plt.show()  å¤æ‚åˆ†æå›¾ # ä½¿ç”¨gridspecå’Œç›´æ–¹å›¾ç»˜åˆ¶ä¸€ä¸ªå¤æ‚åˆ†æå›¾ import matplotlib.gridspec as gridspec x = np.random.random(size=10000) y = np.random.normal(loc=0., scale=1., size=10000) plt.figure() gspec = gridspec.GridSpec(3, 3) top_hist = plt.subplot(gspec[0, 1:]) side_hist = plt.subplot(gspec[1:, 0]) lower_right = plt.subplot(gspec[1:, 1:]) lower_right.scatter(x, y) top_hist.hist(x, bins=100, normed=True) side_hist.hist(y, bins=100, orientation='horizontal', normed=True) side_hist.invert_xaxis()  çƒ­å›¾ ã€€å¯ç”¨äºä¸‰ç»´æ•°æ®å¯è§†åŒ–\nplt.imshow(arr) plt.hist2d() plt.colorbar() # æ·»åŠ é¢œè‰²æ¡  å…¶ä»–  matplotlibæ”¯æŒçš„å›¾å½¢æ˜¯éå¸¸å¤šçš„ï¼Œå¦‚æœæœ‰å…¶ä»–çš„éœ€æ±‚ï¼Œå¯ä»¥æŸ¥çœ‹ä¸€ä¸‹urlåœ°å€ï¼šhttp://matplotlib.org/gallery/index.html echartsä¸­å¯ä»¥çœ‹æ¡†æ¶å®ä¾‹ æ›´å¤šç»˜å›¾å·¥å…·ï¼š plotly:å¯è§†åŒ–å·¥å…·ä¸­çš„github,ç›¸æ¯”äºmatplotlibæ›´åŠ ç®€å•,å›¾å½¢æ›´åŠ æ¼‚äº®,åŒæ—¶å…¼å®¹matplotlibå’Œpandas ä½¿ç”¨ç”¨æ³•:ç®€å•,ç…§ç€æ–‡æ¡£å†™å³å¯ æ–‡æ¡£åœ°å€: https://plot.ly/python/  å¤‡æ³¨ï¼šå¦‚æœæƒ³ä½¿ç”¨å­å›¾ï¼Œç”¨subplotå‡½æ•°ï¼Œå¦‚æœå¯¹æ¯”å­å›¾åˆ™å¾äºšåæ ‡è½´ç›¸åŒï¼Œæ·»åŠ sharey=ï¼ˆè·Ÿå“ªå¼ å›¾å…±äº«åæ ‡è½´ï¼‰\nPandasç»˜å›¾ Pandasçš„DataFrameç»˜å›¾ å…ˆè½¬æ¢æˆdataframeæ ¼å¼è¿›è¡Œç”»å›¾\ndf.plot(kind=) pd.plotting.Tools pd.plotting.scatter_matrix() pd.plotting.parallel_coordinates()  ç»˜åˆ¶æŠ˜çº¿å›¾ np.random.seed(100) df = pd.DataFrame({'A': np.random.randn(365).cumsum(0), 'B': np.random.randn(365).cumsum(0) + 20, 'C': np.random.randn(365).cumsum(0) - 20}, index=pd.date_range('2017/1/1', periods=365)) df.plot()  ç»˜åˆ¶æ•£ç‚¹å›¾ df.plot('A', 'B', kind='scatter')  # é¢œè‰²(c)å’Œå¤§å°(s)æœ‰'B'åˆ—çš„æ•°æ®å†³å®š ax = df.plot('A', 'C', kind='scatter', c='B', s=df['B'], colormap='viridis')  ç›’å½¢å›¾ df.plot(kind='box')  æŸ±çŠ¶å›¾ df.plot(kind='hist', alpha=0.7) df.plot(kind='kde') # æ‹Ÿåˆåˆ†å¸ƒ  Seabornç»˜å›¾ seabornçš„å®‰è£…ï¼š\n1. conda install seaborn 2. pip install seaborn  ","date":1611273600,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1611273600,"objectID":"bc0ba72ae8f8aed4b3757171e8e3b7df","permalink":"https://CoMath21.github.io/post/0-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%901/","publishdate":"2021-01-22T00:00:00Z","relpermalink":"/post/0-python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%901/","section":"post","summary":"Pythonæ•°æ®åˆ†æå‰çš„å‡†å¤‡.","tags":["ç¼–ç¨‹è¯­è¨€","Python","æ•°æ®åˆ†æ"],"title":"Pythonæ•°æ®åˆ†æï¼ˆä¸€ï¼‰","type":"post"},{"authors":["Xinæ€å¥½å…ˆç”Ÿ","CoMath"],"categories":["å­¦ä¹ ç¬”è®°","ç¼–ç¨‹è¯­è¨€"],"content":"  æ–‡å­—ç‰¹æ®Šæ ‡æ³¨\n  æ ‡é¢˜\nä½¿ç”¨æ–¹å¼ï¼š#ä¸€çº§æ ‡é¢˜\t##äºŒçº§æ ‡é¢˜\t######å…­çº§æ ‡é¢˜\nä¸€çº§æ ‡é¢˜ äºŒçº§æ ‡é¢˜ å…­çº§æ ‡é¢˜   ä¸‹åˆ’çº¿\nctrl+u\nä¸‹åˆ’çº¿\n  å¼ºè°ƒ\nä½¿ç”¨æ–¹å¼ï¼šåœ¨å¼ºè°ƒçš„å†…å®¹å‰åå„æ·»åŠ ä¸¤ä¸ª*\nctrl+b\nå¼ºè°ƒçš„å†…å®¹\n  æ–œä½“\nä½¿ç”¨æ–¹å¼ï¼šå†…å®¹å‰åå„æ·»åŠ ä¸€ä¸ª*\nctrl+i\næ–œä½“å†…å®¹\n  åˆ é™¤çº¿\nä½¿ç”¨æ–¹å¼ï¼šå†…å®¹å‰åå„æ·»åŠ ä¸¤ä¸ª~\nåˆ é™¤çº¿\n  é«˜äº®\nä½¿ç”¨æ–¹å¼ï¼šå†…å®¹å‰åå„æ·»åŠ ä¸¤ä¸ª=\n==é«˜äº®==\n    list\n  æœ‰åºåˆ—è¡¨\nä½¿ç”¨æ–¹å¼ï¼šæ•°å­—1+.\n      æ— åºåˆ—è¡¨\nä½¿ç”¨æ–¹å¼ï¼š+/-/*\n       table\nctrl+t\n   åºå· å§“å æˆç»© æ’å     1 å¼ ä¸‰ 100 1            åˆ†å‰²çº¿\nä½¿ç”¨æ–¹å¼ï¼šè¾“å…¥ä¸‰ä¸ªåŠä»¥ä¸Š*æˆ–-\n    æ’å…¥å…ƒç´ \n  å›¾ç‰‡\næ’å…¥æœ¬åœ°å›¾ç‰‡ï¼šç›´æ¥æŠŠå›¾ç‰‡æ‹–å…¥å³å¯ï¼› æ’å…¥ç½‘ç»œå›¾ç‰‡ï¼š! [å›¾ç‰‡æ ‡é¢˜] (å›¾ç‰‡é“¾æ¥)\n  é“¾æ¥\nä½¿ç”¨æ–¹å¼ï¼š[é“¾æ¥æç¤º] (é“¾æ¥åœ°å€)\nç™¾åº¦\n  æ•°å­¦å…¬å¼\nä½¿ç”¨æ–¹å¼ï¼š$$ å›è½¦ $$ x^2+x_1+7=0 $$\n  ä»£ç \nè¡Œå†…ä»£ç ï¼šä»£ç ä¸¤ç«¯å„åŠ ä¸€ä¸ª`\nâ€‹\tSystem.out.println();\nä»£ç å—ï¼šè¾“å…¥ä¸‰ä¸ª~ å›è½¦\npublic static void main(String[] args){ System.out.println(\u0026quot;hello world\u0026quot;); }      æ³¨æ„  ä½¿ç”¨ä¿¡å·ç¬¦å’Œæ–‡å­—é—´åŠ ä¸€ä¸ªç©ºæ ¼æˆ–å›è½¦ï¼Œå³å¯äº§ç”Ÿæ•ˆæœ å¼ºå¤§çš„å¯¼å‡ºåŠŸèƒ½  ","date":1611100800,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1611100800,"objectID":"6e4a2227ea2c55aa7d75770fac9a6ee8","permalink":"https://CoMath21.github.io/post/0-typora%E4%BD%BF%E7%94%A8/","publishdate":"2021-01-20T00:00:00Z","relpermalink":"/post/0-typora%E4%BD%BF%E7%94%A8/","section":"post","summary":"Typorå¿«é€Ÿå…¥é—¨ç®€ä»‹","tags":["ç¼–ç¨‹è¯­è¨€","Typora"],"title":"Typoraä½¿ç”¨","type":"post"},{"authors":["Xinæ€å¥½å…ˆç”Ÿ","CoMath"],"categories":null,"content":"ä¸€ä¸ªäººæœ€å¥½çš„ç”Ÿæ´»çŠ¶æ€ï¼Œæ˜¯è¯¥çœ‹ä¹¦æ—¶çœ‹ä¹¦ï¼Œè¯¥ç©æ—¶å°½æƒ…ç©ï¼Œçœ‹è§ä¼˜ç§€çš„äººæ¬£èµï¼Œçœ‹åˆ°è½é­„çš„äººä¹Ÿä¸è½»è§†ï¼Œæœ‰è‡ªå·±çš„å°ç”Ÿæ´»å’Œå°æƒ…è¶£ï¼Œä¸ç”¨å»æƒ³æ”¹å˜ä¸–ç•Œï¼ŒåŠªåŠ›å»æ´»å‡ºè‡ªå·±ã€‚æ²¡äººçˆ±æ—¶ä¸“æ³¨è‡ªå·±ï¼Œæœ‰äººçˆ±æ—¶ï¼Œæœ‰èƒ½åŠ›æ‹¥æŠ±å½¼æ­¤\n","date":1611100800,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1611100800,"objectID":"83707939014fe3796e181283a66a9a76","permalink":"https://CoMath21.github.io/talk/demo/","publishdate":"2021-01-20T00:00:00Z","relpermalink":"/talk/demo/","section":"talk","summary":"æ€»è¦ç•™ç‚¹ä¸œè¥¿å ä¸ªåœ°æ–¹.","tags":[],"title":"æµ‹è¯•-Demo","type":"talk"},{"authors":null,"categories":null,"content":"","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":-62135596800,"objectID":"c1d17ff2b20dca0ad6653a3161942b64","permalink":"https://CoMath21.github.io/people/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/people/","section":"","summary":"","tags":null,"title":"å…³äº","type":"widget_page"},{"authors":null,"categories":null,"content":"","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":-62135596800,"objectID":"5fcc8730459b0823616811b99a622d2b","permalink":"https://CoMath21.github.io/category/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/category/","section":"","summary":"","tags":null,"title":"åˆ†ç±»","type":"widget_page"},{"authors":null,"categories":null,"content":"","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":-62135596800,"objectID":"9a6cb9348361050ffbcc0117246adb56","permalink":"https://CoMath21.github.io/tag/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/tag/","section":"","summary":"","tags":null,"title":"æ ‡ç­¾","type":"widget_page"}]